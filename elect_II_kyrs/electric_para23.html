<!DOCTYPE html><html lang="uk"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>–ü–∞—Ä–∞ 23 (–ï–ª–µ–∫—Ç—Ä–∏–∫–∞) ‚Äî –®–Ü-–ø–æ–º—ñ—á–Ω–∏–∫ —Ç–µ—Ö–æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è: SOP ‚Üí —á–µ–∫-–ª–∏—Å—Ç–∏, –∫–≤—ñ–∑, RAG</title>
<meta name="description" content="–ü–∞—Ä—Å–∏–º–æ SOP/—ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó, —Ñ–æ—Ä–º—É—î–º–æ —á–µ–∫-–ª–∏—Å—Ç–∏ (58 –º–º), –≥–µ–Ω–µ—Ä—É—î–º–æ –∫–≤—ñ–∑ —ñ –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ, –ª–æ–∫–∞–ª—å–Ω–∏–π RAG-–ø–æ—à—É–∫ –ø–æ –±–∞–∑—ñ SOP, –µ–∫—Å–ø–æ—Ä—Ç CSV/TXT/ICS.">
<meta name="color-scheme" content="light dark">
<style>
:root{--bg:#0b1220;--panel:#0f172a;--muted:#94a3b8;--text:#e6eef9;--line:#223049;--brand:#38bdf8;--ok:#22c55e;--warn:#fbbf24;--bad:#f87171}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,Arial,sans-serif}
.wrap{max-width:1100px;margin:0 auto;padding:16px}
header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.logo{display:flex;align-items:center;gap:10px}
.logo .emoji{font-size:28px}
.logo .badge{font-size:.9rem;color:var(--muted);border:1px solid var(--line);padding:2px 8px;border-radius:999px}
h1{margin:.2em 0 .3em 0}
.muted{color:var(--muted)}
.card{border:1px solid var(--line);border-radius:16px;background:var(--panel);padding:14px;margin-top:14px}
.row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.input,select,textarea{width:100%;padding:8px;border-radius:10px;border:1px solid var(--line);background:#0b1220;color:var(--text)}
.btn{border:1px solid var(--line);background:#0f1f39;color:var(--text);padding:8px 12px;border-radius:10px;cursor:pointer}
.btn.secondary{background:transparent}
.btn.good{border-color:#204b2a;background:#12341b}
.badge{display:inline-block;border:1px solid var(--line);border-radius:999px;padding:2px 8px;color:var(--muted);margin-right:6px}
pre.code{background:#0b1220;border:1px solid var(--line);border-radius:12px;padding:12px;overflow:auto;white-space:pre-wrap}
.small{font-size:.9rem}
.tbl{width:100%;border-collapse:collapse;font-size:.95rem}
.tbl th,.tbl td{border:1px solid var(--line);padding:6px;text-align:left;vertical-align:top}
.tbl th{background:#0b1a2f}
.canvasWrap{border:1px solid var(--line);border-radius:12px;overflow:hidden;background:#0b1220}
svg{max-width:100%;height:auto;display:block}
.note{border:1px dashed var(--line);border-radius:12px;padding:10px;background:#0c182a}
kbd{background:#111827;border:1px solid #334155;border-radius:6px;padding:2px 6px}
.footer{margin-top:20px;color:var(--muted);font-size:.9rem}
.receipt{background:#0b1220;border:1px dashed #334155;border-radius:12px;padding:10px;font-family:ui-monospace,monospace}
.tag{display:inline-block;border:1px solid var(--line);border-radius:999px;padding:2px 8px;color:var(--muted);margin-right:6px;margin-top:6px}
.ok{color:var(--ok)}.warn{color:var(--warn)}.bad{color:var(--bad)}
</style>
<link rel="canonical" href="https://edlab.pp.ua/elect_II_kyrs/electric_para23.html"><meta property="og:type" content="article"><meta property="og:title" content="–ï–ª–µ–∫—Ç—Ä–æ–µ–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞ ‚Äî –ü–∞—Ä–∞ 23"><meta property="og:description" content="–ú–µ—Ç–∞: –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ ¬´—Å–∏—Ä–∏–π¬ª SOP/—ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é (–∫–æ–ø—ñ—è –∑ PDF) —É —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—É –∫–∞—Ä—Ç—É —Ä–æ–±—ñ—Ç: PPE/–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏/–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞/–ö—Ä–æ–∫–∏/–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, –∑—Ä–æ–±–∏—Ç–∏ —á–µ–∫-–ª–∏—Å—Ç–∏ –∑ —Ç–∞–π–º-—à—Ç"><meta property="og:url" content="https://edlab.pp.ua/elect_II_kyrs/electric_para23.html"><script type="application/ld+json">{"@context":"https://schema.org","@type":"LearningResource","name":"–ï–ª–µ–∫—Ç—Ä–æ–µ–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞ ‚Äî –ü–∞—Ä–∞ 23","description":"–ú–µ—Ç–∞: –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ ¬´—Å–∏—Ä–∏–π¬ª SOP/—ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é (–∫–æ–ø—ñ—è –∑ PDF) —É —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—É –∫–∞—Ä—Ç—É —Ä–æ–±—ñ—Ç: PPE/–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏/–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞/–ö—Ä–æ–∫–∏/–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, –∑—Ä–æ–±–∏—Ç–∏ —á–µ–∫-–ª–∏—Å—Ç–∏ –∑ —Ç–∞–π–º-—à—Ç","inLanguage":"uk","educationalLevel":"college","url":"https://edlab.pp.ua/elect_II_kyrs/electric_para23.html","provider":{"@type":"Organization","name":"EDLab"}}</script></head>
<body>
<div class="wrap">
  <header>
    <div class="logo">
      <span class="emoji">üß∞</span>
      <div>
        <b>–ü–∞—Ä–∞ 23 ‚Äî –®–Ü-–ø–æ–º—ñ—á–Ω–∏–∫ —Ç–µ—Ö–æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è</b><br>
        <span class="badge">SOP ‚Üí —á–µ–∫-–ª–∏—Å—Ç–∏ 58 –º–º ‚Üí –∫–≤—ñ–∑ ‚Üí –ª–æ–∫–∞–ª—å–Ω–∏–π RAG ‚Üí –µ–∫—Å–ø–æ—Ä—Ç</span>
      </div>
    </div>
    <a class="btn" href="../index.html" target="_blank" rel="noopener">üè† –ù–∞ –≥–æ–ª–æ–≤–Ω—É</a>
  </header>

  <p class="muted">
    –ú–µ—Ç–∞: –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ ¬´—Å–∏—Ä–∏–π¬ª SOP/—ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é (–∫–æ–ø—ñ—è –∑ PDF) —É <b>—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—É –∫–∞—Ä—Ç—É —Ä–æ–±—ñ—Ç</b>: <i>PPE/–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏/–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞/–ö—Ä–æ–∫–∏/–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞</i>, 
    –∑—Ä–æ–±–∏—Ç–∏ <b>—á–µ–∫-–ª–∏—Å—Ç–∏</b> –∑ —Ç–∞–π–º-—à—Ç–∞–º–ø–∞–º–∏ —ñ –ø—ñ–¥–ø–∏—Å–æ–º, –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ <b>–∫–≤—ñ–∑</b>, –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ <b>–≤—ñ–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ</b>, 
    –∞ —Ç–∞–∫–æ–∂ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é <b>–ª–æ–∫–∞–ª—å–Ω–æ–≥–æ RAG</b> (–±–µ–∑ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—É). –ï–∫—Å–ø–æ—Ä—Ç —É <b>CSV/TXT/ICS</b> —ñ ¬´—á–µ–∫ 58 –º–º¬ª.
  </p>

  <div class="card">
    <h2>üìÑ –í–≤—ñ–¥ SOP (—Ç–µ–∫—Å—Ç/–∫–æ–ø—ñ—è –∑ PDF)</h2>
    <p class="small muted">–ú–æ–∂–Ω–∞ –≤—Å—Ç–∞–≤–∏—Ç–∏ —Ä–æ–∑–¥—ñ–ª–∏ —á–∏ —Å—É—Ü—ñ–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç. –ü–∞—Ä—Å–µ—Ä —à—É–∫–∞—î –∫–ª—é—á—ñ: <span class="mono">PPE, –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏, –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞, –ö—Ä–æ–∫–∏, –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞</span>. –Ø–∫—â–æ –∫–ª—é—á—ñ–≤ –Ω–µ–º–∞ ‚Äî —Ä–æ–∑—ñ–±‚Äô—î –∑–∞ —ñ–º–ø–µ—Ä–∞—Ç–∏–≤–∞–º–∏ (¬´–í–∏–º–∫–Ω–∏¬ª, ¬´–ü–µ—Ä–µ–≤—ñ—Ä¬ª, ¬´–ó–∞–∫—Ä—ñ–ø–∏¬ª...).</p>
    <textarea id="sop" class="input" rows="8" placeholder="PPE: –¥—ñ–µ–ª–µ–∫—Ç—Ä–∏—á–Ω—ñ —Ä—É–∫–∞–≤–∏—Ü—ñ, –∫–∞—Å–∫–∞, –æ–∫—É–ª—è—Ä–∏...
–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏: –º—É–ª—å—Ç–∏–º–µ—Ç—Ä CAT III, —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–ø—Ä—É–≥–∏, —ñ–∑–æ–ª—è—Ü—ñ–π–Ω–∏–π –ø–æ–∫–∞–∂—á–∏–∫...
–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞:
1) –í—ñ–¥–∫–ª—é—á–∏—Ç–∏ –≤–≤–æ–¥–Ω–∏–π –∞–≤—Ç–æ–º–∞—Ç QF1; 2) –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ LOTO; 3) –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –Ω–∞–ø—Ä—É–≥–∏;
–ö—Ä–æ–∫–∏:
1) –í—ñ–¥–∫—Ä–∏—Ç–∏ —à–∞—Ñ—É; 2) –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–∞—Ç—è–∂–∫—É –∫–ª–µ–º; 3) –û—á–∏—Å—Ç–∏—Ç–∏ –≤—ñ–¥ –ø–∏–ª—É; 4) –ó–∞–º—ñ—Ä –æ–ø–æ—Ä—É —ñ–∑–æ–ª—è—Ü—ñ—ó;
–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞:
1) –ó–Ω—è—Ç–∏ LOTO; 2) –£–≤—ñ–º–∫–Ω—É—Ç–∏ QF1; 3) –ó–∞–ø–∏—Å–∞—Ç–∏ –ø–æ–∫–∞–∑–∏ —É –∂—É—Ä–Ω–∞–ª;"></textarea>
    <div class="row" style="margin-top:6px">
      <button class="btn good" id="parse">üß© –†–æ–∑–ø–∞—Ä—Å–∏—Ç–∏</button>
      <button class="btn secondary" id="demo">üé≤ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ–π–Ω–∏–π SOP</button>
      <button class="btn secondary" id="clear">üßπ –û—á–∏—Å—Ç–∏—Ç–∏</button>
      <span id="badge" class="badge">–°—Ç–∞—Ç—É—Å: ‚Äî</span>
    </div>
  </div>

  <div class="card">
    <h2>‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –≤–∏–∫–æ–Ω–∞–Ω–Ω—è</h2>
    <div class="row">
      <input id="jobTitle" class="input" placeholder="–ù–∞–∑–≤–∞ —Ä–æ–±–æ—Ç–∏ (–Ω–∞–ø—Ä. –¢–û —â–∏—Ç–∞ –©–û-1)">
      <input id="who" class="input" placeholder="–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å (–ü–Ü–ë)">
      <input id="super" class="input" placeholder="–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä/–¥–æ–ø—É—Å–∫ (–ü–Ü–ë)">
      <input id="start" class="input" type="datetime-local">
      <input id="loc" class="input" placeholder="–ú—ñ—Å—Ü–µ/—à–∞—Ñ–∞/—Ñ—ñ–¥–µ—Ä">
    </div>
    <table class="tbl" id="tbl">
      <thead><tr><th>#</th><th>–ö—Ä–æ–∫</th><th>–ì–æ—Ç–æ–≤–æ</th><th>–ß–∞—Å</th><th>–ö–æ–º–µ–Ω—Ç–∞—Ä</th></tr></thead>
      <tbody></tbody>
    </table>
    <div class="row" style="margin-top:6px">
      <button class="btn" id="stampAll">‚è±Ô∏è –ü—Ä–æ—Å—Ç–∞–≤–∏—Ç–∏ —á–∞—Å</button>
      <button class="btn secondary" id="addStep">‚ûï –î–æ–¥–∞—Ç–∏ –∫—Ä–æ–∫</button>
      <button class="btn secondary" id="rmDone">üßΩ –ü—Ä–∏–±—Ä–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω—ñ</button>
      <button class="btn" id="receipt">üñ®Ô∏è 58 –º–º —á–µ–∫</button>
      <button class="btn" id="exportCsv">üìÑ CSV</button>
      <button class="btn" id="exportTxt">üíæ TXT</button>
      <button class="btn" id="exportIcs">üóìÔ∏è ICS</button>
    </div>
    <div class="receipt" id="rc" hidden=""></div>
  </div>

  <div class="card">
    <h2>üß† –ö–≤—ñ–∑ –ø–æ SOP + ¬´—á–µ–∫–µ—Ä¬ª –≤—ñ–ª—å–Ω–æ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ</h2>
    <div class="row">
      <button class="btn good" id="genQuiz">üìù –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ 6 –ø–∏—Ç–∞–Ω—å</button>
      <button class="btn secondary" id="clearQuiz">üßπ –û—á–∏—Å—Ç–∏—Ç–∏</button>
      <span id="qBadge" class="badge">–ü–∏—Ç–∞–Ω—å: 0</span>
    </div>
    <table class="tbl" id="quizTbl">
      <thead><tr><th>#</th><th>–ü–∏—Ç–∞–Ω–Ω—è</th><th>–í—ñ–¥–ø–æ–≤—ñ–¥—å</th><th>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞</th></tr></thead>
      <tbody></tbody>
    </table>
    <h3 style="margin-top:10px">‚úçÔ∏è –í—ñ–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –∑–∞–ø—É—Å–∫/–¥–æ–ø—É—Å–∫</h3>
    <textarea id="freeAns" class="input" rows="4" placeholder="–û–ø–∏—à–∏ —É—Å—ñ –∫—Ä–æ–∫–∏ LOTO —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ –Ω–∞–ø—Ä—É–≥–∏..."></textarea>
    <div class="row" style="margin-top:6px">
      <button class="btn" id="checkFree">‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
      <span id="freeScore" class="badge">–û—Ü—ñ–Ω–∫–∞: ‚Äî</span>
    </div>
  </div>

  <div class="card">
    <h2>üîé –õ–æ–∫–∞–ª—å–Ω–∏–π RAG-–ø–æ–º—ñ—á–Ω–∏–∫ (–±–µ–∑ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—É)</h2>
    <p class="small muted">–ó–∞–¥–∞–π –ø–∏—Ç–∞–Ω–Ω—è, –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —à—É–∫–∞—Ç–∏–º—É—Ç—å—Å—è —É —Ç–µ–∫—Å—Ç—ñ SOP (tf-idf/–∫–æ—Å–∏–Ω—É—Å). –í—ñ–¥–ø–æ–≤—ñ–¥—å –º—ñ—Å—Ç–∏—Ç–∏–º–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏.</p>
    <div class="row">
      <input id="q" class="input" placeholder="–©–æ —Ä–æ–±–∏—Ç–∏ –ø–µ—Ä–µ–¥ –∑–∞–º—ñ—Ä–∞–º–∏ –æ–ø–æ—Ä—É —ñ–∑–æ–ª—è—Ü—ñ—ó?">
      <button class="btn" id="ask">‚ùì –ó–∞–ø–∏—Ç–∞—Ç–∏</button>
    </div>
    <pre class="code" id="ragOut">// –í—ñ–¥–ø–æ–≤—ñ–¥—å –∑‚Äô—è–≤–∏—Ç—å—Å—è —Ç—É—Ç</pre>
  </div>

  <div class="card">
    <h2>üîÅ –°—Ö–µ–º–∞ –ø—Ä–æ—Ü–µ—Å—É (SVG)</h2>
    <svg viewBox="0 0 900 360" role="img" aria-label="SOP ‚Üí –ß–µ–∫-–ª–∏—Å—Ç ‚Üí –ö–≤—ñ–∑ ‚Üí RAG ‚Üí –ï–∫—Å–ø–æ—Ä—Ç">
      <rect x="30" y="40" width="180" height="80" rx="12" fill="#0e2a47" stroke="#3b82f6"></rect>
      <text x="120" y="70" fill="#e5e7eb" font-size="14" text-anchor="middle">SOP —Ç–µ–∫—Å—Ç</text>
      <text x="120" y="90" fill="#93c5fd" font-size="12" text-anchor="middle">–≤—Å—Ç–∞–≤–∫–∞ –∑ PDF</text>

      <rect x="240" y="40" width="180" height="80" rx="12" fill="#14532d" stroke="#22c55e"></rect>
      <text x="330" y="70" fill="#dcfce7" font-size="14" text-anchor="middle">–ü–∞—Ä—Å–µ—Ä</text>
      <text x="330" y="90" fill="#a7f3d0" font-size="12" text-anchor="middle">—Ä—É–±—Ä–∏–∫–∏/–∫—Ä–æ–∫–∏</text>

      <rect x="450" y="40" width="180" height="80" rx="12" fill="#7c2d12" stroke="#fb923c"></rect>
      <text x="540" y="70" fill="#fed7aa" font-size="14" text-anchor="middle">–ß–µ–∫-–ª–∏—Å—Ç</text>
      <text x="540" y="90" fill="#fed7aa" font-size="12" text-anchor="middle">—Ç–∞–π–º-—à—Ç–∞–º–ø–∏</text>

      <rect x="660" y="40" width="200" height="80" rx="12" fill="#1f2937" stroke="#9ca3af"></rect>
      <text x="760" y="70" fill="#e5e7eb" font-size="14" text-anchor="middle">–ö–≤—ñ–∑ + RAG</text>
      <text x="760" y="90" fill="#9ca3af" font-size="12" text-anchor="middle">–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–Ω–∞–Ω—å</text>

      <line x1="210" y1="80" x2="240" y2="80" stroke="#93c5fd" stroke-width="3"></line>
      <line x1="420" y1="80" x2="450" y2="80" stroke="#93c5fd" stroke-width="3"></line>
      <line x1="630" y1="80" x2="660" y2="80" stroke="#93c5fd" stroke-width="3"></line>
    </svg>
  </div>

  <div class="card">
    <h2>üìã –ü—ñ–¥—Å—É–º–æ–∫ –¥–ª—è –∑–≤—ñ—Ç—É</h2>
    <ul>
      <li>–ß–µ–∫-–ª–∏—Å—Ç (—Å–∫—Ä—ñ–Ω) + TXT/CSV/ICS.</li>
      <li>–ö–≤—ñ–∑: —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ (—Å–∫—Ä—ñ–Ω) + –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ.</li>
      <li>–ü—Ä–∏–∫–ª–∞–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ RAG —ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏ SOP.</li>
    </ul>
  </div>

  <div class="card">
    <h2>üìú –ù–æ—Ç–∞—Ç–∫–∞ –∑ —ñ—Å—Ç–æ—Ä—ñ—ó</h2>
    <p class="muted small">
      –ü–∞–ø–µ—Ä–æ–≤—ñ SOP –¥–µ—Å—è—Ç–∏–ª—ñ—Ç—Ç—è–º–∏ –±—É–ª–∏ ¬´–º–µ—Ä—Ç–≤–∏–º –∑–Ω–∞–Ω–Ω—è–º¬ª. –°—å–æ–≥–æ–¥–Ω—ñ –º–∏ –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ —ó—Ö –Ω–∞ <b>–∞–∫—Ç–∏–≤–Ω—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó</b> ‚Äî —á–µ–∫-–ª–∏—Å—Ç–∏ –∑ —Ç–∞–π–º-—à—Ç–∞–º–ø–∞–º–∏,
      –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è —Ç–∞ –ø–æ—à—É–∫ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ñ–≤ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ–π. –Ü –Ω–∞–≤—ñ—Ç—å –±–µ–∑ ¬´—Ö–º–∞—Ä¬ª –ª–æ–∫–∞–ª—å–Ω–∞ –º–æ–¥–µ–ª—å –ø–æ–¥–∞—á—ñ –∑–Ω–∞–Ω—å —Å—É—Ç—Ç—î–≤–æ —Å–∫–æ—Ä–æ—á—É—î –ø–æ–º–∏–ª–∫–∏.
    </p>
  </div>

  <div class="footer">
    –û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: <time datetime="2025-10-18">18.10.2025</time>. –ê–≤—Ç–æ—Ä: –°–µ—Ä–≥—ñ–π –ü–æ–ª—ñ—â—É–∫.
  </div>
</div>

<script>
// ===== –£—Ç–∏–ª—ñ—Ç–∏ =====
const $=s=>document.querySelector(s); const $$=s=>Array.from(document.querySelectorAll(s));
function download(name,text,type="text/plain"){const b=new Blob([text],{type:type+";charset=utf-8"});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download=name;document.body.appendChild(a);a.click();a.remove();URL.revokeObjectURL(u);}
function stamp(){return new Date().toISOString().replace(/[:T]/g,'-').slice(0,16);}
function nowLocal(){return new Date().toISOString().slice(0,16).replace('T',' ')}
function uniq(arr){return Array.from(new Set(arr))}
const STOPWORDS = new Set('—ñ –π —Ç–∞ –∞–ª–µ –∞–±–æ —â–æ —â–æ–± —è–∫ —É –≤ –Ω–∞ –¥–æ –∑ –∑—ñ —ñ–∑ –∑–∞ –Ω–∞–¥ –ø—ñ–¥ –ø—Ä–∏ –ø–æ –º—ñ–∂ –ø—Ä–æ –≤—ñ–¥ –±–µ–∑ —Ü–µ —Ü–µ–π —Ü—è —Ü—ñ —Ç–æ–≥–æ —Ç—ñ —Ç–∞–∫–∏–π —Ç–∞–∫–∞ —Ç–∞–∫—ñ –¥–ª—è'.split(' '));

// ===== –°—Ç–∞–Ω =====
let RUB={PPE:[], TOOLS:[], PRE:[], STEPS:[], POST:[]};
let RAW_TEXT='';
let CHECKLIST=[]; // {i,text,done,ts,comment}
let RAG_INDEX=[]; // {chunk, tokens, tf:Map, vec:Map}

// ===== –î–µ–º–æ–¥–∞–Ω—ñ =====
$('#demo').addEventListener('click', ()=>{
  $('#sop').value=`PPE: –¥—ñ–µ–ª–µ–∫—Ç—Ä–∏—á–Ω—ñ —Ä—É–∫–∞–≤–∏—Ü—ñ, –∫–∞—Å–∫–∞, –æ–∫—É–ª—è—Ä–∏, –¥—ñ–µ–ª–µ–∫—Ç—Ä–∏—á–Ω—ñ –∫–∏–ª–∏–º–∫–∏
–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏: –º—É–ª—å—Ç–∏–º–µ—Ç—Ä CAT III, —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–ø—Ä—É–≥–∏, —ñ–∑–æ–ª—è—Ü—ñ–π–Ω–∏–π –º–µ–≥–∞–æ–º–º–µ—Ç—Ä 500 –í, –≤–∏–∫—Ä—É—Ç–∫–∏ –∑ —ñ–∑–æ–ª—è—Ü—ñ—î—é
–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞:
1) –í—ñ–¥–∫–ª—é—á–∏—Ç–∏ –≤–≤–æ–¥–Ω–∏–π –∞–≤—Ç–æ–º–∞—Ç QF1; 2) –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ LOTO (–∑–∞–º–æ–∫, –±—ñ—Ä–∫–∞, –∂—É—Ä–Ω–∞–ª); 3) –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –Ω–∞–ø—Ä—É–≥–∏ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º; 4) –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å–ø—Ä–∞–≤–Ω—ñ—Å—Ç—å –ó–Ü–ó
–ö—Ä–æ–∫–∏:
1) –í—ñ–¥–∫—Ä–∏—Ç–∏ —à–∞—Ñ—É; 2) –û–≥–ª—è–¥ –Ω–∞ –Ω–∞–≥–∞—Ä/–ø–∏–ª; 3) –û—á–∏—Å—Ç–∏—Ç–∏ —â—ñ—Ç–∫–æ—é —Ç–∞ –ø–∏–ª–æ—Å–æ—Å–æ–º; 4) –ü—ñ–¥—Ç—è–≥–Ω—É—Ç–∏ –∫–ª–µ–º–Ω—ñ –∑‚Äô—î–¥–Ω–∞–Ω–Ω—è –º–æ–º–µ–Ω—Ç–Ω–∏–º –∫–ª—é—á–µ–º; 5) –ó–∞–º—ñ—Ä –æ–ø–æ—Ä—É —ñ–∑–æ–ª—è—Ü—ñ—ó 500 –í –º—ñ–∂ L‚ÄìN, L‚ÄìPE, N‚ÄìPE (–Ω–æ—Ä–º–∞ ‚â•1 –ú–û–º); 6) –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–æ–±–æ—Ç—É –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä—ñ–≤/—Ñ—ñ–ª—å—Ç—Ä—ñ–≤; 7) –ó–∞–∫—Ä—ñ–ø–∏—Ç–∏ –∫—Ä–∏—à–∫—É
–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞:
1) –ó–Ω—è—Ç–∏ LOTO; 2) –£–≤—ñ–º–∫–Ω—É—Ç–∏ QF1; 3) –ó–∞–º—ñ—Ä—è—Ç–∏ U, –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ñ–∞–∑—É–≤–∞–Ω–Ω—è; 4) –ó–∞–ø–∏—Å–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ —É –∂—É—Ä–Ω–∞–ª –æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è (–¥–∞—Ç–∞, –ø—ñ–¥–ø–∏—Å, –ó–Ü–ó)`;
});

// ===== –ü–∞—Ä—Å–µ—Ä SOP =====
function parseSOP(txt){
  RAW_TEXT = (txt||'').trim();
  RUB={PPE:[], TOOLS:[], PRE:[], STEPS:[], POST:[]};
  if(!RAW_TEXT){ $('#badge').textContent='–°—Ç–∞—Ç—É—Å: –ø–æ—Ä–æ–∂–Ω—å–æ'; return; }

  const lines = RAW_TEXT.split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
  const join = lines.join('\n');

  function section(keyArr, fallback){
    for(const key of keyArr){
      const re = new RegExp(`${key}\\s*:\\s*([\\s\\S]*?)(?:\\n\\s*[A-Z–ê-–Ø–á–Ü–Ñ“ê].*?:|$)`,'i');
      const m = join.match(re);
      if(m && m[1]) return m[1].trim();
    }
    return fallback? fallback.trim() : '';
  }

  const sPPE   = section(['PPE','–ó–Ü–ó']);
  const sTOOLS = section(['–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏','–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã','Tools']);
  const sPRE   = section(['–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞','Preparation','–ü—ñ–¥–≥–æ—Ç—É–≤–∞–Ω–Ω—è'], '');
  const sSTEPS = section(['–ö—Ä–æ–∫–∏','Steps','–í–∏–∫–æ–Ω–∞–Ω–Ω—è'], '');
  const sPOST  = section(['–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞','–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏','–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è','Post'], '');

  function toList(s){ 
    if(!s) return [];
    // 1) –Ω–æ–º–µ—Ä–∏ 1) 2) ; 2) —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –∫—Ä–∞–ø–∫–æ—é –∑ –∫–æ–º–æ—é; 3) —Ä–æ–∑–±–∏—Ç—Ç—è –ø–æ —Ä—è–¥–∫–∞—Ö
    return s.split(/\n|;|(?:\d+[\)\.]\s*)/).map(t=>t.trim()).filter(t=>t.length>1);
  }

  // –Ø–∫—â–æ –∫–ª—é—á—ñ –≤—ñ–¥—Å—É—Ç–Ω—ñ ‚Äî —Å–ø—Ä–æ–±—É—î–º–æ —ñ–º–ø–µ—Ä–∞—Ç–∏–≤–∏
  let steps = toList(sSTEPS);
  if(steps.length===0){
    const imps = RAW_TEXT.match(/\b(–í—ñ–¥–∫–ª—é—á–∏—Ç–∏|–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏|–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏|–í—ñ–¥–∫—Ä–∏—Ç–∏|–û—á–∏—Å—Ç–∏—Ç–∏|–ü—ñ–¥—Ç—è–≥–Ω—É—Ç–∏|–ó–∞–º—ñ—Ä(—è—Ç–∏)?|–ó–∞–∫—Ä—ñ–ø–∏—Ç–∏|–£–≤—ñ–º–∫–Ω—É—Ç–∏|–ó–∞–ø–∏—Å–∞—Ç–∏)\b[^.\n;]+/gi)||[];
    steps = imps.map(s=>s.trim());
  }

  RUB.PPE   = uniq(toList(sPPE));
  RUB.TOOLS = uniq(toList(sTOOLS));
  RUB.PRE   = toList(sPRE);
  RUB.STEPS = steps;
  RUB.POST  = toList(sPOST);

  $('#badge').textContent=`–°—Ç–∞—Ç—É—Å: –∑–Ω–∞–π–¥–µ–Ω–æ ‚Äî PPE:${RUB.PPE.length}, Tools:${RUB.TOOLS.length}, PRE:${RUB.PRE.length}, –ö—Ä–æ–∫–∏:${RUB.STEPS.length}, POST:${RUB.POST.length}`;
  buildChecklist();
  buildRAG();
}
$('#parse').addEventListener('click', ()=>parseSOP($('#sop').value));
$('#clear').addEventListener('click', ()=>{ $('#sop').value=''; $('#badge').textContent='–°—Ç–∞—Ç—É—Å: ‚Äî'; $('#tbl tbody').innerHTML=''; CHECKLIST.length=0; RAG_INDEX.length=0; $('#rc').hidden=true; $('#quizTbl tbody').innerHTML=''; $('#qBadge').textContent='–ü–∏—Ç–∞–Ω—å: 0'; $('#ragOut').textContent='// –í—ñ–¥–ø–æ–≤—ñ–¥—å –∑‚Äô—è–≤–∏—Ç—å—Å—è —Ç—É—Ç'; });

// ===== –ß–µ–∫-–ª–∏—Å—Ç =====
function buildChecklist(){
  CHECKLIST.length=0;
  let idx=1;
  const add=(arr)=>arr.forEach(t=>CHECKLIST.push({i:idx++, text:t, done:false, ts:'', comment:''}));
  if(RUB.PRE.length) add(RUB.PRE.map(t=>'–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞: '+t));
  if(RUB.STEPS.length) add(RUB.STEPS);
  if(RUB.POST.length) add(RUB.POST.map(t=>'–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞: '+t));
  renderChecklist();
}

function renderChecklist(){
  const tb=$('#tbl tbody'); tb.innerHTML='';
  CHECKLIST.forEach((r,ix)=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${r.i}</td>
      <td>${r.text}</td>
      <td><input type="checkbox" ${r.done?'checked':''} data-ix="${ix}" class="chk"/></td>
      <td class="mono">${r.ts||'‚Äî'}</td>
      <td><input class="input cmt" data-ix="${ix}" placeholder="–ö–æ–º–µ–Ω—Ç–∞—Ä" value="${r.comment.replace(/"/g,'&quot;')}"/></td>`;
    tb.appendChild(tr);
  });
  $$('.chk').forEach(ch=>ch.addEventListener('change', e=>{
    const ix=parseInt(e.target.dataset.ix,10);
    CHECKLIST[ix].done=e.target.checked;
    CHECKLIST[ix].ts = e.target.checked ? nowLocal() : '';
    renderChecklist();
  }));
  $$('.cmt').forEach(c=>c.addEventListener('input', e=>{
    const ix=parseInt(e.target.dataset.ix,10);
    CHECKLIST[ix].comment=e.target.value;
  }));
}

// –∫–Ω–æ–ø–∫–∏ —á–µ–∫-–ª–∏—Å—Ç–∞
$('#stampAll').addEventListener('click', ()=>{
  const t=nowLocal();
  CHECKLIST.forEach(r=>{ if(r.done && !r.ts) r.ts=t; });
  renderChecklist();
});
$('#addStep').addEventListener('click', ()=>{
  const txt=prompt('–¢–µ–∫—Å—Ç –∫—Ä–æ–∫—É:','–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –º–∞—Ä–∫—É–≤–∞–Ω–Ω—è –∫–∞–±–µ–ª—ñ–≤');
  if(!txt) return;
  const next=(CHECKLIST.at(-1)?.i||0)+1;
  CHECKLIST.push({i:next,text:txt,done:false,ts:'',comment:''});
  renderChecklist();
});
$('#rmDone').addEventListener('click', ()=>{
  const left=CHECKLIST.filter(r=>!r.done);
  left.forEach((r,i)=>r.i=i+1);
  CHECKLIST.splice(0,CHECKLIST.length,...left);
  renderChecklist();
});

// –ï–∫—Å–ø–æ—Ä—Ç–∏ —á–µ–∫-–ª–∏—Å—Ç–∞
function toCSV(){
  const head='i,text,done,ts,comment,job,who,super,start,loc\n';
  const job=$('#jobTitle').value||'', who=$('#who').value||'', sup=$('#super').value||'', start=$('#start').value||'', loc=$('#loc').value||'';
  const rows=CHECKLIST.map(r=>[r.i, r.text, r.done?1:0, r.ts, r.comment, job, who, sup, start, loc]
    .map(v=>typeof v==='string'?`"${v.replace(/"/g,'""')}"`:v).join(',')).join('\n');
  return head+rows;
}
function toTXT(){
  const hdr=[
    '–ß–ï–ö-–õ–ò–°–¢ –¢–û',
    '–†–æ–±–æ—Ç–∞: '+($('#jobTitle').value||''),
    '–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å: '+($('#who').value||'')+' | –î–æ–ø—É—Å–∫: '+($('#super').value||''),
    '–°—Ç–∞—Ä—Ç: '+($('#start').value||'')+' | –õ–æ–∫–∞—Ü—ñ—è: '+($('#loc').value||''),
    '--- –ö–†–û–ö–ò ---'
  ];
  const body=CHECKLIST.map(r=>`${r.i}. [${r.done?'x':' '}] ${r.text} ${r.ts?(' @'+r.ts):''} ${r.comment?(' // '+r.comment):''}`);
  return hdr.concat(body).join('\n');
}
function toICS(){
  const job=$('#jobTitle').value||'–¢–û (–∑–∞ SOP)';
  const start=$('#start').value? new Date($('#start').value): new Date();
  const end=new Date(start.getTime()+ Math.max(30, CHECKLIST.length*3)*60000);
  const dt=d=>d.toISOString().replace(/[-:]/g,'').replace(/\.\d{3}Z$/,'Z');
  const desc = '–ú—ñ—Å—Ü–µ: '+($('#loc').value||'-')+'\\n–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å: '+($('#who').value||'-')
    +'\\n–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä: '+($('#super').value||'-')+'\\n–ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫—Ä–æ–∫—ñ–≤: '+CHECKLIST.length;
  return ['BEGIN:VCALENDAR','VERSION:2.0','PRODID:-//EDLab//SOP Assistant//UA',
    'BEGIN:VEVENT','UID:'+('para23-'+Date.now())+'@edlab',
    'DTSTART:'+dt(start),'DTEND:'+dt(end),'SUMMARY:'+job,'DESCRIPTION:'+desc,'END:VEVENT','END:VCALENDAR'].join('\r\n');
}
$('#exportCsv').addEventListener('click', ()=>download('electric_para23_checklist_'+stamp()+'.csv', toCSV(), 'text/csv'));
$('#exportTxt').addEventListener('click', ()=>download('electric_para23_checklist_'+stamp()+'.txt', toTXT()));
$('#exportIcs').addEventListener('click', ()=>download('electric_para23_'+stamp()+'.ics', toICS(), 'text/calendar'));

// –ß–µ–∫ 58 –º–º
$('#receipt').addEventListener('click', ()=>{
  const day=(new Date()).toISOString().slice(0,10);
  const lines=[];
  lines.push('=== –ß–ï–ö –¢–û (58–º–º) ===');
  lines.push('–î–∞—Ç–∞: '+day);
  lines.push(('–†–æ–±–æ—Ç–∞: '+($('#jobTitle').value||'')).slice(0,28));
  lines.push(('–ú—ñ—Å—Ü–µ: '+($('#loc').value||'')).slice(0,28));
  lines.push(('–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å: '+($('#who').value||'')).slice(0,28));
  lines.push('---');
  CHECKLIST.filter(r=>r.done).slice(0,12).forEach(r=>{
    lines.push((r.i+'. '+r.text).slice(0,28));
    if(r.ts) lines.push((r.ts).slice(11,16)+' '+(r.comment||''));
  });
  const txt=lines.join('\n');
  const el=$('#rc'); el.hidden=false; el.textContent=txt;
  download('para23_receipt_'+stamp()+'.txt', txt);
});

// ===== RAG: –ø–æ–±—É–¥–æ–≤–∞ —ñ–Ω–¥–µ–∫—Å—É (tf-idf light) =====
function tokenize(s){
  return s.toLowerCase()
    .replace(/[^\p{L}\p{N}\s]/gu,' ')
    .split(/\s+/).filter(w=>w && !STOPWORDS.has(w));
}
function buildRAG(){
  const chunks=[];
  // –°—Ç–≤–æ—Ä–∏–º–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏ –∑ —Ä—É–±—Ä–∏–∫
  const pack = [
    ['PPE', RUB.PPE.join(', ')],
    ['–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏', RUB.TOOLS.join(', ')],
    ['–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞', RUB.PRE.join('; ')],
    ['–ö—Ä–æ–∫–∏', RUB.STEPS.map((t,i)=>`${i+1}) ${t}`).join(' ')],
    ['–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞', RUB.POST.join('; ')]
  ];
  pack.forEach(([h,txt])=>{
    if(!txt) return;
    // —Ä—ñ–∂–µ–º–æ –Ω–∞ –∫—É—Å–∫–∏ ~200 —Å–∏–º–≤–æ–ª—ñ–≤
    let cur=''; const parts=[];
    txt.split(/\s+/).forEach(w=>{
      if((cur+' '+w).length>200){ parts.push(cur); cur=w; } else { cur = cur ? cur+' '+w : w; }
    });
    if(cur) parts.push(cur);
    parts.forEach(p=>chunks.push({chunk:`${h}: ${p}`}));
  });
  // tf —Ç–∞ —ñ–Ω–¥–µ–∫—Å
  RAG_INDEX = chunks.map(c=>{
    const tokens=tokenize(c.chunk);
    const tf=new Map(); tokens.forEach(t=>tf.set(t,(tf.get(t)||0)+1));
    return {chunk:c.chunk, tokens, tf};
  });
}

// –∫–æ—Å–∏–Ω—É—Å
function cosine(a,b){
  let num=0,na=0,nb=0;
  const keys=new Set([...a.keys(),...b.keys()]);
  keys.forEach(k=>{
    const va=a.get(k)||0, vb=b.get(k)||0;
    num+=va*vb; na+=va*va; nb+=vb*vb;
  });
  return num / (Math.sqrt(na||1)*Math.sqrt(nb||1));
}

$('#ask').addEventListener('click', ()=>{
  if(RAG_INDEX.length===0){ parseSOP($('#sop').value); if(RAG_INDEX.length===0){ alert('–°–ø–æ—á–∞—Ç–∫—É –≤—Å—Ç–∞–≤ SOP —ñ –Ω–∞—Ç–∏—Å–Ω–∏ ¬´–†–æ–∑–ø–∞—Ä—Å–∏—Ç–∏¬ª.'); return; } }
  const q=$('#q').value.trim(); if(!q){ return; }
  const qTok=tokenize(q); const qTf=new Map(); qTok.forEach(t=>qTf.set(t,(qTf.get(t)||0)+1));
  const scored=RAG_INDEX.map(o=>({chunk:o.chunk, score:cosine(o.tf,qTf)})).sort((a,b)=>b.score-a.score).slice(0,3);
  const ans = scored.map((s,i)=>`${i+1}) ${s.chunk}  [score=${s.score.toFixed(2)}]`).join('\n');
  $('#ragOut').textContent = `–ü–∏—Ç–∞–Ω–Ω—è: ${q}\n--- –†–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏ ---\n${ans}\n\n–í—ñ–¥–ø–æ–≤—ñ–¥—å (—Å—Ç–∏—Å–ª–æ):\n`+
    (scored[0]? scored[0].chunk : '–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –≤ SOP. –£—Ç–æ—á–Ω–∏ —Ñ–æ—Ä–º—É–ª—é–≤–∞–Ω–Ω—è.');
});

// ===== –ö–≤—ñ–∑ —ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ =====
function imperativeOnly(arr){ return arr.filter(t=>/^(–í—ñ–¥|–ü–µ—Ä–µ|–ó–∞|–£–≤|–û—á–∏—Å—Ç|–ü—ñ–¥—Ç—è–≥|–ó–∞–º—ñ—Ä|–ó–∞–∫—Ä—ñ–ø|–ó–Ω—è—Ç|–í—Å—Ç–∞–Ω–æ–≤)/i.test(t)); }
function generateQuiz(){
  const base=imperativeOnly(RUB.STEPS);
  const pre =imperativeOnly(RUB.PRE).slice(0,2);
  const post=imperativeOnly(RUB.POST).slice(0,2);
  const pool=uniq(base.concat(pre).concat(post));
  const pick=(n)=>{const a=pool.slice(); const out=[]; while(out.length<n && a.length){ out.push(a.splice(Math.floor(Math.random()*a.length),1)[0]); } return out; }
  const qs = pick(6).map((step,i)=>{
    // –≤–∞—Ä—ñ–∞–Ω—Ç–∏: –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π + 3 –≤–∏–ø–∞–¥–∫–æ–≤–∏—Ö –∑ —ñ–Ω—à–∏—Ö –∫—Ä–æ–∫—ñ–≤
    const distract = uniq(pick(6).filter(x=>x!==step)).slice(0,3);
    const opts = uniq([step].concat(distract)).sort(()=>Math.random()-0.5).slice(0,4);
    return {q:`–©–æ –∑ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î SOP –¥–ª—è –¥–∞–Ω–æ–≥–æ –µ—Ç–∞–ø—É?`, ctx: step.replace(/\d+\)\s*/,'').trim(), opts, ans: step};
  });
  return qs;
}

function renderQuiz(list){
  const tb=$('#quizTbl tbody'); tb.innerHTML='';
  list.forEach((q,i)=>{
    const tr=document.createElement('tr');
    const selId='sel_'+i;
    tr.innerHTML=`<td>${i+1}</td>
      <td><b>${q.q}</b><br/><span class="muted small">–ö–æ–Ω—Ç–µ–∫—Å—Ç: ${q.ctx}</span></td>
      <td>
        <select class="input" id="${selId}">
          ${q.opts.map(o=>`<option>${o}</option>`).join('')}
        </select>
      </td>
      <td><button class="btn checkOne" data-i="${i}">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button><span class="badge" id="res_${i}">‚Äî</span></td>`;
    tb.appendChild(tr);
  });
  $$('.checkOne').forEach(b=>b.addEventListener('click', e=>{
    const i=parseInt(e.target.dataset.i,10);
    const val=$('#sel_'+i).value;
    const ok = (val.trim()===QUIZ[i].ans.trim());
    $('#res_'+i).textContent = ok? 'OK' : '–ù—ñ';
    $('#res_'+i).className = 'badge '+(ok?'ok':'bad');
  }));
  $('#qBadge').textContent='–ü–∏—Ç–∞–Ω—å: '+list.length;
}
let QUIZ=[];
$('#genQuiz').addEventListener('click', ()=>{
  if(!RUB.STEPS.length){ parseSOP($('#sop').value); if(!RUB.STEPS.length){ alert('–î–æ–¥–∞–π SOP —ñ –Ω–∞—Ç–∏—Å–Ω–∏ ¬´–†–æ–∑–ø–∞—Ä—Å–∏—Ç–∏¬ª.'); return; } }
  QUIZ = generateQuiz();
  renderQuiz(QUIZ);
});
$('#clearQuiz').addEventListener('click', ()=>{ QUIZ=[]; $('#quizTbl tbody').innerHTML=''; $('#qBadge').textContent='–ü–∏—Ç–∞–Ω—å: 0'; });

// –í—ñ–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å ‚Äî ¬´—á–µ–∫–µ—Ä¬ª
$('#checkFree').addEventListener('click', ()=>{
  const ans=$('#freeAns').value.toLowerCase();
  if(!ans.trim()){ $('#freeScore').textContent='–û—Ü—ñ–Ω–∫–∞: 0%'; return; }
  // –ö–ª—é—á–æ–≤—ñ –ª–µ–º–∏ –∑ PRE: LOTO, –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –Ω–∞–ø—Ä—É–≥–∏, —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä, –ó–Ü–ó
  const keys=[
    ['loto','–∑–∞–º–æ–∫','–±—ñ—Ä–∫–∞','–∂—É—Ä–Ω–∞–ª'],
    ['–≤—ñ–¥—Å—É—Ç–Ω','–Ω–∞–ø—Ä—É–≥'],
    ['—ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä','–ø–µ—Ä–µ–≤—ñ—Ä'],
    ['–ó–Ü–ó','—Ä—É–∫–∞–≤–∏—Ü','–∫–∞—Å–∫','–æ–∫—É–ª—è—Ä']
  ];
  let hits=0; const need=keys.length;
  keys.forEach(group=>{
    if(group.some(k=>ans.includes(k.toLowerCase()))) hits++;
  });
  const extra = ['–º–æ–º–µ–Ω—Ç','–∫–ª—é—á','—ñ–∑–æ–ª—è—Ü','1 –º–æ–º','500 –≤','–æ–ø—ñ—Ä','–≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä','—Ñ–∞–∑–∞'];
  extra.forEach(k=>{ if(ans.includes(k)) hits+=0.2; });
  const score=Math.min(100, Math.round( (hits/need)*100 ));
  $('#freeScore').textContent='–û—Ü—ñ–Ω–∫–∞: '+score+'%';
  $('#freeScore').className='badge '+(score>=80?'ok':(score>=50?'warn':'bad'));
});

// ===== –ü–æ–±—É–¥–æ–≤–∞ —Ç–∞–±–ª–∏—Ü—ñ –ø—ñ—Å–ª—è —Ä–æ–∑–±–æ—Ä—É SOP =====
function fillTableFromSOP(){
  const tb=$('#tbl tbody'); tb.innerHTML='';
  buildChecklist();
}
$('#parse').addEventListener('click', fillTableFromSOP);

// ===== –Ü–Ω–¥–µ–∫—Å –æ–¥—Ä–∞–∑—É –ø—Ä–∏ –ø–∞—Ä—Å—ñ =====
function afterParse(){ buildChecklist(); buildRAG(); }
$('#parse').addEventListener('click', afterParse);

// ===== –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è =====
if (window.self !== window.top) document.documentElement.classList.add('embedded'); // LMS-friendly
</script>


</body></html>