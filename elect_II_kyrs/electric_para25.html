<!DOCTYPE html><html lang="uk"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>–ü–∞—Ä–∞ 25 (–ï–ª–µ–∫—Ç—Ä–∏–∫–∞) ‚Äî –®–Ü: –∞—É–¥—ñ–æ–¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ç–æ—Ä–∞ (FFT, –æ–∑–Ω–∞–∫–∏, –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è)</title>
<meta name="description" content="WebAudio –º—ñ–∫—Ä–æ—Ñ–æ–Ω/–µ–º—É–ª—è—Ç–æ—Ä ‚Üí —Å–ø–µ–∫—Ç—Ä (FFT) ‚Üí f0/–≥–∞—Ä–º–æ–Ω—ñ–∫–∏/—Ç–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å/—Ü–µ–Ω—Ç—Ä–æ—ó–¥/–ø–ª–æ—Å–∫—ñ—Å—Ç—å/ZCR ‚Üí –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è (–ø—Ä–∞–≤–∏–ª–∞ + kNN) ‚Üí –∂—É—Ä–Ω–∞–ª/—á–µ–∫-–ª–∏—Å—Ç ‚Üí –µ–∫—Å–ø–æ—Ä—Ç PNG/CSV/TXT/JSON. –í–∫–ª—é—á–∞—î Arduino Goertzel-–ª–æ–≥–µ—Ä.">
<meta name="color-scheme" content="light dark">
<style>
:root{--bg:#0b1220;--panel:#0f172a;--muted:#94a3b8;--text:#e6eef9;--line:#223049;--brand:#38bdf8;--ok:#22c55e;--warn:#fbbf24;--bad:#f87171}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,Arial,sans-serif}
.wrap{max-width:1140px;margin:0 auto;padding:16px}
header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.logo{display:flex;align-items:center;gap:10px}
.logo .emoji{font-size:28px}
.logo .badge{font-size:.9rem;color:var(--muted);border:1px solid var(--line);padding:2px 8px;border-radius:999px}
h1{margin:.2em 0 .3em 0}
.muted{color:var(--muted)}
.card{border:1px solid var(--line);border-radius:16px;background:var(--panel);padding:14px;margin-top:14px}
.row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.input,select,textarea{width:100%;padding:8px;border-radius:10px;border:1px solid var(--line);background:#0b1220;color:var(--text)}
.btn{border:1px solid var(--line);background:#0f1f39;color:var(--text);padding:8px 12px;border-radius:10px;cursor:pointer}
.btn.secondary{background:transparent}
.btn.good{border-color:#204b2a;background:#12341b}
.badge{display:inline-block;border:1px solid var(--line);border-radius:999px;padding:2px 8px;color:var(--muted);margin-right:6px}
.grid{display:grid;gap:14px;grid-template-columns:1.5fr 1fr}
@media(max-width:1140px){.grid{grid-template-columns:1fr}}
canvas{display:block;width:100%;height:220px;background:#0b1220;border:1px solid var(--line);border-radius:12px}
.small{font-size:.9rem}
pre.code{background:#0b1220;border:1px solid var(--line);border-radius:12px;padding:12px;overflow:auto;white-space:pre-wrap}
.tbl{width:100%;border-collapse:collapse;font-size:.95rem}
.tbl th,.tbl td{border:1px solid var(--line);padding:6px;text-align:left;vertical-align:top}
.tbl th{background:#0b1a2f}
.ok{color:var(--ok)}.warn{color:var(--warn)}.bad{color:var(--bad)}
.note{border:1px dashed var(--line);border-radius:12px;padding:10px;background:#0c182a}
.footer{margin-top:20px;color:var(--muted);font-size:.9rem}
.tag{display:inline-block;border:1px solid var(--line);border-radius:999px;padding:2px 8px;color:var(--muted);margin-right:6px;margin-top:6px}
</style>
<link rel="canonical" href="https://edlab.pp.ua/elect_II_kyrs/electric_para25.html"><meta property="og:type" content="article"><meta property="og:title" content="–ï–ª–µ–∫—Ç—Ä–æ–µ–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞ ‚Äî –ü–∞—Ä–∞ 25"><meta property="og:description" content="–©–µ –∑ 1930-—Ö —Ç–µ—Ö–Ω—ñ–∫–∏ —Å–ª—É—Ö–∞–ª–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ç–æ—Ä–∏ —Å—Ç–µ—Ç–æ—Å–∫–æ–ø–æ–º. –°—å–æ–≥–æ–¥–Ω—ñ WebAudio + FFT –¥–∞—î —Ç—ñ –∂ ¬´–≤—É—Ö–∞¬ª, –∞–ª–µ –∑ —Ü–∏—Ñ—Ä–∞–º–∏: —Ç–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, –≥–∞—Ä–º–æ–Ω—ñ–∫–∏ —ñ —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–∞ ¬´—à–µ—Ä—à–∞"><meta property="og:url" content="https://edlab.pp.ua/elect_II_kyrs/electric_para25.html"><script type="application/ld+json">{"@context":"https://schema.org","@type":"LearningResource","name":"–ï–ª–µ–∫—Ç—Ä–æ–µ–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞ ‚Äî –ü–∞—Ä–∞ 25","description":"–©–µ –∑ 1930-—Ö —Ç–µ—Ö–Ω—ñ–∫–∏ —Å–ª—É—Ö–∞–ª–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ç–æ—Ä–∏ —Å—Ç–µ—Ç–æ—Å–∫–æ–ø–æ–º. –°—å–æ–≥–æ–¥–Ω—ñ WebAudio + FFT –¥–∞—î —Ç—ñ –∂ ¬´–≤—É—Ö–∞¬ª, –∞–ª–µ –∑ —Ü–∏—Ñ—Ä–∞–º–∏: —Ç–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, –≥–∞—Ä–º–æ–Ω—ñ–∫–∏ —ñ —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–∞ ¬´—à–µ—Ä—à–∞","inLanguage":"uk","educationalLevel":"college","url":"https://edlab.pp.ua/elect_II_kyrs/electric_para25.html","provider":{"@type":"Organization","name":"EDLab"}}</script></head>
<body>
<div class="wrap">
  <header>
    <div class="logo">
      <span class="emoji">üîä</span>
      <div>
        <b>–ü–∞—Ä–∞ 25 ‚Äî –®–Ü: –∞—É–¥—ñ–æ–¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ç–æ—Ä–∞</b><br>
        <span class="badge">–º—ñ–∫—Ä–æ—Ñ–æ–Ω/WebAudio ‚Üí FFT ‚Üí –æ–∑–Ω–∞–∫–∏ ‚Üí –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è ‚Üí –∂—É—Ä–Ω–∞–ª ‚Üí –µ–∫—Å–ø–æ—Ä—Ç</span>
      </div>
    </div>
    <a class="btn" href="../index.html" target="_blank" rel="noopener">üè† –ù–∞ –≥–æ–ª–æ–≤–Ω—É</a>
  </header>

  <div class="grid">
    <!-- –õ–Ü–í–ê –ö–û–õ–û–ù–ö–ê -->
    <div class="card">
      <h2>üéôÔ∏è –î–∂–µ—Ä–µ–ª–æ –∑–≤—É–∫—É</h2>
      <div class="row">
        <div style="flex:1">
          <label for="src">–î–∂–µ—Ä–µ–ª–æ</label>
          <select id="src" class="input">
            <option value="mic" selected="">–ú—ñ–∫—Ä–æ—Ñ–æ–Ω (–±—Ä–∞—É–∑–µ—Ä)</option>
            <option value="emu">–ï–º—É–ª—è—Ç–æ—Ä (—Å–∏–Ω—Ç–µ—Ç–∏—á–Ω—ñ –∑–≤—É–∫–∏)</option>
          </select>
        </div>
        <div class="row" style="gap:8px">
          <button class="btn good" id="start">‚ñ∂Ô∏è –°—Ç–∞—Ä—Ç</button>
          <button class="btn secondary" id="stop">‚è∏Ô∏è –°—Ç–æ–ø</button>
          <span id="stat" class="badge">–°—Ç–∞—Ç—É—Å: idle</span>
        </div>
      </div>

      <div id="emuBox" class="note" style="margin-top:8px;display:none">
        <b>–ï–º—É–ª—è—Ç–æ—Ä:</b>
        <div class="row">
          <div style="flex:1">
            <label for="emuType">–¢–∏–ø</label>
            <select id="emuType" class="input">
              <option value="normal" selected="">–ù–æ—Ä–º–∞–ª—å–Ω–∏–π –≥—É–ª (50/60 –ì—Ü + –≥–∞—Ä–º–æ–Ω—ñ–∫–∏)</option>
              <option value="loose">–†–æ–∑—Ö–∏—Ç–∞–Ω–µ —è–¥—Ä–æ (120‚Äì300 –ì—Ü ¬´–±—Ä—è–∑–∫—ñ—Ç¬ª)</option>
              <option value="bearing">–ü—ñ–¥—à–∏–ø–Ω–∏–∫ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞ (—Ç–æ–Ω 1‚Äì4 –∫–ì—Ü)</option>
              <option value="pd">–ß–∞—Å—Ç–∫–æ–≤—ñ —Ä–æ–∑—Ä—è–¥–∏ (—à–∏—Ä–æ–∫–æ—Å–º—É–≥–æ–≤—ñ —ñ–º–ø—É–ª—å—Å–∏ 3‚Äì20 –∫–ì—Ü)</option>
              <option value="cav">–ö–∞–≤—ñ—Ç–∞—Ü—ñ—è –Ω–∞—Å–æ—Å–∞/–º–∞—Å–ª–æ (0.8‚Äì1.5 –∫–ì—Ü —à–∏—Ä–æ–∫–∏–π ¬´—à—É—Ä—Ö—ñ—Ç¬ª)</option>
            </select>
          </div>
          <div style="flex:1">
            <label>–†—ñ–≤–µ–Ω—å <input id="emuLvl" class="input" type="range" min="0" max="1" step="0.01" value="0.6"></label>
          </div>
        </div>
      </div>

      <h3 style="margin-top:12px">üìà –û—Å—Ü–∏–ª–æ–≥—Ä–∞–º–∞</h3>
      <canvas id="wave" width="900" height="200"></canvas>

      <h3 style="margin-top:12px">üìä –°–ø–µ–∫—Ç—Ä (FFT)</h3>
      <canvas id="spec" width="900" height="240"></canvas>

      <div class="row" style="margin-top:8px">
        <button class="btn" id="savePng">üñºÔ∏è –ó–±–µ—Ä–µ–≥—Ç–∏ —Å–ø–µ–∫—Ç—Ä (PNG)</button>
        <button class="btn secondary" id="clearPlot">üßπ –û—á–∏—Å—Ç–∏—Ç–∏ –≥—Ä–∞—Ñ—ñ–∫</button>
      </div>
    </div>

    <!-- –ü–†–ê–í–ê –ö–û–õ–û–ù–ö–ê -->
    <div class="card">
      <h2>üß† –û–∑–Ω–∞–∫–∏ —Ç–∞ –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è</h2>
      <div class="row">
        <div style="flex:1">
          <label for="auto">–ê–≤—Ç–æ–∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è</label>
          <select id="auto" class="input"><option>–£–≤—ñ–º–∫–Ω–µ–Ω–∞</option><option>–í–∏–º–∫–Ω–µ–Ω–∞</option></select>
        </div>
        <div style="flex:1">
          <label for="k">k –¥–ª—è k-NN (–¥–æ–ø–æ–º—ñ–∂–Ω–∏–π)</label>
          <input id="k" class="input" type="number" min="1" step="1" value="3">
        </div>
      </div>

      <h3 style="margin-top:10px">üìê –†–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω—ñ –æ–∑–Ω–∞–∫–∏</h3>
      <table class="tbl">
        <tbody id="feat">
          <tr><th>f‚ÇÄ (–ì—Ü)</th><td id="f0">‚Äî</td></tr>
          <tr><th>H2/H3 (–¥–ë –≤—ñ–¥ f‚ÇÄ)</th><td id="h23">‚Äî</td></tr>
          <tr><th>–¢–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å (–ø—ñ–∫–æ–≤–∞/—Å—É–º–∞—Ä–Ω–∞ –µ–Ω–µ—Ä–≥—ñ—è)</th><td id="ton">‚Äî</td></tr>
          <tr><th>–¶–µ–Ω—Ç—Ä–æ—ó–¥ —Å–ø–µ–∫—Ç—Ä–∞ (–ì—Ü)</th><td id="cent">‚Äî</td></tr>
          <tr><th>–ü–ª–æ—Å–∫—ñ—Å—Ç—å —Å–ø–µ–∫—Ç—Ä–∞</th><td id="flat">‚Äî</td></tr>
          <tr><th>Zero-Crossing Rate</th><td id="zcr">‚Äî</td></tr>
          <tr><th>Crest factor</th><td id="crest">‚Äî</td></tr>
          <tr><th>SNR (–æ—Ü—ñ–Ω–∫–∞)</th><td id="snr">‚Äî</td></tr>
        </tbody>
      </table>

      <h3 style="margin-top:10px">‚öñÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –ø—Ä–∞–≤–∏–ª</h3>
      <div class="row small">
        <div style="flex:1">
          <label>f‚ÇÄ ~ 50/60¬±3 –ì—Ü; H2&gt;-15 –¥–ë (–Ω–æ—Ä–º–∞)</label>
        </div>
        <div style="flex:1">
          <label>¬´–ë—Ä—è–∑–∫—ñ—Ç¬ª: f‚ÇÄ –≤ 120‚Äì300 –ì—Ü, —Ç–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å &lt;0.25, –ø–ª–æ—Å–∫—ñ—Å—Ç—å &gt;0.4</label>
        </div>
        <div style="flex:1">
          <label>–ü—ñ–¥—à–∏–ø–Ω–∏–∫: —Ü–µ–Ω—Ç—Ä–æ—ó–¥ 1‚Äì4 –∫–ì—Ü, —Ç–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å &gt;0.35</label>
        </div>
        <div style="flex:1">
          <label>PD: —Ü–µ–Ω—Ç—Ä–æ—ó–¥ &gt;3 –∫–ì—Ü, –ø–ª–æ—Å–∫—ñ—Å—Ç—å &gt;0.6, ZCR ‚Üë</label>
        </div>
      </div>

      <div class="row" style="margin-top:8px">
        <button class="btn" id="classify">‚úÖ –ö–ª–∞—Å–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –∑–∞—Ä–∞–∑</button>
        <span id="pred" class="badge">Pred: ‚Äî</span>
      </div>

      <h3 style="margin-top:12px">üìú –ñ—É—Ä–Ω–∞–ª —ñ–Ω—Ü–∏–¥–µ–Ω—Ç—ñ–≤</h3>
      <pre id="alog" class="code" style="max-height:180px;overflow:auto">// –ü–æ–∫–∏ –±–µ–∑ —ñ–Ω—Ü–∏–¥–µ–Ω—Ç—ñ–≤</pre>

      <div class="row" style="margin-top:6px">
        <button class="btn" id="saveCsv">üìÑ –ï–∫—Å–ø–æ—Ä—Ç CSV (–æ–∑–Ω–∞–∫–∏)</button>
        <button class="btn" id="saveTxt">üíæ –ó–≤—ñ—Ç TXT</button>
        <button class="btn" id="saveModel">‚¨áÔ∏è model.json</button>
        <button class="btn secondary" id="loadModel">üì• –Ü–º–ø–æ—Ä—Ç model.json</button>
      </div>
    </div>
  </div>

  <div class="card">
    <h2>üß© Arduino-—Å–∫–µ—Ç—á (Goertzel: 100/120/200/240/1k/3k –ì—Ü)</h2>
    <div class="row">
      <button class="btn good" id="gen">‚öôÔ∏è –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ .ino</button>
      <button class="btn secondary" id="copy">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
      <button class="btn secondary" id="dl">‚¨áÔ∏è –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .ino</button>
    </div>
    <pre class="code" id="code">// –ù–∞—Ç–∏—Å–Ω–∏ ¬´–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ .ino¬ª</pre>
  </div>

  <div class="card">
    <h2>ü§ñ –ü—Ä–æ–º–ø—Ç –¥–æ LLM –¥–ª—è –ø–æ—è—Å–Ω–µ–Ω—å</h2>
    <div class="row">
      <button class="btn" id="genPrompt">üìù –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏</button>
      <button class="btn secondary" id="copyPrompt">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
      <button class="btn secondary" id="savePrompt">‚¨áÔ∏è TXT</button>
    </div>
    <pre class="code" id="prompt">// –°–ø–æ—á–∞—Ç–∫—É –∑–∞–ø—É—Å—Ç–∏ –∞–Ω–∞–ª—ñ–∑</pre>
  </div>

  <div class="card">
    <h2>üîå –°—Ö–µ–º–∞ —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è –º—ñ–∫—Ä–æ—Ñ–æ–Ω–∞ (SVG)</h2>
    <svg viewBox="0 0 900 300" role="img" aria-label="–ú—ñ–∫—Ä–æ—Ñ–æ–Ω –±—ñ–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ç–æ—Ä–∞">
      <rect x="40" y="60" width="240" height="160" rx="12" fill="#0e2a47" stroke="#3b82f6"></rect>
      <text x="160" y="90" fill="#e5e7eb" font-size="16" text-anchor="middle">–°–∏–ª–æ–≤–∏–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ç–æ—Ä</text>
      <text x="160" y="110" fill="#93c5fd" font-size="12" text-anchor="middle">–¥–≤–µ—Ä—Ü—è—Ç–∞ –ó–†.1</text>
      <circle cx="360" cy="150" r="18" fill="#14532d" stroke="#22c55e"></circle>
      <text x="360" y="155" fill="#dcfce7" font-size="12" text-anchor="middle">üé§</text>
      <text x="360" y="177" fill="#a7f3d0" font-size="12" text-anchor="middle">–º—ñ–∫—Ä–æ—Ñ–æ–Ω 20‚Äì40 —Å–º</text>
      <line x1="280" y1="140" x2="342" y2="150" stroke="#93c5fd" stroke-width="3"></line>
      <text x="140" y="240" fill="#fbbf24" font-size="12">‚ö†Ô∏è –ù–µ –≤—ñ–¥–∫—Ä–∏–≤–∞–π —à–∞—Ñ—É –ø—ñ–¥ –Ω–∞–ø—Ä—É–≥–æ—é; —Ç—Ä–∏–º–∞–π—Å—è –∑–∞ —Ä–æ–∑–º—ñ—Ç–∫–æ—é –±–µ–∑–ø–µ–∫–∏</text>
    </svg>
    <div class="note small" style="margin-top:10px">
      <b>–ë–µ–∑–ø–µ–∫–∞:</b> –ø—Ä–∞—Ü—é—î–º–æ <i>–ø–æ–∑–∞</i> –∑–æ–Ω–æ—é –∫–æ–Ω—Ç–∞–∫—Ç—É –∑ –≤–∏—Å–æ–∫–æ—é –Ω–∞–ø—Ä—É–≥–æ—é, LOTO –ø—Ä–∏ –±—É–¥—å-—è–∫–æ–º—É —Å–µ—Ä–≤—ñ—Å—ñ. –ú—ñ–∫—Ä–æ—Ñ–æ–Ω —Å—Ç–∞–≤–∏–º–æ –Ω–∞ —à—Ç–∞—Ç–∏–≤ 20‚Äì40 —Å–º –≤—ñ–¥ –∫–æ—Ä–ø—É—Å—É, —â–æ–± –Ω–µ —Ç–æ—Ä–∫–∞—Ç–∏—Å—è –Ω—ñ—á–æ–≥–æ –ø—ñ–¥ –Ω–∞–ø—Ä—É–≥–æ—é.
    </div>
  </div>

  <div class="card">
    <h2>üìã –ü—ñ–¥—Å—É–º–æ–∫ –¥–ª—è –∑–≤—ñ—Ç—É</h2>
    <ul>
      <li>PNG —Å–ø–µ–∫—Ç—Ä–∞ + –æ—Å—Ü–∏–ª–æ–≥—Ä–∞–º–∏ (—Å–∫—Ä—ñ–Ω/–µ–∫—Å–ø–æ—Ä—Ç).</li>
      <li>CSV –æ–∑–Ω–∞–∫ 1‚Äì2 —Ö–≤–∏–ª–∏–Ω–∏ —Ç–∞ –∂—É—Ä–Ω–∞–ª —ñ–Ω—Ü–∏–¥–µ–Ω—Ç—ñ–≤.</li>
      <li>–û–ø–∏—Å –¥—ñ–∞–≥–Ω–æ–∑—É —Ç–∞ –¥—ñ–π –∑–∞ —á–µ–∫-–ª–∏—Å—Ç–æ–º.</li>
    </ul>
  </div>

  <div class="card">
    <h2>üìú –Ü—Å—Ç–æ—Ä–∏—á–Ω–∞ –Ω–æ—Ç–∞—Ç–∫–∞</h2>
    <p class="muted small">
      –©–µ –∑ 1930-—Ö —Ç–µ—Ö–Ω—ñ–∫–∏ —Å–ª—É—Ö–∞–ª–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ç–æ—Ä–∏ —Å—Ç–µ—Ç–æ—Å–∫–æ–ø–æ–º. –°—å–æ–≥–æ–¥–Ω—ñ WebAudio + FFT –¥–∞—î —Ç—ñ –∂ ¬´–≤—É—Ö–∞¬ª, –∞–ª–µ –∑ —Ü–∏—Ñ—Ä–∞–º–∏:
      —Ç–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å, –≥–∞—Ä–º–æ–Ω—ñ–∫–∏ —ñ —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–∞ ¬´—à–µ—Ä—à–∞–≤—ñ—Å—Ç—å¬ª –≤–∏—è–≤–ª—è—é—Ç—å —Ä–æ–∑–±–∞–ª–∞–Ω—Å—É–≤–∞–Ω–Ω—è –¥–æ —Ç–æ–≥–æ, —è–∫ –≤–æ–Ω–æ —Å—Ç–∞–Ω–µ –∞–≤–∞—Ä—ñ—î—é.
    </p>
  </div>

  <div class="footer">
    –û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: <time datetime="2025-10-18">18.10.2025</time>. –ê–≤—Ç–æ—Ä: –°–µ—Ä–≥—ñ–π –ü–æ–ª—ñ—â—É–∫.
  </div>
</div>

<script>
// ===== –£–¢–ò–õ–Ü–¢–ò =====
const $=s=>document.querySelector(s), $$=s=>Array.from(document.querySelectorAll(s));
function stamp(){return new Date().toISOString().replace(/[:T]/g,'-').slice(0,16);}
function download(name,text,type="text/plain"){const b=new Blob([text],{type:type+";charset=utf-8"});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download=name;document.body.appendChild(a);a.click();a.remove();URL.revokeObjectURL(u);}

// ===== –ê–£–î–Ü–û –ü–ê–ô–ü–õ–ê–ô–ù =====
let actx=null, micStream=null, analyser=null, srcNode=null, emuNodes=[];
let spBuf=null, wfBuf=null, fs=48000;

const wave=$('#wave'), wctx=wave.getContext('2d');
const spec=$('#spec'), sctx=spec.getContext('2d');

const NFFT=4096; // 4096 —Ç–æ—á–æ–∫ ‚âà 11.7 –ì—Ü —Ä–æ–∑–¥—ñ–ª—å–Ω—ñ—Å—Ç—å –ø—Ä–∏ 48 –∫–ì—Ü
const logbook=[]; // [{t,msg}]
const featsLog=[]; // rows for CSV

function log(msg){ const t=new Date().toLocaleTimeString(); logbook.push({t,msg}); const box=$('#alog'); if(box.textContent.startsWith('//')) box.textContent=''; box.textContent+=`[${t}] ${msg}\n`; box.scrollTop=box.scrollHeight; }

function drawWave(arr){
  const W=wave.width,H=wave.height;
  wctx.clearRect(0,0,W,H);
  wctx.strokeStyle='#223049'; wctx.strokeRect(0.5,0.5,W-1,H-1);
  wctx.beginPath(); wctx.strokeStyle='#38bdf8'; wctx.lineWidth=1;
  const L=arr.length;
  for(let i=0;i<L;i++){
    const x= i*(W/(L-1));
    const y= H/2 - arr[i]*(H/2-12);
    if(i) wctx.lineTo(x,y); else wctx.moveTo(x,y);
  }
  wctx.stroke();
}

function drawSpec(db, fstep){
  const W=spec.width,H=spec.height;
  sctx.clearRect(0,0,W,H);
  sctx.strokeStyle='#223049'; sctx.strokeRect(0.5,0.5,W-1,H-1);
  // —Å—ñ—Ç–∫–∞ —á–∞—Å—Ç–æ—Ç (–∫–æ–∂–Ω—ñ 1 –∫–ì—Ü)
  sctx.fillStyle='#94a3b8'; sctx.font='12px ui-monospace';
  for(let fk=1000; fk<=20000; fk+=1000){
    const x= (fk/fstep) * (W/NFFT/2);
    sctx.strokeStyle='#18243b'; sctx.beginPath(); sctx.moveTo(x,0); sctx.lineTo(x,H); sctx.stroke();
    sctx.fillText(fk/1000+'–∫', x+2, 12);
  }
  // —Å–∞–º —Å–ø–µ–∫—Ç—Ä
  sctx.beginPath(); sctx.strokeStyle='#22c55e'; sctx.lineWidth=1.6;
  const L=db.length;
  for(let i=0;i<L;i++){
    const x= i*(W/(L-1));
    const mag = Math.max(-100, Math.min(0, db[i])); // dBFS
    const y= H-10 - ((mag+100)/100)*(H-20);
    if(i) sctx.lineTo(x,y); else sctx.moveTo(x,y);
  }
  sctx.stroke();
}

function startAudio(){
  if(actx) return;
  actx = new (window.AudioContext||window.webkitAudioContext)({latencyHint:'interactive'});
  fs = actx.sampleRate;
  analyser = actx.createAnalyser();
  analyser.fftSize = NFFT;
  analyser.smoothingTimeConstant = 0.4;
  spBuf = new Float32Array(analyser.frequencyBinCount);
  wfBuf = new Float32Array(analyser.fftSize);

  if($('#src').value==='mic'){
    navigator.mediaDevices.getUserMedia({audio:{noiseSuppression:false, echoCancellation:false, autoGainControl:false}})
      .then(stream=>{
        micStream=stream;
        srcNode=actx.createMediaStreamSource(stream);
        srcNode.connect(analyser);
        $('#stat').textContent='–°—Ç–∞—Ç—É—Å: mic '+fs+' –ì—Ü';
        log('–ú—ñ–∫—Ä–æ—Ñ–æ–Ω —É–≤—ñ–º–∫–Ω–µ–Ω–æ');
        loop();
      }).catch(err=>{ alert('–î–æ—Å—Ç—É–ø –¥–æ –º—ñ–∫—Ä–æ—Ñ–æ–Ω–∞ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ: '+err.message); $('#stat').textContent='–°—Ç–∞—Ç—É—Å: –ø–æ–º–∏–ª–∫–∞'; });
  }else{
    // –ï–º—É–ª—è—Ç–æ—Ä
    const g=actx.createGain(); g.gain.value=parseFloat($('#emuLvl').value)||0.6;
    const type=$('#emuType').value;
    emuNodes=[g];

    function mkOsc(f, gain){ const o=actx.createOscillator(); o.type='sine'; o.frequency.value=f; const gg=actx.createGain(); gg.gain.value=gain; o.connect(gg).connect(g); o.start(); emuNodes.push(o,gg); }
    function mkNoise(bwHz, gain){ // –±—ñ–ª–∏–π —á–µ—Ä–µ–∑ Biquad
      const buf=actx.createBuffer(1, fs, fs), d=buf.getChannelData(0); for(let i=0;i<fs;i++) d[i]=Math.random()*2-1;
      const s=actx.createBufferSource(); s.buffer=buf; s.loop=true;
      const biq=actx.createBiquadFilter(); biq.type='bandpass'; biq.Q=fs/(bwHz||1000); biq.frequency.value=4000;
      const gg=actx.createGain(); gg.gain.value=gain; s.connect(biq).connect(gg).connect(g); s.start(); emuNodes.push(s,biq,gg);
    }

    if(type==='normal'){
      mkOsc(50, 0.5); mkOsc(100, 0.25); mkOsc(150, 0.12);
    }else if(type==='loose'){
      mkOsc(180, 0.4); mkOsc(240,0.28); mkOsc(300,0.18); mkNoise(400, 0.05);
    }else if(type==='bearing'){
      mkOsc(2200, 0.35); mkOsc(2600, 0.15); mkNoise(800,0.06);
    }else if(type==='pd'){
      mkNoise(6000, 0.45); // —à–∏—Ä–æ–∫–æ—Å–º—É–≥–æ–≤–∏–π
    }else if(type==='cav'){
      mkNoise(1200, 0.30); // —Å–µ—Ä–µ–¥–Ω—ñ —á–∞—Å—Ç–æ—Ç–∏
    }

    g.connect(analyser);
    srcNode = g;
    $('#stat').textContent='–°—Ç–∞—Ç—É—Å: –µ–º—É–ª—è—Ç–æ—Ä '+fs+' –ì—Ü';
    log('–ï–º—É–ª—è—Ç–æ—Ä –∑–≤—É–∫—É: '+$('#emuType').value);
    loop();
  }
}

function stopAudio(){
  if(emuNodes.length){
    emuNodes.forEach(n=>{ try{ if(n.stop) n.stop(); if(n.disconnect) n.disconnect(); }catch{} });
    emuNodes.length=0;
  }
  if(micStream){ micStream.getTracks().forEach(t=>t.stop()); micStream=null; }
  if(actx){ try{ actx.close(); }catch{} }
  actx=null; analyser=null; srcNode=null;
  $('#stat').textContent='–°—Ç–∞—Ç—É—Å: idle';
  log('–ó—É–ø–∏–Ω–µ–Ω–æ');
}

$('#start').addEventListener('click', startAudio);
$('#stop').addEventListener('click', stopAudio);
$('#src').addEventListener('change', ()=>{ $('#emuBox').style.display = ($('#src').value==='emu')?'block':'none'; });

// ===== –†–û–ó–†–ê–•–£–ù–û–ö –û–ó–ù–ê–ö =====
function peakPick(db, fstep){
  // —à—É–∫–∞—î–º–æ –º–∞–∫—Å–∏–º—É–º –¥–æ 1 –∫–ì—Ü –¥–ª—è f0; –≥–∞—Ä–º–æ–Ω—ñ–∫–∏ 2f0, 3f0 ¬±2 –±—ñ–Ω—ñ–≤
  let bestI=1, bestV=-1e9;
  const kMax=Math.floor(1000/fstep);
  for(let i=1;i<kMax;i++){ if(db[i]>bestV){ bestV=db[i]; bestI=i; } }
  const f0=bestI*fstep;
  function bandDb(f){ const k=Math.round(f/fstep); let m=-120; for(let d=-2;d<=2;d++){ const ki=k+d; if(ki>0 && ki<db.length) m=Math.max(m, db[ki]); } return m; }
  const h1=bandDb(f0), h2=bandDb(2*f0), h3=bandDb(3*f0);
  return {f0, h1, h2, h3};
}
function spectralCentroid(db, fstep){
  let num=0,den=0; for(let k=1;k<db.length;k++){ const a=Math.pow(10, db[k]/20); num += (k*fstep)*a; den += a; }
  return (den>0)? num/den : 0;
}
function spectralFlatness(db){
  // –≥–µ–æ–º–µ—Ç—Ä. —Å–µ—Ä–µ–¥–Ω—î / —Å–µ—Ä–µ–¥–Ω—î (–≤ –¥–± ‚Äî —Å–µ—Ä–µ–¥–Ω—î, –≥–µ–æ–º–µ—Ç—Ä. ‚Äî —á–µ—Ä–µ–∑ –ª–æ–≥)
  let sum=0, sumLog=0, n=0;
  for(let i=1;i<db.length;i++){ const a=Math.max(1e-6, Math.pow(10, db[i]/20)); sum += a; sumLog += Math.log(a); n++; }
  const gm = Math.exp(sumLog/n), am = sum/n;
  return gm/am;
}
function zcrAndCrest(time){
  let z=0; for(let i=1;i<time.length;i++){ if((time[i-1]>=0)!==(time[i]>=0)) z++; }
  const zcr = z/time.length;
  let max=0, sum=0; for(const v of time){ const av=Math.abs(v); if(av>max) max=av; sum+=av; }
  const crest = (sum>0)? max / (sum/time.length) : 0;
  return {zcr, crest};
}
function tonality(db){
  const arr=db.slice(1).map(v=>Math.pow(10,v/20));
  const max=Math.max(...arr), sum=arr.reduce((a,b)=>a+b,0);
  return (sum>0)? max/sum : 0;
}
function snrEst(db){
  const arr=db.slice(1);
  const max=Math.max(...arr);
  const med=arr.slice().sort((a,b)=>a-b)[Math.floor(arr.length*0.5)];
  return max - med; // –≤ –¥–ë
}

function computeFeatures(){
  if(!analyser) return null;
  analyser.getFloatTimeDomainData(wfBuf);
  analyser.getFloatFrequencyData(spBuf); // dBFS, –≤—ñ–¥ 0..Nyquist
  const fstep = fs/NFFT;
  drawWave(wfBuf);
  drawSpec(spBuf, fstep);

  const pk = peakPick(spBuf, fstep);
  const cent = spectralCentroid(spBuf, fstep);
  const flat = spectralFlatness(spBuf);
  const tc = tonality(spBuf);
  const {zcr, crest} = zcrAndCrest(wfBuf);
  const snr = snrEst(spBuf);

  // –æ–Ω–æ–≤–∏—Ç–∏ UI
  $('#f0').textContent = pk.f0.toFixed(1);
  $('#h23').textContent = `${(pk.h2-pk.h1).toFixed(1)} –¥–ë / ${(pk.h3-pk.h1).toFixed(1)} –¥–ë`;
  $('#ton').textContent = tc.toFixed(2);
  $('#cent').textContent = cent.toFixed(0);
  $('#flat').textContent = flat.toFixed(2);
  $('#zcr').textContent = zcr.toFixed(3);
  $('#crest').textContent = crest.toFixed(2);
  $('#snr').textContent = snr.toFixed(1)+' –¥–ë';

  const row={t:new Date().toISOString(), f0:pk.f0, h2rel:(pk.h2-pk.h1), h3rel:(pk.h3-pk.h1), ton:tc, cent, flat, zcr, crest, snr};
  featsLog.push(row);
  return row;
}

// ===== –ö–õ–ê–°–ò–§–Ü–ö–ê–¶–Ü–Ø =====
const LABELS=['normal','loose','bearing','pd','cav'];
const MEMO=[]; // –∑—Ä–∞–∑–∫–∏ –¥–ª—è kNN: {x:[...], y:'label'}
function ruleBased(feat){
  const {f0,h2rel,h3rel,ton,cent,flat,zcr,snr}=feat;
  // PD
  if(cent>3000 && flat>0.60 && zcr>0.10 && snr<35) return 'pd';
  // –ü—ñ–¥—à–∏–ø–Ω–∏–∫
  if(cent>=1000 && cent<=4000 && ton>0.35 && flat<0.55) return 'bearing';
  // –ö–∞–≤—ñ—Ç–∞—Ü—ñ—è
  if(cent>=800 && cent<=1500 && flat>0.45 && ton<0.30) return 'cav';
  // –†–æ–∑—Ö–∏—Ç–∞–Ω–µ —è–¥—Ä–æ
  if(f0>=120 && f0<=300 && flat>0.40 && ton<0.25) return 'loose';
  // –ù–æ—Ä–º–∞: 50/60 ¬±3 –ì—Ü, H2 –Ω–µ –¥—É–∂–µ –ø—Ä–∏–≥–Ω—ñ—á–µ–Ω–∞
  if(f0>=47 && f0<=63 && h2rel>-18) return 'normal';
  // fallback –∑–∞ –Ω–∞–π–±–ª–∏–∂—á–∏–º
  return 'normal';
}
function toVec(f){ return [f.f0, f.h2rel, f.h3rel, f.ton, f.cent, f.flat, f.zcr, f.crest, f.snr]; }
function dist2(a,b){ let s=0; for(let i=0;i<a.length;i++){ const d=a[i]-b[i]; s+=d*d; } return s; }
function knn(feat,k){
  if(MEMO.length<5) return ruleBased(feat);
  const x=toVec(feat);
  const arr=MEMO.map(r=>({d:dist2(x,r.x), y:r.y})).sort((a,b)=>a.d-b.d).slice(0,k);
  const votes=new Map(); arr.forEach(o=>votes.set(o.y,(votes.get(o.y)||0)+1));
  let best='normal', v=-1; for(const [y,c] of votes){ if(c>v){v=c; best=y;} }
  return best;
}
function keepMemo(label,feat){
  MEMO.push({x:toVec(feat), y:label});
  if(MEMO.length>300) MEMO.shift();
}
function classifyNow(){
  const f=computeFeatures(); if(!f) return;
  // –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —è—Ä–ª–∏–∫ –≤—ñ–¥ –¥–∂–µ—Ä–µ–ª–∞ –µ–º—É–ª.
  let hint=null;
  if($('#src').value==='emu') hint=$('#emuType').value;
  const rb=ruleBased(f);
  const k=parseInt($('#k').value)||3;
  const kn=knn(f,k);
  const pred = (hint && hint!=='normal' && rb!==hint)? kn : rb; // —è–∫—â–æ –µ–º—É–ª—å ¬´–∫–∞–∂–µ¬ª —ñ–Ω—à–∏–π, –¥–æ–≤—ñ—Ä–∏–º–æ—Å—è kNN
  $('#pred').textContent='Pred: '+pred;
  if(pred!=='normal'){
    log(`–ê–Ω–æ–º–∞–ª—å–Ω–∏–π –∑–≤—É–∫: ${pred} | f0=${f.f0.toFixed(1)}–ì—Ü cent=${f.cent.toFixed(0)}–ì—Ü flat=${f.flat.toFixed(2)} ton=${f.ton.toFixed(2)}`);
  }
  if($('#src').value==='emu') keepMemo($('#emuType').value, f);
  else keepMemo(pred, f);
}
$('#classify').addEventListener('click', classifyNow);

// –∞–≤—Ç–æ–∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è
let autoTick=true;
$('#auto').addEventListener('change', ()=>{ autoTick = ($('#auto').value==='–£–≤—ñ–º–∫–Ω–µ–Ω–∞'); });

// —Ü–∏–∫–ª
function loop(){
  if(!analyser) return;
  const f=computeFeatures();
  if(autoTick) classifyNow();
  requestAnimationFrame(loop);
}

// ===== –ï–ö–°–ü–û–†–¢–ò =====
$('#savePng').addEventListener('click', ()=>{
  const tmp=document.createElement('canvas'); tmp.width=spec.width; tmp.height=spec.height+wave.height+10;
  const tctx=tmp.getContext('2d');
  tctx.drawImage(wave,0,0); tctx.drawImage(spec,0,wave.height+10);
  tmp.toBlob(b=>{ const u=URL.createObjectURL(b); const a=document.createElement('a'); a.href=u; a.download='para25_spectrum_'+stamp()+'.png'; a.click(); URL.revokeObjectURL(u); });
});
$('#clearPlot').addEventListener('click', ()=>{ wctx.clearRect(0,0,wave.width,wave.height); sctx.clearRect(0,0,spec.width,spec.height); });

$('#saveCsv').addEventListener('click', ()=>{
  const head='timestamp,f0,h2rel,h3rel,ton,cent,flat,zcr,crest,snr,label\n';
  const body=featsLog.map(r=>`${r.t},${r.f0.toFixed(2)},${r.h2rel.toFixed(2)},${r.h3rel.toFixed(2)},${r.ton.toFixed(3)},${r.cent.toFixed(0)},${r.flat.toFixed(3)},${r.zcr.toFixed(4)},${r.crest.toFixed(2)},${r.snr.toFixed(1)},`).join('\n');
  download('electric_para25_feats_'+stamp()+'.csv', head+body, 'text/csv');
});
$('#saveTxt').addEventListener('click', ()=>{
  const lines=['–ü–∞—Ä–∞ 25 ‚Äî –ê—É–¥—ñ–æ–¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ç–æ—Ä–∞','–ü—ñ–¥—Å—É–º–æ–∫ —ñ–Ω—Ü–∏–¥–µ–Ω—Ç—ñ–≤:'];
  logbook.forEach(l=>lines.push(`[${l.t}] ${l.msg}`));
  download('electric_para25_report_'+stamp()+'.txt', lines.join('\n'));
});

// –º–æ–¥–µ–ª—å
$('#saveModel').addEventListener('click', ()=>{
  const m={memo:MEMO.slice(-200), params:{NFFT, fs, rules:'ruleBased+knn'}};
  download('electric_para25_model_'+stamp()+'.json', JSON.stringify(m,null,2), 'application/json');
});
$('#loadModel').addEventListener('click', ()=>{
  const inp=document.createElement('input'); inp.type='file'; inp.accept='application/json';
  inp.onchange=e=>{
    const f=e.target.files[0]; if(!f) return;
    const r=new FileReader(); r.onload=()=>{
      try{
        const m=JSON.parse(r.result);
        if(m.memo?.length){ MEMO.length=0; m.memo.forEach(o=>MEMO.push(o)); log('–ú–æ–¥–µ–ª—å —ñ–º–ø–æ—Ä—Ç–æ–≤–∞–Ω–∞: '+m.memo.length+' –∑—Ä–∞–∑–∫—ñ–≤'); }
      }catch(err){ alert('–ü–æ–º–∏–ª–∫–∞ JSON: '+err.message); }
    }; r.readAsText(f);
  };
  inp.click();
});

// ===== –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä Arduino Goertzel =====
function genSketch(){
  const code = `/*
  –ü–∞—Ä–∞ 25 ‚Äî –ê—É–¥—ñ–æ–¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ç–æ—Ä–∞ (Goertzel)
  –ú—ñ–∫—Ä–æ—Ñ–æ–Ω–Ω–∏–π –º–æ–¥—É–ª—å (MAX4466/KY-037) ‚Üí A0. –°–µ–º–ø–ª—ñ–Ω–≥ ~4 –∫–ì—Ü. –í—ñ–∫–Ω–æ 256 –∑—Ä–∞–∑–∫—ñ–≤.
  –ß–∞—Å—Ç–æ—Ç–∏: 100, 120, 200, 240, 1000, 3000 –ì—Ü.
  –í–∏–≤—ñ–¥ CSV: millis,mag100,mag120,mag200,mag240,mag1k,mag3k,rms
  ‚ö† –ü–æ—Ä–∞–¥–∞: –∂–∏–≤–ª–µ–Ω–Ω—è –π –∑–µ–º–ª—è –º—ñ–∫—Ä–æ—Ñ–æ–Ω–∞ ‚Äî –∫–æ—Ä–æ—Ç–∫—ñ –ø—Ä–æ–≤–æ–¥–∏, –µ–∫—Ä–∞–Ω—É–≤–∞–Ω–Ω—è.
*/
#define MIC_PIN A0
#define FS 4000
#define N 256
#include <Arduino.h>

float coeffs[6];
float freqs[6]={100,120,200,240,1000,3000};
float mags[6];

void setup(){
  Serial.begin(115200);
  analogReference(DEFAULT);
  for(int i=0;i<6;i++){
    float k = 0.5 + (N*freqs[i])/FS;
    float w = 2.0*PI*k/N;
    coeffs[i] = 2.0*cos(w);
  }
  Serial.println(F("millis,mag100,mag120,mag200,mag240,mag1k,mag3k,rms"));
}

void loop(){
  static int16_t x[N];
  // —Å–µ–º–ø–ª—ñ–Ω–≥ —ñ–∑ —Ä—ñ–≤–Ω–æ–º—ñ—Ä–Ω–∏–º —ñ–Ω—Ç–µ—Ä–≤–∞–ª–æ–º
  unsigned long t0=micros();
  for(int i=0;i<N;i++){
    int v=analogRead(MIC_PIN)-512; // —Ü–µ–Ω—Ç—Ä 0..1023
    x[i]=v;
    while((micros()-t0) < (unsigned long)((i+1)*(1000000.0/FS))){} // –ø—Ä–æ—Å—Ç–∏–π —Ç–∞–π–º–µ—Ä
  }
  // RMS
  double acc2=0; for(int i=0;i<N;i++){ acc2 += (double)x[i]*x[i]; }
  float rms = sqrt(acc2/N);

  // Goertzel
  for(int f=0; f<6; f++){
    float s0=0,s1=0,s2=0;
    float c=coeffs[f];
    for(int i=0;i<N;i++){ s0 = x[i] + c*s1 - s2; s2=s1; s1=s0; }
    float power = s1*s1 + s2*s2 - c*s1*s2;
    mags[f] = sqrt(max(0.0f, power))/N;
  }
  unsigned long ms=millis();
  Serial.print(ms);
  Serial.print(',');
  Serial.print(mags[0],2); Serial.print(',');
  Serial.print(mags[1],2); Serial.print(',');
  Serial.print(mags[2],2); Serial.print(',');
  Serial.print(mags[3],2); Serial.print(',');
  Serial.print(mags[4],2); Serial.print(',');
  Serial.print(mags[5],2); Serial.print(',');
  Serial.println(rms,2);
}
`;
  return code;
}
$('#gen').addEventListener('click', ()=>{ const txt=genSketch(); $('#code').textContent=txt; });
$('#copy').addEventListener('click', ()=>{ const ta=document.createElement('textarea'); ta.value=$('#code').textContent; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove(); });
$('#dl').addEventListener('click', ()=>{ const txt=$('#code').textContent||genSketch(); download('electric_para25_audio_goertzel.ino',txt,'text/x-ino'); });

// ===== –ü—Ä–æ–º–ø—Ç –¥–æ LLM =====
function buildPrompt(){
  return `–¢–∏ ‚Äî —ñ–Ω–∂–µ–Ω–µ—Ä –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ç–æ—Ä—ñ–≤ –∑–∞ –∞–∫—É—Å—Ç–∏—á–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏.
–í—Ö—ñ–¥:
‚Ä¢ –°—Ç—Ä—É–º—ñ–Ω—å –æ–∑–Ω–∞–∫: f0, h2rel, h3rel, tonality, centroid, flatness, ZCR, crest, SNR
‚Ä¢ –ö–ª–∞—Å–∏: normal, loose_core, fan_bearing, partial_discharge, cavitation
‚Ä¢ –ñ—É—Ä–Ω–∞–ª —ñ–Ω—Ü–∏–¥–µ–Ω—Ç—ñ–≤ (—á–∞—Å ‚Üí –æ–ø–∏—Å)
–ó–∞–≤–¥–∞–Ω–Ω—è:
1) –ü–æ—è—Å–Ω–∏, —á–æ–º—É –æ–±—Ä–∞–Ω–æ –¥—ñ–∞–≥–Ω–æ–∑ (–ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ –æ–∑–Ω–∞–∫–∏).
2) –ó–∞–ø—Ä–æ–ø–æ–Ω—É–π –Ω–µ–≥–∞–π–Ω—ñ –¥—ñ—ó (LOTO/–æ–≥–ª—è–¥/–æ—á–∏—â–µ–Ω–Ω—è/–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–µ–Ω—Ç–∏–ª—è—Ü—ñ—ó/–Ü–ß-—Ç–µ—Ä–º–æ–≥—Ä–∞—Ñ—ñ—è/–µ–ª–µ–∫—Ç—Ä–æ–≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è).
3) –°—Ñ–æ—Ä–º—É–π —á–µ–∫-–ª–∏—Å—Ç ¬´—Å–∏–º–ø—Ç–æ–º‚Üí–º–æ–∂–ª–∏–≤—ñ –ø—Ä–∏—á–∏–Ω–∏‚Üí–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞‚Üí–ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç¬ª.
4) –Ø–∫—â–æ PD –π–º–æ–≤—ñ—Ä–Ω—ñ ‚Äî –ø—ñ–¥–∫—Ä–µ—Å–ª–∏ —Ä–∏–∑–∏–∫–∏ —Ç–∞ –≤–∏–º–æ–≥—É –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –≤–∏–º—ñ—Ä—ñ–≤ (UHF, PD test). –ó–∞–≤–µ—Ä—à–∏ –∫–æ—Ä–æ—Ç–∫–∏–º —Ä–µ–∑—é–º–µ —Ä–∏–∑–∏–∫—ñ–≤.`;
}
$('#genPrompt').addEventListener('click', ()=>{ $('#prompt').textContent=buildPrompt(); });
$('#copyPrompt').addEventListener('click', ()=>{ const ta=document.createElement('textarea'); ta.value=$('#prompt').textContent; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove(); });
$('#savePrompt').addEventListener('click', ()=>{ const txt=$('#prompt').textContent||buildPrompt(); download('electric_para25_prompt_'+stamp()+'.txt', txt); });

// ===== –Ü–ù–Ü–¶–Ü–ê–õ–Ü–ó–ê–¶–Ü–Ø =====
if (window.self !== window.top) document.documentElement.classList.add('embedded'); // LMS-friendly
</script>


</body></html>