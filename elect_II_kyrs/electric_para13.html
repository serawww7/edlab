<!-- electric_para13.html
     –ü–∞—Ä–∞ 13 (–ï–ª–µ–∫—Ç—Ä–∏–∫–∏, –∞—É–¥–∏—Ç–æ—Ä–Ω–æ): –ï–õ–ï–ö–¢–†–û–©–ò–¢ ¬∑ –ü–ê–ù–ï–õ–¨–ù–ò–ô –ñ–£–†–ù–ê–õ
     –í—ñ–¥–æ–º—ñ—Å—Ç—å —â–∏—Ç–∞: –∫–æ–ª–∞/—Ñ–∞–∑–∏/–Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è/–∞–≤—Ç–æ–º–∞—Ç–∏/–ü–ó–í (RCD), –±–∞–ª–∞–Ω—Å —Ñ–∞–∑, –ø—Ä–æ—Å—Ç—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ,
     –Ω–∞–∫–ª–µ–π–∫–∏ 58 –º–º –Ω–∞ –ª—ñ–Ω—ñ—ó, A4-–∑–≤—ñ—Ç, —ñ–º–ø–æ—Ä—Ç/–µ–∫—Å–ø–æ—Ä—Ç CSV.
     –ü–æ–≤–Ω—ñ—Å—Ç—é –∞–≤—Ç–æ–Ω–æ–º–Ω–∏–π —Ñ–∞–π–ª –¥–ª—è GitHub Pages —ñ –≤–±—É–¥–æ–≤—É–≤–∞–Ω–Ω—è –≤ Moodle —á–µ—Ä–µ–∑ <iframe>.
--><!DOCTYPE html><html lang="uk"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>–ï–ª–µ–∫—Ç—Ä–∏–∫–∏ ¬∑ –ü–∞—Ä–∞ 13 ‚Äî –ï–ª–µ–∫—Ç—Ä–æ—â–∏—Ç: –ø–∞–Ω–µ–ª—å–Ω–∏–π –∂—É—Ä–Ω–∞–ª, –±–∞–ª–∞–Ω—Å —Ñ–∞–∑, RCD, –Ω–∞–∫–ª–µ–π–∫–∏</title>
<meta name="color-scheme" content="light dark">
<style>
  :root{
    --bg:#0b1220; --bg2:#111827; --card:#0f172a; --text:#e2e8f0; --muted:#9aa5b1; --line:#1f2937;
    --ok:#22c55e; --warn:#f59e0b; --bad:#ef4444; --info:#60a5fa;
  }
  *{box-sizing:border-box}
  body{margin:0; background:linear-gradient(180deg,var(--bg),var(--bg2) 30%,var(--bg)); color:var(--text);
       font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif; line-height:1.55}
  .wrap{max-width:1120px; margin:0 auto; padding:24px 16px 96px}
  .badge{display:inline-block; padding:6px 10px; border:1px solid var(--line); background:#0b1220; border-radius:999px; font-size:12px; color:#9aa5b1}
  h1{font-size:32px; margin:6px 0 12px; line-height:1.15; background:linear-gradient(90deg,#60a5fa,#22c55e); -webkit-background-clip:text; -webkit-text-fill-color:transparent}
  h2{font-size:22px; margin:22px 0 12px}
  h3{font-size:18px; margin:12px 0 8px; color:#cbd5e1}
  p{margin:8px 0}
  .card{background:linear-gradient(180deg,#0f172a,#0b1220); border:1px solid var(--line); border-radius:16px; padding:16px; margin:12px 0; box-shadow:0 6px 24px rgba(0,0,0,.25)}
  .row{display:flex; gap:10px; flex-wrap:wrap}
  .grid{display:grid; gap:12px}
  .g2{grid-template-columns:1fr 1fr}
  .g3{grid-template-columns:repeat(3,1fr)}
  @media (max-width:1050px){.g3{grid-template-columns:1fr}; .g2{grid-template-columns:1fr}}
  .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
  .btn{display:inline-block; padding:10px 14px; border-radius:10px; border:1px solid var(--line); background:#0d1a2e; color:#dbeafe; text-decoration:none; cursor:pointer}
  .btn:hover{background:#0f1f39}
  .small{font-size:12px; color:#93a3b5}
  .chip{display:inline-block; padding:2px 8px; border:1px solid #223049; border-radius:999px; font-size:12px; margin-right:6px; background:#0d1a2e}
  .ok{color:var(--ok)} .warn{color:var(--warn)} .bad{color:var(--bad)} .muted{color:#9aa5b1}
  input,select,textarea{padding:8px 10px; border-radius:10px; border:1px solid #223049; background:#0d1a2e; color:#e5e7eb; width:100%}
  textarea{min-height:88px}

  /* –¢–∞–±–ª–∏—Ü—ñ */
  table{width:100%; border-collapse:separate; border-spacing:0; border:1px solid #223049; border-radius:12px; overflow:hidden}
  thead th{background:#0c1629; color:#a5b4fc; text-align:left; padding:10px 12px; font-size:14px}
  tbody td{padding:8px 10px; border-top:1px solid #1f2937; font-size:14px; vertical-align:top}
  tbody tr:nth-child(even){background:#0b1324}

  /* –ö–≤–∏—Ç–∞–Ω—Ü—ñ—ó 58 –º–º */
  .tickets{display:flex; gap:12px; flex-wrap:wrap}
  .ticket{
    width:58mm; background:#fff; color:#000; padding:5mm 4mm; border-radius:6px;
    box-shadow:0 0 0 1px #e5e7eb inset; font-family:"Courier New",ui-monospace,monospace
  }
  .ticket h4{margin:0 0 4px; font-size:13px; text-align:center}
  .ticket p{margin:1px 0; font-size:12px}
  .ticket .line{border-top:1px dashed #111; margin:5px 0}
  .ticket small{font-size:10px}
  .ticket .qr{font-size:10px; word-break:break-all}

  /* A4 */
  #printArea{background:#fff; color:#000; border-radius:12px; border:1px solid #e5e7eb; padding:16px}
  .doc{page-break-after:always; padding:12mm; color:#000; font-family:Georgia,"Times New Roman",serif}
  .doc h2{color:#000; font-size:20px; margin:0 0 6px}
  .doc h3{color:#000; font-size:16px; margin:6px 0}
  .doc p{color:#000; margin:4px 0}
  .doc table{width:100%; border-collapse:collapse; border:1px solid #111}
  .doc th,.doc td{border:1px solid #111; padding:6px 8px; font-size:12px; vertical-align:top}
  .doc .sign{margin-top:10mm; display:flex; gap:10mm; flex-wrap:wrap}
  .doc .sign div{flex:1 1 220px}

  /* –í–±—É–¥–æ–≤–∞–Ω–∏–π —Ä–µ–∂–∏–º (iframe/Moodle) */
  html.embedded body{background:#fff; color:#111}
  html.embedded .card{background:#fff; border:1px solid #e5e7eb; box-shadow:none}
  html.embedded h1{-webkit-text-fill-color:initial; background:none; color:#111}

  @media print{
    @page{ size:A4; margin:12mm }
    body{ background:#fff; color:#000 }
    .no-print, .card:not(.printable){ display:none !important }
    #printArea{ border:none; padding:0 }
    .ticket{ box-shadow:none; width:auto; padding:0 }
  }
</style>
<meta name="description" content="–°–∫–ª–∞—Å—Ç–∏ –≤—ñ–¥–æ–º—ñ—Å—Ç—å —â–∏—Ç–∞: —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ–ª–∞ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, —Ñ–∞–∑–∞–º–∏, –∞–≤—Ç–æ–º–∞—Ç–∞–º–∏ —Ç–∞ –ü–ó–í; –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –±–∞–ª–∞–Ω—Å —Ñ–∞–∑, –ø—Ä–æ—Å—Ç—É —Å–µ–ª–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –ø–æ –Ω–æ–º—ñ–Ω–∞–ª–∞—Ö; –∑–≥–µ–Ω"><link rel="canonical" href="https://edlab.pp.ua/elect_II_kyrs/electric_para13.html"><meta property="og:type" content="article"><meta property="og:title" content="üõ†Ô∏è –ï–ª–µ–∫—Ç—Ä–æ—â–∏—Ç: –ø–∞–Ω–µ–ª—å–Ω–∏–π –∂—É—Ä–Ω–∞–ª ‚Üí –±–∞–ª–∞–Ω—Å —Ñ–∞–∑ ‚Üí RCD/RCBO ‚Üí üßæ –Ω–∞–∫–ª–µ–π–∫–∏ 58 –º–º ‚Üí A4"><meta property="og:description" content="–°–∫–ª–∞—Å—Ç–∏ –≤—ñ–¥–æ–º—ñ—Å—Ç—å —â–∏—Ç–∞: —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ–ª–∞ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, —Ñ–∞–∑–∞–º–∏, –∞–≤—Ç–æ–º–∞—Ç–∞–º–∏ —Ç–∞ –ü–ó–í; –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –±–∞–ª–∞–Ω—Å —Ñ–∞–∑, –ø—Ä–æ—Å—Ç—É —Å–µ–ª–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –ø–æ –Ω–æ–º—ñ–Ω–∞–ª–∞—Ö; –∑–≥–µ–Ω"><meta property="og:url" content="https://edlab.pp.ua/elect_II_kyrs/electric_para13.html"><script type="application/ld+json">{"@context":"https://schema.org","@type":"LearningResource","name":"üõ†Ô∏è –ï–ª–µ–∫—Ç—Ä–æ—â–∏—Ç: –ø–∞–Ω–µ–ª—å–Ω–∏–π –∂—É—Ä–Ω–∞–ª ‚Üí –±–∞–ª–∞–Ω—Å —Ñ–∞–∑ ‚Üí RCD/RCBO ‚Üí üßæ –Ω–∞–∫–ª–µ–π–∫–∏ 58 –º–º ‚Üí A4","description":"–°–∫–ª–∞—Å—Ç–∏ –≤—ñ–¥–æ–º—ñ—Å—Ç—å —â–∏—Ç–∞: —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ–ª–∞ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, —Ñ–∞–∑–∞–º–∏, –∞–≤—Ç–æ–º–∞—Ç–∞–º–∏ —Ç–∞ –ü–ó–í; –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –±–∞–ª–∞–Ω—Å —Ñ–∞–∑, –ø—Ä–æ—Å—Ç—É —Å–µ–ª–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –ø–æ –Ω–æ–º—ñ–Ω–∞–ª–∞—Ö; –∑–≥–µ–Ω","inLanguage":"uk","educationalLevel":"college","url":"https://edlab.pp.ua/elect_II_kyrs/electric_para13.html","provider":{"@type":"Organization","name":"EDLab"}}</script></head>
<body>
  <div class="wrap">
    <span class="badge">–ï–ª–µ–∫—Ç—Ä–∏–∫–∏ ¬∑ –ü–∞—Ä–∞ 13 ¬∑ –∞—É–¥–∏—Ç–æ—Ä–Ω–æ</span>
    <h1>üõ†Ô∏è –ï–ª–µ–∫—Ç—Ä–æ—â–∏—Ç: –ø–∞–Ω–µ–ª—å–Ω–∏–π –∂—É—Ä–Ω–∞–ª ‚Üí –±–∞–ª–∞–Ω—Å —Ñ–∞–∑ ‚Üí RCD/RCBO ‚Üí üßæ –Ω–∞–∫–ª–µ–π–∫–∏ 58 –º–º ‚Üí A4</h1>

    <div class="card">
      <h2>üéØ –ú–µ—Ç–∞</h2>
      <p>–°–∫–ª–∞—Å—Ç–∏ –≤—ñ–¥–æ–º—ñ—Å—Ç—å —â–∏—Ç–∞: —Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫–æ–ª–∞ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, —Ñ–∞–∑–∞–º–∏, –∞–≤—Ç–æ–º–∞—Ç–∞–º–∏ —Ç–∞ –ü–ó–í; –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ <b>–±–∞–ª–∞–Ω—Å —Ñ–∞–∑</b>, –ø—Ä–æ—Å—Ç—É <b>—Å–µ–ª–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å</b> –ø–æ –Ω–æ–º—ñ–Ω–∞–ª–∞—Ö; –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –Ω–∞–∫–ª–µ–π–∫–∏ 58 –º–º —ñ A4-–∑–≤—ñ—Ç. –ü—Ä–∞—Ü—é—î–º–æ –∑ 1-—Ñ —Ç–∞ 3-—Ñ –∫–æ–ª–∞–º–∏.</p>
      <div class="row">
        <button class="btn" onclick="seedDemo()">üîÑ –ü—Ä–∏–∫–ª–∞–¥</button>
        <button class="btn" onclick="exportCSV()">üì§ –ï–∫—Å–ø–æ—Ä—Ç CSV</button>
        <input id="file" type="file" accept=".csv,text/csv" class="btn">
        <button class="btn" onclick="importCSV()">‚¨ÜÔ∏è –Ü–º–ø–æ—Ä—Ç CSV</button>
      </div>
      <p class="small">CSV: <span class="mono">id,name,type,phase,phases,kw,U,PF,eta,curve,mcbA,rcdType,rcd_mA,rcdA,rcdGroup,wire_mm2,length_m,url,notes,duty_pct,diversity_pct</span></p>
    </div>

    <div class="card">
      <h2>üß© –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ —â–∏—Ç–∞</h2>
      <div class="grid g3">
        <div>
          <div class="row"><label class="small" style="min-width:150px">–ù–∞–∑–≤–∞ —â–∏—Ç–∞</label><input id="panelName" value="–©–û-1 ¬∑ –ú–∞–π—Å—Ç–µ—Ä–Ω—è"></div>
          <div class="row"><label class="small" style="min-width:150px">–ì–æ–ª–æ–≤–Ω–∏–π –∞–≤—Ç–æ–º–∞—Ç, –ê</label>
            <select id="mainMCB"><option>25</option><option selected="">40</option><option>50</option><option>63</option></select></div>
          <div class="row"><label class="small" style="min-width:150px">–ö—Ä–∏–≤–∞ –≥–æ–ª–æ–≤–Ω–æ–≥–æ</label>
            <select id="mainCurve"><option selected="">C</option><option>B</option><option>D</option></select></div>
        </div>
        <div>
          <div class="row"><label class="small" style="min-width:150px">U —Ñ–∞–∑-—Ñ–∞–∑–∞, –í</label><input id="Ull" type="number" value="400"></div>
          <div class="row"><label class="small" style="min-width:150px">U —Ñ–∞–∑–∞-–Ω—É–ª—å, –í</label><input id="Uln" type="number" value="230"></div>
          <div class="row"><label class="small" style="min-width:150px">–í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∏–π</label><input id="resp" value="–°—Ç—É–¥–µ–Ω—Ç –ü–Ü–ë / –≥—Ä—É–ø–∞"></div>
        </div>
        <div>
          <div class="row"><label class="small" style="min-width:150px">–ó–∞–≥–∞–ª—å–Ω–∏–π –∫–æ–µ—Ñ. –ø–æ–ø–∏—Ç—É (diversity)</label><input id="diversity" type="number" step="1" value="80"></div>
          <div class="row"><label class="small" style="min-width:150px">–õ—ñ–º—ñ—Ç –¥–∏—Å–±–∞–ª–∞–Ω—Å—É —Ñ–∞–∑, %</label><input id="imbLimit" type="number" step="1" value="20"></div>
          <div class="row"><button class="btn" onclick="calcTotals()">üßÆ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button></div>
        </div>
      </div>
    </div>

    <div class="card">
      <h2>‚ûï –î–æ–¥–∞—Ç–∏ –∫–æ–ª–æ</h2>
      <div class="grid g3">
        <div>
          <h3>–ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</h3>
          <div class="row"><label class="small" style="min-width:140px">ID</label><input id="id" value="L-01"></div>
          <div class="row"><label class="small" style="min-width:140px">–ù–∞–∑–≤–∞</label><input id="name" value="–û—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è –∞—É–¥–∏—Ç–æ—Ä—ñ—ó"></div>
          <div class="row"><label class="small" style="min-width:140px">–¢–∏–ø</label>
            <select id="type"><option>–û—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è</option><option>–†–æ–∑–µ—Ç–∫–∏</option><option>–î–≤–∏–≥—É–Ω</option><option>–Ü–Ω—à–µ</option></select></div>
          <div class="row"><label class="small" style="min-width:140px">–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å, –∫–í—Ç</label><input id="kw" type="number" step="0.1" value="1.2"></div>
          <div class="row"><label class="small" style="min-width:140px">PF (cosœÜ)</label><input id="pf" type="number" step="0.01" value="0.95"></div>
          <div class="row"><label class="small" style="min-width:140px">Œ∑ (–∑–∞ –ø–æ—Ç—Ä–µ–±–∏)</label><input id="eta" type="number" step="0.01" value="0.95"></div>
        </div>
        <div>
          <h3>–§–∞–∑–∏ / –ó–∞—Ö–∏—Å—Ç</h3>
          <div class="row"><label class="small" style="min-width:140px">–§–∞–∑–∏</label>
            <select id="phases"><option selected="">1–§</option><option>3–§</option></select></div>
          <div class="row" id="phaseRow"><label class="small" style="min-width:140px">–§–∞–∑–∞ (1–§)</label>
            <select id="phase"><option>A</option><option>B</option><option>C</option></select></div>
          <div class="row"><label class="small" style="min-width:140px">MCB –∫—Ä–∏–≤–∞</label>
            <select id="curve"><option>B</option><option selected="">C</option><option>D</option></select></div>
          <div class="row"><label class="small" style="min-width:140px">MCB, –ê</label>
            <select id="mcbA"><option>6</option><option>10</option><option selected="">16</option><option>20</option><option>25</option><option>32</option></select></div>
        </div>
        <div>
          <h3>RCD / –õ—ñ–Ω—ñ—è</h3>
          <div class="row"><label class="small" style="min-width:140px">RCD —Ç–∏–ø</label>
            <select id="rcdType"><option>‚Äî</option><option selected="">AC</option><option>A</option><option>F</option></select></div>
          <div class="row"><label class="small" style="min-width:140px">RCD IŒîn, –º–ê</label>
            <select id="rcd_mA"><option>‚Äî</option><option>30</option><option selected="">100</option><option>300</option></select></div>
          <div class="row"><label class="small" style="min-width:140px">RCD, –ê</label>
            <select id="rcdA"><option>‚Äî</option><option>25</option><option selected="">40</option><option>63</option></select></div>
          <div class="row"><label class="small" style="min-width:140px">–ì—Ä—É–ø–∞ RCD</label><input id="rcdGroup" value="RCD-1"></div>
          <div class="row"><label class="small" style="min-width:140px">–ü—Ä–æ–≤—ñ–¥, –º–º¬≤</label><select id="wire"><option>1.5</option><option selected="">2.5</option><option>4</option><option>6</option></select></div>
          <div class="row"><label class="small" style="min-width:140px">–î–æ–≤–∂–∏–Ω–∞, –º</label><input id="len" type="number" value="25"></div>
        </div>
      </div>
      <div class="grid g3" style="margin-top:8px">
        <div>
          <div class="row"><label class="small" style="min-width:140px">URL (NFC/QR)</label><input id="url" placeholder="https://serawww7.github.io/edlab/..."></div>
        </div>
        <div>
          <div class="row"><label class="small" style="min-width:140px">–ù–æ—Ç–∞—Ç–∫–∞</label><input id="notes" placeholder="–ü—Ä–∏–º—ñ—Ç–∫–∞"></div>
        </div>
        <div>
          <div class="row"><label class="small" style="min-width:140px">Duty, % (–∫–æ—Ä–∏—Å—Ç.)</label><input id="duty" type="number" value="70"></div>
          <div class="row"><label class="small" style="min-width:140px">Diversity, % (–∫–æ–ª–∞)</label><input id="div" type="number" value="100"></div>
        </div>
      </div>
      <div class="row" style="margin-top:8px">
        <button class="btn" onclick="addOrUpdate()">üíæ –î–æ–¥–∞—Ç–∏/–û–Ω–æ–≤–∏—Ç–∏</button>
        <button class="btn" onclick="seedOne()">üîÑ –ü—Ä–∏–∫–ª–∞–¥ –∫–æ–ª–∞</button>
      </div>
      <p class="small">–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ I: 1–§ ‚Üí <span class="mono">I = P / (Uln¬∑PF¬∑Œ∑)</span>, 3–§ ‚Üí <span class="mono">I = P / (‚àö3¬∑Ull¬∑PF¬∑Œ∑)</span>. P = –∫–í—Ç¬∑1000.</p>
    </div>

    <div class="card printable">
      <h2>üìã –í—ñ–¥–æ–º—ñ—Å—Ç—å —â–∏—Ç–∞</h2>
      <table id="tbl">
        <thead>
          <tr>
            <th>#</th><th>ID</th><th>–ù–∞–∑–≤–∞</th><th>–§–∞–∑–∏</th><th>–§–∞–∑–∞</th><th>–∫–í—Ç</th><th>I, –ê</th><th>MCB</th><th>RCD</th><th>–ü—Ä–æ–≤—ñ–¥</th><th>–î–æ–≤–∂., –º</th><th>–°—Ç–∞—Ç—É—Å</th><th>URL</th><th>–î—ñ—ó</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <p class="small">–°—Ç–∞—Ç—É—Å: <span class="chip ok">PASS</span> ‚Äî –æ–∫; <span class="chip warn">IMB</span> ‚Äî –¥–∏—Å–±–∞–ª–∞–Ω—Å —Ñ–∞–∑; <span class="chip bad">MCB/RCD</span> ‚Äî –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–∞ –Ω–µ—É–∑–≥–æ–¥–∂–µ–Ω—ñ—Å—Ç—å.</p>
    </div>

    <div class="card">
      <h2>üìä –ü—ñ–¥—Å—É–º–∫–∏ / –ë–∞–ª–∞–Ω—Å —Ñ–∞–∑</h2>
      <div id="sum" class="grid g3"></div>
      <div class="row" style="margin-top:8px">
        <button class="btn" onclick="buildTickets()">üßæ –ù–∞–∫–ª–µ–π–∫–∏ 58 –º–º (–≤—Å—ñ)</button>
        <button class="btn" onclick="buildReport()">üìÑ A4-–∑–≤—ñ—Ç</button>
        <button class="btn" onclick="window.print()">üñ®Ô∏è –î—Ä—É–∫</button>
      </div>
    </div>

    <div class="card printable">
      <h2>üßæ –ù–∞–∫–ª–µ–π–∫–∏ 58 –º–º</h2>
      <div id="tickets" class="tickets"></div>
    </div>

    <div class="card printable">
      <h2>üìÑ A4-–∑–≤—ñ—Ç (–¥–ª—è –¥—Ä—É–∫—É/PDF)</h2>
      <div id="printArea"></div>
    </div>
  </div>

<script>
  // –í–±—É–¥–æ–≤–∞–Ω–æ —É Moodle ‚Üí —Å—Ç—Ä–∏–º–∞–Ω–∏–π –≤–∏–≥–ª—è–¥
  (function(){ if (window.self !== window.top) document.documentElement.classList.add('embedded'); })();

  // ======= –°–¢–ê–ù =======
  let circuits = []; // –æ–±'—î–∫—Ç–∏ –∫–æ–ª–∞
  const tbody = document.querySelector('#tbl tbody');
  const ticketsBox = document.getElementById('tickets');
  const sumBox = document.getElementById('sum');

  // ======= –£–¢–ò–õ–Ü–¢–ò =======
  function esc(s){ return String(s||'').replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m])); }
  function pad(n){ return n.toString().padStart(2,'0'); }
  function nowStamp(){ const d=new Date(); return `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}`; }

  function I_from(kW, phases, Uln, Ull, PF, eta){
    const P = (parseFloat(kW)||0)*1000;
    const pf = parseFloat(PF)||1;
    const e = parseFloat(eta)||1;
    if(phases==='3–§'){ if(Ull<=0||pf<=0||e<=0) return 0; return P/(Math.sqrt(3)*Ull*pf*e); }
    if(Uln<=0||pf<=0||e<=0) return 0; return P/(Uln*pf*e);
  }

  // ======= –î–û–î–ê–í–ê–ù–ù–Ø / –û–ù–û–í–õ–ï–ù–ù–Ø =======
  function addOrUpdate(){
    const rec = {
      id: (document.getElementById('id').value||'').trim(),
      name: (document.getElementById('name').value||'').trim(),
      type: document.getElementById('type').value,
      phases: document.getElementById('phases').value,
      phase: document.getElementById('phase').value,
      kw: parseFloat(document.getElementById('kw').value||'0'),
      PF: parseFloat(document.getElementById('pf').value||'1'),
      eta: parseFloat(document.getElementById('eta').value||'1'),
      curve: document.getElementById('curve').value,
      mcbA: parseInt(document.getElementById('mcbA').value||'16',10),
      rcdType: document.getElementById('rcdType').value,
      rcd_mA: document.getElementById('rcd_mA').value,
      rcdA: document.getElementById('rcdA').value,
      rcdGroup: (document.getElementById('rcdGroup').value||'').trim(),
      wire: parseFloat(document.getElementById('wire').value||'2.5'),
      len: parseFloat(document.getElementById('len').value||'0'),
      url: (document.getElementById('url').value||'').trim(),
      notes: (document.getElementById('notes').value||'').trim(),
      duty: parseFloat(document.getElementById('duty').value||'100'),
      diversity: parseFloat(document.getElementById('div').value||'100')
    };
    if(!rec.id){ alert('–£–∫–∞–∂–∏ ID'); return; }
    const i = circuits.findIndex(x=>x.id===rec.id);
    if(i>=0) circuits[i] = {...circuits[i], ...rec};
    else circuits.push(rec);
    calcTotals();
  }

  // ======= –†–û–ó–†–ê–•–£–ù–ö–ò / –ü–ï–†–ï–í–Ü–†–ö–ò =======
  function calcTotals(){
    const Uln = parseFloat(document.getElementById('Uln').value||'230');
    const Ull = parseFloat(document.getElementById('Ull').value||'400');
    const mainA = parseFloat(document.getElementById('mainMCB').value||'40');
    const mainCurve = document.getElementById('mainCurve').value;
    const globDiv = parseFloat(document.getElementById('diversity').value||'100')/100;
    const imbLimit = parseFloat(document.getElementById('imbLimit').value||'20');

    // –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ I —Ç–∞ —Å—Ç–∞—Ç—É—Å—É –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–æ–ª–∞
    circuits.forEach(c=>{
      c.I = Math.round(I_from(c.kw, c.phases, Uln, Ull, c.PF, c.eta)*100)/100;
      c.status = 'PASS';
      // –ü—Ä–æ—Å—Ç—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏: MCB ‚â• I*1.25
      const need = (c.I || 0) * 1.25;
      if(c.mcbA < need) c.status = 'MCB';
      // RCD –≥—Ä—É–ø–∞: —è–∫—â–æ –∑–∞–¥–∞–Ω–∏–π rcdType –∞–ª–µ –Ω–µ–º–∞—î –≥—Ä—É–ø–∏ ‚Äî –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è
      if(c.rcdType!=='‚Äî' && !c.rcdGroup){ c.status = (c.status==='PASS') ? 'RCD' : c.status; }
    });

    // –ë–∞–ª–∞–Ω—Å —Ñ–∞–∑ (–≤—Ä–∞—Ö–æ–≤—É—é—á–∏ duty —Ç–∞ diversity)
    const A = sumPhase('A', circuits, globDiv);
    const B = sumPhase('B', circuits, globDiv);
    const C = sumPhase('C', circuits, globDiv);
    const maxI = Math.max(A.I,B.I,C.I);
    const minI = Math.min(A.I,B.I,C.I);
    const imb = maxI>0 ? Math.round(((maxI-minI)/maxI)*100) : 0;

    // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å–µ–ª–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –ø–æ –Ω–æ–º—ñ–Ω–∞–ª–∞—Ö: –≥–æ–ª–æ–≤–Ω–∏–π ‚â• 1.6√ó –Ω–∞–π–±—ñ–ª—å—à–æ–≥–æ –≤—ñ–¥–≥–∞–ª—É–∂–µ–Ω–Ω—è
    const maxBranch = Math.max(...circuits.map(c=>c.mcbA||0),0);
    const selective = mainA >= 1.6*maxBranch ? 'OK' : 'CHECK';

    render(A,B,C,imb,imbLimit, mainA, mainCurve, selective);
  }

  function sumPhase(ph, list, globDiv){
    // 3–§ –¥—ñ–ª–∏—Ç—å—Å—è —Ä—ñ–≤–Ω–æ–º—ñ—Ä–Ω–æ –Ω–∞ A/B/C; 1–§ –π–¥–µ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É —Ñ–∞–∑—É
    let I = 0, P = 0;
    list.forEach(c=>{
      const duty = (c.duty||100)/100;
      const div = (c.diversity||100)/100 * globDiv;
      if(c.phases==='3–§'){
        I += (c.I/3) * duty * div;
        P += (c.kw/3) * 1000 * duty * div;
      }else if(c.phase===ph){
        I += c.I * duty * div;
        P += c.kw * 1000 * duty * div;
      }
    });
    return {phase:ph, I: Math.round(I*100)/100, P: Math.round(P)};
  }

  // ======= –†–ï–ù–î–ï–† =======
  function render(A,B,C,imb,imbLimit, mainA, mainCurve, selective){
    // –¢–∞–±–ª–∏—Ü—è
    tbody.innerHTML='';
    circuits.forEach((c,i)=>{
      const badge = badgeFor(c.status);
      const rcd = c.rcdType==='‚Äî' ? '‚Äî' : `${c.rcdType} ${c.rcd_mA}–º–ê / ${c.rcdA}A ¬∑ ${esc(c.rcdGroup||'?')}`;
      const tr=document.createElement('tr');
      tr.innerHTML = `
        <td>${i+1}</td>
        <td class="editable" data-k="id" data-id="${c.id}">${esc(c.id)}</td>
        <td class="editable" data-k="name" data-id="${c.id}">${esc(c.name)}</td>
        <td class="editable" data-k="phases" data-id="${c.id}">${esc(c.phases)}</td>
        <td class="editable" data-k="phase" data-id="${c.id}">${esc(c.phases==='1–§'?c.phase:'ABC')}</td>
        <td class="editable" data-k="kw" data-id="${c.id}">${esc(c.kw)}</td>
        <td>${c.I??'‚Äî'}</td>
        <td class="editable" data-k="mcbA" data-id="${c.id}">${esc(c.curve)}${esc(c.mcbA)}</td>
        <td class="editable" data-k="rcdGroup" data-id="${c.id}">${rcd}</td>
        <td class="editable" data-k="wire" data-id="${c.id}">${esc(c.wire)}</td>
        <td class="editable" data-k="len" data-id="${c.id}">${esc(c.len)}</td>
        <td>${badge}</td>
        <td class="editable" data-k="url" data-id="${c.id}">${esc(c.url||'')}</td>
        <td class="mono">
          <button class="btn" data-act="label" data-id="${c.id}">–ù–∞–∫–ª–µ–π–∫–∞</button>
          <button class="btn" data-act="del" data-id="${c.id}">‚úñ</button>
        </td>`;
      tbody.appendChild(tr);
    });

    // –ü—ñ–¥—Å—É–º–∫–∏
    const imbBadge = imb>imbLimit ? `<span class="chip warn">–Ü–º–±–∞–ª–∞–Ω—Å ${imb}% (–ª—ñ–º—ñ—Ç ${imbLimit}%)</span>` : `<span class="chip ok">–Ü–º–±–∞–ª–∞–Ω—Å ${imb}%</span>`;
    const selBadge = selective==='OK' ? `<span class="chip ok">–°–µ–ª–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å ~ OK</span>` : `<span class="chip warn">–°–µ–ª–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å ~ CHECK</span>`;
    sumBox.innerHTML = `
      <div class="card"><h3>–§–∞–∑–∞ A</h3><p>I‚âà <b>${A.I} –ê</b> ¬∑ P‚âà ${A.P} –í—Ç</p></div>
      <div class="card"><h3>–§–∞–∑–∞ B</h3><p>I‚âà <b>${B.I} –ê</b> ¬∑ P‚âà ${B.P} –í—Ç</p></div>
      <div class="card"><h3>–§–∞–∑–∞ C</h3><p>I‚âà <b>${C.I} –ê</b> ¬∑ P‚âà ${C.P} –í—Ç</p></div>
      <div class="card"><h3>–ì–æ–ª–æ–≤–Ω–∏–π MCB</h3><p>${esc(document.getElementById('panelName').value)} ¬∑ <b>${esc(document.getElementById('mainCurve').value)}${esc(document.getElementById('mainMCB').value)}A</b><br>${imbBadge} ¬∑ ${selBadge}</p></div>
    `;
  }

  function badgeFor(status){
    let color = '#22c55e'; let txt='PASS';
    if(status==='MCB' || status==='RCD'){ color='#ef4444'; txt=status; }
    return `<span class="mono" style="padding:2px 8px;border:1px solid #223049;border-radius:999px;background:#0d1a2e;color:${color}">${txt}</span>`;
  }

  // –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –≤ —Ç–∞–±–ª–∏—Ü—ñ
  tbody.addEventListener('dblclick', (e)=>{
    const td = e.target.closest('.editable'); if(!td) return;
    const id = td.getAttribute('data-id'); const key = td.getAttribute('data-k');
    const idx = circuits.findIndex(x=>x.id===id); const c = circuits[idx];
    const input = document.createElement('input'); input.value = key==='phase' && c.phases==='3–§' ? 'ABC' : c[key]; input.style.width='100%'; input.style.padding='6px 8px';
    input.addEventListener('blur', ()=>{
      let v = input.value.trim();
      if(['kw','mcbA','wire','len'].includes(key)) v = parseFloat(v.replace(',','.'))||0;
      if(key==='phases' && (v!=='1–§' && v!=='3–§')) v = c.phases;
      if(key==='phase' && c.phases==='3–§') v = 'ABC';
      c[key] = v; calcTotals();
    });
    td.innerHTML=''; td.appendChild(input); input.focus(); input.select();
  });

  tbody.addEventListener('click', (e)=>{
    const b = e.target.closest('button'); if(!b) return;
    const id = b.getAttribute('data-id'); const act = b.getAttribute('data-act');
    if(act==='del'){ circuits = circuits.filter(x=>x.id!==id); calcTotals(); return; }
    if(act==='label'){ const c = circuits.find(x=>x.id===id); buildTickets([c]); ticketsBox.scrollIntoView({behavior:'smooth'}); }
  });

  // ======= –ù–ê–ö–õ–ï–ô–ö–ò 58 –º–º =======
  function buildTickets(list){
    const L = list || circuits;
    ticketsBox.innerHTML='';
    const panel = document.getElementById('panelName').value.trim() || '–©–∏—Ç';
    L.forEach(c=>{
      const el = document.createElement('div'); el.className='ticket';
      const urlText = c.url ? c.url : `https://serawww7.github.io/edlab/electric_para13.html#${encodeURIComponent(c.id)}`;
      el.innerHTML = `
        <h4>–õ–Ü–ù–Ü–Ø –©–ò–¢–ê</h4>
        <p><b>${esc(panel)}</b></p>
        <div class="line"></div>
        <p>${esc(c.id)} ¬∑ ${esc(c.name)}</p>
        <p>${esc(c.phases)} ${esc(c.phases==='1–§'?c.phase:'ABC')} ¬∑ ${esc(c.curve)}${esc(c.mcbA)}A ¬∑ –ü—Ä–æ–≤—ñ–¥ ${esc(c.wire)} –º–º¬≤</p>
        <p>P=${c.kw} –∫–í—Ç ¬∑ I‚âà ${c.I??'‚Äî'} A</p>
        <p>RCD: ${esc(c.rcdType==='‚Äî'?'‚Äî':(c.rcdType+' '+c.rcd_mA+'–º–ê / '+c.rcdA+'A ¬∑ '+(c.rcdGroup||'?')))}</p>
        <div class="line"></div>
        <p class="qr"><small>URL/NFC: ${esc(urlText)}</small></p>
        <p><small>${nowStamp()}</small></p>
      `;
      ticketsBox.appendChild(el);
    });
  }

  // ======= A4-–ó–í–Ü–¢ =======
  function buildReport(){
    if(!circuits.length){ alert('–ù–µ–º–∞—î –∫—ñ–ª'); return; }
    const panel = esc(document.getElementById('panelName').value.trim() || '–©–∏—Ç');
    const resp = esc(document.getElementById('resp').value.trim() || '‚Äî');
    const rows = circuits.map((c,i)=>`
      <tr>
        <td>${i+1}</td><td>${esc(c.id)}</td><td>${esc(c.name)}</td><td>${esc(c.phases)}</td><td>${esc(c.phases==='1–§'?c.phase:'ABC')}</td>
        <td>${c.kw}</td><td>${c.I??'‚Äî'}</td><td>${esc(c.curve)}${esc(c.mcbA)}</td>
        <td>${esc(c.rcdType==='‚Äî'?'‚Äî':(c.rcdType+' '+c.rcd_mA+'–º–ê / '+c.rcdA+'A ¬∑ '+(c.rcdGroup||'')))}</td>
        <td>${c.wire}</td><td>${c.len}</td><td>${esc(c.url||'')}</td><td>${esc(c.notes||'')}</td>
      </tr>
    `).join('');
    const Uln = parseFloat(document.getElementById('Uln').value||'230');
    const Ull = parseFloat(document.getElementById('Ull').value||'400');
    const mainA = parseFloat(document.getElementById('mainMCB').value||'40');
    const mainCurve = document.getElementById('mainCurve').value;

    // –ü–æ–≤—Ç–æ—Ä–Ω–∏–π –ø—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –¥–ª—è –ø—ñ–¥—Å—É–º–∫—ñ–≤
    const globDiv = parseFloat(document.getElementById('diversity').value||'100')/100;
    const A = sumPhase('A', circuits, globDiv);
    const B = sumPhase('B', circuits, globDiv);
    const C = sumPhase('C', circuits, globDiv);
    const maxI = Math.max(A.I,B.I,C.I), minI = Math.min(A.I,B.I,C.I);
    const imb = maxI>0 ? Math.round(((maxI-minI)/maxI)*100) : 0;

    const html = `
      <section class="doc">
        <h2>–í–Ü–î–û–ú–Ü–°–¢–¨ –©–ò–¢–ê ¬∑ ${panel}</h2>
        <p>U<sub>LN</sub>=${Uln} –í ¬∑ U<sub>LL</sub>=${Ull} –í ¬∑ –ì–æ–ª–æ–≤–Ω–∏–π: ${esc(mainCurve)}${mainA}A ¬∑ –î–∞—Ç–∞: ${nowStamp()} ¬∑ –í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∏–π: ${resp}</p>
        <h3>1. –°–∫–ª–∞–¥ –ª—ñ–Ω—ñ–π</h3>
        <table>
          <thead><tr><th>#</th><th>ID</th><th>–ù–∞–∑–≤–∞</th><th>–§–∞–∑–∏</th><th>–§–∞–∑–∞</th><th>–∫–í—Ç</th><th>I, –ê</th><th>MCB</th><th>RCD</th><th>–ü—Ä–æ–≤—ñ–¥</th><th>–î–æ–≤–∂., –º</th><th>URL</th><th>–ü—Ä–∏–º.</th></tr></thead>
          <tbody>${rows}</tbody>
        </table>
        <h3>2. –ü—ñ–¥—Å—É–º–∫–∏ / –ë–∞–ª–∞–Ω—Å —Ñ–∞–∑</h3>
        <table>
          <thead><tr><th>–§–∞–∑–∞</th><th>I —Å—É–º., –ê (–∑ –∫–æ–µ—Ñ.)</th><th>P, –í—Ç (–∑ –∫–æ–µ—Ñ.)</th></tr></thead>
          <tbody>
            <tr><td>A</td><td>${A.I}</td><td>${A.P}</td></tr>
            <tr><td>B</td><td>${B.I}</td><td>${B.P}</td></tr>
            <tr><td>C</td><td>${C.I}</td><td>${C.P}</td></tr>
          </tbody>
        </table>
        <p>–Ü–º–±–∞–ª–∞–Ω—Å —Ñ–∞–∑: <b>${imb}%</b>. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è: –ø—Ä–∞–≥–Ω—É—Ç–∏ &lt;= <span class="mono">${esc(document.getElementById('imbLimit').value)}%</span> —à–ª—è—Ö–æ–º –ø–µ—Ä–µ–≥—Ä—É–ø—É–≤–∞–Ω–Ω—è 1-—Ñ –∫—ñ–ª.</p>
        <div class="sign"><div>–°–∫–ª–∞–≤: ____________________</div><div>–ü–µ—Ä–µ–≤—ñ—Ä–∏–≤: ____________________</div></div>
        <p class="small">–ó–∞—É–≤–∞–∂–µ–Ω–Ω—è: —Ü–µ –Ω–∞–≤—á–∞–ª—å–Ω–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ (—Å–ø—Ä–æ—â–µ–Ω–æ –±–µ–∑ –ö–ó/—Å–µ–ª–µ–∫—Ç–∏–≤–Ω–∏—Ö –¥—ñ–∞–≥—Ä–∞–º). –£ —Ä–µ–∞–ª—å–Ω–æ–º—É –ø—Ä–æ—î–∫—Ç—ñ –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –ö–ó-—Å—Ç—Ä—É–º–∏, —á–∞—Å–æ–≤—ñ/–µ–Ω–µ—Ä–≥–µ—Ç–∏—á–Ω—ñ —Å–µ–ª–µ–∫—Ç–∏–≤–Ω—ñ –∫–∞—Ä—Ç–∏ –≤–∏—Ä–æ–±–Ω–∏–∫–∞, —É–º–æ–≤–∏ –ø—Ä–æ–∫–ª–∞–¥–∫–∏ –∫–∞–±–µ–ª—ñ–≤ —Ç–∞ –ü–£–ï/–î–°–¢–£.</p>
      </section>`;
    document.getElementById('printArea').innerHTML = html;
    document.getElementById('printArea').scrollIntoView({behavior:'smooth'});
  }

  // ======= CSV =======
  function exportCSV(){
    const headers = ['id','name','type','phase','phases','kw','U','PF','eta','curve','mcbA','rcdType','rcd_mA','rcdA','rcdGroup','wire_mm2','length_m','url','notes','duty_pct','diversity_pct'];
    const U = parseFloat(document.getElementById('Uln').value||'230');
    const csv = [headers.join(','), ...circuits.map(c=>[
      c.id,c.name,c.type,c.phase,c.phases,c.kw,U,c.PF,c.eta,c.curve,c.mcbA,c.rcdType,c.rcd_mA,c.rcdA,c.rcdGroup,c.wire,c.len,c.url||'',c.notes||'',c.duty,c.diversity
    ].map(v=>`"${String(v).replace(/"/g,'""')}"`).join(','))].join('\n');
    const blob=new Blob([csv],{type:'text/csv;charset=utf-8'});
    const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='panel_schedule.csv'; a.click(); URL.revokeObjectURL(a.href);
  }

  async function importCSV(){
    const f=document.getElementById('file').files[0]; if(!f){ alert('–û–±–µ—Ä—ñ—Ç—å CSV'); return; }
    const txt=await f.text();
    const lines=txt.trim().split(/\r?\n/); if(lines.length<2){ alert('CSV –ø–æ—Ä–æ–∂–Ω—ñ–π'); return; }
    const headers=lines[0].split(',').map(h=>h.replace(/^"|"$/g,'').trim());
    const req=['id','name','type','phase','phases','kw','PF','eta','curve','mcbA','rcdType','rcd_mA','rcdA','rcdGroup','wire_mm2','length_m','url','notes','duty_pct','diversity_pct'];
    const miss=req.filter(x=>!headers.includes(x)); if(miss.length){ alert('–í—ñ–¥—Å—É—Ç–Ω—ñ –ø–æ–ª—è: '+miss.join(', ')); return; }
    const out=[];
    for(let i=1;i<lines.length;i++){
      const cells=splitCSV(lines[i]); if(!cells.length) continue;
      const o={}; headers.forEach((h,j)=> o[h]=(cells[j]||'').replace(/^"|"$/g,''));
      out.push({
        id:o.id,name:o.name,type:o.type,phase:o.phase,phases:o.phases||'1–§',kw:parseFloat(o.kw||'0'),
        PF:parseFloat(o.PF||'1'),eta:parseFloat(o.eta||'1'),curve:o.curve||'C',mcbA:parseFloat(o.mcbA||'16'),
        rcdType:o.rcdType||'‚Äî',rcd_mA:o.rcd_mA||'‚Äî',rcdA:o.rcdA||'‚Äî',rcdGroup:o.rcdGroup||'',
        wire:parseFloat(o.wire_mm2||'2.5'),len:parseFloat(o.length_m||'0'),url:o.url||'',notes:o.notes||'',
        duty:parseFloat(o.duty_pct||'100'),diversity:parseFloat(o.diversity_pct||'100')
      });
    }
    circuits = out; calcTotals();
  }
  function splitCSV(line){
    const res=[]; let cur=''; let q=false;
    for(let i=0;i<line.length;i++){
      const ch=line[i];
      if(ch==='"'){ if(q && line[i+1]==='"'){ cur+='"'; i++; } else q=!q; }
      else if(ch===',' && !q){ res.push(cur); cur=''; }
      else { cur+=ch; }
    }
    res.push(cur); return res;
  }

  // ======= –ü–†–ò–ö–õ–ê–î–ò =======
  function seedOne(){
    document.getElementById('id').value='S-01';
    document.getElementById('name').value='–†–æ–∑–µ—Ç–∫–∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä—ñ—ó';
    document.getElementById('type').value='–†–æ–∑–µ—Ç–∫–∏';
    document.getElementById('kw').value=2.2;
    document.getElementById('pf').value=0.95;
    document.getElementById('eta').value=0.98;
    document.getElementById('phases').value='1–§';
    document.getElementById('phase').value='A';
    document.getElementById('curve').value='C';
    document.getElementById('mcbA').value=16;
    document.getElementById('rcdType').value='A';
    document.getElementById('rcd_mA').value='30';
    document.getElementById('rcdA').value='40';
    document.getElementById('rcdGroup').value='RCD-1';
    document.getElementById('wire').value=2.5;
    document.getElementById('len').value=22;
    document.getElementById('duty').value=60;
    document.getElementById('div').value=80;
  }

  function seedDemo(){
    circuits = [
      {id:'L-01',name:'–û—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è –∞—É–¥.101',type:'–û—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è',phases:'1–§',phase:'A',kw:1.2,PF:0.95,eta:0.95,curve:'B',mcbA:10,rcdType:'AC',rcd_mA:'100',rcdA:'40',rcdGroup:'RCD-1',wire:1.5,len:25,url:'',notes:'LED',duty:80,diversity:100},
      {id:'S-01',name:'–†–æ–∑–µ—Ç–∫–∏ –ª–∞–±. ‚Ññ1',type:'–†–æ–∑–µ—Ç–∫–∏',phases:'1–§',phase:'B',kw:2.2,PF:0.95,eta:0.98,curve:'C',mcbA:16,rcdType:'A',rcd_mA:'30',rcdA:'40',rcdGroup:'RCD-2',wire:2.5,len:22,url:'',notes:'–ì—Ä—É–ø–∞ ‚Ññ1',duty:60,diversity:80},
      {id:'M-01',name:'–í–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä –¥–∞—Ö–æ–≤–∏–π',type:'–î–≤–∏–≥—É–Ω',phases:'3–§',phase:'ABC',kw:1.5,PF:0.9,eta:0.9,curve:'D',mcbA:16,rcdType:'‚Äî',rcd_mA:'‚Äî',rcdA:'‚Äî',rcdGroup:'',wire:2.5,len:30,url:'',notes:'Y/Œî –≤–±—É–¥.',duty:70,diversity:100},
      {id:'S-02',name:'–†–æ–∑–µ—Ç–∫–∏ –ª–∞–±. ‚Ññ2',type:'–†–æ–∑–µ—Ç–∫–∏',phases:'1–§',phase:'C',kw:1.6,PF:0.95,eta:0.98,curve:'C',mcbA:16,rcdType:'A',rcd_mA:'30',rcdA:'40',rcdGroup:'RCD-2',wire:2.5,len:18,url:'',notes:'–ì—Ä—É–ø–∞ ‚Ññ2',duty:60,diversity:80}
    ];
    calcTotals();
  }

  // ======= UI: –ø–æ–∫–∞–∑/–ø—Ä–∏—Ö–æ–≤. —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ —Ñ–∞–∑–∏ =======
  (function(){
    const phasesSel = document.getElementById('phases');
    const phaseRow = document.getElementById('phaseRow');
    phasesSel.addEventListener('change', ()=>{ phaseRow.style.display = (phasesSel.value==='1–§')?'flex':'none'; });
    phaseRow.style.display = (phasesSel.value==='1–§')?'flex':'none';
  })();

  // –ê–≤—Ç–æ-–¥–µ–º–æ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ
  seedDemo();
</script>


</body></html>