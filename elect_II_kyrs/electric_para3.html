<!-- electric_para3.html
     –ü–∞—Ä–∞ 3 (–ï–ª–µ–∫—Ç—Ä–∏–∫–∏, –∞—É–¥–∏—Ç–æ—Ä–Ω–æ): –§–æ—Ä–º—É–≤–∞–Ω–Ω—è –ê–∫—Ç—É –ü–ü–† (A4/PDF) —ñ –î–µ—Ñ–µ–∫—Ç–Ω–æ–≥–æ –ª–∏—Å—Ç–∞ –∑ CSV –∂—É—Ä–Ω–∞–ª—É –ü–ü–†
     –ü–æ–≤–Ω—ñ—Å—Ç—é –∞–≤—Ç–æ–Ω–æ–º–Ω–∏–π —Ñ–∞–π–ª –¥–ª—è GitHub Pages —ñ –≤–±—É–¥–æ–≤—É–≤–∞–Ω–Ω—è –≤ Moodle —á–µ—Ä–µ–∑ <iframe>.
--><!DOCTYPE html><html lang="uk"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>–ï–ª–µ–∫—Ç—Ä–∏–∫–∏ ¬∑ –ü–∞—Ä–∞ 3 ‚Äî –ê–∫—Ç –ü–ü–† (A4/PDF) + –î–µ—Ñ–µ–∫—Ç–Ω–∏–π –ª–∏—Å—Ç —ñ–∑ CSV</title>
<meta name="color-scheme" content="light dark">
<style>
  :root{
    --bg:#0b1220; --bg2:#111827; --card:#0f172a; --text:#e2e8f0; --muted:#9aa5b1; --line:#1f2937;
    --ok:#22c55e; --warn:#f59e0b; --bad:#ef4444; --ink:#111827;
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:linear-gradient(180deg,var(--bg),var(--bg2) 30%,var(--bg));
    color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif; line-height:1.55
  }
  .wrap{max-width:1100px; margin:0 auto; padding:24px 16px 80px}
  .badge{display:inline-block; padding:6px 10px; border:1px solid var(--line); background:#0b1220; border-radius:999px; font-size:12px; color:var(--muted)}
  h1{font-size:32px; margin:6px 0 12px; background:linear-gradient(90deg,#60a5fa,#22c55e);
      -webkit-background-clip:text; -webkit-text-fill-color:transparent}
  h2{font-size:22px; margin:22px 0 12px}
  h3{font-size:18px; margin:12px 0 8px; color:#cbd5e1}
  p{margin:8px 0}
  .card{background:linear-gradient(180deg,#0f172a,#0b1220); border:1px solid var(--line); border-radius:16px; padding:16px; margin:12px 0; box-shadow:0 6px 24px rgba(0,0,0,.25)}
  .row{display:flex; gap:10px; flex-wrap:wrap}
  .btn{display:inline-block; padding:10px 14px; border-radius:10px; border:1px solid var(--line); background:#0d1a2e; color:#dbeafe; text-decoration:none; cursor:pointer}
  .btn:hover{background:#0f1f39}
  .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
  .small{font-size:12px; color:#93a3b5}
  .grid{display:grid; gap:12px}
  .g2{grid-template-columns:1fr 1fr}
  @media (max-width:980px){.g2{grid-template-columns:1fr}}

  /* –¢–∞–±–ª–∏—Ü—è –ø—Ä–µ–≤'—é CSV */
  table{width:100%; border-collapse:separate; border-spacing:0; border:1px solid #223049; border-radius:12px; overflow:hidden}
  thead th{background:#0c1629; color:#a5b4fc; text-align:left; padding:10px 12px; font-size:14px}
  tbody td{padding:8px 10px; border-top:1px solid #1f2937; font-size:14px; vertical-align:top}
  tbody tr:nth-child(even){background:#0b1324}

  /* –î—Ä—É–∫–æ–≤–∞–Ω–∏–π –ê–∫—Ç/–î–µ—Ñ–µ–∫—Ç–Ω–∏–π: –±—ñ–ª–∏–π —Ñ–æ–Ω, —á–æ—Ä–Ω—ñ —à—Ä–∏—Ñ—Ç–∏, A4-–≤–µ—Ä—Å—Ç–∫–∞ */
  #printArea{background:#fff; color:#000; border-radius:12px; border:1px solid #e5e7eb; padding:16px; }
  .doc{page-break-after:always; padding:12mm; color:#000; font-family:Georgia, "Times New Roman", serif}
  .doc h2{color:#000; font-size:20px; margin:0 0 6px}
  .doc h3{color:#000; font-size:16px; margin:6px 0}
  .doc p{color:#000; margin:4px 0}
  .doc .muted{color:#374151}
  .doc table{width:100%; border-collapse:collapse; border:1px solid #111}
  .doc th,.doc td{border:1px solid #111; padding:6px 8px; font-size:12px; vertical-align:top}
  .doc .sign{margin-top:10mm; display:flex; gap:10mm; flex-wrap:wrap}
  .doc .sign div{flex:1 1 220px}
  .doc .kpi{margin:6px 0 10px}
  .chip{display:inline-block; padding:2px 8px; border:1px solid #111; border-radius:999px; font-size:11px; margin-right:6px}
  .ok{border-color:#16a34a} .bad{border-color:#dc2626}
  .nowrap{white-space:nowrap}
  .qrtext{font-size:11px; word-break:break-all}

  /* –í–±—É–¥–æ–≤–∞–Ω–æ (Moodle) ‚Äî —Å—Ç—Ä–∏–º–∞–Ω—ñ—à—ñ –∫–∞—Ä—Ç–∫–∏ */
  html.embedded body{background:#fff; color:#111}
  html.embedded .card{background:#fff; border:1px solid #e5e7eb; box-shadow:none}
  html.embedded h1{-webkit-text-fill-color:initial; background:none; color:#111}

  @media print{
    @page{ size:A4; margin:12mm }
    body{ background:#fff; color:#000 }
    .no-print, .card:not(.printable){ display:none !important }
    #printArea{ border:none; padding:0 }
    .doc{ page-break-after:always }
  }
</style>
<meta name="description" content="–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ CSV –∂—É—Ä–Ω–∞–ª—É –ü–ü–†, –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–∞–Ω—ñ –π –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –¥—Ä—É–∫–æ–≤–∞–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏: –ê–∫—Ç –ü–ü–† —Ç–∞ –î–µ—Ñ–µ–∫—Ç–Ω–∏–π –ª–∏—Å—Ç."><link rel="canonical" href="https://edlab.pp.ua/elect_II_kyrs/electric_para3.html"><meta property="og:type" content="article"><meta property="og:title" content="üìÑ –ê–∫—Ç –ü–ü–† (A4/PDF) + üßæ –î–µ—Ñ–µ–∫—Ç–Ω–∏–π –ª–∏—Å—Ç —ñ–∑ CSV –∂—É—Ä–Ω–∞–ª—É"><meta property="og:description" content="–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ CSV –∂—É—Ä–Ω–∞–ª—É –ü–ü–†, –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–∞–Ω—ñ –π –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –¥—Ä—É–∫–æ–≤–∞–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏: –ê–∫—Ç –ü–ü–† —Ç–∞ –î–µ—Ñ–µ–∫—Ç–Ω–∏–π –ª–∏—Å—Ç."><meta property="og:url" content="https://edlab.pp.ua/elect_II_kyrs/electric_para3.html"><script type="application/ld+json">{"@context":"https://schema.org","@type":"LearningResource","name":"üìÑ –ê–∫—Ç –ü–ü–† (A4/PDF) + üßæ –î–µ—Ñ–µ–∫—Ç–Ω–∏–π –ª–∏—Å—Ç —ñ–∑ CSV –∂—É—Ä–Ω–∞–ª—É","description":"–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ CSV –∂—É—Ä–Ω–∞–ª—É –ü–ü–†, –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–∞–Ω—ñ –π –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –¥—Ä—É–∫–æ–≤–∞–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏: –ê–∫—Ç –ü–ü–† —Ç–∞ –î–µ—Ñ–µ–∫—Ç–Ω–∏–π –ª–∏—Å—Ç.","inLanguage":"uk","educationalLevel":"college","url":"https://edlab.pp.ua/elect_II_kyrs/electric_para3.html","provider":{"@type":"Organization","name":"EDLab"}}</script></head>
<body>
  <div class="wrap">
    <span class="badge">–ï–ª–µ–∫—Ç—Ä–∏–∫–∏ ¬∑ –ü–∞—Ä–∞ 3 ¬∑ –∞—É–¥–∏—Ç–æ—Ä–Ω–æ</span>
    <h1>üìÑ –ê–∫—Ç –ü–ü–† (A4/PDF) + üßæ –î–µ—Ñ–µ–∫—Ç–Ω–∏–π –ª–∏—Å—Ç —ñ–∑ CSV –∂—É—Ä–Ω–∞–ª—É</h1>

    <div class="card">
      <h2>üéØ –ú–µ—Ç–∞</h2>
      <p>–Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ CSV –∂—É—Ä–Ω–∞–ª—É –ü–ü–†, –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–∞–Ω—ñ –π –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –¥—Ä—É–∫–æ–≤–∞–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏: <b>–ê–∫—Ç –ü–ü–†</b> —Ç–∞ <b>–î–µ—Ñ–µ–∫—Ç–Ω–∏–π –ª–∏—Å—Ç</b>.</p>
      <div class="row">
        <input id="file" type="file" accept=".csv,text/csv" class="btn">
        <button class="btn" type="button" onclick="pasteSample()">‚¨áÔ∏è –í—Å—Ç–∞–≤–∏—Ç–∏ –Ω–∞–≤—á–∞–ª—å–Ω–∏–π CSV</button>
        <button class="btn" type="button" onclick="parseCSV()">üîé –†–æ–∑—ñ–±—Ä–∞—Ç–∏ CSV</button>
      </div>
      <p class="small">–û—á—ñ–∫—É–≤–∞–Ω—ñ –ø–æ–ª—è CSV: <span class="mono">id,object,place,period_months,responsible,last_date,next_date,status</span></p>
      <textarea id="csv" style="width:100%;min-height:120px;margin-top:8px; padding:10px;border-radius:10px;border:1px solid #223049;background:#0d1a2e;color:#e5e7eb" placeholder="–í—Å—Ç–∞–≤ —Å—é–¥–∏ –≤–º—ñ—Å—Ç journal_ppr.csv"></textarea>
    </div>

    <div class="card">
      <h2>üëÄ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–∞–Ω–∏—Ö</h2>
      <div class="grid g2">
        <div>
          <div class="row">
            <label class="small">–ù–æ–º–µ—Ä –∞–∫—Ç–∞</label>
            <input id="actnum" type="text" value="–ü–ü–†-001" style="padding:8px 10px;border-radius:10px;border:1px solid #223049;background:#0d1a2e;color:#e5e7eb">
            <label class="small">–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª/–æ–±‚Äô—î–∫—Ç</label>
            <input id="dept" type="text" value="–ï–ª–µ–∫—Ç—Ä–æ–º–∞–π—Å—Ç–µ—Ä–Ω—è / –ö–æ–ª–µ–¥–∂" style="padding:8px 10px;border-radius:10px;border:1px solid #223049;background:#0d1a2e;color:#e5e7eb">
          </div>
          <div class="row" style="margin-top:8px">
            <label class="small">–ö–æ–º—ñ—Å—ñ—è, –≥–æ–ª–æ–≤–∞</label>
            <input id="head" type="text" value="–í–∏–∫–ª–∞–¥–∞—á –ü–Ü–ë" style="padding:8px 10px;border-radius:10px;border:1px solid #223049;background:#0d1a2e;color:#e5e7eb">
            <label class="small">–ß–ª–µ–Ω–∏ –∫–æ–º—ñ—Å—ñ—ó</label>
            <input id="members" type="text" value="–°—Ç—É–¥–µ–Ω—Ç1; –°—Ç—É–¥–µ–Ω—Ç2" style="padding:8px 10px;border-radius:10px;border:1px solid #223049;background:#0d1a2e;color:#e5e7eb">
          </div>
          <div class="row" style="margin-top:8px">
            <button class="btn" type="button" onclick="buildDocs()">üß© –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –ê–∫—Ç —ñ –î–µ—Ñ–µ–∫—Ç–Ω–∏–π –ª–∏—Å—Ç</button>
            <button class="btn" type="button" onclick="window.print()">üñ®Ô∏è –î—Ä—É–∫ / –ó–±–µ—Ä–µ–≥—Ç–∏ —É PDF</button>
          </div>
          <p class="small">–ü–æ—Ä–∞–¥–∞: –ø—ñ—Å–ª—è –¥—Ä—É–∫—É –∑–±–µ—Ä–µ–∂–∏ PDF —ñ –∑–∞–≤–∞–Ω—Ç–∞–∂ —É —Å–ø—ñ–ª—å–Ω—É –ø–∞–ø–∫—É. –ù–∞–∑–≤–∏ —Ñ–∞–π–ª–∏ —Ç–∞–∫: <span class="mono">–ì–†–£–ü–ê_–ü—Ä—ñ–∑–≤–∏—â–µ_–ê–∫—Ç–ü–ü–†.pdf</span> —Ç–∞ <span class="mono">..._–î–µ—Ñ–µ–∫—Ç–Ω–∏–π–õ–∏—Å—Ç.pdf</span> (–∞–±–æ –≤ –æ–¥–Ω–æ–º—É PDF –¥–≤—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏).</p>
        </div>
        <div>
          <table id="preview"><thead></thead><tbody></tbody></table>
        </div>
      </div>
    </div>

    <div class="card printable">
      <h2>üñ®Ô∏è –î—Ä—É–∫–æ–≤–∞–Ω–∞ –∑–æ–Ω–∞ (A4)</h2>
      <div id="printArea">
        <!-- –î–æ–∫—É–º–µ–Ω—Ç–∏ –±—É–¥—É—Ç—å –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—ñ —Ç—É—Ç -->
      </div>
    </div>
  </div>

<script>
  // –í–±—É–¥–æ–≤–∞–Ω–∏–π —Ä–µ–∂–∏–º (Moodle)
  (function(){ if (window.self !== window.top) document.documentElement.classList.add('embedded'); })();

  // ===== CSV —ñ–º–ø–æ—Ä—Ç =====
  const fileInput = document.getElementById('file');
  const csvTA = document.getElementById('csv');
  const previewHead = document.querySelector('#preview thead');
  const previewBody = document.querySelector('#preview tbody');
  let rows = []; // –º–∞—Å–∏–≤ –æ–±'—î–∫—Ç—ñ–≤

  fileInput.addEventListener('change', async (e)=>{
    const f = e.target.files[0]; if(!f) return;
    const txt = await f.text();
    csvTA.value = txt;
  });

  function pasteSample(){
    csvTA.value =
`id,object,place,period_months,responsible,last_date,next_date,status
ELC-001,"–©–û-1 / –ê–≤—Ç–æ–º–∞—Ç B16","–ú–∞–π—Å—Ç–µ—Ä–Ω—è",3,"–°—Ç—É–¥–µ–Ω—Ç 1",2025-10-15,2026-01-15,PASS
ELC-002,"–ü–æ–¥–æ–≤–∂—É–≤–∞—á ‚Ññ2","–õ–∞–±–æ—Ä–∞—Ç–æ—Ä—ñ—è",1,"–°—Ç—É–¥–µ–Ω—Ç 2",2025-10-10,2025-11-10,FAIL
ELC-003,"–ü–ó–í 30–º–ê, –ª—ñ–Ω—ñ—è 3","–õ–∞–±–æ—Ä–∞—Ç–æ—Ä—ñ—è",6,"–°—Ç—É–¥–µ–Ω—Ç 3",2025-10-01,2026-04-01,PASS`;
    parseCSV();
  }

  function parseCSV(){
    const txt = csvTA.value.trim();
    if(!txt){ alert('–í—Å—Ç–∞–≤ CSV –∞–±–æ –æ–±–µ—Ä–∏ —Ñ–∞–π–ª'); return; }
    const lines = txt.split(/\r?\n/);
    const headers = lines[0].split(',').map(h=>h.replace(/^"|"$/g,'').trim());
    const out = [];
    for(let i=1;i<lines.length;i++){
      const line = lines[i];
      if(!line.trim()) continue;
      const cells = splitCSV(line);
      const obj = {};
      headers.forEach((h,idx)=> obj[h] = (cells[idx]||'').replace(/^"|"$/g,''));
      out.push(obj);
    }
    rows = out;
    renderPreview(headers, rows);
  }

  function splitCSV(line){
    const res=[]; let cur=''; let q=false;
    for(let i=0;i<line.length;i++){
      const ch=line[i];
      if(ch==='"' ){ 
        if(q && line[i+1]==='"'){ cur+='"'; i++; }
        else q=!q;
      } else if(ch===',' && !q){ res.push(cur); cur=''; }
      else { cur+=ch; }
    }
    res.push(cur);
    return res;
  }

  function renderPreview(headers, data){
    previewHead.innerHTML='<tr>'+headers.map(h=>`<th>${h}</th>`).join('')+'</tr>';
    previewBody.innerHTML='';
    data.forEach(r=>{
      const tr=document.createElement('tr');
      tr.innerHTML = headers.map(h=>`<td>${escapeHTML(r[h]||'')}</td>`).join('');
      previewBody.appendChild(tr);
    });
  }

  function escapeHTML(s){ return String(s).replace(/[&<>"']/g, m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m])); }

  // ===== –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ =====
  function buildDocs(){
    if(!rows.length){ alert('–°–ø–æ—á–∞—Ç–∫—É —ñ–º–ø–æ—Ä—Ç—É–π CSV'); return; }
    const actnum = document.getElementById('actnum').value.trim() || '–ü–ü–†-XXX';
    const dept = document.getElementById('dept').value.trim() || '–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª';
    const head = document.getElementById('head').value.trim() || '–ì–æ–ª–æ–≤–∞ –∫–æ–º—ñ—Å—ñ—ó';
    const members = document.getElementById('members').value.trim() || '–ß–ª–µ–Ω –∫–æ–º—ñ—Å—ñ—ó';

    const pass = rows.filter(r=> (r.status||'').toUpperCase()==='PASS');
    const fail = rows.filter(r=> (r.status||'').toUpperCase()==='FAIL');
    const due  = rows.filter(r=> (r.status||'').toUpperCase()==='DUE');

    const today = new Date(); const pad=n=>n.toString().padStart(2,'0');
    const dateStr = `${today.getFullYear()}-${pad(today.getMonth()+1)}-${pad(today.getDate())}`;

    const actHTML = `
      <section class="doc" id="act">
        <h2>–ê–ö–¢ –ü–õ–ê–ù–û–í–û-–ü–û–ü–ï–†–ï–î–ñ–£–í–ê–õ–¨–ù–û–ì–û –†–ï–ú–û–ù–¢–£ ‚Ññ <span class="nowrap">${escapeHTML(actnum)}</span></h2>
        <p class="muted">–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª/–æ–±‚Äô—î–∫—Ç: ${escapeHTML(dept)} ¬∑ –î–∞—Ç–∞: ${dateStr}</p>
        <div class="kpi">
          <span class="chip ok">PASS: ${pass.length}</span>
          <span class="chip">DUE: ${due.length}</span>
          <span class="chip bad">FAIL: ${fail.length}</span>
        </div>
        <h3>1. –ü–µ—Ä–µ–ª—ñ–∫ –ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–∏—Ö –æ–±‚Äô—î–∫—Ç—ñ–≤</h3>
        ${buildTable(rows)}
        <h3>2. –í–∏—Å–Ω–æ–≤–æ–∫</h3>
        <p>–ó–∞ –ø—ñ–¥—Å—É–º–∫–∞–º–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–∏—è–≤–ª–µ–Ω–æ: <b>${fail.length}</b> –æ–±‚Äô—î–∫—Ç(–∏/—ñ–≤) –∑—ñ —Å—Ç–∞—Ç—É—Å–æ–º <b>FAIL</b>. –ù–µ–æ–±—Ö—ñ–¥–Ω–æ —É—Å—É–Ω—É—Ç–∏ –∑–∞—É–≤–∞–∂–µ–Ω–Ω—è —ñ –ø—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–∏–π –ü–ü–† –¥–æ <span class="nowrap">${nextMonth(dateStr)}</span>.</p>
        <div class="sign">
          <div>–ì–æ–ª–æ–≤–∞ –∫–æ–º—ñ—Å—ñ—ó: _____________________ / ${escapeHTML(head)}</div>
          <div>–ß–ª–µ–Ω(–∏) –∫–æ–º—ñ—Å—ñ—ó: _____________________ / ${escapeHTML(members)}</div>
        </div>
        <p class="qrtext">Ref: ${escapeHTML(actnum)} ¬∑ –ó–≤—ñ—Ç —Å—Ñ–æ—Ä–º–æ–≤–∞–Ω–æ –∑ CSV –∂—É—Ä–Ω–∞–ª—É –ü–ü–† ¬∑ ${location.href}</p>
      </section>
    `;

    const defectHTML = `
      <section class="doc" id="defects">
        <h2>–î–ï–§–ï–ö–¢–ù–ò–ô –õ–ò–°–¢ –¥–æ –ê–∫—Ç–∞ –ü–ü–† ‚Ññ <span class="nowrap">${escapeHTML(actnum)}</span></h2>
        <p class="muted">–ú—ñ—Å—Ç–∏—Ç—å –ø–æ–∑–∏—Ü—ñ—ó –∑—ñ —Å—Ç–∞—Ç—É—Å–æ–º FAIL. –î–∞—Ç–∞: ${dateStr}</p>
        ${fail.length ? buildTable(fail) : '<p>FAIL-–ø–æ–∑–∏—Ü—ñ–π –Ω–µ –≤–∏—è–≤–ª–µ–Ω–æ.</p>'}
        ${fail.length ? '<p>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó: –ø—Ä–æ–≤–µ—Å—Ç–∏ —É—Å—É–Ω–µ–Ω–Ω—è –¥–µ—Ñ–µ–∫—Ç—ñ–≤ —É –Ω–∞–π–∫–æ—Ä–æ—Ç—à–∏–π —Ç–µ—Ä–º—ñ–Ω, –ø–æ–≤—Ç–æ—Ä–Ω–∏–π –ü–ü–† ‚Äî –ø—ñ—Å–ª—è —É—Å—É–Ω–µ–Ω–Ω—è.</p>' : ''}
        <div class="sign">
          <div>–ö–µ—Ä—ñ–≤–Ω–∏–∫ —Ä–æ–±—ñ—Ç: _____________________</div>
          <div>–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å: ________________________</div>
        </div>
        <p class="qrtext">Ref: ${escapeHTML(actnum)}-DEF ¬∑ ${location.href}</p>
      </section>
    `;

    document.getElementById('printArea').innerHTML = actHTML + defectHTML;
    // –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –¥–æ –¥—Ä—É–∫–æ–≤–∞–Ω–æ–≥–æ –±–ª–æ–∫—É
    document.getElementById('printArea').scrollIntoView({behavior:'smooth', block:'start'});
  }

  function nextMonth(iso){
    const [y,m,d]=iso.split('-').map(Number);
    const dt=new Date(y,m-1,d); dt.setMonth(dt.getMonth()+1);
    const pad=n=>n.toString().padStart(2,'0');
    return `${dt.getFullYear()}-${pad(dt.getMonth()+1)}-${pad(dt.getDate())}`;
  }

  function buildTable(arr){
    const rowsHTML = arr.map((r,i)=>`
      <tr>
        <td>${i+1}</td>
        <td>${escapeHTML(r.id||'')}</td>
        <td>${escapeHTML(r.object||'')}</td>
        <td>${escapeHTML(r.place||'')}</td>
        <td class="nowrap">${escapeHTML(r.last_date||'')}</td>
        <td class="nowrap">${escapeHTML(r.next_date||'')}</td>
        <td>${escapeHTML(r.status||'')}</td>
        <td>${escapeHTML(r.responsible||'')}</td>
      </tr>`).join('');
    return `
      <table>
        <thead>
          <tr>
            <th>‚Ññ</th><th>ID</th><th>–û–±‚Äô—î–∫—Ç</th><th>–ú—ñ—Å—Ü–µ</th><th>–û—Å—Ç–∞–Ω–Ω—è</th><th>–ù–∞—Å—Ç—É–ø–Ω–∞</th><th>–°—Ç–∞—Ç—É—Å</th><th>–í—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∏–π</th>
          </tr>
        </thead>
        <tbody>${rowsHTML}</tbody>
      </table>`;
  }

  // –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –∑ –¥–µ–º–æ, —â–æ–± –±—É–ª–æ —â–æ –¥—Ä—É–∫—É–≤–∞—Ç–∏ –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ
  pasteSample();
</script>


</body></html>