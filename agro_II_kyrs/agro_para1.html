<!-- pair1-thermoprint.html
     –ü–∞—Ä–∞ 1 (–∞—É–¥–∏—Ç–æ—Ä–Ω–æ, 03.10.2025): –í—Å—Ç—É–ø + —Ç–µ—Ä–º–æ–¥—Ä—É–∫ 58 –º–º (—á–µ–∫ –ü–ú–ú / –≤–∏–¥–∞—á–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É)
     –ü–æ–≤–Ω—ñ—Å—Ç—é –∞–≤—Ç–æ–Ω–æ–º–Ω–∏–π —Ñ–∞–π–ª –¥–ª—è —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è –Ω–∞ GitHub Pages —Ç–∞ –≤—Å—Ç–∞–≤–∫–∏ –≤ Moodle —á–µ—Ä–µ–∑ <iframe>.
--><!DOCTYPE html><html lang="uk"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>–ü–∞—Ä–∞ 1 ‚Äî –í—Å—Ç—É–ø + –¢–µ—Ä–º–æ–¥—Ä—É–∫ 58 –º–º</title>
<meta name="color-scheme" content="light dark">
<style>
  /* --------- –ë–ê–ó–û–í–ê –¢–ï–ú–ê (standalone) --------- */
  :root{
    --bg:#0b1220; --card:#0f172a; --muted:#94a3b8; --text:#e2e8f0;
    --accent:#22c55e; --accent-2:#60a5fa; --warn:#f59e0b; --good:#10b981;
    --border:#1f2937;
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:linear-gradient(180deg,#0b1220,#111827 30%,#0b1220);
    color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif; line-height:1.55
  }
  .wrap{max-width:980px; margin:0 auto; padding:24px 16px 64px}
  .badge{display:inline-block; padding:6px 10px; border:1px solid var(--border); background:#0b1220; border-radius:999px; font-size:12px; color:var(--muted); letter-spacing:.3px}
  h1{font-size:34px; margin:6px 0 12px; line-height:1.15;
     background:linear-gradient(90deg,#60a5fa,#22c55e); -webkit-background-clip:text; -webkit-text-fill-color:transparent}
  h2{font-size:22px; margin:28px 0 12px}
  h3{font-size:18px; margin:20px 0 8px; color:#cbd5e1}
  p{margin:10px 0}
  ul,ol{margin:8px 0 12px 22px}
  .card{background:linear-gradient(180deg,#0f172a,#0b1220); border:1px solid var(--border); border-radius:16px; padding:16px; margin:12px 0; box-shadow:0 6px 24px rgba(0,0,0,.25)}
  .grid{display:grid; gap:12px}
  .g3{grid-template-columns:repeat(3,minmax(0,1fr))}
  @media (max-width:820px){.g3{grid-template-columns:1fr}}
  .kpi{display:flex; align-items:center; gap:10px; padding:10px 12px; border:1px dashed #263042; border-radius:12px}
  .mono,code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
  .table{width:100%; border-collapse:separate; border-spacing:0; overflow:hidden; border-radius:12px; border:1px solid #223049}
  .table th,.table td{padding:10px 12px; border-bottom:1px solid #1f2937; font-size:14px; vertical-align:top}
  .table thead th{background:#0c1629; color:#a5b4fc; text-align:left}
  .step{display:flex; gap:12px; align-items:flex-start; padding:10px 12px; border:1px solid #1f2937; border-radius:12px; background:#0b1324; margin:8px 0}
  .step .n{min-width:30px; height:30px; border-radius:8px; background:#0e1a2e; display:grid; place-items:center; color:#a5b4fc; font-weight:700}
  .pill{display:inline-block; padding:4px 10px; border:1px solid #223049; border-radius:999px; font-size:12px; color:#a5b4fc; background:#0d1a2e; margin-right:6px}
  .btn{display:inline-block; padding:10px 14px; border-radius:10px; border:1px solid #223049; background:#0d1a2e; color:#dbeafe; text-decoration:none; cursor:pointer}
  .btn:hover{background:#0f1f39}
  .footer{margin-top:28px; font-size:12px; color:#93a3b5}

  /* --- –ë–ª–æ–∫ ¬´–ö–≤–∏—Ç–∞–Ω—Ü—ñ—è 58 –º–º¬ª --- */
  .ticket-wrap{display:flex; gap:16px; flex-wrap:wrap}
  .ticket-panel{flex:1 1 360px}
  .ticket{
    width:58mm; background:#fff; color:#000; padding:6mm 4mm; border-radius:6px;
    box-shadow:0 0 0 1px #e5e7eb inset; font-family:"Courier New",ui-monospace,monospace;
  }
  .ticket h4{margin:0 0 6px; font-size:13px; text-align:center}
  .ticket p{margin:2px 0; font-size:12px}
  .ticket .center{text-align:center}
  .ticket .line{border-top:1px dashed #111; margin:6px 0}
  .ticket .qr{font-size:11px; word-break:break-all}
  .ticket small{font-size:10px}

  .field{display:flex; gap:8px; margin:6px 0}
  .field label{min-width:120px; color:#cbd5e1}
  .field input, .field select{
    flex:1; padding:8px 10px; border-radius:10px; border:1px solid #223049; background:#0d1a2e; color:#e5e7eb
  }
  .row-actions{display:flex; gap:10px; flex-wrap:wrap; margin-top:8px}
  .no-print{display:block}

  /* --------- –í–ï–†–°–Ü–Ø –î–õ–Ø –í–ë–£–î–û–í–£–í–ê–ù–ù–Ø (iframe/Moodle) --------- */
  html.embedded body{
    background:#fff; color:#111; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif
  }
  html.embedded .wrap{max-width:100%; padding:16px 0 24px}
  html.embedded .badge{display:none}
  html.embedded h1{
    -webkit-text-fill-color:initial; background:none; color:#111; font-weight:800;
    font-size:28px; margin:4px 12px 8px
  }
  html.embedded .card{
    background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:14px; margin:10px 12px; box-shadow:none
  }
  html.embedded h2{font-size:20px; margin:4px 0 8px}
  html.embedded h3{font-size:16px; margin:8px 0 6px; color:#111}
  html.embedded .step{background:#fafafa; border:1px solid #e5e7eb}
  html.embedded .field label{color:#374151}
  html.embedded .field input, html.embedded .field select{
    background:#fff; color:#111; border:1px solid #d1d5db
  }
  html.embedded .btn{background:#111827; color:#fff; border-color:#111827}
  html.embedded .btn:hover{background:#0b1220}
  html.embedded .footer{color:#6b7280; margin:4px 12px}

  @media print{
    @page{ size:58mm auto; margin:4mm }
    body{ background:#fff; color:#000 }
    .no-print, .card:not(.printable){ display:none !important }
    .ticket{ box-shadow:none; width:auto; padding:0 }
  }
</style>
<noscript><meta http-equiv="refresh" content="0; url=?noscript=1"></noscript>

<style>
/* PRINT PATCH v1 CSS (auto) */
.ticket{ font-weight:700; letter-spacing:0.1px }
.ticket h4{ font-weight:700 }
.ticket p,
.ticket b,
.ticket strong,
.ticket span,
.ticket small{ font-weight:700 }
</style>

<meta name="description" content="–®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç: –≤–≤–æ–¥–∏–º–æ –ø—Ä–æ—Å—Ç—ñ –¥–∞–Ω—ñ (–∞–≥—Ä–µ–≥–∞—Ç, –æ–ø–µ—Ä–∞—Ç–æ—Ä, –ü–ú–ú/—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç) ‚Üí –≥–µ–Ω–µ—Ä—É—î–º–æ –∫–≤–∏—Ç–∞–Ω—Ü—ñ—é 58 –º–º ‚Üí –¥—Ä—É–∫—É—î–º–æ. –ú—ñ–Ω—ñ–º—É–º —Å–ª—ñ–≤ ‚Äî –º–∞–∫—Å–∏–º—É–º –¥—ñ—ó."><link rel="canonical" href="https://edlab.pp.ua/agro_II_kyrs/agro_para1.html"><meta property="og:type" content="article"><meta property="og:title" content="üåæ –í—Å—Ç—É–ø –¥–æ –∫—É—Ä—Å—É + üßæ —Ç–µ—Ä–º–æ–¥—Ä—É–∫ 58 –º–º: —á–µ–∫ –ü–ú–ú / –≤–∏–¥–∞—á–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É"><meta property="og:description" content="–®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç: –≤–≤–æ–¥–∏–º–æ –ø—Ä–æ—Å—Ç—ñ –¥–∞–Ω—ñ (–∞–≥—Ä–µ–≥–∞—Ç, –æ–ø–µ—Ä–∞—Ç–æ—Ä, –ü–ú–ú/—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç) ‚Üí –≥–µ–Ω–µ—Ä—É—î–º–æ –∫–≤–∏—Ç–∞–Ω—Ü—ñ—é 58 –º–º ‚Üí –¥—Ä—É–∫—É—î–º–æ. –ú—ñ–Ω—ñ–º—É–º —Å–ª—ñ–≤ ‚Äî –º–∞–∫—Å–∏–º—É–º –¥—ñ—ó."><meta property="og:url" content="https://edlab.pp.ua/agro_II_kyrs/agro_para1.html"><script type="application/ld+json">{"@context":"https://schema.org","@type":"LearningResource","name":"üåæ –í—Å—Ç—É–ø –¥–æ –∫—É—Ä—Å—É + üßæ —Ç–µ—Ä–º–æ–¥—Ä—É–∫ 58 –º–º: —á–µ–∫ –ü–ú–ú / –≤–∏–¥–∞—á–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É","description":"–®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç: –≤–≤–æ–¥–∏–º–æ –ø—Ä–æ—Å—Ç—ñ –¥–∞–Ω—ñ (–∞–≥—Ä–µ–≥–∞—Ç, –æ–ø–µ—Ä–∞—Ç–æ—Ä, –ü–ú–ú/—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç) ‚Üí –≥–µ–Ω–µ—Ä—É—î–º–æ –∫–≤–∏—Ç–∞–Ω—Ü—ñ—é 58 –º–º ‚Üí –¥—Ä—É–∫—É—î–º–æ. –ú—ñ–Ω—ñ–º—É–º —Å–ª—ñ–≤ ‚Äî –º–∞–∫—Å–∏–º—É–º –¥—ñ—ó.","inLanguage":"uk","educationalLevel":"college","url":"https://edlab.pp.ua/agro_II_kyrs/agro_para1.html","provider":{"@type":"Organization","name":"EDLab"}}</script></head>
<body>
  <div class="wrap">
    <span class="badge">–ü–∞—Ä–∞ 1 ¬∑ –õ–ü–ó ¬∑ –∞–≥—Ä–æ–Ω–æ–º–∏ ¬∑ 03.10.2025</span>
    <h1>üåæ –í—Å—Ç—É–ø –¥–æ –∫—É—Ä—Å—É + üßæ —Ç–µ—Ä–º–æ–¥—Ä—É–∫ 58 –º–º: —á–µ–∫ –ü–ú–ú / –≤–∏–¥–∞—á–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É</h1>

    <div class="card">
      <h2>üéØ –ú–µ—Ç–∞</h2>
      <p>–®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç: –≤–≤–æ–¥–∏–º–æ –ø—Ä–æ—Å—Ç—ñ –¥–∞–Ω—ñ (–∞–≥—Ä–µ–≥–∞—Ç, –æ–ø–µ—Ä–∞—Ç–æ—Ä, –ü–ú–ú/—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç) ‚Üí –≥–µ–Ω–µ—Ä—É—î–º–æ <b>–∫–≤–∏—Ç–∞–Ω—Ü—ñ—é 58 –º–º</b> ‚Üí –¥—Ä—É–∫—É—î–º–æ. –ú—ñ–Ω—ñ–º—É–º —Å–ª—ñ–≤ ‚Äî –º–∞–∫—Å–∏–º—É–º –¥—ñ—ó.</p>
      <div class="grid g3">
        <div class="kpi"><span>üßë‚Äçüåæ</span><div><b>–§–æ–∫—É—Å</b><br>–ø—Ä–æ—Å—Ç–æ—Ç–∞, –∑—Ä–æ–∑—É–º—ñ–ª—ñ –∫—Ä–æ–∫–∏</div></div>
        <div class="kpi"><span>üñ®Ô∏è</span><div><b>–ü—Ä–∏–ª–∞–¥</b><br>—Ç–µ—Ä–º–æ–ø—Ä–∏–Ω—Ç–µ—Ä 58 –º–º (ESC/POS –∞–±–æ —Å–∏—Å—Ç–µ–º–Ω–∏–π –¥—Ä—É–∫)</div></div>
        <div class="kpi"><span>üìÑ</span><div><b>–ê—Ä—Ç–µ—Ñ–∞–∫—Ç–∏</b><br>—á–µ–∫ ¬´–ü–ú–ú¬ª, —á–µ–∫ ¬´–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç¬ª</div></div>
      </div>
    </div>

    <div class="card printable">
      <h2>üß™ –ü—Ä–∞–∫—Ç–∏–∫—É–º: —Å—Ñ–æ—Ä–º—É–π —á–µ–∫ —ñ –Ω–∞–¥—Ä—É–∫—É–π</h2>

      <div class="ticket-wrap">
        <!-- –ü–∞–Ω–µ–ª—å –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è -->
        <div class="ticket-panel">
          <h3>1) –í–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö</h3>

          <div class="field">
            <label for="type">–¢–∏–ø —á–µ–∫–∞</label>
            <select id="type">
              <option value="fuel">–ü–ú–ú ‚Äî –≤–∏–¥–∞—á–∞ –ø–∞–ª—å–Ω–æ–≥–æ</option>
              <option value="tool">–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç ‚Äî –≤–∏–¥–∞—á–∞/–ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è</option>
            </select>
          </div>

          <div class="field">
            <label for="machine">–ê–≥—Ä–µ–≥–∞—Ç</label>
            <input id="machine" type="text" value="–ú–¢–ó-82">
          </div>

          <div class="field">
            <label for="operator">–û–ø–µ—Ä–∞—Ç–æ—Ä</label>
            <input id="operator" type="text" value="–Ü–≤–∞–Ω">
          </div>

          <div class="field" data-for="fuel">
            <label for="fuel">–ü–ú–ú, –ª</label>
            <input id="fuel" type="number" step="0.1" value="12">
          </div>

          <div class="field" data-for="tool" style="display:none">
            <label for="toolname">–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç</label>
            <input id="toolname" type="text" value="–ö–ª—é—á-27">
          </div>

          <div class="field" data-for="tool" style="display:none">
            <label for="action">–î—ñ—è</label>
            <select id="action">
              <option value="–í–ò–î–ê–ß–ê">–í–ò–î–ê–ß–ê</option>
              <option value="–ü–û–í–ï–†–ù–ï–ù–ù–Ø">–ü–û–í–ï–†–ù–ï–ù–ù–Ø</option>
            </select>
          </div>

          <div class="row-actions no-print">
            <button class="btn" type="button" id="buildBtn">üß© –ó—ñ–±—Ä–∞—Ç–∏ —á–µ–∫</button>
            <button class="btn" type="button" id="printBtn">üñ®Ô∏è –î—Ä—É–∫—É–≤–∞—Ç–∏ 58 –º–º</button>
            <button class="btn" type="button" id="saveBtn">üì• –ó–±–µ—Ä–µ–≥—Ç–∏ —è–∫ TXT</button>
          </div>

          <p style="margin-top:10px; color:#a3b2c4" class="no-print">
            –ü–æ—Ä–∞–¥–∞: —è–∫—â–æ –æ–±—Ä—ñ–∑–∞—î ‚Äî —É –¥—ñ–∞–ª–æ–∑—ñ –¥—Ä—É–∫—É –∑–º–µ–Ω—à –ø–æ–ª—è/–º–∞—Å—à—Ç–∞–± –¥–æ 90‚Äì95%.
          </p>
        </div>

        <!-- –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥ 58 –º–º -->
        <div class="ticket-panel">
          <h3>2) –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥ (—Ç–µ, —â–æ –ø—ñ–¥–µ –Ω–∞ —Å—Ç—Ä—ñ—á–∫—É)</h3>
          <div id="ticket" class="ticket" aria-live="polite">
            <h4>–ê–ì–†–û–°–ï–†–í–Ü–° ¬∑ –ö–í–ò–¢–ê–ù–¶–Ü–Ø</h4>
            <p class="center"><small id="t-date">–î–∞—Ç–∞: ‚Äî</small></p>
            <div class="line"></div>
            <p><b id="t-title">–ü–ú–ú ‚Äî –≤–∏–¥–∞—á–∞ –ø–∞–ª—å–Ω–æ–≥–æ</b></p>
            <p>–ê–≥—Ä–µ–≥–∞—Ç: <span id="t-machine">‚Äî</span></p>
            <p>–û–ø–µ—Ä–∞—Ç–æ—Ä: <span id="t-operator">‚Äî</span></p>
            <p id="t-fuel">–ü–ú–ú: ‚Äî –ª</p>
            <p id="t-tool" style="display:none">–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: ‚Äî</p>
            <p id="t-action" style="display:none">–î—ñ—è: ‚Äî</p>
            <div class="line"></div>
            <p class="qr"><small id="t-ref">Ref: LOCAL-0001</small></p>
            <p class="center"><small>–ü—ñ–¥–ø–∏—Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞: __________</small></p>
            <div class="line"></div>
            <p class="center"><small>–î—è–∫—É—î–º–æ! –ë–µ—Ä–µ–∂—ñ—Ç—å —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —ñ –ø–∞–ª—å–Ω–µ üå±</small></p>
          </div>
          <div class="row-actions no-print" style="margin-top:10px">
            <button class="btn" type="button" id="refreshBtn">üîÑ –û–Ω–æ–≤–∏—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥</button>
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <h2>ü™ú –•—ñ–¥ —Ä–æ–±–æ—Ç–∏ (—à–≤–∏–¥–∫–æ —ñ –ø—Ä–æ—Å—Ç–æ)</h2>
      <div class="step"><div class="n">1</div><div><b>–ü–æ—è—Å–Ω–µ–Ω–Ω—è</b> (—â–æ —Ç–∞–∫–µ —á–µ–∫ —ñ –Ω–∞–≤—ñ—â–æ —É –ø–æ–ª—ñ).</div></div>
      <div class="step"><div class="n">2</div><div><b>–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –ø—Ä–∏–Ω—Ç–µ—Ä–∞</b> (—Å–∏—Å—Ç–µ–º–∞ –º–∞—î –π–æ–≥–æ –±–∞—á–∏—Ç–∏; —Ç–µ—Å—Ç-–¥—Ä—É–∫ 1 —Ä—è–¥–∫–∞).</div></div>
      <div class="step"><div class="n">3</div><div><b>–ó–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –ø–æ–ª—ñ–≤</b> (—Ç–∏–ø, –∞–≥—Ä–µ–≥–∞—Ç, –æ–ø–µ—Ä–∞—Ç–æ—Ä, –ü–ú–ú/—ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç).</div></div>
      <div class="step"><div class="n">4</div><div><b>–ó–±—ñ—Ä —á–µ–∫–∞</b> (üß©), –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞, <b>–¥—Ä—É–∫</b> (üñ®Ô∏è) –∞–±–æ <b>TXT-–µ–∫—Å–ø–æ—Ä—Ç</b> (üì•).</div></div>
    </div>

    <div class="card">
      <h2>‚úÖ –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è (10 –±–∞–ª—ñ–≤)</h2>
      <table class="table">
        <thead><tr><th>–ö—Ä–∏—Ç–µ—Ä—ñ–π</th><th>–ë–∞–ª–∏</th></tr></thead>
        <tbody>
          <tr><td>–ó–∞–ø–æ–≤–Ω–µ–Ω—ñ –ø–æ–ª—è (–∞–≥—Ä–µ–≥–∞—Ç, –æ–ø–µ—Ä–∞—Ç–æ—Ä, –ü–ú–ú –∞–±–æ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç)</td><td>3</td></tr>
          <tr><td>–ö–æ—Ä–µ–∫—Ç–Ω–∏–π –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥ (–¥–∞—Ç–∞, Ref)</td><td>2</td></tr>
          <tr><td>–î—Ä—É–∫ —á–µ–∫–∞ 58 –º–º (—á–∏—Ç–∞–±–µ–ª—å–Ω–æ)</td><td>3</td></tr>
          <tr><td>–§–æ—Ç–æ —á–µ–∫–∞ —É —Å–ø—ñ–ª—å–Ω—ñ–π –ø–∞–ø—Ü—ñ –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—é –Ω–∞–∑–≤–æ—é</td><td>2</td></tr>
        </tbody>
      </table>
    </div>

    <div class="footer">
      <span class="pill">üßæ –ß–µ–∫ –ü–ú–ú</span>
      <span class="pill">üß∞ –ß–µ–∫ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—É</span>
      <span class="pill">üî∞ –í—Å—Ç—É–ø</span>
    </div>
  </div>

<script>
  // –í–±—É–¥–æ–≤–∞–Ω–∏–π —Ä–µ–∂–∏–º (iframe): —Å–ø—Ä–æ—â–µ–Ω–∏–π –≤–∏–≥–ª—è–¥ ¬´–ø—ñ–¥ Moodle¬ª
  (function(){
    if (window.self !== window.top) {
      document.documentElement.classList.add('embedded');
    }
  })();

  // –ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –ø–æ–ª—ñ–≤
  const typeEl = document.getElementById('type');
  const fuelBlock = document.querySelector('[data-for="fuel"]');
  const toolBlocks = document.querySelectorAll('[data-for="tool"]');
  function toggleFields(){
    const t = typeEl.value;
    if(t === 'fuel'){
      fuelBlock.style.display = '';
      toolBlocks.forEach(el=>el.style.display='none');
    }else{
      fuelBlock.style.display = 'none';
      toolBlocks.forEach(el=>el.style.display='');
    }
  }
  typeEl.addEventListener('change', toggleFields);
  toggleFields();

  // –ü–æ–±—É–¥–æ–≤–∞ –∫–≤–∏—Ç–∞–Ω—Ü—ñ—ó
  function buildTicket(){
    const t = typeEl.value;
    const machine = document.getElementById('machine').value.trim() || '‚Äî';
    const operator = document.getElementById('operator').value.trim() || '‚Äî';
    const fuel = document.getElementById('fuel').value;
    const toolname = document.getElementById('toolname').value.trim() || '‚Äî';
    const action = document.getElementById('action').value;

    const now = new Date();
    const pad = n => n.toString().padStart(2,'0');
    const stamp = `${now.getFullYear()}-${pad(now.getMonth()+1)}-${pad(now.getDate())} ${pad(now.getHours())}:${pad(now.getMinutes())}`;
    document.getElementById('t-date').textContent = `–î–∞—Ç–∞: ${stamp}`;

    document.getElementById('t-machine').textContent = machine;
    document.getElementById('t-operator').textContent = operator;

    const title = (t==='fuel') ? '–ü–ú–ú ‚Äî –≤–∏–¥–∞—á–∞ –ø–∞–ª—å–Ω–æ–≥–æ' : '–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç ‚Äî –≤–∏–¥–∞—á–∞/–ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è';
    document.getElementById('t-title').textContent = title;

    const fuelLine = document.getElementById('t-fuel');
    const toolLine = document.getElementById('t-tool');
    const actionLine = document.getElementById('t-action');

    if(t==='fuel'){
      fuelLine.style.display = '';
      fuelLine.textContent = `–ü–ú–ú: ${fuel ? fuel : '‚Äî'} –ª`;
      toolLine.style.display = 'none';
      actionLine.style.display = 'none';
    }else{
      fuelLine.style.display = 'none';
      toolLine.style.display = '';
      toolLine.textContent = `–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: ${toolname}`;
      actionLine.style.display = '';
      actionLine.textContent = `–î—ñ—è: ${action}`;
    }

    const ref = 'LOCAL-' + Math.random().toString(36).slice(2,8).toUpperCase();
    document.getElementById('t-ref').textContent = `Ref: ${ref}`;
  }

  // TXT-–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
  function downloadTXT(){
    const tTitle = document.getElementById('t-title').textContent;
    const tDate  = document.getElementById('t-date').textContent;
    const tMachine = document.getElementById('t-machine').textContent;
    const tOperator= document.getElementById('t-operator').textContent;
    const tFuel = document.getElementById('t-fuel').style.display==='none' ? '' : document.getElementById('t-fuel').textContent;
    const tTool = document.getElementById('t-tool').style.display==='none' ? '' : document.getElementById('t-tool').textContent;
    const tAction = document.getElementById('t-action').style.display==='none' ? '' : document.getElementById('t-action').textContent;
    const tRef  = document.getElementById('t-ref').textContent;

    const lines = [
      'AGROSERVICE RECEIPT',
      '--------------------',
      tTitle,
      tDate,
      `–ê–≥—Ä–µ–≥–∞—Ç: ${tMachine}`,
      `–û–ø–µ—Ä–∞—Ç–æ—Ä: ${tOperator}`,
      tFuel, tTool, tAction,
      '--------------------',
      tRef,
      '–ü—ñ–¥–ø–∏—Å: ____________',
      '–î—è–∫—É—î–º–æ! –ë–µ—Ä–µ–∂—ñ—Ç—å —Ä–µ—Å—É—Ä—Å.'
    ].filter(Boolean);

    const blob = new Blob([lines.join('\n')], {type:'text/plain;charset=utf-8'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'check_58mm.txt';
    a.click();
    URL.revokeObjectURL(a.href);
  }

  // –ö–Ω–æ–ø–∫–∏
  document.getElementById('buildBtn').addEventListener('click', buildTicket);
  document.getElementById('refreshBtn').addEventListener('click', buildTicket);
  document.getElementById('printBtn').addEventListener('click', ()=>printTicketNewTab());
  document.getElementById('saveBtn').addEventListener('click', downloadTXT);

  // –ü–æ—á–∞—Ç–∫–æ–≤–∏–π –∑—Ä–∞–∑–æ–∫
  buildTicket();
</script>

<script>
// PRINT PATCH v1 (auto)
function printTicketNewTab(){
  var ticket = document.getElementById('ticket');
  if(!ticket){ alert('–ù–µ–º–∞—î #ticket –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ'); return; }
  try{
    var someTxt = (document.querySelector('#ticket span, #ticket p, #ticket h4')||{}).textContent||'';
    if(!someTxt || someTxt.trim()==='‚Äî'){ if(typeof buildTicket==='function') buildTicket(); }
  }catch(_){}

  var css = `
    @media print { @page { size:58mm auto; margin:0 } }
    html,body{ margin:0; padding:0; background:#fff; color:#000 }
    .ticket{
      width:58mm; margin:0; padding:6mm 4mm; background:#fff; color:#000;
      font-family:"Courier New", Courier, monospace; font-weight:700; letter-spacing:0.1px;
      border:none; box-shadow:none; border-radius:0
    }
    .ticket h4{ margin:0 0 6px; font-size:13px; text-align:center; font-weight:700 }
    .ticket p{ margin:2px 0; font-size:12px; font-weight:700 }
    .ticket b,.ticket strong,.ticket span{ font-weight:700 }
    .line{ border-top:1px dashed #111; margin:6px 0 }
    small{ font-size:10px; font-weight:700 }
  `;
  var html = `<!DOCTYPE html><html><head><meta charset="utf-8"><title>–ß–µ–∫ 58 –º–º</title><style>${css}</style></head><body>${ticket.outerHTML}
  <script>
    window.addEventListener('load',()=>{
      try{ window.focus(); window.print(); if(window.opener) window.opener.postMessage({type:'ticketPrint',status:'invoked'},'*'); }
      catch(e){ if(window.opener) window.opener.postMessage({type:'ticketPrint',status:'error'},'*'); }
    });
  <\/script>
  </body></html>`;

  var w = window.open('', '_blank');
  if(!w){ openTicketOnly(); return; }  // –ø–æ–ø–∞–ø –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ ‚Äî —Ñ–æ–ª–±–µ–∫
  w.document.open(); w.document.write(html); w.document.close();

  var timer = setTimeout(()=>{ openTicketOnly(); }, 1200);
  window.addEventListener('message', (ev)=>{
    if(ev && ev.data && ev.data.type==='ticketPrint'){ clearTimeout(timer); }
  }, {once:true});
}

function openTicketOnly(){
  var ticket = document.getElementById('ticket');
  if(!ticket){ alert('–ù–µ–º–∞—î #ticket –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ'); return; }
  try{
    var someTxt = (document.querySelector('#ticket span, #ticket p, #ticket h4')||{}).textContent||'';
    if(!someTxt || someTxt.trim()==='‚Äî'){ if(typeof buildTicket==='function') buildTicket(); }
  }catch(_){}

  var css = `
    @media print { @page { size:58mm auto; margin:0 } }
    html,body{ margin:0; background:#fff; color:#000 }
    .ticket{
      width:58mm; margin:0; padding:6mm 4mm; background:#fff; color:#000;
      font-family:"Courier New", Courier, monospace; font-weight:700; letter-spacing:0.1px;
      border:none; box-shadow:none; border-radius:0
    }
    .ticket h4{ margin:0 0 6px; font-size:13px; text-align:center; font-weight:700 }
    .ticket p{ margin:2px 0; font-size:12px; font-weight:700 }
    .line{ border-top:1px dashed #111; margin:6px 0 }
    small{ font-size:10px; font-weight:700 }
  `;
  var html = `<!DOCTYPE html><html><head><meta charset="utf-8"><title>–ß–µ–∫ 58 –º–º</title><style>${css}</style></head><body>${ticket.outerHTML}
<script>window.addEventListener('load',()=>{ try{ window.focus(); window.print(); }catch(e){} });<\/script>
</body></html>`;

  var blob = new Blob([html], {type:'text/html'});
  var url = URL.createObjectURL(blob);
  window.open(url, '_blank');
  setTimeout(()=>URL.revokeObjectURL(url), 60000);
}
</script>



</body></html>