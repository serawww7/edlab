<!-- agro_para11.html
     –ü–ê–†–ê 11 (–∞—É–¥–∏—Ç–æ—Ä–Ω–æ) –¥–ª—è –∞–≥—Ä–æ–Ω–æ–º—ñ–≤
     –¢–µ–º–∞: –í–û–õ–û–ì–Ü–°–¢–¨ –ó–ï–†–ù–ê, –£–°–£–®–ö–ê/–£–ú–û–õ–û–¢, –°–û–ë–Ü–í–ê–†–¢–Ü–°–¢–¨ –°–£–®–Ü–ù–ù–Ø –¢–ê –°–£–ú–Ü–®–Ü–í–ê–ù–ù–Ø –ü–ê–†–¢–Ü–ô
     –§–æ–∫—É—Å: —Ç–µ–ª–µ—Ñ–æ–Ω–∏/–ü–ö; –±–µ–∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫; –∫–æ–Ω—Ç—Ä–∞—Å—Ç —Ç–µ–º–Ω–∏—Ö –∫–ª—ñ—Ç–∏–Ω–æ–∫ ‚Üí —Å–≤—ñ—Ç–ª–∏–π —Ç–µ–∫—Å—Ç.
     –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ç–∞–±–ª–∏—Ü—è –ø–∞—Ä—Ç—ñ–π (—Ç, %–≤–æ–ª–æ–≥.), –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —É—Å—É—à–∫–∏, –µ–Ω–µ—Ä–≥–æ–≤–∏—Ç—Ä–∞—Ç —ñ –≤–∞—Ä—Ç–æ—Å—Ç—ñ, –ø—ñ–¥–∫–∞–∑–∫–∏ ¬´—Å—É—à–∏—Ç–∏/—Å–∫–ª–∞–¥¬ª, –ø—ñ–¥–±—ñ—Ä –∑–º—ñ—à—É–≤–∞–Ω–Ω—è –¥–æ —Ü—ñ–ª—å–æ–≤–æ—ó –≤–æ–ª–æ–≥–æ—Å—Ç—ñ, CSV.
     –î–æ–¥–∞—Ç–∫–æ–≤–æ: –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ–∫—Å—Ç—É –¥–ª—è NFC-–º—ñ—Ç–æ–∫ —Å–∏–ª–æ—Å–∞/–ø–∞—Ä—Ç—ñ—ó —Ç–∞ —á–µ–∫ 58 –º–º –¥–ª—è –≤–∞–≥–∞—Ä—è (–∑–∞ –±–∞–∂–∞–Ω–Ω—è–º).

     –ì–æ—Ç–æ–≤–æ –¥–ª—è GitHub Pages / iFrame —É Moodle.
-->
<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>–ü–∞—Ä–∞ 11 ‚Äî –í–æ–ª–æ–≥—ñ—Å—Ç—å –∑–µ—Ä–Ω–∞: —É—Å—É—à–∫–∞, —Å—É—à—ñ–Ω–Ω—è, —Å—É–º—ñ—à—É–≤–∞–Ω–Ω—è, –≤–∞—Ä—Ç—ñ—Å—Ç—å</title>
<meta name="color-scheme" content="light dark">
<style>
  :root{
    --bg:#0b1220; --card:#0f172a; --muted:#94a3b8; --text:#e2e8f0;
    --accent:#22c55e; --accent-2:#60a5fa; --warn:#f59e0b; --bad:#ef4444; --good:#10b981; --line:#1f2937;
    --darkcell:#0b1324; --darkink:#e6eef9; --darkink2:#e5e7eb;
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:linear-gradient(180deg,#0b1220,#111827 30%,#0b1220);
    color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif; line-height:1.55
  }
  .wrap{max-width:1100px; margin:0 auto; padding:24px 16px 64px}
  .badge{display:inline-block; padding:6px 10px; border:1px solid var(--line); background:#0b1220; border-radius:999px; font-size:12px; color:var(--muted); letter-spacing:.3px}
  h1{font-size:34px; margin:6px 0 12px; line-height:1.15;
     background:linear-gradient(90deg,#60a5fa,#22c55e); -webkit-background-clip:text; -webkit-text-fill-color:transparent}
  h2{font-size:22px; margin:28px 0 12px}
  h3{font-size:18px; margin:20px 0 8px; color:#cbd5e1}
  p{margin:10px 0}
  .small{font-size:12px; color:#9fb0c8}
  .muted{color:#93a3b5}
  .pill{display:inline-block; padding:4px 10px; border:1px solid #223049; border-radius:999px; font-size:12px; color:#a5b4fc; background:#0d1a2e; margin-right:6px}
  .btn{display:inline-block; padding:10px 14px; border-radius:10px; border:1px solid #223049; background:#0d1a2e; color:#dbeafe; text-decoration:none; cursor:pointer}
  .btn:hover{background:#0f1f39}
  .row{display:flex; gap:10px; flex-wrap:wrap}
  .grid{display:grid; gap:12px}
  .g2{grid-template-columns:repeat(2,minmax(0,1fr))}
  .g3{grid-template-columns:repeat(3,minmax(0,1fr))}
  @media (max-width:1000px){.g2,.g3{grid-template-columns:1fr}}

  .card{background:linear-gradient(180deg,#0f172a,#0b1220); border:1px solid var(--line); border-radius:16px; padding:16px; margin:12px 0; box-shadow:0 6px 24px rgba(0,0,0,.25)}
  .box{border:1px solid #223049; border-radius:12px; padding:12px; background:var(--darkcell); color:var(--darkink)}
  .ok{color:var(--good)} .warn{color:var(--warn)} .bad{color:var(--bad)}
  .mono,code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}

  .table{width:100%; border-collapse:separate; border-spacing:0; overflow:auto; border-radius:12px; border:1px solid #223049}
  .table th,.table td{padding:8px 10px; border-bottom:1px solid #1f2937; font-size:14px; vertical-align:top}
  .table thead th{background:#0c1629; color:#a5b4fc; text-align:left; position:sticky; top:0}
  .table tbody tr:nth-child(even){background:var(--darkcell); color:var(--darkink2)}
  .table td.dark, .table th.dark{background:var(--darkcell) !important; color:var(--darkink2) !important}
  .table td .tag{display:inline-block; padding:3px 8px; border-radius:999px; border:1px solid #223049; background:#0d1a2e; color:#dbeafe; font-size:12px}

  input[type="text"], input[type="number"], input[type="date"], select, textarea{
    width:100%; padding:8px 10px; border-radius:10px; border:1px solid #223049; background:#0d1a2e; color:#e6eef9
  }
  .out{background:var(--darkcell); color:var(--darkink2); border:1px dashed #263042; padding:10px 12px; border-radius:10px; word-break:break-all}

  /* –ß–µ–∫ 58 –º–º */
  .ticket{ width:58mm; background:#fff; color:#000; padding:6mm 4mm; border-radius:6px; box-shadow:0 0 0 1px #e5e7eb inset; font-family:"Courier New",ui-monospace,monospace}
  .ticket h4{margin:0 0 6px; font-size:13px; text-align:center}
  .ticket p{margin:2px 0; font-size:12px}
  .ticket .line{border-top:1px dashed #111; margin:6px 0}
  .ticket small{font-size:10px}

  /* –í–±—É–¥–æ–≤–∞–Ω–æ (iframe) ‚Üí —Å–≤—ñ—Ç–ª–∏–π –≤–∏–≥–ª—è–¥ */
  html.embedded body{background:#fff; color:#111}
  html.embedded .card{background:#fff; border:1px solid #e5e7eb; box-shadow:none}
  html.embedded h1{-webkit-text-fill-color:initial; background:none; color:#111}
  html.embedded .btn{background:#111827; color:#fff; border-color:#111827}
  html.embedded .box{background:#f8fafc; color:#111}
  html.embedded .table tbody tr:nth-child(even){background:#f3f4f6; color:#111}

  @media print{
    @page{ margin:4mm }
    .no-print{ display:none !important }
  }
</style>

<style>
/* PRINT PATCH v1 CSS (auto) */
.ticket{ font-weight:700; letter-spacing:0.1px }
.ticket h4{ font-weight:700 }
.ticket p,
.ticket b,
.ticket strong,
.ticket span,
.ticket small{ font-weight:700 }
</style>

</head>
<body>
  <div class="wrap">
    <span class="badge">–ü–∞—Ä–∞ 11 ¬∑ –∞—É–¥–∏—Ç–æ—Ä–Ω–æ ¬∑ –∞–≥—Ä–æ–Ω–æ–º–∏</span>
    <h1>üåæ –í–æ–ª–æ–≥—ñ—Å—Ç—å –∑–µ—Ä–Ω–∞: —É—Å—É—à–∫–∞, —Å—É—à—ñ–Ω–Ω—è, –ø—ñ–¥–±—ñ—Ä —Å—É–º—ñ—à—É–≤–∞–Ω–Ω—è —Ç–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å</h1>

    <div class="card">
      <h2>üéØ –ú–µ—Ç–∞</h2>
      <p>
        –ó–∞ –ø–∞—Ä—É —Å—Ç—É–¥–µ–Ω—Ç–∏ –≤–µ–¥—É—Ç—å <b>–∂—É—Ä–Ω–∞–ª –ø–∞—Ä—Ç—ñ–π –∑–µ—Ä–Ω–∞</b> (–≤–∞–≥–∞, –≤–æ–ª–æ–≥—ñ—Å—Ç—å), –æ–±—á–∏—Å–ª—é—é—Ç—å <b>—É—Å—É—à–∫—É</b>, <b>–≤–∏—Ç—Ä–∞—Ç–∏ –Ω–∞ —Å—É—à—ñ–Ω–Ω—è</b> —Ç–∞
        —Ñ–æ—Ä–º—É—é—Ç—å <b>—Ä—ñ—à–µ–Ω–Ω—è</b>: ¬´—Å–∫–ª–∞–¥ (–±–µ–∑ —Å—É—à—ñ–Ω–Ω—è)¬ª –∞–±–æ ¬´–Ω–∞ —Å—É—à–∞—Ä–∫—É¬ª. –î–æ–¥–∞—Ç–∫–æ–≤–æ ‚Äî <b>–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å—É–º—ñ—à—É–≤–∞–Ω–Ω—è</b> –¥–≤–æ—Ö –ø–∞—Ä—Ç—ñ–π –¥–æ —Ü—ñ–ª—ñ
        —Ç–∞ <b>—á–µ–∫ 58 –º–º</b> –¥–ª—è –≤–∞–≥–∞—Ä—è/–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞.
      </p>
      <p class="small">–§–æ—Ä–º—É–ª–∏: <span class="mono">M—Å—É—Ö–∞ = M–≤–æ–ª–æ–≥–∞ √ó (100 ‚àí W‚ÇÄ)/(100 ‚àí W—Ü)</span>; <span class="mono">–£—Å—É—à–∫–∞ = M–≤–æ–ª–æ–≥–∞ ‚àí M—Å—É—Ö–∞</span>.
        –í–∞—Ä—Ç—ñ—Å—Ç—å —Å—É—à—ñ–Ω–Ω—è (–Ω–∞–≤—á–∞–ª—å–Ω–æ): <span class="mono">–ï–Ω–µ—Ä–≥—ñ—è = k‚Çë √ó M–≤–æ–ª–æ–≥–∞(—Ç) √ó (W‚ÇÄ ‚àí W—Ü)</span>; <span class="mono">–í–∞—Ä—Ç—ñ—Å—Ç—å = –ï–Ω–µ—Ä–≥—ñ—è √ó –¶—ñ–Ω–∞‚Çë</span>.
      </p>
    </div>

    <!-- –ü–ê–†–ê–ú–ï–¢–†–ò –¢–ê –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø -->
    <div class="card">
      <h2>‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</h2>
      <div class="grid g3">
        <div class="box">
          <h3>–¶—ñ–ª—å –≤–æ–ª–æ–≥–æ—Å—Ç—ñ</h3>
          <div class="row">
            <div style="flex:1"><label>–ö—É–ª—å—Ç—É—Ä–∞</label><input id="crop" type="text" value="–ö—É–∫—É—Ä—É–¥–∑–∞"></div>
            <div style="flex:1"><label>W—Ü, %</label><input id="Wtarget" type="number" step="0.1" value="14.0"></div>
          </div>
          <p class="small">–¢–∏–ø–æ–≤—ñ –Ω–∞–≤—á–∞–ª—å–Ω—ñ: –ø—à–µ–Ω–∏—Ü—è 13‚Äì14%, –∫—É–∫—É—Ä—É–¥–∑–∞ 14%, —Å–æ–Ω—è—à–Ω–∏–∫ 8‚Äì9%.</p>
        </div>
        <div class="box">
          <h3>–ï–Ω–µ—Ä–≥–æ–≤–∏—Ç—Ä–∞—Ç–∏ —Å—É—à—ñ–Ω–Ω—è</h3>
          <div class="row">
            <div style="flex:1"><label>k‚Çë, –∫–í—Ç¬∑–≥–æ–¥/—Ç¬∑%–≤–æ–ª.</label><input id="ke" type="number" step="1" value="18"></div>
            <div style="flex:1"><label>–¶—ñ–Ω–∞ –∫–í—Ç¬∑–≥–æ–¥, –≥—Ä–Ω</label><input id="pE" type="number" step="0.1" value="4.5"></div>
          </div>
          <p class="small">–ê–±–æ —ñ–Ω—Ç–µ—Ä–ø—Ä–µ—Ç—É–π k‚Çë —è–∫ ¬´—É–º–æ–≤–Ω—ñ –æ–¥–∏–Ω–∏—Ü—ñ –µ–Ω–µ—Ä–≥—ñ—ó¬ª ‚Äî –≥–æ–ª–æ–≤–Ω–µ, —â–æ–± –ø—Ä–æ–ø–æ—Ä—Ü—ñ—ó –±—É–ª–∏ –∫–æ—Ä–µ–∫—Ç–Ω—ñ.</p>
        </div>
        <div class="box">
          <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
          <div class="row">
            <button class="btn" onclick="addRow()">‚ûï –î–æ–¥–∞—Ç–∏ –ø–∞—Ä—Ç—ñ—é</button>
            <button class="btn" onclick="recalc()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
            <button class="btn" onclick="example()">üß™ –ü—Ä–∏–∫–ª–∞–¥</button>
            <button class="btn" onclick="copyCSV()">üìã CSV</button>
          </div>
        </div>
      </div>
    </div>

    <!-- –¢–ê–ë–õ–ò–¶–Ø –ü–ê–†–¢–Ü–ô -->
    <div class="card">
      <h2>üß± –ü–∞—Ä—Ç—ñ—ó –∑–µ—Ä–Ω–∞</h2>
      <div style="overflow:auto">
        <table class="table" id="tbl">
          <thead>
            <tr>
              <th>#</th>
              <th>–î–∞—Ç–∞/—á–∞—Å</th>
              <th>–ü–æ–ª–µ</th>
              <th>–ö—É–ª—å—Ç—É—Ä–∞</th>
              <th>–í–∞–≥–∞, —Ç</th>
              <th>W‚ÇÄ, %</th>
              <th class="dark">M—Å—É—Ö–∞, —Ç</th>
              <th class="dark">–£—Å—É—à–∫–∞, —Ç</th>
              <th class="dark">–ï–Ω–µ—Ä–≥—ñ—è, –∫–í—Ç¬∑–≥–æ–¥</th>
              <th class="dark">–í–∞—Ä—Ç—ñ—Å—Ç—å, –≥—Ä–Ω</th>
              <th class="dark">–†—ñ—à–µ–Ω–Ω—è</th>
              <th>–ù–æ—Ç–∞—Ç–∫–∞</th>
            </tr>
          </thead>
          <tbody id="body"></tbody>
          <tfoot>
            <tr>
              <th class="dark" colspan="4">–†–∞–∑–æ–º</th>
              <th class="dark" id="sumW">‚Äî</th>
              <th class="dark">‚Äî</th>
              <th class="dark" id="sumDry">‚Äî</th>
              <th class="dark" id="sumLoss">‚Äî</th>
              <th class="dark" id="sumE">‚Äî</th>
              <th class="dark" id="sumCost">‚Äî</th>
              <th class="dark" id="sumNote">–û–Ω–æ–≤–ª–µ–Ω–æ</th>
              <th></th>
            </tr>
          </tfoot>
        </table>
      </div>
      <div id="csv" class="out" style="margin-top:8px">‚Äî</div>
      <p class="small">CSV: <span class="mono"># | –î–∞—Ç–∞ | –ü–æ–ª–µ | –ö—É–ª—å—Ç—É—Ä–∞ | –í–∞–≥–∞_—Ç | W0_% | Ms—É—Ö–∞_—Ç | –£—Å—É—à–∫–∞_—Ç | –ï–Ω–µ—Ä–≥—ñ—è_–∫–í—Ç–≥–æ–¥ | –í–∞—Ä—Ç—ñ—Å—Ç—å_–≥—Ä–Ω | –†—ñ—à–µ–Ω–Ω—è | –ù–æ—Ç–∞—Ç–∫–∞</span></p>
      <p class="small muted">–ö–æ–Ω—Ç—Ä–∞—Å—Ç: —Ç–µ–º–Ω—ñ –∫–ª—ñ—Ç–∏–Ω–∫–∏ (<span class="mono">.dark</span>) –º–∞—é—Ç—å —Å–≤—ñ—Ç–ª–∏–π —Ç–µ–∫—Å—Ç.</p>
    </div>

    <!-- –°–£–ú–Ü–®–£–í–ê–ù–ù–Ø –î–í–û–• –ü–ê–†–¢–Ü–ô -->
    <div class="card">
      <h2>üß™ –°—É–º—ñ—à—É–≤–∞–Ω–Ω—è 2 –ø–∞—Ä—Ç—ñ–π –¥–æ —Ü—ñ–ª—ñ</h2>
      <div class="grid g2">
        <div class="box">
          <h3>–í–≤—ñ–¥</h3>
          <div class="row">
            <div style="flex:1"><label>–ü–∞—Ä—Ç—ñ—è A ‚Äî –≤–∞–≥–∞, —Ç</label><input id="mA" type="number" step="0.01" value="20"></div>
            <div style="flex:1"><label>–ü–∞—Ä—Ç—ñ—è A ‚Äî W‚Çê, %</label><input id="wA" type="number" step="0.1" value="18.5"></div>
          </div>
          <div class="row" style="margin-top:6px">
            <div style="flex:1"><label>–ü–∞—Ä—Ç—ñ—è B ‚Äî –≤–∞–≥–∞, —Ç</label><input id="mB" type="number" step="0.01" value="15"></div>
            <div style="flex:1"><label>–ü–∞—Ä—Ç—ñ—è B ‚Äî W·µ¶, %</label><input id="wB" type="number" step="0.1" value="12.5"></div>
          </div>
          <div class="row" style="margin-top:8px">
            <button class="btn" onclick="blend()">üîÅ –û–±—á–∏—Å–ª–∏—Ç–∏ —Å—É–º—ñ—à</button>
          </div>
        </div>
        <div class="box">
          <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
          <p><b>W—Å—É–º, %:</b> <span id="wMix" class="mono">‚Äî</span></p>
          <p class="mono" id="mixDecision">‚Äî</p>
          <div class="out" id="mixExplain">‚Äî</div>
        </div>
      </div>
      <p class="small">–§–æ—Ä–º—É–ª–∞: <span class="mono">W—Å—É–º = (mA¬∑W‚Çê + mB¬∑W·µ¶)/(mA + mB)</span>.</p>
    </div>

    <!-- NFC –¢–ê –ß–ï–ö -->
    <div class="card">
      <h2>üîñ NFC-—Ç–µ–∫—Å—Ç –¥–ª—è —Å–∏–ª–æ—Å–∞ / üßæ –ß–µ–∫ 58 –º–º</h2>
      <div class="grid g2">
        <div class="box">
          <h3>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ–∫—Å—Ç—É –¥–ª—è NFC</h3>
          <div class="row">
            <div style="flex:1"><label>–°–∏–ª–æ—Å/–ë—É–Ω–∫–µ—Ä</label><input id="bin" type="text" value="SIL-1"></div>
            <div style="flex:1"><label>–ü–∞—Ä—Ç—ñ—è (–∫–æ–¥)</label><input id="lot" type="text" value="LOT-001"></div>
          </div>
          <div class="row" style="margin-top:6px">
            <div style="flex:1"><label>–ö—É–ª—å—Ç—É—Ä–∞</label><input id="nfcCrop" type="text" value="–ö—É–∫—É—Ä—É–¥–∑–∞"></div>
            <div style="flex:1"><label>W, % (—Ñ–∞–∫—Ç)</label><input id="nfcW" type="number" step="0.1" value="15.8"></div>
          </div>
          <div class="row" style="margin-top:6px">
            <button class="btn" onclick="buildNFC()">üß© –ó—ñ–±—Ä–∞—Ç–∏ —Ç–µ–∫—Å—Ç</button>
            <button class="btn" onclick="copyEl('nfcOut')">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
          </div>
          <div id="nfcOut" class="out">‚Äî</div>
          <p class="small">–ó–∞–ø–∏—à–∏ —Ü–µ–π —Ç–µ–∫—Å—Ç —É NDEF (Text) —á–µ—Ä–µ–∑ –±—É–¥—å-—è–∫–∏–π NFC-–¥–æ–¥–∞—Ç–æ–∫ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω—ñ.</p>
        </div>
        <div class="box">
          <h3>–ß–µ–∫ 58 –º–º –¥–ª—è –≤–∞–≥–∞—Ä—è</h3>
          <div class="row">
            <button class="btn" onclick="buildTicket()">üßæ –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏</button>
            <button class="btn" onclick="printTicketNewTab()">üñ®Ô∏è –î—Ä—É–∫</button>
          </div>
          <div class="ticket" id="ticket" style="margin-top:8px">
            <h4>–ñ–£–†–ù–ê–õ –ü–ê–†–¢–Ü–á</h4>
            <p id="tDate"><small>–î–∞—Ç–∞: ‚Äî</small></p>
            <div class="line"></div>
            <p><b>–ü–æ–ª–µ:</b> <span id="tField">‚Äî</span></p>
            <p><b>–ö—É–ª—å—Ç.:</b> <span id="tCrop">‚Äî</span> ¬∑ <b>W‚ÇÄ:</b> <span id="tW0">‚Äî</span>%</p>
            <p><b>–í–∞–≥–∞:</b> <span id="tW">‚Äî</span> —Ç</p>
            <p><b>W—Ü:</b> <span id="tWtar">‚Äî</span>% ¬∑ <b>M—Å—É—Ö–∞:</b> <span id="tMd">‚Äî</span> —Ç</p>
            <p><b>–ï–Ω–µ—Ä–≥—ñ—è:</b> <span id="tE">‚Äî</span> –∫–í—Ç¬∑–≥–æ–¥ ¬∑ <b>–í–∞—Ä—Ç—ñ—Å—Ç—å:</b> <span id="tCost">‚Äî</span> –≥—Ä–Ω</p>
            <div class="line"></div>
            <p><small id="tNote">–ü—Ä–∏–º.: ‚Äî</small></p>
          </div>
        </div>
      </div>
    </div>

    <!-- –•–Ü–î –†–û–ë–û–¢–ò, –û–¶–Ü–ù–Æ–í–ê–ù–ù–Ø -->
    <div class="card">
      <h2>ü™ú –•—ñ–¥ —Ä–æ–±–æ—Ç–∏ (45‚Äì70 —Ö–≤)</h2>
      <ol>
        <li>–ó–∞–Ω–µ—Å–∏ 6‚Äì10 –ø–∞—Ä—Ç—ñ–π (–¥–∞—Ç–∞/–ø–æ–ª–µ/–≤–∞–≥–∞/–≤–æ–ª–æ–≥–æ—Å—Ç—å) ‚Üí <b>–ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</b>.</li>
        <li>–û—Ü—ñ–Ω–∏ —Ä—ñ—à–µ–Ω–Ω—è: ¬´—Å–∫–ª–∞–¥¬ª —è–∫—â–æ W‚ÇÄ ‚â§ W—Ü; ¬´—Å—É—à–∏—Ç–∏¬ª —è–∫—â–æ W‚ÇÄ > W—Ü. –ü–µ—Ä–µ–≥–ª—è–Ω—å —É—Å—É—à–∫—É —Ç–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å.</li>
        <li>–ü–µ—Ä–µ–≤—ñ—Ä –∑–º—ñ—à—É–≤–∞–Ω–Ω—è –¥–≤–æ—Ö –ø–∞—Ä—Ç—ñ–π –¥–æ —Ü—ñ–ª—å–æ–≤–æ—ó –≤–æ–ª–æ–≥–æ—Å—Ç—ñ.</li>
        <li>–ó–≥–µ–Ω–µ—Ä—É–π NFC-—Ç–µ–∫—Å—Ç –¥–ª—è —Å–∏–ª–æ—Å–∞ —Ç–∞/–∞–±–æ —Ä–æ–∑–¥—Ä—É–∫—É–π —á–µ–∫ 58 –º–º –¥–ª—è –ø–∞—Ä—Ç—ñ—ó.</li>
        <li>–°–∫–æ–ø—ñ—é–π CSV —É Google Sheets (–∞—Ä–∫—É—à <span class="mono">DryingLog</span>), –ø–æ–±—É–¥—É–π –≥—Ä–∞—Ñ—ñ–∫ ¬´–í–∞—Ä—Ç—ñ—Å—Ç—å/–ø–∞—Ä—Ç—ñ—è¬ª.</li>
      </ol>
    </div>

    <div class="card">
      <h2>‚úÖ –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è (10 –±–∞–ª—ñ–≤)</h2>
      <table class="table">
        <thead><tr><th>–ö—Ä–∏—Ç–µ—Ä—ñ–π</th><th>–ë–∞–ª–∏</th></tr></thead>
        <tbody>
          <tr><td>–ö–æ—Ä–µ–∫—Ç–Ω—ñ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏ M—Å—É—Ö–∞/—É—Å—É—à–∫–∞ —Ç–∞ –µ–Ω–µ—Ä–≥–æ–≤–∏—Ç—Ä–∞—Ç–∏</td><td>4</td></tr>
          <tr><td>–ê—Ä–≥—É–º–µ–Ω—Ç–æ–≤–∞–Ω–µ —Ä—ñ—à–µ–Ω–Ω—è ¬´—Å–∫–ª–∞–¥/—Å—É—à–∏—Ç–∏¬ª –¥–ª—è –∫–æ–∂–Ω–æ—ó –ø–∞—Ä—Ç—ñ—ó</td><td>3</td></tr>
          <tr><td>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å—É–º—ñ—à—É–≤–∞–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ —Ç–∞ –ø–æ—è—Å–Ω–µ–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç</td><td>2</td></tr>
          <tr><td>CSV —É Sheets + –∫–æ—Ä–æ—Ç–∫—ñ –≤–∏—Å–Ω–æ–≤–∫–∏</td><td>1</td></tr>
        </tbody>
      </table>
      <p class="pill">üåΩ –í–æ–ª–æ–≥—ñ—Å—Ç—å</p><p class="pill">‚öôÔ∏è –£—Å—É—à–∫–∞</p><p class="pill">‚ö° –ï–Ω–µ—Ä–≥–æ–≤–∞—Ä—Ç—ñ—Å—Ç—å</p><p class="pill">üß™ –°—É–º—ñ—à—É–≤–∞–Ω–Ω—è</p>
    </div>
  </div>

<script>
  // –í–±—É–¥–æ–≤–∞–Ω–∏–π —Ä–µ–∂–∏–º (Moodle iFrame)
  (function(){ if (window.self !== window.top) document.documentElement.classList.add('embedded'); })();

  const bodyEl = document.getElementById('body');
  const csvEl = document.getElementById('csv');

  // –£—Ç–∏–ª—ñ—Ç–∏
  const byId = id => document.getElementById(id);
  const rnd = (n,d=2) => Number((+n).toFixed(d));
  function copyEl(id){ const t = byId(id).textContent.trim(); if(!t||t==='‚Äî'){alert('–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö');return;} navigator.clipboard.writeText(t).then(()=>flash('‚úÖ –°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'),()=>flash('–ù–µ –≤–¥–∞–ª–æ—Å—è')); }
  function flash(msg){ const o=document.title; document.title=msg; setTimeout(()=>document.title=o,900); }

  function addRow(sample){
    const now = new Date();
    const def = {
      date: new Date(now.getFullYear(), now.getMonth(), now.getDate(), now.getHours(), now.getMinutes()).toISOString().slice(0,16),
      field:'F-01', crop: byId('crop').value || '–ö—É–∫—É—Ä—É–¥–∑–∞',
      weight: 22.0, W0: 18.0, note: ''
    };
    const s = Object.assign(def, sample||{});
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td class="idx">1</td>
      <td><input type="datetime-local" value="${s.date}"></td>
      <td><input type="text" value="${s.field}"></td>
      <td><input type="text" value="${s.crop}"></td>
      <td><input type="number" step="0.01" value="${s.weight}"></td>
      <td><input type="number" step="0.1" value="${s.W0}"></td>
      <td class="dark md">‚Äî</td>
      <td class="dark loss">‚Äî</td>
      <td class="dark en">‚Äî</td>
      <td class="dark cost">‚Äî</td>
      <td class="dark dec">‚Äî</td>
      <td><input type="text" value="${s.note}"></td>
    `;
    bodyEl.appendChild(tr);
    reindex();
  }

  function reindex(){ [...bodyEl.querySelectorAll('tr')].forEach((tr,i)=>tr.querySelector('.idx').textContent = i+1); }

  function recalc(){
    const Wt = parseFloat(byId('Wtarget').value||'14');   // %
    const ke  = parseFloat(byId('ke').value||'18');       // –∫–í—Ç¬∑–≥–æ–¥/—Ç¬∑%–≤–æ–ª.
    const pE  = parseFloat(byId('pE').value||'4.5');      // –≥—Ä–Ω/–∫–í—Ç¬∑–≥–æ–¥

    let sumW=0, sumDry=0, sumLoss=0, sumE=0, sumCost=0;

    [...bodyEl.querySelectorAll('tr')].forEach(tr=>{
      const W0 = parseFloat(tr.children[5].querySelector('input').value||'0');
      const M  = parseFloat(tr.children[4].querySelector('input').value||'0');

      // Ms—É—Ö–∞ —Ç–∞ —É—Å—É—à–∫–∞ –¥–æ —Ü—ñ–ª—ñ (—è–∫—â–æ –≤–∂–µ —Å—É—Ö–∞ ‚Äî Ms—É—Ö–∞=M)
      const Md = (W0<=Wt) ? M : M * ((100 - W0)/(100 - Wt));
      const loss = M - Md;

      // –ï–Ω–µ—Ä–≥—ñ—è/–≤–∞—Ä—Ç—ñ—Å—Ç—å (—Ç—ñ–ª—å–∫–∏ —è–∫—â–æ W0>Wt)
      const dW = Math.max(0, W0 - Wt);
      const E = M * dW * ke;
      const cost = E * pE;

      tr.querySelector('.md').textContent   = rnd(Md,3);
      tr.querySelector('.loss').textContent = rnd(loss,3);
      tr.querySelector('.en').textContent   = (dW>0)? rnd(E,0) : 0;
      tr.querySelector('.cost').textContent = (dW>0)? rnd(cost,0).toLocaleString('uk-UA') : '0';

      const dec = (W0<=Wt) ? '–°–∫–ª–∞–¥ (OK)' : '–ù–∞ —Å—É—à–∞—Ä–∫—É';
      tr.querySelector('.dec').textContent = dec;
      tr.querySelector('.dec').style.color = (W0<=Wt)? '#10b981' : '#f59e0b';

      sumW += M; sumDry += Md; sumLoss += loss; sumE += (dW>0)?E:0; sumCost += (dW>0)?cost:0;
    });

    byId('sumW').textContent    = rnd(sumW,2);
    byId('sumDry').textContent  = rnd(sumDry,2);
    byId('sumLoss').textContent = rnd(sumLoss,2);
    byId('sumE').textContent    = rnd(sumE,0);
    byId('sumCost').textContent = rnd(sumCost,0).toLocaleString('uk-UA');

    buildCSV();
  }

  function buildCSV(){
    const lines = [...bodyEl.querySelectorAll('tr')].map(tr=>{
      const idx=tr.querySelector('.idx').textContent.trim();
      const d  = tr.children[1].querySelector('input').value.trim();
      const f  = tr.children[2].querySelector('input').value.trim();
      const c  = tr.children[3].querySelector('input').value.trim();
      const M  = tr.children[4].querySelector('input').value.trim();
      const W0 = tr.children[5].querySelector('input').value.trim();
      const Md = tr.querySelector('.md').textContent.trim();
      const L  = tr.querySelector('.loss').textContent.trim();
      const E  = tr.querySelector('.en').textContent.trim();
      const Ct = tr.querySelector('.cost').textContent.trim();
      const Dc = tr.querySelector('.dec').textContent.trim();
      const Nt = tr.children[11].querySelector('input').value.trim();
      return [idx,d,f,c,M,W0,Md,L,E,Ct,Dc,Nt].join(' | ');
    });
    csvEl.textContent = lines.join('\n') || '‚Äî';
  }

  function copyCSV(){
    const t = csvEl.textContent.trim();
    if(!t || t==='‚Äî'){ alert('–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è'); return; }
    navigator.clipboard.writeText(t).then(()=>flash('‚úÖ CSV —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'),()=>flash('–ù–µ –≤–¥–∞–ª–æ—Å—è'));
  }

  function example(){
    bodyEl.innerHTML='';
    addRow({field:'F-01', crop:'–ö—É–∫—É—Ä—É–¥–∑–∞', weight:22.8, W0:18.7});
    addRow({field:'F-02', crop:'–ö—É–∫—É—Ä—É–¥–∑–∞', weight:19.6, W0:16.5});
    addRow({field:'F-03', crop:'–ö—É–∫—É—Ä—É–¥–∑–∞', weight:24.2, W0:13.8});
    addRow({field:'F-01', crop:'–ö—É–∫—É—Ä—É–¥–∑–∞', weight:18.1, W0:20.2});
    addRow({field:'F-02', crop:'–ö—É–∫—É—Ä—É–¥–∑–∞', weight:21.7, W0:14.0});
    recalc();
  }

  // –°—É–º—ñ—à—É–≤–∞–Ω–Ω—è
  function blend(){
    const mA = parseFloat(byId('mA').value||'0');
    const wA = parseFloat(byId('wA').value||'0');
    const mB = parseFloat(byId('mB').value||'0');
    const wB = parseFloat(byId('wB').value||'0');
    const Wt = parseFloat(byId('Wtarget').value||'14');

    if(mA<=0||mB<=0){ alert('–í–∫–∞–∂–∏ –¥–æ–¥–∞—Ç–Ω—ñ –≤–∞–≥–∏ –ø–∞—Ä—Ç—ñ–π.'); return; }

    const wMix = (mA*wA + mB*wB)/(mA+mB);
    byId('wMix').textContent = rnd(wMix,2);

    let msg='', expl='';
    if(wMix <= Wt){
      msg = `‚úÖ W—Å—É–º = ${rnd(wMix,2)}% ‚â§ W—Ü = ${Wt}% ‚Üí –ú–æ–∂–Ω–∞ –Ω–∞ —Å–∫–ª–∞–¥ –±–µ–∑ —Å—É—à—ñ–Ω–Ω—è.`;
      expl = '–°—É—Ö–∞ –∞–±–æ –≤ –º–µ–∂–∞—Ö –Ω–æ—Ä–º–∏ –ø—ñ—Å–ª—è —Å—É–º—ñ—à—É–≤–∞–Ω–Ω—è.';
    }else{
      const over = rnd(wMix - Wt,2);
      msg = `‚ö†Ô∏è W—Å—É–º = ${rnd(wMix,2)}% > W—Ü = ${Wt}% (–Ω–∞ ${over} –ø.–ø.) ‚Üí –ü–æ—Ç—Ä—ñ–±–Ω–µ —Å—É—à—ñ–Ω–Ω—è.`;
      // –ü—ñ–¥–∫–∞–∑–∫–∞: —è–∫—É —á–∞—Å—Ç–∫—É —Å—É—Ö—ñ—à–æ—ó –ø–∞—Ä—Ç—ñ—ó —Ç—Ä–µ–±–∞ –≤–∑—è—Ç–∏ –¥–æ –æ–±–º–µ–∂–µ–Ω–Ω—è mA —á–∏ mB (–Ω–∞–≤—á–∞–ª—å–Ω–æ)
      const needMB = (mA*(wA - Wt))/(Wt - wB); // mB, —â–æ–± –¥–æ—Å—è–≥—Ç–∏ Wt (—è–∫—â–æ wB < Wt)
      if(wB < Wt && needMB>0){
        expl = `–©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ —Ä—ñ–≤–Ω–æ ${Wt}%, –ø—Ä–∏ —Ñ—ñ–∫—Å–æ–≤–∞–Ω—ñ–π –ø–∞—Ä—Ç—ñ—ó A (${mA} —Ç) –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∑—è—Ç–∏ B ‚âà ${rnd(needMB,2)} —Ç (–∑–∞ —É–º–æ–≤–∏, —â–æ —Ü–µ ‚â§ ${mB} —Ç).`;
      }else{
        expl = '–û–±–µ—Ä–∏ —Å—É—Ö—ñ—à—É –ø–∞—Ä—Ç—ñ—é –∞–±–æ –∑–º–µ–Ω—à—É–π —á–∞—Å—Ç–∫—É –≤–æ–ª–æ–≥—ñ—à–æ—ó.';
      }
    }
    byId('mixDecision').textContent = msg;
    byId('mixExplain').textContent = expl;
  }

  // NFC —Ç–∞ —á–µ–∫
  function buildNFC(){
    const text = [
      `BIN:${byId('bin').value.trim()}`,
      `LOT:${byId('lot').value.trim()}`,
      `CROP:${byId('nfcCrop').value.trim()}`,
      `W:${byId('nfcW').value.trim()}%`,
      `DATE:${new Date().toISOString().slice(0,19).replace('T',' ')}`
    ].join('\n');
    byId('nfcOut').textContent = text;
  }

  function buildTicket(){
    // –±–µ—Ä—É –ø–µ—Ä—à–∏–π —Ä—è–¥–æ–∫ —è–∫ –∞–∫—Ç–∏–≤–Ω—É –ø–∞—Ä—Ç—ñ—é –¥–ª—è —á–µ–∫–∞
    const tr = bodyEl.querySelector('tr');
    if(!tr){ alert('–ù–µ–º–∞—î –∂–æ–¥–Ω–æ—ó –ø–∞—Ä—Ç—ñ—ó.'); return; }
    const d  = tr.children[1].querySelector('input').value.trim();
    const f  = tr.children[2].querySelector('input').value.trim();
    const c  = tr.children[3].querySelector('input').value.trim();
    const M  = parseFloat(tr.children[4].querySelector('input').value||'0');
    const W0 = parseFloat(tr.children[5].querySelector('input').value||'0');
    const Wt = parseFloat(byId('Wtarget').value||'14');
    const Md = (W0<=Wt) ? M : M * ((100 - W0)/(100 - Wt));
    const dW = Math.max(0, W0 - Wt);
    const E = dW>0 ? M*dW*parseFloat(byId('ke').value||'18') : 0;
    const Ct = dW>0 ? E*parseFloat(byId('pE').value||'4.5') : 0;

    byId('tDate').innerHTML = `<small>–î–∞—Ç–∞: ${d}</small>`;
    byId('tField').textContent = f;
    byId('tCrop').textContent  = c;
    byId('tW0').textContent    = rnd(W0,1);
    byId('tW').textContent     = rnd(M,2);
    byId('tWtar').textContent  = rnd(Wt,1);
    byId('tMd').textContent    = rnd(Md,2);
    byId('tE').textContent     = dW>0 ? rnd(E,0) : 0;
    byId('tCost').textContent  = dW>0 ? rnd(Ct,0) : 0;
    byId('tNote').textContent  = `–ü—Ä–∏–º.: ${dW>0?'–°—É—à—ñ–Ω–Ω—è –ø–æ—Ç—Ä—ñ–±–Ω–µ':'–°–∫–ª–∞–¥ (OK)'} ¬∑ Ref: LOT-${Math.random().toString(36).slice(2,8).toUpperCase()}`;
  }

  // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
  (function init(){
    addRow(); addRow(); addRow();
    recalc();
  })();
</script>

<script>
// PRINT PATCH v1 (auto)
function printTicketNewTab(){
  var ticket = document.getElementById('ticket');
  if(!ticket){ alert('–ù–µ–º–∞—î #ticket –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ'); return; }
  try{
    var someTxt = (document.querySelector('#ticket span, #ticket p, #ticket h4')||{}).textContent||'';
    if(!someTxt || someTxt.trim()==='‚Äî'){ if(typeof buildTicket==='function') buildTicket(); }
  }catch(_){}

  var css = `
    @media print { @page { size:58mm auto; margin:0 } }
    html,body{ margin:0; padding:0; background:#fff; color:#000 }
    .ticket{
      width:58mm; margin:0; padding:6mm 4mm; background:#fff; color:#000;
      font-family:"Courier New", Courier, monospace; font-weight:700; letter-spacing:0.1px;
      border:none; box-shadow:none; border-radius:0
    }
    .ticket h4{ margin:0 0 6px; font-size:13px; text-align:center; font-weight:700 }
    .ticket p{ margin:2px 0; font-size:12px; font-weight:700 }
    .ticket b,.ticket strong,.ticket span{ font-weight:700 }
    .line{ border-top:1px dashed #111; margin:6px 0 }
    small{ font-size:10px; font-weight:700 }
  `;
  var html = `<!DOCTYPE html><html><head><meta charset="utf-8"><title>–ß–µ–∫ 58 –º–º</title><style>${css}</style></head><body>${ticket.outerHTML}
  <script>
    window.addEventListener('load',()=>{
      try{ window.focus(); window.print(); if(window.opener) window.opener.postMessage({type:'ticketPrint',status:'invoked'},'*'); }
      catch(e){ if(window.opener) window.opener.postMessage({type:'ticketPrint',status:'error'},'*'); }
    });
  <\/script>
  </body></html>`;

  var w = window.open('', '_blank');
  if(!w){ openTicketOnly(); return; }  // –ø–æ–ø–∞–ø –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ ‚Äî —Ñ–æ–ª–±–µ–∫
  w.document.open(); w.document.write(html); w.document.close();

  var timer = setTimeout(()=>{ openTicketOnly(); }, 1200);
  window.addEventListener('message', (ev)=>{
    if(ev && ev.data && ev.data.type==='ticketPrint'){ clearTimeout(timer); }
  }, {once:true});
}

function openTicketOnly(){
  var ticket = document.getElementById('ticket');
  if(!ticket){ alert('–ù–µ–º–∞—î #ticket –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ'); return; }
  try{
    var someTxt = (document.querySelector('#ticket span, #ticket p, #ticket h4')||{}).textContent||'';
    if(!someTxt || someTxt.trim()==='‚Äî'){ if(typeof buildTicket==='function') buildTicket(); }
  }catch(_){}

  var css = `
    @media print { @page { size:58mm auto; margin:0 } }
    html,body{ margin:0; background:#fff; color:#000 }
    .ticket{
      width:58mm; margin:0; padding:6mm 4mm; background:#fff; color:#000;
      font-family:"Courier New", Courier, monospace; font-weight:700; letter-spacing:0.1px;
      border:none; box-shadow:none; border-radius:0
    }
    .ticket h4{ margin:0 0 6px; font-size:13px; text-align:center; font-weight:700 }
    .ticket p{ margin:2px 0; font-size:12px; font-weight:700 }
    .line{ border-top:1px dashed #111; margin:6px 0 }
    small{ font-size:10px; font-weight:700 }
  `;
  var html = `<!DOCTYPE html><html><head><meta charset="utf-8"><title>–ß–µ–∫ 58 –º–º</title><style>${css}</style></head><body>${ticket.outerHTML}
<script>window.addEventListener('load',()=>{ try{ window.focus(); window.print(); }catch(e){} });<\/script>
</body></html>`;

  var blob = new Blob([html], {type:'text/html'});
  var url = URL.createObjectURL(blob);
  window.open(url, '_blank');
  setTimeout(()=>URL.revokeObjectURL(url), 60000);
}
</script>

</body>
</html>
