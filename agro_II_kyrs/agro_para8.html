<!-- –ü–ê–†–ê 8 (–∞—É–¥–∏—Ç–æ—Ä–Ω–æ) –¥–ª—è –∞–≥—Ä–æ–Ω–æ–º—ñ–≤
     –¢–µ–º–∞: –ï–ö–û–ù–û–ú–Ü–ß–ù–ò–ô –ü–û–†–û–ì –®–ö–û–î–û–ß–ò–ù–ù–û–°–¢–Ü (EIL) —ñ –ü–û–†–û–ì –î–Ü–á (ET) ‚Äî –º–æ–±—ñ–ª—å–Ω–µ –æ–±—Å—Ç–µ–∂–µ–Ω–Ω—è, —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏, —Ä—ñ—à–µ–Ω–Ω—è
     –§–æ–∫—É—Å: —Ç–µ–ª–µ—Ñ–æ–Ω–∏/–ü–ö, –ª–æ–∫–∞–ª—å–Ω–æ; —Ç–∞–±–ª–∏—Ü—è –≤—ñ–¥–±–æ—Ä—É –ø—Ä–æ–±, –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä EIL/ET, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è ¬´–¥—ñ—è—Ç–∏/—Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏¬ª, CSV.
     –ö–æ–Ω—Ç—Ä–∞—Å—Ç: —Ç–µ–º–Ω—ñ –∫–ª—ñ—Ç–∏–Ω–∫–∏ –º–∞—é—Ç—å —Å–≤—ñ—Ç–ª–∏–π —Ç–µ–∫—Å—Ç (—è–∫ –ø—Ä–æ—Å–∏–≤ –≤–∏–∫–ª–∞–¥–∞—á).
     –ì–æ—Ç–æ–≤–æ –¥–ª—è GitHub Pages / iFrame —É Moodle. -->
<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>–ü–∞—Ä–∞ 8 ‚Äî –ï–∫–æ–Ω–æ–º—ñ—á–Ω–∏–π –ø–æ—Ä—ñ–≥ —à–∫–æ–¥–æ—á–∏–Ω–Ω–æ—Å—Ç—ñ (EIL) —ñ –ø–æ—Ä—ñ–≥ –¥—ñ—ó (ET)</title>
<meta name="color-scheme" content="light dark">
<style>
  :root{
    --bg:#0b1220; --card:#0f172a; --muted:#94a3b8; --text:#e2e8f0;
    --accent:#22c55e; --accent-2:#60a5fa; --warn:#f59e0b; --bad:#ef4444; --good:#10b981; --line:#1f2937;
    --darkcell:#0b1324; --darkink:#e6eef9; --darkink2:#e5e7eb;
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:linear-gradient(180deg,#0b1220,#111827 30%,#0b1220);
    color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif; line-height:1.55
  }
  .wrap{max-width:1080px; margin:0 auto; padding:24px 16px 64px}
  .badge{display:inline-block; padding:6px 10px; border:1px solid var(--line); background:#0b1220; border-radius:999px; font-size:12px; color:var(--muted); letter-spacing:.3px}
  h1{font-size:34px; margin:6px 0 12px; line-height:1.15;
     background:linear-gradient(90deg,#60a5fa,#22c55e); -webkit-background-clip:text; -webkit-text-fill-color:transparent}
  h2{font-size:22px; margin:28px 0 12px}
  h3{font-size:18px; margin:20px 0 8px; color:#cbd5e1}
  p{margin:10px 0}
  .muted{color:#93a3b5}
  .small{font-size:12px; color:#9fb0c8}

  .card{
    background:linear-gradient(180deg,#0f172a,#0b1220); border:1px solid var(--line); border-radius:16px; padding:16px; margin:12px 0;
    box-shadow:0 6px 24px rgba(0,0,0,.25)
  }
  .grid{display:grid; gap:12px}
  .g2{grid-template-columns:repeat(2,minmax(0,1fr))}
  .g3{grid-template-columns:repeat(3,minmax(0,1fr))}
  @media (max-width:980px){.g2,.g3{grid-template-columns:1fr}}

  .btn{display:inline-block; padding:10px 14px; border-radius:10px; border:1px solid #223049; background:#0d1a2e; color:#dbeafe; text-decoration:none; cursor:pointer}
  .btn:hover{background:#0f1f39}
  .pill{display:inline-block; padding:4px 10px; border:1px solid #223049; border-radius:999px; font-size:12px; color:#a5b4fc; background:#0d1a2e; margin-right:6px}
  .mono,code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}

  .box{border:1px solid #223049; border-radius:12px; padding:12px; background:var(--darkcell); color:var(--darkink)}
  .ok{color:var(--good)} .warn{color:var(--warn)} .bad{color:var(--bad)}

  .table{width:100%; border-collapse:separate; border-spacing:0; overflow:auto; border-radius:12px; border:1px solid #223049}
  .table th,.table td{padding:8px 10px; border-bottom:1px solid #1f2937; font-size:14px; vertical-align:top}
  .table thead th{background:#0c1629; color:#a5b4fc; text-align:left; position:sticky; top:0}
  .table tbody tr:nth-child(even){background:var(--darkcell); color:var(--darkink2)}
  .table td.dark, .table th.dark{background:var(--darkcell) !important; color:var(--darkink2) !important}
  .table td .tag{display:inline-block; padding:3px 8px; border-radius:999px; border:1px solid #223049; background:#0d1a2e; color:#dbeafe; font-size:12px}

  input[type="text"], input[type="number"], input[type="date"], select, textarea{
    width:100%; padding:8px 10px; border-radius:10px; border:1px solid #223049; background:#0d1a2e; color:#e6eef9
  }

  .out{background:var(--darkcell); color:var(--darkink2); border:1px dashed #263042; padding:10px 12px; border-radius:10px; word-break:break-all}
  .row{display:flex; gap:10px; flex-wrap:wrap}

  /* –í–±—É–¥–æ–≤–∞–Ω–æ (iframe) ‚Üí —Å–≤—ñ—Ç–ª–∏–π –≤–∏–≥–ª—è–¥ */
  html.embedded body{background:#fff; color:#111}
  html.embedded .card{background:#fff; border:1px solid #e5e7eb; box-shadow:none}
  html.embedded h1{-webkit-text-fill-color:initial; background:none; color:#111}
  html.embedded .btn{background:#111827; color:#fff; border-color:#111827}
  html.embedded .box{background:#f8fafc; color:#111}
  html.embedded .table tbody tr:nth-child(even){background:#f3f4f6; color:#111}
</style>
</head>
<body>
  <div class="wrap">
    <span class="badge">–ü–∞—Ä–∞ 8 ¬∑ –∞—É–¥–∏—Ç–æ—Ä–Ω–æ ¬∑ –∞–≥—Ä–æ–Ω–æ–º–∏</span>
    <h1>ü™≤ –ï–∫–æ–Ω–æ–º—ñ—á–Ω–∏–π –ø–æ—Ä—ñ–≥ —à–∫–æ–¥–æ—á–∏–Ω–Ω–æ—Å—Ç—ñ (EIL) —Ç–∞ –ø–æ—Ä—ñ–≥ –¥—ñ—ó (ET): –≤—ñ–¥ –≤—ñ–¥–±–æ—Ä—É –ø—Ä–æ–± –¥–æ —Ä—ñ—à–µ–Ω–Ω—è</h1>

    <div class="card">
      <h2>üéØ –ú–µ—Ç–∞</h2>
      <p>
        –ó–∞ –ø–∞—Ä—É —Å—Ç—É–¥–µ–Ω—Ç–∏ –≤–∏–∫–æ–Ω—É—é—Ç—å <b>–ø–æ–ª—å–æ–≤–∏–π –≤—ñ–¥–±—ñ—Ä –ø—Ä–æ–±</b> (—ñ–º—ñ—Ç–∞—Ü—ñ–π–Ω–æ –≤ –∞—É–¥–∏—Ç–æ—Ä—ñ—ó), —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—é—Ç—å
        <b>EIL</b> (Economic Injury Level) —ñ <b>ET</b> (Economic Threshold), –ø–æ—Ä—ñ–≤–Ω—é—é—Ç—å —ñ–∑ —Ñ–∞–∫—Ç–∏—á–Ω–æ—é —â—ñ–ª—å–Ω—ñ—Å—Ç—é —à–∫—ñ–¥–Ω–∏–∫–∞
        —Ç–∞ —Ñ–æ—Ä–º—É—é—Ç—å <b>—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—é</b>: ¬´–æ–±–ø—Ä–∏—Å–∫—É–≤–∞—Ç–∏¬ª —á–∏ ¬´—Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏¬ª. –†–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî <b>CSV</b> –¥–ª—è Sheets.
      </p>
      <p class="small">–°–ø—Ä–æ—â–µ–Ω–∞ –Ω–∞–≤—á–∞–ª—å–Ω–∞ –º–æ–¥–µ–ª—å: <span class="mono">EIL = C / (V √ó I √ó D √ó K)</span>, –¥–µ C ‚Äî –≤–∞—Ä—Ç—ñ—Å—Ç—å –∑–∞—Ö–∏—Å—Ç—É (–≥—Ä–Ω/–≥–∞),
        V ‚Äî —Ü—ñ–Ω–∞ –≤—Ä–æ–∂–∞—é (–≥—Ä–Ω/—Ç), I ‚Äî —ñ–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ñ—Å—Ç—å —É—à–∫–æ–¥–∂–µ–Ω–Ω—è (–æ–¥./—Ä–æ—Å–ª–∏–Ω—É ‚Üí —á–∞—Å—Ç–∫–∞ –≤—Ç—Ä–∞—á–µ–Ω–æ–≥–æ –ø–æ—Ç–µ–Ω—Ü—ñ–∞–ª—É),
        D ‚Äî –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —É—à–∫–æ–¥–∂–µ–Ω–Ω—è –≤ –≤—Ç—Ä–∞—Ç—É –≤—Ä–æ–∂–∞—é (—Ç/–≥–∞ –Ω–∞ –æ–¥–∏–Ω–∏—Ü—é —É—à–∫–æ–¥–∂–µ–Ω–Ω—è), K ‚Äî –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—é (0..1).
        –ü–æ—Ä—ñ–≥ –¥—ñ—ó ET = f(EIL); —Ç—É—Ç –≤—ñ–∑—å–º–µ–º–æ <span class="mono">ET = 0.8 √ó EIL</span> (–∑–∞–ø–∞—Å –Ω–∞ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—è –ø–æ–ø—É–ª—è—Ü—ñ—ó).</p>
    </div>

    <!-- –í–ò–•–Ü–î–ù–Ü –ü–ê–†–ê–ú–ï–¢–†–ò –ï–ö–û–ù–û–ú–Ü–ö–ò –Ü –ë–Ü–û–õ–û–ì–Ü–á -->
    <div class="card">
      <h2>‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –∫—É–ª—å—Ç—É—Ä–∏, –µ–∫–æ–Ω–æ–º—ñ–∫–∏ —ñ –∫–æ–Ω—Ç—Ä–æ–ª—é</h2>
      <div class="grid g3">
        <div class="box">
          <h3>–ö—É–ª—å—Ç—É—Ä–∞ —Ç–∞ —Ü—ñ–Ω–∞</h3>
          <div><label>–ö—É–ª—å—Ç—É—Ä–∞</label><input id="crop" type="text" value="–ü—à–µ–Ω–∏—Ü—è –æ–∑–∏–º–∞" /></div>
          <div class="row" style="margin-top:6px">
            <div style="flex:1"><label>–û—á—ñ–∫—É–≤–∞–Ω–∏–π –≤—Ä–æ–∂–∞–π, —Ç/–≥–∞</label><input id="yield" type="number" step="0.1" value="5.5" /></div>
            <div style="flex:1"><label>–¶—ñ–Ω–∞, –≥—Ä–Ω/—Ç</label><input id="price" type="number" step="1" value="7000" /></div>
          </div>
        </div>

        <div class="box">
          <h3>–ë—ñ–æ–ª–æ–≥—ñ—è —à–∫–æ–¥–æ—á–∏–Ω–Ω–æ—Å—Ç—ñ</h3>
          <div class="row">
            <div style="flex:1"><label>I ‚Äî —É—à–∫–æ–¥–∂., –æ–¥./—Ä–æ—Å–ª.</label><input id="I" type="number" step="0.001" value="0.02" /></div>
            <div style="flex:1"><label>D ‚Äî –≤—Ç—Ä–∞—Ç–∏, —Ç/–≥–∞/1–æ–¥.</label><input id="D" type="number" step="0.01" value="0.2" /></div>
          </div>
          <p class="small">–ù–∞–ø—Ä., ¬´0.02¬ª –æ–∑–Ω–∞—á–∞—î, —â–æ –æ–¥–Ω–∞ –æ—Å–æ–±–∏–Ω–∞/—Ä–æ—Å–ª–∏–Ω—É –≤–∏–∫–ª–∏–∫–∞—î 2% —ñ–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—ñ —É—à–∫–æ–¥–∂–µ–Ω–Ω—è —É —Ñ–æ—Ä–º—É–ª—ñ.</p>
        </div>

        <div class="box">
          <h3>–ó–∞—Ö–∏—Å—Ç</h3>
          <div class="row">
            <div style="flex:1"><label>C ‚Äî –≤–∞—Ä—Ç—ñ—Å—Ç—å, –≥—Ä–Ω/–≥–∞</label><input id="C" type="number" step="1" value="1200" /></div>
            <div style="flex:1"><label>K ‚Äî –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å (0..1)</label><input id="K" type="number" step="0.05" value="0.8" /></div>
          </div>
          <div class="row" style="margin-top:6px">
            <button class="btn" type="button" onclick="recalcEIL()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏ EIL/ET</button>
          </div>
          <div class="box" style="margin-top:6px">
            <div><b>EIL (–µ–∫–æ–Ω–æ–º—ñ—á–Ω–∏–π –ø–æ—Ä—ñ–≥), –æ—Å./—Ä–æ—Å–ª.:</b> <span id="EIL">‚Äî</span></div>
            <div><b>ET (–ø–æ—Ä—ñ–≥ –¥—ñ—ó), –æ—Å./—Ä–æ—Å–ª.:</b> <span id="ET">‚Äî</span></div>
          </div>
        </div>
      </div>
      <p class="muted">–ü—ñ—Å–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è EIL/ET –≤–∏–∫–æ–Ω–∞–π –≤—ñ–¥–±—ñ—Ä –ø—Ä–æ–± –Ω–∏–∂—á–µ. –ü–æ—Ä—ñ–≤–Ω—è–π —Å–µ—Ä–µ–¥–Ω—é —â—ñ–ª—å–Ω—ñ—Å—Ç—å —ñ–∑ ET.</p>
    </div>

    <!-- –í–Ü–î–ë–Ü–† –ü–†–û–ë (–¢–∞–±–ª–∏—Ü—è) -->
    <div class="card">
      <h2>üß™ –í—ñ–¥–±—ñ—Ä –ø—Ä–æ–± (—Å–∫–∞–Ω –ª—ñ–Ω—ñ—ó/–∑–∏–≥–∑–∞–≥, 10‚Äì20 —Ç–æ—á–æ–∫)</h2>
      <div class="row">
        <button class="btn" type="button" onclick="addRow()">‚ûï –î–æ–¥–∞—Ç–∏ —Ç–æ—á–∫—É</button>
        <button class="btn" type="button" onclick="recalcStats()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
        <button class="btn" type="button" onclick="preset()">üß™ –ü—Ä–∏–∫–ª–∞–¥</button>
        <button class="btn" type="button" onclick="copyCSV()">üìã –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ CSV</button>
      </div>
      <div style="overflow:auto; margin-top:8px">
        <table class="table" id="tbl">
          <thead>
            <tr>
              <th>#</th>
              <th>–î–∞—Ç–∞</th>
              <th>–ü–æ–ª–µ (–∫–æ–¥)</th>
              <th>–ö—É–ª—å—Ç—É—Ä–∞</th>
              <th>–†–æ—Å–ª–∏–Ω —É –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É</th>
              <th>–®–∫—ñ–¥–Ω–∏–∫—ñ–≤, —à—Ç</th>
              <th class="dark">–û—Å./—Ä–æ—Å–ª.</th>
              <th>–ü—Ä–∏–º—ñ—Ç–∫–∞</th>
            </tr>
          </thead>
          <tbody id="body"></tbody>
          <tfoot>
            <tr>
              <th class="dark" colspan="5">–°–µ—Ä–µ–¥–Ω—î (–æ—Å./—Ä–æ—Å–ª.)</th>
              <th class="dark" id="sumPests">‚Äî</th>
              <th class="dark" id="meanPerPlant">‚Äî</th>
              <th class="dark" id="nPoints">0 —Ç–æ—á–æ–∫</th>
            </tr>
          </tfoot>
        </table>
      </div>

      <div class="grid g2" style="margin-top:12px">
        <div class="box">
          <h3>üìä –†—ñ—à–µ–Ω–Ω—è</h3>
          <p><b>–°–ï–†–ï–î–ù–Ñ, –æ—Å./—Ä–æ—Å–ª.:</b> <span id="avg" class="mono">‚Äî</span></p>
          <p><b>ET, –æ—Å./—Ä–æ—Å–ª.:</b> <span id="etShow" class="mono">‚Äî</span></p>
          <p class="mono" id="decision">‚Äî</p>
        </div>
        <div class="box">
          <h3>üìÑ –ï–∫—Å–ø–æ—Ä—Ç —É Sheets</h3>
          <div id="csv" class="out">‚Äî</div>
          <p class="small">–§–æ—Ä–º–∞—Ç CSV: <span class="mono"># | –î–∞—Ç–∞ | –ü–æ–ª–µ | –ö—É–ª—å—Ç—É—Ä–∞ | –†–æ—Å–ª–∏–Ω_—Ä–∞—Ö | –®–∫—ñ–¥–Ω–∏–∫—ñ–≤ | –û—Å./—Ä–æ—Å–ª. | –ü—Ä–∏–º—ñ—Ç–∫–∞</span></p>
        </div>
      </div>
      <p class="small muted">–ö–æ–Ω—Ç—Ä–∞—Å—Ç –¥–ª—è —Ç–µ–º–Ω–∏—Ö –∫–ª—ñ—Ç–∏–Ω–æ–∫ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–æ: —Ç–µ–∫—Å—Ç —Å–≤—ñ—Ç–ª–∏–π, —ñ–∫–æ–Ω–∫–∏/—Ç–µ–≥–∏ –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ñ.</p>
    </div>

    <!-- –•–Ü–î –†–û–ë–û–¢–ò, –û–¶–Ü–ù–Æ–í–ê–ù–ù–Ø -->
    <div class="card">
      <h2>ü™ú –•—ñ–¥ —Ä–æ–±–æ—Ç–∏ (45‚Äì70 —Ö–≤)</h2>
      <ol>
        <li>–ó–∞–ø–æ–≤–Ω–∏ –µ–∫–æ–Ω–æ–º—ñ—á–Ω—ñ/–±—ñ–æ–ª–æ–≥—ñ—á–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ (C, V=—Ü—ñ–Ω–∞, I, D, K) ‚Üí <b>–ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</b> EIL —ñ ET.</li>
        <li>–ó—Ä–æ–±–∏ 10‚Äì20 —Ç–æ—á–æ–∫ –≤—ñ–¥–±–æ—Ä—É (–ø–æ 10 —Ä–æ—Å–ª–∏–Ω –Ω–∞ —Ç–æ—á–∫—É –∞–±–æ —ñ–Ω—à–∞ —Å—Ç–∞–ª–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å) ‚Üí –≤–Ω–µ—Å–∏ –≤ —Ç–∞–±–ª–∏—Ü—é.</li>
        <li>–ù–∞—Ç–∏—Å–Ω–∏ <b>–ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</b> ‚Üí –æ—Ç—Ä–∏–º–∞—î—à —Å–µ—Ä–µ–¥–Ω—é —â—ñ–ª—å–Ω—ñ—Å—Ç—å —ñ –≤–∏—Å–Ω–æ–≤–æ–∫ (–¥—ñ—è—Ç–∏/—Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏).</li>
        <li>–°–∫–æ–ø—ñ—é–π CSV, –≤—Å—Ç–∞–≤ —É Google Sheets (–∞—Ä–∫—É—à <span class="mono">PestScout</span>) —Ç–∞ –ø–æ–±—É–¥—É–π –≥—Ä–∞—Ñ—ñ–∫ ¬´–û—Å./—Ä–æ—Å–ª.¬ª.</li>
      </ol>
    </div>

    <div class="card">
      <h2>‚úÖ –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è (10 –±–∞–ª—ñ–≤)</h2>
      <table class="table">
        <thead><tr><th>–ö—Ä–∏—Ç–µ—Ä—ñ–π</th><th>–ë–∞–ª–∏</th></tr></thead>
        <tbody>
          <tr><td>–ö–æ—Ä–µ–∫—Ç–Ω–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ EIL/ET (–∑ –∞–¥–µ–∫–≤–∞—Ç–Ω–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏)</td><td>3</td></tr>
          <tr><td>–ú—ñ–Ω—ñ–º—É–º 10 —Ç–æ—á–æ–∫ –≤—ñ–¥–±–æ—Ä—É –∑ –æ—Å–º–∏—Å–ª–µ–Ω–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏</td><td>3</td></tr>
          <tr><td>–û–±“ë—Ä—É–Ω—Ç–æ–≤–∞–Ω–µ —Ä—ñ—à–µ–Ω–Ω—è ¬´–æ–±–ø—Ä–∏—Å–∫–æ–≤—É–≤–∞—Ç–∏/—Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏¬ª</td><td>2</td></tr>
          <tr><td>CSV —É Sheets + –∫–æ—Ä–æ—Ç–∫–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫ (3 —Ä–µ—á–µ–Ω–Ω—è)</td><td>2</td></tr>
        </tbody>
      </table>
      <p class="pill">ü™≤ EIL</p><p class="pill">‚ö†Ô∏è ET</p><p class="pill">üì± –°–∫–∞—É—Ç–∏–Ω–≥</p><p class="pill">üìä CSV ‚Üí Sheets</p>
    </div>
  </div>

<script>
  // –†–µ–∂–∏–º ¬´–≤–±—É–¥–æ–≤–∞–Ω–æ¬ª
  (function(){ if (window.self !== window.top) document.documentElement.classList.add('embedded'); })();

  // –ï–∫–æ–Ω–æ–º—ñ—á–Ω—ñ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏: EIL, ET
  function recalcEIL(){
    const C = num('C');              // –≥—Ä–Ω/–≥–∞
    const V = num('price');          // –≥—Ä–Ω/—Ç
    const I = num('I');              // —É—à–∫–æ–¥–∂–µ–Ω–Ω—è –Ω–∞ –æ–¥–Ω—É –æ—Å–æ–±–∏–Ω—É
    const D = num('D');              // –≤—Ç—Ä–∞—Ç–∏, —Ç/–≥–∞ –Ω–∞ 1 –æ–¥. —É—à–∫–æ–¥–∂–µ–Ω–Ω—è
    const K = num('K');              // –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å (0..1)
    if([C,V,I,D,K].some(x=>!(x>0))){
      alert('–ü–µ—Ä–µ–≤—ñ—Ä C, V, I, D, K ‚Äî –≤—Å—ñ –º–∞—é—Ç—å –±—É—Ç–∏ > 0'); return;
    }
    // EIL = C / (V * I * D * K) ‚Äî –≤ –æ–¥–∏–Ω–∏—Ü—è—Ö "–æ—Å–æ–±–∏–Ω–∏ –Ω–∞ —Ä–æ—Å–ª–∏–Ω—É"
    const EIL = C / (V * I * D * K);
    const ET = EIL * 0.8; // –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–æ
    out('EIL', round(EIL,3));
    out('ET', round(ET,3));
    out('etShow', round(ET,3));
    recalcStats(); // –æ–Ω–æ–≤–∏—Ç–∏ —Ä—ñ—à–µ–Ω–Ω—è
  }

  // –¢–∞–±–ª–∏—Ü—è –≤—ñ–¥–±–æ—Ä—É –ø—Ä–æ–±
  const bodyEl = document.getElementById('body');
  const csvEl  = document.getElementById('csv');

  function addRow(sample){
    const now = new Date();
    const def = {
      date: (new Date(now.getFullYear(), now.getMonth(), now.getDate())).toISOString().slice(0,10),
      field:'F-01', crop: get('crop') || '–ü—à–µ–Ω–∏—Ü—è –æ–∑–∏–º–∞',
      plants: 10, pests: 3, note:''
    };
    const s = Object.assign(def, sample||{});
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td class="idx">1</td>
      <td><input type="date" value="${s.date}"/></td>
      <td><input type="text" value="${s.field}"/></td>
      <td><input type="text" value="${s.crop}"/></td>
      <td><input type="number" step="1" value="${s.plants}"/></td>
      <td><input type="number" step="1" value="${s.pests}"/></td>
      <td class="dark dens">‚Äî</td>
      <td><input type="text" value="${s.note}"/></td>
    `;
    bodyEl.appendChild(tr);
    reindex();
  }

  function reindex(){
    [...bodyEl.querySelectorAll('tr')].forEach((tr,i)=>tr.querySelector('.idx').textContent = i+1);
  }

  function recalcStats(){
    const rows = [...bodyEl.querySelectorAll('tr')];
    if(!rows.length){ out('sumPests','‚Äî'); out('meanPerPlant','‚Äî'); out('nPoints','0 —Ç–æ—á–æ–∫'); out('avg','‚Äî'); out('decision','‚Äî'); csvEl.textContent='‚Äî'; return; }

    let sumPests=0, sumPlants=0;
    rows.forEach(tr=>{
      const plants = parseFloat(tr.children[4].querySelector('input').value||'0');
      const pests  = parseFloat(tr.children[5].querySelector('input').value||'0');
      const dens   = (plants>0) ? (pests/plants) : 0;
      tr.querySelector('.dens').textContent = round(dens,3);
      sumPests += pests;
      sumPlants += plants;
    });

    const meanPerPlant = sumPlants>0 ? sumPests/sumPlants : 0;
    out('sumPests', sumPests);
    out('meanPerPlant', round(meanPerPlant,3));
    out('nPoints', `${rows.length} —Ç–æ—á–æ–∫`);
    out('avg', round(meanPerPlant,3));

    // –†—ñ—à–µ–Ω–Ω—è
    const ETtxt = document.getElementById('ET').textContent.trim();
    const ET = ETtxt && ETtxt!=='‚Äî' ? parseFloat(ETtxt.replace(',','.')) : NaN;

    if(!isNaN(ET)){
      let msg='';
      if(meanPerPlant >= ET){
        msg = `‚úÖ –°–ï–†–ï–î–ù–Ñ = ${round(meanPerPlant,3)} –æ—Å./—Ä–æ—Å–ª. ‚â• ET = ${round(ET,3)} ‚Üí –†–ï–ö–û–ú–ï–ù–î–ê–¶–Ü–Ø: –û–±–ø—Ä–∏—Å–∫—É–≤–∞—Ç–∏ (–∑–∞ —Å–ø—Ä–∏—è—Ç–ª–∏–≤–æ—ó –ø–æ–≥–æ–¥–∏ —ñ –≤–∏–±–æ—Ä—É –ó–ó–†).`;
      }else if(meanPerPlant >= ET*0.8){
        msg = `‚ö†Ô∏è –°–ï–†–ï–î–ù–Ñ = ${round(meanPerPlant,3)} –æ—Å./—Ä–æ—Å–ª. –±–ª–∏–∑—å–∫–æ –¥–æ ET (${round(ET,3)}). –†–ï–ö–û–ú–ï–ù–î–ê–¶–Ü–Ø: –ü–æ—Å–∏–ª–∏—Ç–∏ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ (–ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ –∑–∞–≤—Ç—Ä–∞/—á–µ—Ä–µ–∑ 2 –¥–Ω—ñ).`;
      }else{
        msg = `‚ÑπÔ∏è –°–ï–†–ï–î–ù–Ñ = ${round(meanPerPlant,3)} –æ—Å./—Ä–æ—Å–ª. < ET = ${round(ET,3)}. –†–ï–ö–û–ú–ï–ù–î–ê–¶–Ü–Ø: –°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏.`;
      }
      const dec = document.getElementById('decision');
      dec.textContent = msg;
      dec.style.color = (meanPerPlant >= ET) ? '#10b981' : (meanPerPlant >= ET*0.8 ? '#f59e0b' : '');
    }

    buildCSV();
  }

  function buildCSV(){
    const lines = [...bodyEl.querySelectorAll('tr')].map(tr=>{
      const idx = tr.querySelector('.idx').textContent.trim();
      const date = tr.children[1].querySelector('input').value.trim();
      const field = tr.children[2].querySelector('input').value.trim();
      const crop  = tr.children[3].querySelector('input').value.trim();
      const plants= tr.children[4].querySelector('input').value.trim();
      const pests = tr.children[5].querySelector('input').value.trim();
      const dens  = tr.querySelector('.dens').textContent.trim();
      const note  = tr.children[7].querySelector('input').value.trim();
      return [idx,date,field,crop,plants,pests,dens,note].join(' | ');
    });
    csvEl.textContent = lines.join('\n') || '‚Äî';
  }

  function copyCSV(){
    const t = csvEl.textContent.trim();
    if(!t || t==='‚Äî'){ alert('–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è'); return; }
    navigator.clipboard.writeText(t).then(()=>flash('‚úÖ CSV —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'),()=>flash('–ù–µ –≤–¥–∞–ª–æ—Å—è —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏'));
  }

  function preset(){
    // 10 —Ç–æ—á–æ–∫ √ó 10 —Ä–æ—Å–ª–∏–Ω: —É–º–æ–≤–Ω–∞ —Å–∏—Ç—É–∞—Ü—ñ—è "–Ω–∞ –º–µ–∂—ñ"
    bodyEl.innerHTML = '';
    const vals = [2,3,4,1,5,3,4,2,3,4]; // —à–∫—ñ–¥–Ω–∏–∫–∏ –Ω–∞ 10 —Ä–æ—Å–ª–∏–Ω
    vals.forEach((p,i)=>addRow({pests:p, plants:10, field: 'F-0'+((i%3)+1)}));
    recalcStats();
  }

  // –£—Ç–∏–ª—ñ—Ç–∏
  function num(id){ return parseFloat((document.getElementById(id).value||'').replace(',','.'))||0; }
  function out(id, v){ document.getElementById(id).textContent = v; }
  function get(id){ return (document.getElementById(id).value||'').trim(); }
  function round(n,d=3){ return Number((+n).toFixed(d)); }
  function flash(msg){ const o=document.title; document.title=msg; setTimeout(()=>document.title=o,900); }

  // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
  recalcEIL();
  addRow(); addRow(); addRow(); // –∫—ñ–ª—å–∫–∞ —Ä—è–¥–∫—ñ–≤ –¥–ª—è —Å—Ç–∞—Ä—Ç—É
  recalcStats();
</script>
</body>
</html>
