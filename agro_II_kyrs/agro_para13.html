<!-- agro_para13.html
     –ü–ê–†–ê 13 (–∞—É–¥–∏—Ç–æ—Ä–Ω–æ) –¥–ª—è –∞–≥—Ä–æ–Ω–æ–º—ñ–≤
     –¢–µ–º–∞: –ü–õ–ê–ù–£–í–ê–ù–ù–Ø –ü–û–õ–¨–û–í–û–á –û–ü–ï–†–ê–¶–Ü–á ‚Äî –ø–ª–æ—â–∞ –∑–∞ –ø—Ä–æ—Ö–æ–¥–∞–º–∏, –Ω–∞—Å—ñ–Ω–Ω—è/–¥–æ–±—Ä–∏–≤–∞, –ü–ú–ú, —á–∞—Å, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
     –§–æ–∫—É—Å: —Ç–µ–ª–µ—Ñ–æ–Ω–∏/–ü–ö; –±–µ–∑ –±—ñ–±–ª—ñ–æ—Ç–µ–∫; –≤—Å–µ –ª–æ–∫–∞–ª—å–Ω–æ. –ö–æ–Ω—Ç—Ä–∞—Å—Ç —Ç–µ–º–Ω–∏—Ö –∫–ª—ñ—Ç–∏–Ω–æ–∫ ‚Üí —Å–≤—ñ—Ç–ª–∏–π —Ç–µ–∫—Å—Ç.

     –©–æ —Ä–æ–±–∏–º–æ:
     ‚Ä¢ –í–Ω–æ—Å–∏–º–æ –ø—Ä–æ—Ö–æ–¥–∏ (–¥–æ–≤–∂–∏–Ω–∞ –≥–æ–Ω—É, –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ—Ö–æ–¥—ñ–≤, —à–∏—Ä–∏–Ω–∞ –∑–∞—Ö–≤–∞—Ç—É, % –ø–µ—Ä–µ–∫—Ä–∏—Ç—Ç—è, —à–≤–∏–¥–∫—ñ—Å—Ç—å, –≤–∏—Ç—Ä–∞—Ç–∞ –ø–∞–ª—å–Ω–æ–≥–æ).
     ‚Ä¢ –û—Ç—Ä–∏–º—É—î–º–æ –ø–ª–æ—â—É (–≥–∞), —á–∞—Å (–≥–æ–¥), –≤–∏—Ç—Ä–∞—Ç—É –ø–∞–ª—å–Ω–æ–≥–æ (–ª), –Ω–∞—Å—ñ–Ω–Ω—è/–¥–æ–±—Ä–∏–≤–∞/–ó–ó–† –∑–∞ –Ω–æ—Ä–º–∞–º–∏ —Ç–∞ –º—ñ—à–∫–∞–º–∏/–±–µ–≥–∞–º–∏.
     ‚Ä¢ –ü–ª–∞–Ω—É—î–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (–º—ñ—Å—Ç–∫—ñ—Å—Ç—å –±—É–Ω–∫–µ—Ä–∞/—Å—ñ–≤–∞–ª–∫–∏/–æ–±–ø—Ä–∏—Å–∫—É–≤–∞—á–∞).
     ‚Ä¢ –ï–∫—Å–ø–æ—Ä—Ç —É CSV –¥–ª—è Google Sheets. –ì–æ—Ç–æ–≤–æ –¥–ª—è GitHub Pages / iFrame —É Moodle.
-->
<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>–ü–∞—Ä–∞ 13 ‚Äî –ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è –ø–æ–ª—å–æ–≤–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó: –ø–ª–æ—â–∞, —Ä–µ—Å—É—Ä—Å–∏, —á–∞—Å, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</title>
<meta name="color-scheme" content="light dark">
<style>
  :root{
    --bg:#0b1220; --card:#0f172a; --muted:#94a3b8; --text:#e2e8f0;
    --accent:#22c55e; --accent-2:#60a5fa; --warn:#f59e0b; --bad:#ef4444; --good:#10b981; --line:#1f2937;
    --darkcell:#0b1324; --darkink:#e6eef9; --darkink2:#e5e7eb;
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:linear-gradient(180deg,#0b1220,#111827 30%,#0b1220);
    color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif; line-height:1.55
  }
  .wrap{max-width:1100px; margin:0 auto; padding:24px 16px 64px}
  .badge{display:inline-block; padding:6px 10px; border:1px solid var(--line); background:#0b1220; border-radius:999px; font-size:12px; color:var(--muted); letter-spacing:.3px}
  h1{font-size:34px; margin:6px 0 12px; line-height:1.15;
     background:linear-gradient(90deg,#60a5fa,#22c55e); -webkit-background-clip:text; -webkit-text-fill-color:transparent}
  h2{font-size:22px; margin:28px 0 12px}
  h3{font-size:18px; margin:20px 0 8px; color:#cbd5e1}
  p{margin:10px 0}
  .small{font-size:12px; color:#9fb0c8}
  .muted{color:#93a3b5}
  .pill{display:inline-block; padding:4px 10px; border:1px solid #223049; border-radius:999px; font-size:12px; color:#a5b4fc; background:#0d1a2e; margin-right:6px}

  .card{background:linear-gradient(180deg,#0f172a,#0b1220); border:1px solid var(--line); border-radius:16px; padding:16px; margin:12px 0; box-shadow:0 6px 24px rgba(0,0,0,.25)}
  .box{border:1px solid #223049; border-radius:12px; padding:12px; background:var(--darkcell); color:var(--darkink)}
  .ok{color:var(--good)} .warn{color:var(--warn)} .bad{color:var(--bad)}
  .mono,code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
  .btn{display:inline-block; padding:10px 14px; border-radius:10px; border:1px solid #223049; background:#0d1a2e; color:#dbeafe; text-decoration:none; cursor:pointer}
  .btn:hover{background:#0f1f39}
  .row{display:flex; gap:10px; flex-wrap:wrap}
  .grid{display:grid; gap:12px}
  .g2{grid-template-columns:repeat(2,minmax(0,1fr))}
  .g3{grid-template-columns:repeat(3,minmax(0,1fr))}
  @media (max-width:1000px){.g2,.g3{grid-template-columns:1fr}}

  .table{width:100%; border-collapse:separate; border-spacing:0; overflow:auto; border-radius:12px; border:1px solid #223049}
  .table th,.table td{padding:8px 10px; border-bottom:1px solid #1f2937; font-size:14px; vertical-align:top}
  .table thead th{background:#0c1629; color:#a5b4fc; text-align:left; position:sticky; top:0}
  .table tbody tr:nth-child(even){background:var(--darkcell); color:var(--darkink2)}
  .table td.dark, .table th.dark{background:var(--darkcell) !important; color:var(--darkink2) !important}
  .out{background:var(--darkcell); color:var(--darkink2); border:1px dashed #263042; padding:10px 12px; border-radius:10px; word-break:break-all}

  input[type="text"], input[type="number"]{
    width:100%; padding:8px 10px; border-radius:10px; border:1px solid #223049; background:#0d1a2e; color:#e6eef9
  }

  /* –í–±—É–¥–æ–≤–∞–Ω–æ (iframe) ‚Üí —Å–≤—ñ—Ç–ª–∏–π –≤–∏–≥–ª—è–¥ */
  html.embedded body{background:#fff; color:#111}
  html.embedded .card{background:#fff; border:1px solid #e5e7eb; box-shadow:none}
  html.embedded h1{-webkit-text-fill-color:initial; background:none; color:#111}
  html.embedded .btn{background:#111827; color:#fff; border-color:#111827}
  html.embedded .box{background:#f8fafc; color:#111}
  html.embedded .table tbody tr:nth-child(even){background:#f3f4f6; color:#111}

  @media print{
    @page{ margin:12mm }
    .no-print{ display:none !important }
  }
</style>
</head>
<body>
  <div class="wrap">
    <span class="badge">–ü–∞—Ä–∞ 13 ¬∑ –∞—É–¥–∏—Ç–æ—Ä–Ω–æ ¬∑ –∞–≥—Ä–æ–Ω–æ–º–∏</span>
    <h1>üöú –ü–ª–∞–Ω—É–≤–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ—ó: –ø–ª–æ—â–∞ –∑–∞ –ø—Ä–æ—Ö–æ–¥–∞–º–∏ ‚Üí –Ω–∞—Å—ñ–Ω–Ω—è/–¥–æ–±—Ä–∏–≤–∞/–ó–ó–† ‚Üí –ü–ú–ú ‚Üí —á–∞—Å ‚Üí –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</h1>

    <div class="card">
      <h2>üéØ –ú–µ—Ç–∞</h2>
      <p>
        –ó–∞ –ø–∞—Ä—É —Å—Ç—É–¥–µ–Ω—Ç–∏ —Å–ø–ª–∞–Ω—É—é—Ç—å –æ–¥–Ω—É –ø–æ–ª—å–æ–≤—É –æ–ø–µ—Ä–∞—Ü—ñ—é (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Å—ñ–≤–±—É/—Ä–æ–∑–∫–∏–¥–∞–Ω–Ω—è/–æ–±–ø—Ä–∏—Å–∫—É–≤–∞–Ω–Ω—è) –¥–ª—è 1‚Äì3 –ø–æ–ª—ñ–≤:
        –≤–Ω–µ—Å—É—Ç—å <b>–ø—Ä–æ—Ö–æ–¥–∏</b>, –æ—Ç—Ä–∏–º–∞—é—Ç—å <b>–ø–ª–æ—â—É</b>, <b>—á–∞—Å</b>, <b>–ø–∞–ª–∏–≤–æ</b>, <b>–∫—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–∞—Å—ñ–Ω–Ω—è/–¥–æ–±—Ä–∏–≤/–ó–ó–†</b>,
        –∞ —Ç–∞–∫–æ–∂ <b>–ø–ª–∞–Ω –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å</b> –∑–∞ –º—ñ—Å—Ç–∫—ñ—Å—Ç—é –∞–≥—Ä–µ–≥–∞—Ç—É. –†–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî <b>CSV</b> –¥–ª—è Sheets.
      </p>
      <p class="small">–ï—Ñ–µ–∫—Ç–∏–≤–Ω–∞ —à–∏—Ä–∏–Ω–∞ –∑–∞—Ö–≤–∞—Ç—É: <span class="mono">W·µâ·∂†·∂† = W √ó (1 ‚àí Overlap%)</span>.
        –ü–ª–æ—â–∞ (–≥–∞): <span class="mono">A = (L √ó Passes √ó W·µâ·∂†·∂†) / 10 000</span>, –¥–µ <span class="mono">L</span> ‚Äî –¥–æ–≤–∂–∏–Ω–∞ –≥–æ–Ω—É (–º).</p>
    </div>

    <!-- –ü–ê–†–ê–ú–ï–¢–†–ò –û–ü–ï–†–ê–¶–Ü–á -->
    <div class="card">
      <h2>‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –æ–ø–µ—Ä–∞—Ü—ñ—ó —Ç–∞ –Ω–æ—Ä–º–∏</h2>
      <div class="grid g3">
        <div class="box">
          <h3>–ó–∞–≥–∞–ª—å–Ω–µ</h3>
          <div class="row">
            <div style="flex:1"><label>–û–ø–µ—Ä–∞—Ü—ñ—è</label><input id="op" type="text" value="–°—ñ–≤–±–∞ —è—á–º–µ–Ω—é"></div>
            <div style="flex:1"><label>–ö–æ–¥ –∑–º—ñ–Ω–∏</label><input id="shift" type="text" value="S-01"></div>
          </div>
          <div class="row" style="margin-top:6px">
            <div style="flex:1"><label>–®–∏—Ä–∏–Ω–∞ –∑–∞—Ö–≤–∞—Ç—É W, –º</label><input id="W" type="number" step="0.01" value="6.0"></div>
            <div style="flex:1"><label>–ü–µ—Ä–µ–∫—Ä–∏—Ç—Ç—è, %</label><input id="Ov" type="number" step="1" value="6"></div>
          </div>
          <p class="small">–ü–µ—Ä–µ–∫—Ä–∏—Ç—Ç—è 0‚Äì15%: –¥–ª—è –æ–±–ø—Ä–∏—Å–∫—É–≤–∞–Ω–Ω—è –∑–∞–∑–≤–∏—á–∞–π –±—ñ–ª—å—à–µ, –¥–ª—è —Å—ñ–≤–±–∏ ‚Äî –º–µ–Ω—à–µ.</p>
        </div>

        <div class="box">
          <h3>–ù–æ—Ä–º–∏ (–Ω–∞ 1 –≥–∞)</h3>
          <div class="row">
            <div style="flex:1"><label>–ù–∞—Å—ñ–Ω–Ω—è, –∫–≥/–≥–∞</label><input id="seedN" type="number" step="0.1" value="180"></div>
            <div style="flex:1"><label>–î–æ–±—Ä–∏–≤–æ, –∫–≥/–≥–∞</label><input id="fertN" type="number" step="0.1" value="120"></div>
          </div>
          <div class="row" style="margin-top:6px">
            <div style="flex:1"><label>–†–æ–±–æ—á–∏–π —Ä–æ–∑—á–∏–Ω/–ó–ó–†, –ª/–≥–∞</label><input id="sprN" type="number" step="0.1" value="0"></div>
            <div style="flex:1"><label>–ü–ú–ú, –ª/–≥–∞ (–æ—Ä—ñ—î–Ω—Ç–∏—Ä)</label><input id="fuelHa" type="number" step="0.1" value="8.5"></div>
          </div>
          <p class="small">–Ø–∫—â–æ –≤—ñ–¥–æ–º–∞ –≤–∏—Ç—Ä–∞—Ç–∞ –ø–∞–ª—å–Ω–æ–≥–æ ¬´–ª/–≥–æ–¥¬ª, –≤–≤–µ–¥–∏ —ó—ó —É —Ç–∞–±–ª–∏—Ü—ñ –ø—Ä–æ—Ö–æ–¥—ñ–≤ ‚Äî –ø—Ä–æ–≥—Ä–∞–º–∞ —Å–∞–º–∞ –ø–µ—Ä–µ—Ä–∞—Ö—É—î.</p>
        </div>

        <div class="box">
          <h3>–õ–æ–≥—ñ—Å—Ç–∏–∫–∞</h3>
          <div class="row">
            <div style="flex:1"><label>–ú—ñ—Å—Ç–∫—ñ—Å—Ç—å –±—É–Ω–∫–µ—Ä–∞/—Ü–∏—Å—Ç–µ—Ä–Ω–∏, –∫–≥/–ª</label><input id="hopper" type="number" step="1" value="3000"></div>
            <div style="flex:1"><label>–í–∞–≥–∞ –º—ñ—à–∫–∞ –Ω–∞—Å—ñ–Ω–Ω—è, –∫–≥</label><input id="bagSeed" type="number" step="1" value="50"></div>
          </div>
          <div class="row" style="margin-top:6px">
            <div style="flex:1"><label>–í–∞–≥–∞ –±—ñ–≥-–±–µ–≥–∞ –¥–æ–±—Ä–∏–≤, –∫–≥</label><input id="bagFert" type="number" step="1" value="600"></div>
            <div style="flex:1"><label>–ö–∞–Ω. –ó–ó–†, –ª</label><input id="canSpr" type="number" step="1" value="10"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- –¢–ê–ë–õ–ò–¶–Ø –ü–†–û–•–û–î–Ü–í -->
    <div class="card">
      <h2>üß± –ü—Ä–æ—Ö–æ–¥–∏ –ø–æ –ø–æ–ª—é/–ø–æ–ª—è—Ö</h2>
      <div class="row">
        <button class="btn" onclick="addRow()">‚ûï –î–æ–¥–∞—Ç–∏ —Ä—è–¥–æ–∫</button>
        <button class="btn" onclick="preset()">üß™ –ü—Ä–∏–∫–ª–∞–¥</button>
        <button class="btn" onclick="recalc()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
        <button class="btn" onclick="copyCSV()">üìã CSV</button>
      </div>
      <div style="overflow:auto; margin-top:8px">
        <table class="table" id="tbl">
          <thead>
            <tr>
              <th>#</th>
              <th>–ü–æ–ª–µ</th>
              <th>–î–æ–≤–∂–∏–Ω–∞ –≥–æ–Ω—É L, –º</th>
              <th>–ö-—Ç—å –ø—Ä–æ—Ö–æ–¥—ñ–≤</th>
              <th>–®–∏—Ä–∏–Ω–∞ W (–º, –æ–ø—Ü.)</th>
              <th>–ü–µ—Ä–µ–∫—Ä., % (–æ–ø—Ü.)</th>
              <th>–®–≤–∏–¥–∫., –∫–º/–≥–æ–¥</th>
              <th>–ü–ú–ú, –ª/–≥–æ–¥ (–æ–ø—Ü.)</th>
              <th class="dark">–ü–ª–æ—â–∞, –≥–∞</th>
              <th class="dark">–ß–∞—Å, –≥–æ–¥</th>
              <th class="dark">–ü–ú–ú, –ª</th>
              <th>–ü—Ä–∏–º—ñ—Ç–∫–∞</th>
            </tr>
          </thead>
          <tbody id="body"></tbody>
          <tfoot>
            <tr>
              <th class="dark" colspan="8">–†–∞–∑–æ–º</th>
              <th class="dark" id="sumA">‚Äî</th>
              <th class="dark" id="sumT">‚Äî</th>
              <th class="dark" id="sumF">‚Äî</th>
              <th></th>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>

    <!-- –†–ï–ó–£–õ–¨–¢–ê–¢–ò -->
    <div class="card">
      <h2>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</h2>
      <div class="grid g3">
        <div class="box">
          <h3>–°—É–º–∞—Ä–Ω–æ –ø–æ –æ–ø–µ—Ä–∞—Ü—ñ—ó</h3>
          <p>–ü–ª–æ—â–∞: <b><span id="Aha">‚Äî</span> –≥–∞</b></p>
          <p>–ß–∞—Å: <b><span id="Th">‚Äî</span> –≥–æ–¥</b> ¬∑ –ü–ú–ú: <b><span id="Fl">‚Äî</span> –ª</b></p>
          <p>–ù–∞—Å—ñ–Ω–Ω—è: <b><span id="SeedKg">‚Äî</span> –∫–≥</b> (<span id="SeedBags">‚Äî</span> –º—ñ—à.)</p>
          <p>–î–æ–±—Ä–∏–≤–æ: <b><span id="FertKg">‚Äî</span> –∫–≥</b> (<span id="FertBags">‚Äî</span> –±—ñ–≥-–±–µ–≥)</p>
          <p>–†–æ–∑—á–∏–Ω/–ó–ó–†: <b><span id="SprL">‚Äî</span> –ª</b> (<span id="SprCans">‚Äî</span> –∫–∞–Ω.)</p>
        </div>
        <div class="box">
          <h3>–ü–ª–∞–Ω –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å</h3>
          <p>–ú—ñ—Å—Ç–∫—ñ—Å—Ç—å: <span id="Hcap">‚Äî</span> ‚Üí –û—Ä—ñ—î–Ω—Ç. –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å: <b><span id="Loads">‚Äî</span></b></p>
          <div id="LoadsPlan" class="out">‚Äî</div>
        </div>
        <div class="box">
          <h3>CSV</h3>
          <div id="csv" class="out">‚Äî</div>
          <p class="small">–§–æ—Ä–º–∞—Ç: <span class="mono"># | –ü–æ–ª–µ | L | Passes | W | Ov% | V_kmh | Fuel_h | A_ha | T_h | F_l | Note</span></p>
        </div>
      </div>
      <p class="small muted">–ö–æ–Ω—Ç—Ä–∞—Å—Ç –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–æ: —Ç–µ–º–Ω—ñ –∫–ª—ñ—Ç–∏–Ω–∫–∏ (<span class="mono">.dark</span>) –∑—ñ —Å–≤—ñ—Ç–ª–∏–º —Ç–µ–∫—Å—Ç–æ–º.</p>
    </div>

    <!-- –•–Ü–î –†–û–ë–û–¢–ò, –û–¶–Ü–ù–Æ–í–ê–ù–ù–Ø -->
    <div class="card">
      <h2>ü™ú –•—ñ–¥ —Ä–æ–±–æ—Ç–∏ (45‚Äì70 —Ö–≤)</h2>
      <ol>
        <li>–ó–∞–ø–æ–≤–Ω–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –æ–ø–µ—Ä–∞—Ü—ñ—ó (W, –ø–µ—Ä–µ–∫—Ä–∏—Ç—Ç—è, –Ω–æ—Ä–º–∏, –ª–æ–≥—ñ—Å—Ç–∏–∫–∞).</li>
        <li>–í–Ω–µ—Å–∏ 3‚Äì6 —Ä—è–¥–∫—ñ–≤ –ø—Ä–æ—Ö–æ–¥—ñ–≤ –ø–æ –æ–¥–Ω–æ–º—É —á–∏ –∫—ñ–ª—å–∫–æ—Ö –ø–æ–ª—è—Ö (–¥–æ–≤–∂–∏–Ω–∞ –≥–æ–Ω—É, –∫-—Ç—å –ø—Ä–æ—Ö–æ–¥—ñ–≤, —à–≤–∏–¥–∫—ñ—Å—Ç—å).</li>
        <li>–ù–∞—Ç–∏—Å–Ω–∏ <b>–ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</b> ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä –ø–ª–æ—â—É, –Ω–∞—Å—ñ–Ω–Ω—è/–¥–æ–±—Ä–∏–≤–∞/–ó–ó–†, —á–∞—Å —ñ –ü–ú–ú. –ó–∞ –ø–æ—Ç—Ä–µ–±–∏ –≤—ñ–¥–∫–æ—Ä–∏–≥—É–π.</li>
        <li>–ü–µ—Ä–µ–≥–ª—è–Ω—å –ø–ª–∞–Ω –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å —ñ <b>—Å–∫–æ–ø—ñ—é–π CSV</b> —É Google Sheets (–∞—Ä–∫—É—à <span class="mono">FieldOps</span>).</li>
      </ol>
    </div>

    <div class="card">
      <h2>‚úÖ –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è (10 –±–∞–ª—ñ–≤)</h2>
      <table class="table">
        <thead><tr><th>–ö—Ä–∏—Ç–µ—Ä—ñ–π</th><th>–ë–∞–ª–∏</th></tr></thead>
        <tbody>
          <tr><td>–ö–æ—Ä–µ–∫—Ç–Ω–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –ø–ª–æ—â—ñ –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –ø–µ—Ä–µ–∫—Ä–∏—Ç—Ç—è</td><td>3</td></tr>
          <tr><td>–†–µ—Å—É—Ä—Å–∏ (–Ω–∞—Å—ñ–Ω–Ω—è/–¥–æ–±—Ä–∏–≤–∞/–ó–ó–†, –ü–ú–ú) —Ç–∞ —á–∞—Å —Ä–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω–æ –π –æ–±“ë—Ä—É–Ω—Ç–æ–≤–∞–Ω–æ</td><td>4</td></tr>
          <tr><td>–õ–æ–≥—ñ—Å—Ç–∏–∫–∞ (–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è) —Å–∫–ª–∞–¥–µ–Ω–∞ –ª–æ–≥—ñ—á–Ω–æ</td><td>2</td></tr>
          <tr><td>CSV —É Sheets + –∫–æ—Ä–æ—Ç–∫—ñ –≤–∏—Å–Ω–æ–≤–∫–∏</td><td>1</td></tr>
        </tbody>
      </table>
      <p class="pill">üìê –ü–ª–æ—â–∞</p><p class="pill">üåæ –ù–∞—Å—ñ–Ω–Ω—è/–¥–æ–±—Ä–∏–≤–∞</p><p class="pill">‚õΩ –ü–ú–ú</p><p class="pill">üì¶ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</p>
    </div>
  </div>

<script>
  // –í–±—É–¥–æ–≤–∞–Ω–∏–π —Ä–µ–∂–∏–º (–¥–ª—è Moodle iFrame)
  (function(){ if (window.self !== window.top) document.documentElement.classList.add('embedded'); })();

  const bodyEl = document.getElementById('body');
  const csvEl  = document.getElementById('csv');

  const byId = id => document.getElementById(id);
  const rnd = (n,d=2) => Number((+n).toFixed(d));

  function addRow(sample){
    const def = { field:'F-01', L: 950, passes: 20, W: '', Ov: '', V: 8.5, FuelH: '', note:'' };
    const s = Object.assign(def, sample||{});
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td class="idx">1</td>
      <td><input type="text" value="${s.field}"></td>
      <td><input type="number" step="1" value="${s.L}"></td>
      <td><input type="number" step="1" value="${s.passes}"></td>
      <td><input type="number" step="0.01" value="${s.W}"></td>
      <td><input type="number" step="1" value="${s.Ov}"></td>
      <td><input type="number" step="0.1" value="${s.V}"></td>
      <td><input type="number" step="0.1" value="${s.FuelH}"></td>
      <td class="dark area">‚Äî</td>
      <td class="dark time">‚Äî</td>
      <td class="dark fuel">‚Äî</td>
      <td><input type="text" value="${s.note}"></td>
    `;
    bodyEl.appendChild(tr);
    reindex();
  }
  function reindex(){ [...bodyEl.querySelectorAll('tr')].forEach((tr,i)=>tr.querySelector('.idx').textContent=i+1); }

  function effectiveWidth(rowW, rowOv){
    const W = parseFloat(rowW) || parseFloat(byId('W').value||'0');
    const Ov = (parseFloat(rowOv) || parseFloat(byId('Ov').value||'0'))/100;
    return Math.max(0, W * (1 - Ov));
  }

  function recalc(){
    let sumA=0, sumT=0, sumF=0;

    [...bodyEl.querySelectorAll('tr')].forEach(tr=>{
      const L = parseFloat(tr.children[2].querySelector('input').value||'0');          // –º
      const passes = parseFloat(tr.children[3].querySelector('input').value||'0');
      const W = tr.children[4].querySelector('input').value;
      const Ov = tr.children[5].querySelector('input').value;
      const V = parseFloat(tr.children[6].querySelector('input').value||'0');          // –∫–º/–≥–æ–¥
      const FuelH = parseFloat(tr.children[7].querySelector('input').value||'0');      // –ª/–≥–æ–¥ (–æ–ø—Ü—ñ–π–Ω–æ)

      const Weff = effectiveWidth(W, Ov); // –º
      const A = (L * passes * Weff) / 10000; // –≥–∞

      // –ß–∞—Å: —à–ª—è—Ö = L*passes (–º) ‚Üí –∫–º; —á–∞—Å = S / V
      const distance_km = (L * passes) / 1000;
      const T = V>0 ? (distance_km / V) : 0;

      // –ü–∞–ª–∏–≤–æ: —è–∫—â–æ –∑–∞–¥–∞–Ω–æ –ª/–≥–æ–¥ ‚Äî F = FuelH * T; —ñ–Ω–∞–∫—à–µ –±–µ—Ä–µ–º–æ –Ω–æ—Ä–º—É –ª/–≥–∞
      const fuelHa = parseFloat(byId('fuelHa').value||'0');
      const F = FuelH>0 ? (FuelH * T) : (fuelHa * A);

      tr.querySelector('.area').textContent = rnd(A,3);
      tr.querySelector('.time').textContent = rnd(T,2);
      tr.querySelector('.fuel').textContent = rnd(F,1);

      sumA += A; sumT += T; sumF += F;
    });

    byId('sumA').textContent = rnd(sumA,3);
    byId('sumT').textContent = rnd(sumT,2);
    byId('sumF').textContent = rnd(sumF,1);

    // –†–µ—Å—É—Ä—Å–∏ –∑–∞ –Ω–æ—Ä–º–∞–º–∏
    const seedKg = sumA * parseFloat(byId('seedN').value||'0');
    const fertKg = sumA * parseFloat(byId('fertN').value||'0');
    const sprL   = sumA * parseFloat(byId('sprN').value||'0');

    byId('Aha').textContent = rnd(sumA,3);
    byId('Th').textContent  = rnd(sumT,2);
    byId('Fl').textContent  = rnd(sumF,1);
    byId('SeedKg').textContent = rnd(seedKg,0);
    byId('FertKg').textContent = rnd(fertKg,0);
    byId('SprL').textContent   = rnd(sprL,0);

    const bagSeed = Math.max(1, parseFloat(byId('bagSeed').value||'50'));
    const bagFert = Math.max(1, parseFloat(byId('bagFert').value||'600'));
    const canSpr  = Math.max(1, parseFloat(byId('canSpr').value||'10'));

    byId('SeedBags').textContent = Math.ceil(seedKg / bagSeed);
    byId('FertBags').textContent = Math.ceil(fertKg / bagFert);
    byId('SprCans').textContent  = Math.ceil(sprL / canSpr);

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (–æ—Ä—ñ—î–Ω—Ç–∏—Ä): –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –Ω–∞–π–±—ñ–ª—å—à—É –∑ —Ç—Ä—å–æ—Ö –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä, —è–∫–∞ –∑–∞–¥–∞–Ω–∞
    const hopper = parseFloat(byId('hopper').value||'0');
    byId('Hcap').textContent = hopper ? (hopper.toLocaleString('uk-UA') + ' –∫–≥/–ª') : '‚Äî';

    // –Ø–∫—â–æ —î —Ä–æ–∑—á–∏–Ω (sprL>0) ‚Äî —Ä–∞—Ö—É—î–º–æ –ø–æ –Ω—å–æ–º—É, —ñ–Ω–∞–∫—à–µ ‚Äî –ø–æ –Ω–∞—Å—ñ–Ω–Ω—é –∞–±–æ –¥–æ–±—Ä–∏–≤—É (—â–æ –±—ñ–ª—å—à–µ –∑–∞ –º–∞—Å–æ—é)
    let massForLoads = 0, label='–†–æ–∑—á–∏–Ω/–ó–ó–†';
    if(sprL>0){ massForLoads = sprL; }
    else if(fertKg>=seedKg){ massForLoads = fertKg; label='–î–æ–±—Ä–∏–≤–æ'; }
    else { massForLoads = seedKg; label='–ù–∞—Å—ñ–Ω–Ω—è'; }

    let loads = 0, plan = '‚Äî';
    if(hopper>0 && massForLoads>0){
      loads = Math.max(1, Math.ceil(massForLoads / hopper));
      const per = massForLoads / loads;
      plan = `${label}: —Ä–∞–∑–æ–º ‚âà ${rnd(massForLoads,0)} (–∫–≥/–ª)\n`+
             `–ú—ñ—Å—Ç–∫—ñ—Å—Ç—å: ${hopper} ‚Üí ${loads} –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å √ó ~${rnd(per,0)} (–∫–≥/–ª)`;
    }
    byId('Loads').textContent = loads || '‚Äî';
    byId('LoadsPlan').textContent = plan;

    buildCSV();
  }

  function buildCSV(){
    const lines = [...bodyEl.querySelectorAll('tr')].map(tr=>{
      const idx = tr.querySelector('.idx').textContent.trim();
      const field = tr.children[1].querySelector('input').value.trim();
      const L = tr.children[2].querySelector('input').value.trim();
      const passes = tr.children[3].querySelector('input').value.trim();
      const W = tr.children[4].querySelector('input').value.trim() || byId('W').value.trim();
      const Ov = tr.children[5].querySelector('input').value.trim() || byId('Ov').value.trim();
      const V = tr.children[6].querySelector('input').value.trim();
      const FuelH = tr.children[7].querySelector('input').value.trim();
      const A = tr.querySelector('.area').textContent.trim();
      const T = tr.querySelector('.time').textContent.trim();
      const F = tr.querySelector('.fuel').textContent.trim();
      const note = tr.children[11].querySelector('input').value.trim();
      return [idx,field,L,passes,W,Ov,V,FuelH,A,T,F,note].join(' | ');
    });
    csvEl.textContent = lines.join('\n') || '‚Äî';
  }

  function copyCSV(){
    const t = csvEl.textContent.trim();
    if(!t || t==='‚Äî'){ alert('–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è'); return; }
    navigator.clipboard.writeText(t).then(()=>flash('‚úÖ CSV —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'),()=>flash('–ù–µ –≤–¥–∞–ª–æ—Å—è'));
  }

  function preset(){
    bodyEl.innerHTML='';
    // 3 –ø—Ä–∏–∫–ª–∞–¥–∏: —Å—ñ–≤–±–∞ –Ω–∞ —Ç—Ä—å–æ—Ö –ø–æ–ª—è—Ö —ñ–∑ —Ä—ñ–∑–Ω–∏–º–∏ –¥–æ–≤–∂–∏–Ω–∞–º–∏ —Ç–∞ —à–≤–∏–¥–∫–æ—Å—Ç—è–º–∏
    addRow({field:'F-01', L:1000, passes:18, W:'', Ov:'', V:8.2, FuelH:''});
    addRow({field:'F-02', L:850,  passes:22, W:'', Ov:'', V:7.8, FuelH:16.5});
    addRow({field:'F-03', L:1200, passes:15, W:'', Ov:8,  V:8.8, FuelH:''});
    recalc();
  }

  function flash(msg){ const o=document.title; document.title=msg; setTimeout(()=>document.title=o,900); }

  // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
  (function init(){ addRow(); addRow(); recalc(); })();
</script>
</body>
</html>
