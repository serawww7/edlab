<!-- agro_para14.html
     –ü–ê–†–ê 14 (–∞—É–¥–∏—Ç–æ—Ä–Ω–æ) –¥–ª—è –∞–≥—Ä–æ–Ω–æ–º—ñ–≤
     –¢–µ–º–∞: –ù–û–†–ú–ê –í–ò–°–Ü–í–£ ‚Äî –≤—ñ–¥ —Ü—ñ–ª—å–æ–≤–æ—ó –≥—É—Å—Ç–æ—Ç–∏ –¥–æ –∫–≥/–≥–∞, –Ω–∞—Å—ñ–Ω–Ω—è/–º, –∫—Ä–æ–∫—É –º—ñ–∂ –Ω–∞—Å—ñ–Ω–∏–Ω–∞–º–∏ —Ç–∞ –≤–∏—Ç—Ä–∞—Ç–∏ –∫–≥/—Ö–≤
     –§–æ–∫—É—Å: —Ç–µ–ª–µ—Ñ–æ–Ω–∏/–ü–ö; –±–µ–∑ –±—ñ–±–ª—ñ–æ—Ç–µ–∫; —É—Å–µ –ª–æ–∫–∞–ª—å–Ω–æ. –ö–æ–Ω—Ç—Ä–∞—Å—Ç —Ç–µ–º–Ω–∏—Ö –∫–ª—ñ—Ç–∏–Ω–æ–∫ ‚Üí —Å–≤—ñ—Ç–ª–∏–π —Ç–µ–∫—Å—Ç.
     –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –¥–ª—è –∫—ñ–ª—å–∫–æ—Ö –ø–æ–ª—ñ–≤/—Å–æ—Ä—Ç—ñ–≤, –ø–ª–∞–Ω –º—ñ—à–∫—ñ–≤, –∫–∞–ª—ñ–±—Ä—É–≤–∞–Ω–Ω—è (–∫–≥/—Ö–≤), CSV.

     –§–æ—Ä–º—É–ª–∏ (–Ω–∞–≤—á–∞–ª—å–Ω–æ):
     ‚Ä¢ –ù–µ–æ–±—Ö—ñ–¥–Ω–æ –Ω–∞—Å—ñ–Ω–∏–Ω/–º¬≤: N = Ptarget / ((G_lab/100) * (E_field/100))
     ‚Ä¢ –ù–æ—Ä–º–∞, –∫–≥/–≥–∞: Rate = N * TKW * 0.01  (–¥–µ TKW ‚Äî –≥/1000 –Ω–∞—Å—ñ–Ω–∏–Ω)
     ‚Ä¢ –ù–∞—Å—ñ–Ω–Ω—è/–º —Ä—è–¥–∫–∞: n_m = N * Row(m)
     ‚Ä¢ –ö—Ä–æ–∫ –º—ñ–∂ –Ω–∞—Å—ñ–Ω–∏–Ω–∞–º–∏: s(cm) = 100 / n_m
     ‚Ä¢ –ü–æ—Ç—ñ–∫ –Ω–∞—Å—ñ–Ω–Ω—è, –∫–≥/—Ö–≤: Flow = Rate * V(km/h) * W(m) / 600
-->
<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>–ü–∞—Ä–∞ 14 ‚Äî –ù–æ—Ä–º–∞ –≤–∏—Å—ñ–≤—É: –∫–≥/–≥–∞, –Ω–∞—Å—ñ–Ω–Ω—è/–º, –∫—Ä–æ–∫, –∫–≥/—Ö–≤, –º—ñ—à–∫–∏</title>
<meta name="color-scheme" content="light dark">
<style>
  :root{
    --bg:#0b1220; --card:#0f172a; --muted:#94a3b8; --text:#e2e8f0;
    --accent:#22c55e; --accent-2:#60a5fa; --warn:#f59e0b; --bad:#ef4444; --good:#10b981; --line:#1f2937;
    --darkcell:#0b1324; --darkink:#e6eef9; --darkink2:#e5e7eb;
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:linear-gradient(180deg,#0b1220,#111827 30%,#0b1220);
    color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif; line-height:1.55
  }
  .wrap{max-width:1100px; margin:0 auto; padding:24px 16px 64px}
  .badge{display:inline-block; padding:6px 10px; border:1px solid var(--line); background:#0b1220; border-radius:999px; font-size:12px; color:var(--muted); letter-spacing:.3px}
  h1{font-size:34px; margin:6px 0 12px; line-height:1.15;
     background:linear-gradient(90deg,#60a5fa,#22c55e); -webkit-background-clip:text; -webkit-text-fill-color:transparent}
  h2{font-size:22px; margin:28px 0 12px}
  h3{font-size:18px; margin:20px 0 8px; color:#cbd5e1}
  p{margin:10px 0}
  .small{font-size:12px; color:#9fb0c8}
  .muted{color:#93a3b5}
  .pill{display:inline-block; padding:4px 10px; border:1px solid #223049; border-radius:999px; font-size:12px; color:#a5b4fc; background:#0d1a2e; margin-right:6px}
  .btn{display:inline-block; padding:10px 14px; border-radius:10px; border:1px solid #223049; background:#0d1a2e; color:#dbeafe; text-decoration:none; cursor:pointer}
  .btn:hover{background:#0f1f39}
  .row{display:flex; gap:10px; flex-wrap:wrap}
  .grid{display:grid; gap:12px}
  .g2{grid-template-columns:repeat(2,minmax(0,1fr))}
  .g3{grid-template-columns:repeat(3,minmax(0,1fr))}
  @media (max-width:1000px){.g2,.g3{grid-template-columns:1fr}}

  .card{background:linear-gradient(180deg,#0f172a,#0b1220); border:1px solid var(--line); border-radius:16px; padding:16px; margin:12px 0; box-shadow:0 6px 24px rgba(0,0,0,.25)}
  .box{border:1px solid #223049; border-radius:12px; padding:12px; background:var(--darkcell); color:var(--darkink)}
  .ok{color:var(--good)} .warn{color:var(--warn)} .bad{color:var(--bad)}
  .mono,code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}

  .table{width:100%; border-collapse:separate; border-spacing:0; overflow:auto; border-radius:12px; border:1px solid #223049}
  .table th,.table td{padding:8px 10px; border-bottom:1px solid #1f2937; font-size:14px; vertical-align:top}
  .table thead th{background:#0c1629; color:#a5b4fc; text-align:left; position:sticky; top:0}
  .table tbody tr:nth-child(even){background:var(--darkcell); color:var(--darkink2)}
  .table td.dark, .table th.dark{background:var(--darkcell) !important; color:var(--darkink2) !important}
  .out{background:var(--darkcell); color:var(--darkink2); border:1px dashed #263042; padding:10px 12px; border-radius:10px; word-break:break-all}

  input[type="text"], input[type="number"]{
    width:100%; padding:8px 10px; border-radius:10px; border:1px solid #223049; background:#0d1a2e; color:#e6eef9
  }

  /* –í–±—É–¥–æ–≤–∞–Ω–æ (iframe) ‚Üí —Å–≤—ñ—Ç–ª–∏–π –≤–∏–≥–ª—è–¥ */
  html.embedded body{background:#fff; color:#111}
  html.embedded .card{background:#fff; border:1px solid #e5e7eb; box-shadow:none}
  html.embedded h1{-webkit-text-fill-color:initial; background:none; color:#111}
  html.embedded .btn{background:#111827; color:#fff; border-color:#111827}
  html.embedded .box{background:#f8fafc; color:#111}
  html.embedded .table tbody tr:nth-child(even){background:#f3f4f6; color:#111}

  @media print{
    @page{ margin:12mm }
    .no-print{ display:none !important }
  }
</style>
</head>
<body>
  <div class="wrap">
    <span class="badge">–ü–∞—Ä–∞ 14 ¬∑ –∞—É–¥–∏—Ç–æ—Ä–Ω–æ ¬∑ –∞–≥—Ä–æ–Ω–æ–º–∏</span>
    <h1>üå± –ù–æ—Ä–º–∞ –≤–∏—Å—ñ–≤—É: –≤—ñ–¥ —Ü—ñ–ª—å–æ–≤–æ—ó –≥—É—Å—Ç–æ—Ç–∏ –¥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—ñ–≤–∞–ª–∫–∏</h1>

    <div class="card">
      <h2>üéØ –ú–µ—Ç–∞</h2>
      <p>
        –ó–∞ –ø–∞—Ä—É —Å—Ç—É–¥–µ–Ω—Ç–∏ –¥–ª—è –∫—ñ–ª—å–∫–æ—Ö –ø–æ–ª—ñ–≤/—Å–æ—Ä—Ç—ñ–≤ –æ–±—á–∏—Å–ª—é—é—Ç—å <b>–Ω–µ–æ–±—Ö—ñ–¥–Ω—É –Ω–æ—Ä–º—É –≤–∏—Å—ñ–≤—É (–∫–≥/–≥–∞)</b> –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º
        <b>–ú1000 (TKW)</b>, <b>—Å—Ö–æ–∂–æ—Å—Ç—ñ</b> —Ç–∞ <b>–ø–æ–ª—å–æ–≤–æ—ó —Å—Ö–æ–∂–æ—Å—Ç—ñ</b>, –æ—Ç—Ä–∏–º—É—é—Ç—å <b>–Ω–∞—Å—ñ–Ω–Ω—è/–º —Ä—è–¥–∫–∞</b>,
        <b>–∫—Ä–æ–∫ –º—ñ–∂ –Ω–∞—Å—ñ–Ω–∏–Ω–∞–º–∏</b> —Ç–∞ <b>–ø–æ—Ç—ñ–∫ –Ω–∞—Å—ñ–Ω–Ω—è (–∫–≥/—Ö–≤)</b> –¥–ª—è –∫–∞–ª—ñ–±—Ä—É–≤–∞–Ω–Ω—è. –ù–∞ –≤–∏—Ö–æ–¥—ñ ‚Äî <b>–ø–ª–∞–Ω –º—ñ—à–∫—ñ–≤</b> —ñ <b>CSV</b>.
      </p>
      <p class="small">–ü–∞–º º—è—Ç–∫–∞: –ø–æ–ª—å–æ–≤–∞ —Å—Ö–æ–∂—ñ—Å—Ç—å (E_field) –≤—Ä–∞—Ö–æ–≤—É—î –≤—Ç—Ä–∞—Ç–∏ –≤—ñ–¥ “ë—Ä—É–Ω—Ç–æ–≤–∏—Ö —É–º–æ–≤/—à–∫—ñ–¥–Ω–∏–∫—ñ–≤ —ñ –∑–∞–∑–≤–∏—á–∞–π <span class="mono">0.75‚Äì0.9</span>.</p>
    </div>

    <!-- –ü–ê–†–ê–ú–ï–¢–†–ò –°–Ü–í–ê–õ–ö–ò –¢–ê –õ–û–ì–Ü–°–¢–ò–ö–ò -->
    <div class="card">
      <h2>‚öôÔ∏è –°—ñ–≤–∞–ª–∫–∞ —Ç–∞ –ª–æ–≥—ñ—Å—Ç–∏–∫–∞</h2>
      <div class="grid g3">
        <div class="box">
          <h3>–°—ñ–≤–∞–ª–∫–∞</h3>
          <div class="row">
            <div style="flex:1"><label>–†–æ–±–æ—á–∞ —à–∏—Ä–∏–Ω–∞ W, –º</label><input id="W" type="number" step="0.01" value="6.0"></div>
            <div style="flex:1"><label>–ú—ñ–∂—Ä—è–¥–¥—è, —Å–º</label><input id="rowCm" type="number" step="0.1" value="15.0"></div>
          </div>
          <div class="row" style="margin-top:6px">
            <div style="flex:1"><label>–®–≤–∏–¥–∫—ñ—Å—Ç—å, –∫–º/–≥–æ–¥</label><input id="V" type="number" step="0.1" value="8.5"></div>
            <div style="flex:1"><label>–ú—ñ—Å—Ç–∫—ñ—Å—Ç—å –±—É–Ω–∫–µ—Ä–∞, –∫–≥</label><input id="hopper" type="number" step="1" value="3000"></div>
          </div>
        </div>

        <div class="box">
          <h3>–ú—ñ—à–∫–∏/–±—ñ–≥-–±–µ–≥–∏</h3>
          <div class="row">
            <div style="flex:1"><label>–í–∞–≥–∞ –º—ñ—à–∫–∞, –∫–≥</label><input id="bag" type="number" step="1" value="50"></div>
            <div style="flex:1"><label>–î–æ–¥. –∑–∞–ø–∞—Å, %</label><input id="reserve" type="number" step="1" value="3"></div>
          </div>
          <p class="small">–ó–∞–ø–∞—Å –ø–æ–∫—Ä–∏–≤–∞—î –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ —Ä–æ–∑–≥—ñ–Ω/–∑—É–ø–∏–Ω–∫–∏.</p>
        </div>

        <div class="box">
          <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
          <div class="row">
            <button class="btn" onclick="addRow()">‚ûï –î–æ–¥–∞—Ç–∏ –ø–æ–ª–µ/—Å–æ—Ä—Ç</button>
            <button class="btn" onclick="preset()">üß™ –ü—Ä–∏–∫–ª–∞–¥</button>
            <button class="btn" onclick="recalc()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
            <button class="btn" onclick="copyCSV()">üìã CSV</button>
          </div>
        </div>
      </div>
    </div>

    <!-- –¢–ê–ë–õ–ò–¶–Ø –ü–û–õ–Ü–í/–°–û–†–¢–Ü–í -->
    <div class="card">
      <h2>üß± –ü–æ–ª—è / —Å–æ—Ä—Ç–∏</h2>
      <div style="overflow:auto">
        <table class="table" id="tbl">
          <thead>
            <tr>
              <th>#</th>
              <th>–ü–æ–ª–µ</th>
              <th>–ö—É–ª—å—Ç—É—Ä–∞/–°–æ—Ä—Ç</th>
              <th>–ü–ª–æ—â–∞, –≥–∞</th>
              <th>–¶—ñ–ª—å —Ä–æ—Å–ª–∏–Ω, —à—Ç/–º¬≤</th>
              <th>TKW (–≥/1000)</th>
              <th>–°—Ö–æ–∂—ñ—Å—Ç—å, %</th>
              <th>–ü–æ–ª—å–æ–≤–∞ —Å—Ö–æ–∂—ñ—Å—Ç—å, %</th>
              <th class="dark">–ù–∞—Å—ñ–Ω–∏–Ω/–º¬≤</th>
              <th class="dark">–∫–≥/–≥–∞</th>
              <th class="dark">–ù–∞—Å—ñ–Ω–∏–Ω/–º</th>
              <th class="dark">–ö—Ä–æ–∫, —Å–º</th>
              <th class="dark">–∫–≥ –Ω–∞ –ø–æ–ª–µ</th>
              <th class="dark">–ú—ñ—à–∫–∏</th>
              <th class="dark">–∫–≥/—Ö–≤ (–∫–∞–ª—ñ–±—Ä.)</th>
              <th>–ü—Ä–∏–º—ñ—Ç–∫–∞</th>
            </tr>
          </thead>
          <tbody id="body"></tbody>
          <tfoot>
            <tr>
              <th class="dark" colspan="12">–†–∞–∑–æ–º</th>
              <th class="dark" id="sumKg">‚Äî</th>
              <th class="dark" id="sumBags">‚Äî</th>
              <th class="dark" id="sumFlow">‚Äî</th>
              <th></th>
            </tr>
          </tfoot>
        </table>
      </div>
      <div id="csv" class="out" style="margin-top:8px">‚Äî</div>
      <p class="small">CSV: <span class="mono"># | –ü–æ–ª–µ | –ö—É–ª—å—Ç—É—Ä–∞ | –ü–ª–æ—â–∞_–≥–∞ | –¶—ñ–ª—å_—à—Ç–º2 | TKW | –°—Ö–æ–∂—ñ—Å—Ç—å_% | –ü–æ–ª—å–æ–≤–∞_% | –ù–∞—Å—ñ–Ω–∏–Ω_–º2 | –∫–≥_–≥–∞ | –ù–∞—Å—ñ–Ω–∏–Ω_–º | –ö—Ä–æ–∫_—Å–º | –∫–≥_–ø–æ–ª–µ | –ú—ñ—à–∫–∏ | –∫–≥_—Ö–≤ | –ü—Ä–∏–º—ñ—Ç–∫–∞</span></p>
      <p class="small muted">–ö–æ–Ω—Ç—Ä–∞—Å—Ç –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–æ: —Ç–µ–º–Ω—ñ –∫–ª—ñ—Ç–∏–Ω–∫–∏ (<span class="mono">.dark</span>) –º–∞—é—Ç—å —Å–≤—ñ—Ç–ª–∏–π —Ç–µ–∫—Å—Ç.</p>
    </div>

    <!-- –ü–Ü–î–°–£–ú–ö–ò —Ç–∞ –ü–õ–ê–ù –ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–¨ -->
    <div class="card">
      <h2>üìä –ü—ñ–¥—Å—É–º–∫–∏ —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</h2>
      <div class="grid g2">
        <div class="box">
          <h3>–°—É–º–∞—Ä–Ω–æ</h3>
          <p>–ù–∞—Å—ñ–Ω–Ω—è —Ä–∞–∑–æ–º: <b><span id="sumKg2">‚Äî</span> –∫–≥</b> ¬∑ <b><span id="sumBags2">‚Äî</span> –º—ñ—à.</b></p>
          <p>–û—Ä—ñ—î–Ω—Ç–æ–≤–Ω–∏–π –ø–æ—Ç—ñ–∫: <b><span id="flowNote">‚Äî</span></b></p>
        </div>
        <div class="box">
          <h3>–ü–ª–∞–Ω –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å</h3>
          <p>–ú—ñ—Å—Ç–∫—ñ—Å—Ç—å –±—É–Ω–∫–µ—Ä–∞: <b><span id="Hcap">‚Äî</span></b></p>
          <p>–û—Ä—ñ—î–Ω—Ç–æ–≤–Ω–æ: <b><span id="Loads">‚Äî</span> –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å</b></p>
          <div id="LoadsPlan" class="out">‚Äî</div>
        </div>
      </div>
    </div>

    <!-- –•–Ü–î –†–û–ë–û–¢–ò, –û–¶–Ü–ù–Æ–í–ê–ù–ù–Ø -->
    <div class="card">
      <h2>ü™ú –•—ñ–¥ —Ä–æ–±–æ—Ç–∏ (45‚Äì70 —Ö–≤)</h2>
      <ol>
        <li>–í–Ω–µ—Å–∏ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø–æ–ª—è: –ø–ª–æ—â—É, TKW, –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—É —Ç–∞ –ø–æ–ª—å–æ–≤—É —Å—Ö–æ–∂—ñ—Å—Ç—å, —Ü—ñ–ª—å–æ–≤—É –≥—É—Å—Ç–æ—Ç—É.</li>
        <li>–ü–µ—Ä–µ–≤—ñ—Ä <b>–∫–≥/–≥–∞</b>, <b>–Ω–∞—Å—ñ–Ω–∏–Ω/–º</b> —ñ <b>–∫—Ä–æ–∫</b>. –ó–∞ –ø–æ—Ç—Ä–µ–±–∏ –∑–º—ñ–Ω—é–π —Ü—ñ–ª—ñ –π –ø–∞—Ä–∞–º–µ—Ç—Ä–∏.</li>
        <li>–ó–≤—ñ—Ä <b>–∫–≥/—Ö–≤</b> –¥–ª—è –∫–∞–ª—ñ–±—Ä—É–≤–∞–Ω–Ω—è (–ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫–æ–ª—ñ—Å/–∫–æ—Ç—É—à–æ–∫) –∑–∞ –∑–∞–¥–∞–Ω–æ—ó —à–≤–∏–¥–∫–æ—Å—Ç—ñ —Ç–∞ —à–∏—Ä–∏–Ω–∏.</li>
        <li>–°–∫–æ–ø—ñ—é–π CSV —É Google Sheets (–∞—Ä–∫—É—à <span class="mono">SeedingRate</span>) —ñ –¥–æ–¥–∞–π —Ñ–æ—Ç–æ –∑ –∫–∞–ª—ñ–±—Ä—É–≤–∞–Ω–Ω—è.</li>
      </ol>
    </div>

    <div class="card">
      <h2>‚úÖ –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è (10 –±–∞–ª—ñ–≤)</h2>
      <table class="table">
        <thead><tr><th>–ö—Ä–∏—Ç–µ—Ä—ñ–π</th><th>–ë–∞–ª–∏</th></tr></thead>
        <tbody>
          <tr><td>–ö–æ—Ä–µ–∫—Ç–Ω–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –Ω–æ—Ä–º–∏ (–∫–≥/–≥–∞) –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º TKW, —Å—Ö–æ–∂–æ—Å—Ç—ñ —Ç–∞ –ø–æ–ª—å–æ–≤–æ—ó —Å—Ö–æ–∂–æ—Å—Ç—ñ</td><td>4</td></tr>
          <tr><td>–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –Ω–∞—Å—ñ–Ω–∏–Ω/–º —ñ –∫—Ä–æ–∫—É –∑ –ª–æ–≥—ñ—á–Ω–∏–º–∏ –ø–æ—è—Å–Ω–µ–Ω–Ω—è–º–∏</td><td>3</td></tr>
          <tr><td>–ö–∞–ª—ñ–±—Ä—É–≤–∞–Ω–Ω—è: –æ–±“ë—Ä—É–Ω—Ç–æ–≤–∞–Ω–∏–π –ø–æ—Ç—ñ–∫ –∫–≥/—Ö–≤ —ñ –ø–ª–∞–Ω –º—ñ—à–∫—ñ–≤/–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å</td><td>2</td></tr>
          <tr><td>CSV —É Sheets + –∫–æ—Ä–æ—Ç–∫—ñ –≤–∏—Å–Ω–æ–≤–∫–∏</td><td>1</td></tr>
        </tbody>
      </table>
      <p class="pill">üåæ –ú1000 (TKW)</p><p class="pill">üå± –ì—É—Å—Ç–æ—Ç–∞</p><p class="pill">üìè –ö—Ä–æ–∫</p><p class="pill">‚öôÔ∏è –ö–∞–ª—ñ–±—Ä—É–≤–∞–Ω–Ω—è</p>
    </div>
  </div>

<script>
  // –í–±—É–¥–æ–≤–∞–Ω–∏–π —Ä–µ–∂–∏–º (–¥–ª—è Moodle iFrame)
  (function(){ if (window.self !== window.top) document.documentElement.classList.add('embedded'); })();

  const bodyEl = document.getElementById('body');
  const csvEl  = document.getElementById('csv');

  const byId = id => document.getElementById(id);
  const rnd = (n,d=2) => Number((+n).toFixed(d));

  function addRow(sample){
    const def = {
      field:'F-01', crop:'–ü—à–µ–Ω–∏—Ü—è/–°–æ—Ä—Ç-A', area: 25.0,
      P: 450, TKW: 45, G: 92, Ef: 85, note:''
    };
    const s = Object.assign(def, sample||{});
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td class="idx">1</td>
      <td><input type="text" value="${s.field}"></td>
      <td><input type="text" value="${s.crop}"></td>
      <td><input type="number" step="0.01" value="${s.area}"></td>
      <td><input type="number" step="1" value="${s.P}"></td>
      <td><input type="number" step="0.1" value="${s.TKW}"></td>
      <td><input type="number" step="0.1" value="${s.G}"></td>
      <td><input type="number" step="0.1" value="${s.Ef}"></td>
      <td class="dark N">‚Äî</td>
      <td class="dark KgHa">‚Äî</td>
      <td class="dark perM">‚Äî</td>
      <td class="dark stepCm">‚Äî</td>
      <td class="dark KgField">‚Äî</td>
      <td class="dark Bags">‚Äî</td>
      <td class="dark Flow">‚Äî</td>
      <td><input type="text" value="${s.note}"></td>
    `;
    bodyEl.appendChild(tr);
    reindex();
  }

  function reindex(){ [...bodyEl.querySelectorAll('tr')].forEach((tr,i)=>tr.querySelector('.idx').textContent=i+1); }

  function recalc(){
    const W = parseFloat(byId('W').value||'0');
    const rowCm = parseFloat(byId('rowCm').value||'15');
    const rowM = rowCm/100;
    const V = parseFloat(byId('V').value||'0');
    const bag = Math.max(1, parseFloat(byId('bag').value||'50'));
    const reserve = Math.max(0, parseFloat(byId('reserve').value||'0'));
    const hopper = parseFloat(byId('hopper').value||'0');

    let sumKg=0, sumBags=0, sumFlow=0;

    [...bodyEl.querySelectorAll('tr')].forEach(tr=>{
      const area  = parseFloat(tr.children[3].querySelector('input').value||'0');
      const P     = parseFloat(tr.children[4].querySelector('input').value||'0');     // —Ü—ñ–ª—å —Ä–æ—Å–ª–∏–Ω/–º¬≤
      const TKW   = parseFloat(tr.children[5].querySelector('input').value||'0');     // –≥/1000
      const G     = parseFloat(tr.children[6].querySelector('input').value||'0');     // %
      const Ef    = parseFloat(tr.children[7].querySelector('input').value||'0');     // %

      const germ = (G/100) * (Ef/100);
      const N = germ>0 ? (P / germ) : 0;                // –Ω–∞—Å—ñ–Ω–∏–Ω/–º¬≤
      const KgHa = N * TKW * 0.01;                      // –∫–≥/–≥–∞ (–¥–∏–≤. —à–∞–ø–∫—É)
      const perM = N * rowM;                            // –Ω–∞—Å—ñ–Ω–∏–Ω/–º
      const stepCm = perM>0 ? (100 / perM) : 0;         // —Å–º
      const KgField = KgHa * area * (1 + reserve/100);  // –∑ –∑–∞–ø–∞—Å–æ–º
      const Bags = KgField>0 ? Math.ceil(KgField / bag) : 0;

      // –ü–æ—Ç—ñ–∫ –¥–ª—è –∫–∞–ª—ñ–±—Ä—É–≤–∞–Ω–Ω—è (–∫–≥/—Ö–≤): Rate*V*W/600
      const Flow = (KgHa * V * W) / 600;

      tr.querySelector('.N').textContent      = rnd(N,1);
      tr.querySelector('.KgHa').textContent   = rnd(KgHa,1);
      tr.querySelector('.perM').textContent   = rnd(perM,2);
      tr.querySelector('.stepCm').textContent = rnd(stepCm,1);
      tr.querySelector('.KgField').textContent= rnd(KgField,0);
      tr.querySelector('.Bags').textContent   = Bags;
      tr.querySelector('.Flow').textContent   = rnd(Flow,2);

      sumKg += KgField; sumBags += Bags; sumFlow += Flow;
    });

    byId('sumKg').textContent   = rnd(sumKg,0);
    byId('sumBags').textContent = sumBags;
    byId('sumFlow').textContent = rnd(sumFlow,2);

    byId('sumKg2').textContent   = rnd(sumKg,0);
    byId('sumBags2').textContent = sumBags;
    byId('flowNote').textContent = `–ù–∞ —à–≤–∏–¥–∫–æ—Å—Ç—ñ ${V} –∫–º/–≥–æ–¥ —ñ —à–∏—Ä–∏–Ω—ñ ${W} –º —Å—É–º–∞—Ä–Ω–∏–π –ø–æ—Ç—ñ–∫ ‚âà ${rnd(sumFlow,2)} –∫–≥/—Ö–≤`;

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
    byId('Hcap').textContent = hopper ? `${hopper} –∫–≥` : '‚Äî';
    let loads='‚Äî', plan='‚Äî';
    if(hopper>0 && sumKg>0){
      const L = Math.max(1, Math.ceil(sumKg / hopper));
      loads = L;
      const per = sumKg / L;
      plan = `–†–∞–∑–æ–º –Ω–∞—Å—ñ–Ω–Ω—è ‚âà ${rnd(sumKg,0)} –∫–≥\n–ú—ñ—Å—Ç–∫—ñ—Å—Ç—å ${hopper} –∫–≥ ‚Üí ${L} –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—å √ó ~${rnd(per,0)} –∫–≥`;
    }
    byId('Loads').textContent = loads;
    byId('LoadsPlan').textContent = plan;

    buildCSV();
  }

  function buildCSV(){
    const lines = [...bodyEl.querySelectorAll('tr')].map(tr=>{
      const idx  = tr.querySelector('.idx').textContent.trim();
      const field= tr.children[1].querySelector('input').value.trim();
      const crop = tr.children[2].querySelector('input').value.trim();
      const area = tr.children[3].querySelector('input').value.trim();
      const P    = tr.children[4].querySelector('input').value.trim();
      const TKW  = tr.children[5].querySelector('input').value.trim();
      const G    = tr.children[6].querySelector('input').value.trim();
      const Ef   = tr.children[7].querySelector('input').value.trim();
      const N    = tr.querySelector('.N').textContent.trim();
      const KgHa = tr.querySelector('.KgHa').textContent.trim();
      const perM = tr.querySelector('.perM').textContent.trim();
      const step = tr.querySelector('.stepCm').textContent.trim();
      const KgFld= tr.querySelector('.KgField').textContent.trim();
      const Bags = tr.querySelector('.Bags').textContent.trim();
      const Flow = tr.querySelector('.Flow').textContent.trim();
      const note = tr.children[15].querySelector('input').value.trim();
      return [idx,field,crop,area,P,TKW,G,Ef,N,KgHa,perM,step,KgFld,Bags,Flow,note].join(' | ');
    });
    csvEl.textContent = lines.join('\n') || '‚Äî';
  }

  function copyCSV(){
    const t = csvEl.textContent.trim();
    if(!t || t==='‚Äî'){ alert('–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è'); return; }
    navigator.clipboard.writeText(t).then(()=>flash('‚úÖ CSV —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'),()=>flash('–ù–µ –≤–¥–∞–ª–æ—Å—è'));
  }

  function preset(){
    bodyEl.innerHTML='';
    addRow({field:'F-01', crop:'–ü—à–µ–Ω–∏—Ü—è/–°–æ—Ä—Ç-A', area:24.5, P:450, TKW:45, G:92, Ef:85});
    addRow({field:'F-02', crop:'–ü—à–µ–Ω–∏—Ü—è/–°–æ—Ä—Ç-B', area:18.2, P:420, TKW:42, G:94, Ef:88});
    addRow({field:'F-03', crop:'–Ø—á–º—ñ–Ω—å/–°–æ—Ä—Ç-C',  area:30.0, P:380, TKW:48, G:90, Ef:82});
    recalc();
  }

  function flash(msg){ const o=document.title; document.title=msg; setTimeout(()=>document.title=o,900); }

  // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
  (function init(){ addRow(); addRow(); recalc(); })();
</script>
</body>
</html>
