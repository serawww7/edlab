<!DOCTYPE html><html lang="uk"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>–ü–∞—Ä–∞ 22 ‚Äî –®–Ü-–ø—Ä–æ–≥–Ω–æ–∑ —Ä–∏–∑–∏–∫—ñ–≤ —Ö–≤–æ—Ä–æ–±: –ø–æ–≥–æ–¥–∞ ‚Üí —ñ–Ω—Ñ–µ–∫—Ü—ñ–π–Ω—ñ –≤—ñ–∫–Ω–∞ ‚Üí ¬´—â–æ —è–∫—â–æ¬ª ‚Üí –ø—Ä–æ–º–ø—Ç</title>
<meta name="description" content="–ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ/–µ–º—É—î–º–æ –ø–æ–≥–æ–¥–∏–Ω–Ω—ñ T/RH/–æ–ø–∞–¥–∏, —Ä–∞—Ö—É—î–º–æ leaf wetness, Smith Period (–∫–∞—Ä—Ç–æ–ø–ª—è —Ñ—ñ—Ç–æ—Ñ—Ç–æ—Ä–æ–∑), —ñ–Ω–¥–µ–∫—Å —Å–µ–ø—Ç–æ—Ä—ñ–æ–∑—É (–ø—à–µ–Ω–∏—Ü—è), —Ä–∏–∑–∏–∫ –±–æ—Ä–æ—à–Ω–∏—Å—Ç–æ—ó —Ä–æ—Å–∏. –ñ–∏–≤–∏–π –≥—Ä–∞—Ñ—ñ–∫, what-if —Å–∏–º—É–ª—è—Ç–æ—Ä, –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è LLM, –µ–∫—Å–ø–æ—Ä—Ç CSV/TXT.">
<meta name="color-scheme" content="light dark">
<style>
:root{--bg:#0b1220;--panel:#0f172a;--muted:#94a3b8;--text:#e6eef9;--line:#223049;--brand:#38bdf8;--ok:#22c55e;--warn:#fbbf24;--bad:#f87171}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,"Segoe UI",Inter,Roboto,Arial,sans-serif}
.wrap{max-width:1000px;margin:0 auto;padding:16px}
header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.logo{display:flex;gap:10px;align-items:center}
.logo .emoji{font-size:28px}
.logo .badge{font-size:.9rem;color:var(--muted);border:1px solid var(--line);padding:2px 8px;border-radius:999px}
h1{margin:.2em 0 .3em}
.muted{color:var(--muted)}
.card{border:1px solid var(--line);border-radius:16px;background:var(--panel);padding:14px;margin-top:14px}
.row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.input,select,textarea{width:100%;padding:8px;border-radius:10px;border:1px solid var(--line);background:#0b1220;color:var(--text)}
.btn{border:1px solid var(--line);background:#0f1f39;color:var(--text);padding:8px 12px;border-radius:10px;cursor:pointer}
.btn.secondary{background:transparent}
.btn.good{border-color:#204b2a;background:#12341b}
.badge{display:inline-block;border:1px solid var(--line);border-radius:999px;padding:2px 8px;color:var(--muted);margin-right:6px}
.grid{display:grid;gap:14px;grid-template-columns:1.4fr 1fr}
@media(max-width:980px){.grid{grid-template-columns:1fr}}
pre.code{background:#0b1220;border:1px solid var(--line);border-radius:12px;padding:12px;overflow:auto;white-space:pre-wrap}
.canvasWrap{border:1px solid var(--line);border-radius:12px;overflow:hidden;background:#0b1220}
canvas{display:block;width:100%;height:260px}
.log{max-height:160px;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:8px;background:#0b1220;font-family:ui-monospace,monospace;font-size:13px;white-space:pre-wrap}
svg{max-width:100%;height:auto;display:block}
.tag{display:inline-block;border:1px solid var(--line);border-radius:999px;padding:2px 8px;color:var(--muted);margin-right:6px;margin-top:6px}
.small{font-size:.9rem}
.footer{margin-top:20px;color:var(--muted);font-size:.9rem}
table.comp{width:100%;border-collapse:collapse;font-size:.95rem}
table.comp th,table.comp td{border:1px solid var(--line);padding:6px;text-align:left}
.ok{color:var(--ok)}.warn{color:var(--warn)}.bad{color:var(--bad)}
</style>
<link rel="canonical" href="https://edlab.pp.ua/agro_II_kyrs/agro_para22.html"><meta property="og:type" content="article"><meta property="og:title" content="–ê–≥—Ä–æ–Ω–æ–º—ñ—è ‚Äî –ü–∞—Ä–∞ 22"><meta property="og:description" content="–ú–µ—Ç–∞: –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –ø–æ–≥–æ–¥–∏–Ω–Ω—ñ –¥–∞–Ω—ñ (T, RH, –æ–ø–∞–¥–∏) –Ω–∞ —ñ–Ω—Ñ–µ–∫—Ü—ñ–π–Ω—ñ —ñ–Ω–¥–µ–∫—Å–∏ –¥–ª—è 3 –∫–µ–π—Å—ñ–≤: —Ñ—ñ—Ç–æ—Ñ—Ç–æ—Ä–æ–∑ –∫–∞—Ä—Ç–æ–ø–ª—ñ (Smith Period), —Å–µ–ø—Ç–æ—Ä—ñ–æ–∑ –ø—à–µ–Ω–∏—Ü—ñ (leaf wetness + T"><meta property="og:url" content="https://edlab.pp.ua/agro_II_kyrs/agro_para22.html"><script type="application/ld+json">{"@context":"https://schema.org","@type":"LearningResource","name":"–ê–≥—Ä–æ–Ω–æ–º—ñ—è ‚Äî –ü–∞—Ä–∞ 22","description":"–ú–µ—Ç–∞: –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –ø–æ–≥–æ–¥–∏–Ω–Ω—ñ –¥–∞–Ω—ñ (T, RH, –æ–ø–∞–¥–∏) –Ω–∞ —ñ–Ω—Ñ–µ–∫—Ü—ñ–π–Ω—ñ —ñ–Ω–¥–µ–∫—Å–∏ –¥–ª—è 3 –∫–µ–π—Å—ñ–≤: —Ñ—ñ—Ç–æ—Ñ—Ç–æ—Ä–æ–∑ –∫–∞—Ä—Ç–æ–ø–ª—ñ (Smith Period), —Å–µ–ø—Ç–æ—Ä—ñ–æ–∑ –ø—à–µ–Ω–∏—Ü—ñ (leaf wetness + T","inLanguage":"uk","educationalLevel":"college","url":"https://edlab.pp.ua/agro_II_kyrs/agro_para22.html","provider":{"@type":"Organization","name":"EDLab"}}</script></head>
<body>
<div class="wrap">
  <header>
    <div class="logo">
      <span class="emoji">üß¨</span>
      <div>
        <b>–ü–∞—Ä–∞ 22 ‚Äî –®–Ü-–ø—Ä–æ–≥–Ω–æ–∑ —Ä–∏–∑–∏–∫—ñ–≤ —Ö–≤–æ—Ä–æ–±</b><br>
        <span class="badge">–ü–æ–≥–æ–¥–∞ ‚Üí leaf wetness ‚Üí Smith Period ‚Üí —ñ–Ω–¥–µ–∫—Å–∏ —Ä–∏–∑–∏–∫—É ‚Üí ¬´—â–æ —è–∫—â–æ¬ª ‚Üí –ø—Ä–æ–º–ø—Ç –¥–ª—è LLM</span>
      </div>
    </div>
    <a class="btn" href="../index.html" target="_blank" rel="noopener">üè† –ù–∞ –≥–æ–ª–æ–≤–Ω—É</a>
  </header>

  <p class="muted">
    –ú–µ—Ç–∞: –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –ø–æ–≥–æ–¥–∏–Ω–Ω—ñ –¥–∞–Ω—ñ (<b>T, RH, –æ–ø–∞–¥–∏</b>) –Ω–∞ <b>—ñ–Ω—Ñ–µ–∫—Ü—ñ–π–Ω—ñ —ñ–Ω–¥–µ–∫—Å–∏</b> –¥–ª—è 3 –∫–µ–π—Å—ñ–≤: 
    <b>—Ñ—ñ—Ç–æ—Ñ—Ç–æ—Ä–æ–∑ –∫–∞—Ä—Ç–æ–ø–ª—ñ</b> (Smith Period), <b>—Å–µ–ø—Ç–æ—Ä—ñ–æ–∑ –ø—à–µ–Ω–∏—Ü—ñ</b> (leaf wetness + T), <b>–±–æ—Ä–æ—à–Ω–∏—Å—Ç–∞ —Ä–æ—Å–∞ –ø—à–µ–Ω–∏—Ü—ñ</b> (–ø–æ—Å—É—à–ª–∏–≤–∞ —Ç–µ–ø–ª–æ–≤–∞ –Ω—ñ—à–∞). 
    –î–∞–ª—ñ ‚Äî <b>—Å–∏–º—É–ª—è—Ç–æ—Ä ‚Äú—â–æ —è–∫—â–æ‚Äù</b> (–∑–º—ñ–Ω–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∏/–≤–æ–ª–æ–≥–∏/–æ–ø–∞–¥—ñ–≤) —ñ <b>–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—Ä–æ–º–ø—Ç–∞</b> –¥–æ LLM –¥–ª—è –ø–ª–∞–Ω—É –¥—ñ–π (IPM).
  </p>

  <div class="grid">
    <!-- –õ–Ü–í–û: –¥–∞–Ω—ñ + –≥—Ä–∞—Ñ—ñ–∫–∏ + —Ä–∏–∑–∏–∫–∏ -->
    <div class="card">
      <h2>üóÇÔ∏è –î–∞–Ω—ñ –ø–æ–≥–æ–¥–∏</h2>
      <div class="row">
        <div style="flex:1">
          <label for="csv">CSV (timestamp,T,RH,rain_mm)</label>
          <textarea id="csv" class="input" rows="6" placeholder="2025-05-18T06:00,12.4,92,0
2025-05-18T07:00,13.1,94,0
..."></textarea>
        </div>
      </div>
      <div class="row">
        <button class="btn good" id="parse">üì• –Ü–º–ø–æ—Ä—Ç</button>
        <button class="btn secondary" id="emu">üé≤ –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –µ—Ç–∞–ª–æ–Ω 4 –¥–æ–±–∏</button>
        <button class="btn secondary" id="clear">üßπ –û—á–∏—Å—Ç–∏—Ç–∏</button>
        <span id="badgeN" class="badge">–ó–∞–ø–∏—Å—ñ–≤: 0</span>
      </div>

      <h3 style="margin-top:12px">üìà –ì—Ä–∞—Ñ—ñ–∫ (T, RH, –æ–ø–∞–¥–∏)</h3>
      <div class="canvasWrap"><canvas id="chart" width="900" height="260"></canvas></div>

      <h3 style="margin-top:12px">üß™ ‚Äú–©–æ —è–∫—â–æ‚Äù ‚Äî –∑–º—ñ–Ω–∏ –ø–æ–≥–æ–¥–Ω–∏—Ö —É–º–æ–≤</h3>
      <div class="row">
        <div style="flex:1">
          <label for="dT">ŒîT, ¬∞C (–¥–æ–¥–∞—Ç–∏ –¥–æ –≤—Å—ñ—Ö)</label>
          <input id="dT" class="input" type="number" step="0.5" value="0">
        </div>
        <div style="flex:1">
          <label for="dRH">ŒîRH, % (–æ–±–º–µ–∂–µ–Ω–Ω—è 0..100)</label>
          <input id="dRH" class="input" type="number" step="1" value="0">
        </div>
        <div style="flex:1">
          <label for="mulRain">–ú–Ω–æ–∂–Ω–∏–∫ –æ–ø–∞–¥—ñ–≤</label>
          <input id="mulRain" class="input" type="number" step="0.1" value="1">
        </div>
      </div>
      <div class="row">
        <button class="btn" id="applyWhatIf">üßÆ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏ —Ä–∏–∑–∏–∫–∏</button>
        <span id="badgeWI" class="badge">What-if: 0/0/0</span>
      </div>

      <h3 style="margin-top:12px">ü¶† –†–∏–∑–∏–∫–∏ (–æ—Å—Ç–∞–Ω–Ω—ñ 48‚Äì72 –≥–æ–¥)</h3>
      <table class="comp" id="riskTable">
        <thead><tr><th>–ú–æ–¥–µ–ª—å</th><th>–ü—Ä–∞–≤–∏–ª–æ</th><th>–ü—ñ–¥—Å—É–º–æ–∫</th><th>–†—ñ–≤–µ–Ω—å</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- –ü–†–ê–í–û: –ø—Ä–æ–º–ø—Ç + —Å—Ö–µ–º–∞ + –∂—É—Ä–Ω–∞–ª -->
    <div class="card">
      <h2>üß© –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è LLM</h2>
      <div class="row">
        <div style="flex:1">
          <label for="crop">–ö—É–ª—å—Ç—É—Ä–∞</label>
          <select id="crop" class="input">
            <option>–ö–∞—Ä—Ç–æ–ø–ª—è</option>
            <option>–ü—à–µ–Ω–∏—Ü—è –æ–∑–∏–º–∞</option>
          </select>
        </div>
        <div style="flex:1">
          <label for="bbch">–§–∞–∑–∞ (BBCH)</label>
          <input id="bbch" class="input" placeholder="–Ω–∞–ø—Ä. BBCH 39 ‚Äî –∫–æ–ª–æ—Å –≤ –ø—ñ—Ö–≤—ñ –ª–∏—Å—Ç–∫–∞">
        </div>
      </div>
      <div class="row">
        <div style="flex:1">
          <label for="field">–ü–æ–ª–µ/–ª–æ–∫–∞—Ü—ñ—è</label>
          <input id="field" class="input" placeholder="–ü–æ–ª–µ ‚Ññ5, –£–º–∞–Ω—å">
        </div>
        <div style="flex:1">
          <label for="constraints">–û–±–º–µ–∂–µ–Ω–Ω—è/—Ä–µ—Å—É—Ä—Å–∏</label>
          <input id="constraints" class="input" placeholder="–≤—ñ–∫–Ω–æ –ø–æ–≥–æ–¥–∏ 48 –≥–æ–¥, –Ω–∞–∑–µ–º–Ω–∏–π –æ–±–ø—Ä–∏—Å–∫—É–≤–∞—á, –±—é–¥–∂–µ—Ç 6000 –≥—Ä–Ω/–≥–∞">
        </div>
      </div>
      <div class="row">
        <button class="btn good" id="genPrompt">‚öôÔ∏è –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –ø—Ä–æ–º–ø—Ç</button>
        <button class="btn secondary" id="copyPrompt">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
        <button class="btn secondary" id="savePrompt">‚¨áÔ∏è TXT</button>
      </div>
      <pre class="code" id="promptPreview">// –°–ø–æ—á–∞—Ç–∫—É —ñ–º–ø–æ—Ä—Ç—É–π –ø–æ–≥–æ–¥—É –∞–±–æ –Ω–∞—Ç–∏—Å–Ω–∏ ¬´üé≤ –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –µ—Ç–∞–ª–æ–Ω¬ª</pre>

      <h2 style="margin-top:12px">üîÅ –°—Ö–µ–º–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É (SVG)</h2>
      <svg viewBox="0 0 760 420" role="img" aria-label="–°—Ö–µ–º–∞ —Ä–∏–∑–∏–∫—ñ–≤ —Ö–≤–æ—Ä–æ–±">
        <rect x="40" y="40" width="180" height="80" rx="12" fill="#0e2a47" stroke="#3b82f6"></rect>
        <text x="130" y="72" fill="#e5e7eb" font-size="14" text-anchor="middle">–ü–æ–≥–æ–¥–∏–Ω–Ω—ñ T/RH/–æ–ø–∞–¥–∏</text>
        <rect x="260" y="40" width="180" height="80" rx="12" fill="#14532d" stroke="#22c55e"></rect>
        <text x="350" y="60" fill="#dcfce7" font-size="14" text-anchor="middle">Leaf Wetness</text>
        <text x="350" y="80" fill="#a7f3d0" font-size="12" text-anchor="middle">RH‚â•90% –∞–±–æ rain&gt;0</text>
        <rect x="480" y="40" width="240" height="80" rx="12" fill="#1f2937" stroke="#9ca3af"></rect>
        <text x="600" y="60" fill="#e5e7eb" font-size="14" text-anchor="middle">–ú–æ–¥–µ–ª—ñ —Ä–∏–∑–∏–∫—É</text>
        <text x="600" y="80" fill="#9ca3af" font-size="12" text-anchor="middle">Smith / Septoria / PM</text>
        <line x1="220" y1="80" x2="260" y2="80" stroke="#93c5fd" stroke-width="3"></line>
        <line x1="440" y1="80" x2="480" y2="80" stroke="#93c5fd" stroke-width="3"></line>

        <rect x="40" y="170" width="240" height="90" rx="12" fill="#0b3f5a" stroke="#22d3ee"></rect>
        <text x="160" y="200" fill="#a5f3fc" font-size="14" text-anchor="middle">¬´–©–æ —è–∫—â–æ¬ª</text>
        <text x="160" y="220" fill="#a5f3fc" font-size="12" text-anchor="middle">ŒîT, ŒîRH, √órain</text>
        <line x1="160" y1="260" x2="600" y2="120" stroke="#64748b" stroke-width="2" stroke-dasharray="6 6"></line>

        <rect x="320" y="170" width="180" height="90" rx="12" fill="#7c2d12" stroke="#fb923c"></rect>
        <text x="410" y="200" fill="#fed7aa" font-size="14" text-anchor="middle">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—Ä–æ–º–ø—Ç–∞</text>
        <text x="410" y="220" fill="#fed7aa" font-size="12" text-anchor="middle">IPM-–ø–ª–∞–Ω –¥–ª—è LLM</text>

        <rect x="540" y="170" width="180" height="90" rx="12" fill="#111827" stroke="#4b5563"></rect>
        <text x="630" y="200" fill="#e5e7eb" font-size="14" text-anchor="middle">–ó–≤—ñ—Ç/–µ–∫—Å–ø–æ—Ä—Ç</text>
        <text x="630" y="220" fill="#9ca3af" font-size="12" text-anchor="middle">CSV/TXT</text>
      </svg>

      <div class="card" style="margin-top:12px">
        <h3>üìú –ù–æ—Ç–∞—Ç–∫–∞ –∑ —ñ—Å—Ç–æ—Ä—ñ—ó</h3>
        <p class="muted small">–ö–ª–∞—Å–∏—á–Ω–∏–π <b>Smith Period</b> –¥–ª—è —Ñ—ñ—Ç–æ—Ñ—Ç–æ—Ä–æ–∑—É –∫–∞—Ä—Ç–æ–ø–ª—ñ —Å—Ñ–æ—Ä–º—É–ª—å–æ–≤–∞–Ω–æ –≤ 1950‚Äì60-—Ö —É –ë—Ä–∏—Ç–∞–Ω—ñ—ó: –¥–≤–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ –¥–Ω—ñ –∑ <i>T<sub>–º—ñ–Ω</sub> ‚â• 10¬∞C</i> —ñ <i>‚â•11 –≥–æ–¥ RH‚â•90%</i> —â–æ–¥–Ω—è ‚Äî —Å–∏–≥–Ω–∞–ª –¥–æ –ø—Ä–æ—Ñ—ñ–ª–∞–∫—Ç–∏–∫–∏. –°—É—á–∞—Å–Ω—ñ —Å–∏—Å—Ç–µ–º–∏ –ø–æ—î–¥–Ω—É—é—Ç—å —Ç–∞–∫—ñ –ø—Ä–∞–≤–∏–ª–∞ –∑ –ª–æ–∫–∞–ª—å–Ω–æ—é –ø–æ–≥–æ–¥–æ—é —Ç–∞ –®–Ü-–ø—ñ–¥–∫–∞–∑–∫–∞–º–∏ –¥–ª—è IPM.</p>
      </div>

      <h3 style="margin-top:12px">üíæ –ü—ñ–¥—Å—É–º–æ–∫/–∂—É—Ä–Ω–∞–ª</h3>
      <div class="row">
        <input id="fio" class="input" placeholder="–ü–Ü–ë —Å—Ç—É–¥–µ–Ω—Ç–∞">
        <button class="btn" id="saveTxt">üíæ TXT</button>
        <button class="btn" id="saveCsv">üìÑ CSV</button>
      </div>
      <div id="log" class="log" aria-live="polite"></div>

      <h3 style="margin-top:12px">üß∑ –¢–µ–≥–∏</h3>
      <div>
        <span class="tag">#SmithPeriod</span>
        <span class="tag">#leaf_wetness</span>
        <span class="tag">#IPM</span>
        <span class="tag">#what_if</span>
        <span class="tag">#prompt_engineering</span>
      </div>
    </div>
  </div>

  <div class="card">
    <h2>üìã –ü—ñ–¥—Å—É–º–æ–∫ –¥–ª—è –∑–≤—ñ—Ç—É</h2>
    <ul>
      <li>CSV –∑–∞ 3‚Äì4 –¥–æ–±–∏ (T,RH,rain), –≥—Ä–∞—Ñ—ñ–∫ —Ç–∞ —Ç–∞–±–ª–∏—Ü—è —Ä–∏–∑–∏–∫—ñ–≤.</li>
      <li>–°–∫—Ä—ñ–Ω –ø—Ä–æ–º–ø—Ç–∞ –π –∫–æ—Ä–æ—Ç–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å LLM (–ø–ª–∞–Ω IPM).</li>
      <li>–ö–æ–º–µ–Ω—Ç–∞—Ä, —è–∫ –∑–º—ñ–Ω–∏–ª–∏—Å—è —Ä–∏–∑–∏–∫–∏ –ø—Ä–∏ ¬´—â–æ —è–∫—â–æ¬ª.</li>
    </ul>
  </div>

  <div class="footer">
    –û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: <time datetime="2025-10-18">18.10.2025</time>. –ê–≤—Ç–æ—Ä: –°–µ—Ä–≥—ñ–π –ü–æ–ª—ñ—â—É–∫.
  </div>
</div>

<script>
// ======= –£—Ç–∏–ª—ñ—Ç–∏ =======
const $=s=>document.querySelector(s);
function download(name,text,type="text/plain"){const b=new Blob([text],{type:type+";charset=utf-8"});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download=name;document.body.appendChild(a);a.click();a.remove();URL.revokeObjectURL(u);}
function stamp(){return new Date().toISOString().replace(/[:T]/g,'-').slice(0,16);}
function toISO(dt){return new Date(dt).toISOString().slice(0,16).replace('T',' ')}

// ======= –î–∞–Ω—ñ =======
let rows=[]; // {t: Date, T, RH, rain}

// –ï—Ç–∞–ª–æ–Ω–Ω–∞ –ø–æ–≥–æ–¥–∞ –Ω–∞ 4 –¥–æ–±–∏ –∑ –≤—ñ–∫–Ω–∞–º–∏ –≤–æ–ª–æ–≥–æ—Å—Ç—ñ
function genDemo(){
  rows.length=0;
  const start=new Date(); start.setHours(start.getHours()-96,0,0,0);
  for(let i=0;i<96;i++){
    const t=new Date(start.getTime()+i*3600000);
    const hour=t.getHours();
    const baseT=12+8*Math.sin((2*Math.PI*(hour-6))/24); // –¥–æ–±–æ–≤–∏–π —Ö—ñ–¥
    let T=baseT + (Math.random()*1.2-0.6);
    let RH=60+25*Math.sin((2*Math.PI*(hour+2))/24) + (Math.random()*6-3);
    let rain=0;
    // —Å—Ç–≤–æ—Ä–∏–º–æ –≤–æ–ª–æ–≥—ñ –Ω–æ—á—ñ
    if(hour>=21 || hour<=7){ RH+=20; }
    // –ø–µ—Ä—ñ–æ–¥ –¥–æ—â—ñ–≤
    if(i%30===0 || (hour>=15 && hour<=17 && Math.random()<0.2)){ rain=Math.random()<0.6?0.6:0; RH=Math.max(RH,92); }
    RH=Math.max(30,Math.min(100, RH));
    rows.push({t, T:parseFloat(T.toFixed(1)), RH:parseFloat(RH.toFixed(0)), rain:parseFloat(rain.toFixed(1))});
  }
}

function parseCSV(txt){
  rows.length=0;
  const lines=(txt||'').trim().split(/\r?\n/).filter(Boolean);
  for(const line of lines){
    const [ts,Ts,RHs,Rs]=line.split(',').map(s=>s.trim());
    const t=new Date(ts);
    const T=parseFloat(Ts), RH=parseFloat(RHs), rain=parseFloat(Rs);
    if(!isNaN(t.getTime()) && !Number.isNaN(T) && !Number.isNaN(RH) && !Number.isNaN(rain)){
      rows.push({t,T,RH,rain});
    }
  }
  rows.sort((a,b)=>a.t-b.t);
}

// ======= Leaf Wetness proxy =======
// –ü—Ä–æ—Å—Ç–µ –Ω–∞–±–ª–∏–∂–µ–Ω–Ω—è: –≥–æ–¥–∏–Ω–∞ ¬´–º–æ–∫—Ä–∞¬ª, —è–∫—â–æ RH‚â•90% –∞–±–æ rain>0
function isWet(r){ return (r.RH>=90) || (r.rain>0); }

// ======= –ú–æ–¥–µ–ª—ñ —Ä–∏–∑–∏–∫—É =======
// 1) Smith Period (—Ñ—ñ—Ç–æ—Ñ—Ç–æ—Ä–æ–∑ –∫–∞—Ä—Ç–æ–ø–ª—ñ):
//   –¥–≤–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ –¥–Ω—ñ: Tmin ‚â• 10¬∞C —ñ ‚â•11 –≥–æ–¥ –≤–æ–ª–æ–≥–æ (>90% RH –∞–±–æ –¥–æ—â) –ö–û–ñ–ù–û–ì–û –¥–Ω—è.
function smithPeriod(rows){
  if(rows.length===0) return {periods:[], active:false};
  // –∞–≥—Ä–µ–≥—É—î–º–æ –ø–æ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω–∏—Ö –¥–Ω—è—Ö
  const dayMap=new Map(); // key YYYY-MM-DD -> {minT, wetHours}
  rows.forEach(r=>{
    const key=r.t.toISOString().slice(0,10);
    const o=dayMap.get(key)||{minT:Infinity, wetHours:0};
    o.minT=Math.min(o.minT, r.T);
    if(isWet(r)) o.wetHours++;
    dayMap.set(key,o);
  });
  const days=[...dayMap.entries()].sort((a,b)=>a[0].localeCompare(b[0]));
  const ok=days.map(([date,v])=>({date,minT:v.minT, wetHours:v.wetHours, pass:(v.minT>=10 && v.wetHours>=11)}));
  const periods=[];
  for(let i=1;i<ok.length;i++){
    if(ok[i-1].pass && ok[i].pass) periods.push([ok[i-1].date, ok[i].date]);
  }
  return {periods, active: periods.length>0, details:ok};
}

// 2) Septoria (–ø—à–µ–Ω–∏—Ü—è): –≤–∏—Å–æ–∫–∏–π —Ä–∏–∑–∏–∫, —è–∫—â–æ –∑–∞ 48 –≥–æ–¥ —Å—É–º–∞—Ä–Ω–æ ‚â•20 –≥–æ–¥ –º–æ–∫—Ä–æ–≥–æ –ª–∏—Å—Ç—è —ñ —Å–µ—Ä–µ–¥–Ω—è T 12‚Äì20¬∞C.
// —Å–µ—Ä–µ–¥–Ω—ñ–π ‚Äî ‚â•12 –≥–æ–¥ –º–æ–∫—Ä–æ—Ç–∏; –Ω–∏–∑—å–∫–∏–π ‚Äî —ñ–Ω–∞–∫—à–µ.
function septoriaRisk(rows){
  const tail=rows.slice(-48); if(tail.length===0) return {level:'‚Äî',wet:0,avgT:NaN};
  let wet=0, sumT=0;
  tail.forEach(r=>{ if(isWet(r)) wet++; sumT+=r.T; });
  const avgT=sumT/tail.length;
  let level='–Ω–∏–∑—å–∫–∏–π';
  if(wet>=20 && avgT>=12 && avgT<=20) level='–≤–∏—Å–æ–∫–∏–π';
  else if(wet>=12) level='—Å–µ—Ä–µ–¥–Ω—ñ–π';
  return {level, wet, avgT:parseFloat(avgT.toFixed(1))};
}

// 3) –ë–æ—Ä–æ—à–Ω–∏—Å—Ç–∞ —Ä–æ—Å–∞ (–ø—à–µ–Ω–∏—Ü—è): –ø–æ–ª—é–±–ª—è—î 15‚Äì25¬∞C —ñ RH 40‚Äì80%, –±–µ–∑ –º–æ–∫—Ä–æ—ó –ø–æ–≤–µ—Ä—Ö–Ω—ñ (–¥–æ—â —à–∫–æ–¥–∏—Ç—å —Å–ø–æ—Ä—É–ª—è—Ü—ñ—ó).
// –û—Ü—ñ–Ω–∏–º–æ –∑–∞ 48 –≥–æ–¥: —á–∞—Å—Ç–∫–∞ –≥–æ–¥–∏–Ω –∑ 15‚Äì25¬∞C —Ç–∞ RH 40‚Äì80% —ñ rain==0.
//  >60% ‚Äî –≤–∏—Å–æ–∫–∏–π, 30‚Äì60% ‚Äî —Å–µ—Ä–µ–¥–Ω—ñ–π, —ñ–Ω–∞–∫—à–µ –Ω–∏–∑—å–∫–∏–π.
function powderyMildewRisk(rows){
  const tail=rows.slice(-48); if(tail.length===0) return {level:'‚Äî',share:0};
  let good=0;
  tail.forEach(r=>{
    if(r.T>=15 && r.T<=25 && r.RH>=40 && r.RH<=80 && r.rain==0) good++;
  });
  const share=good/tail.length;
  let level='–Ω–∏–∑—å–∫–∏–π';
  if(share>0.6) level='–≤–∏—Å–æ–∫–∏–π';
  else if(share>0.3) level='—Å–µ—Ä–µ–¥–Ω—ñ–π';
  return {level, share:Math.round(share*100)};
}

// ======= What-if –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è =======
function applyWhatIf(dT,dRH,mulRain){
  const adj=rows.map(r=>{
    const T=r.T + dT;
    const RH=Math.max(0,Math.min(100, r.RH + dRH));
    const rain=Math.max(0, r.rain * mulRain);
    return {t:r.t, T, RH, rain};
  });
  return {smith:smithPeriod(adj), sept:septoriaRisk(adj), pm:powderyMildewRisk(adj)};
}

// ======= UI: –≥—Ä–∞—Ñ—ñ–∫ =======
const cvs=$('#chart'), ctx=cvs.getContext('2d');
function draw(){
  const W=cvs.width,H=cvs.height;
  ctx.clearRect(0,0,W,H);
  ctx.strokeStyle='#223049';ctx.strokeRect(0.5,0.5,W-1,H-1);
  if(rows.length<2) return;
  const s=rows.slice(-120); // –ø–æ–∫–∞–∑—É—î–º–æ ~5 –¥—ñ–± –º–∞–∫—Å
  const xs=s.map((_,i)=> i*(W/(s.length-1)));
  // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ 0..35
  ctx.beginPath();ctx.strokeStyle='#38bdf8';ctx.lineWidth=2;
  xs.forEach((x,i)=>{const y=H-10-(Math.min(35,Math.max(0,s[i].T))/35)*(H-20); i?ctx.lineTo(x,y):ctx.moveTo(x,y);});ctx.stroke();
  // RH 0..100
  ctx.beginPath();ctx.strokeStyle='#22c55e';ctx.lineWidth=2;
  xs.forEach((x,i)=>{const y=H-10-(s[i].RH/100)*(H-20); i?ctx.lineTo(x,y):ctx.moveTo(x,y);});ctx.stroke();
  // –û–ø–∞–¥–∏ —Å—Ç–æ–≤–ø—á–∏–∫–∞–º–∏
  ctx.fillStyle='#94a3b8';
  const maxR=5; // —à–∫–∞–ª–∞ 0..5 –º–º/–≥–æ–¥
  xs.forEach((x,i)=>{const h=(Math.min(maxR,s[i].rain)/maxR)*(H-20); ctx.fillRect(x-1, H-10-h, 2, h);});
  ctx.fillStyle='#94a3b8';ctx.font='12px ui-monospace';ctx.fillText('T',W-28,14);ctx.fillText('RH',W-12,14);
}

// ======= –¢–∞–±–ª–∏—Ü—è —Ä–∏–∑–∏–∫—ñ–≤ =======
function renderRisks(base){
  const tb=$('#riskTable tbody');
  tb.innerHTML='';
  // Smith
  const smith=base.smith; const sp=smith.periods.map(p=>p.join(' ‚Üí ')).join('; ')||'‚Äî';
  tb.appendChild(tr('–§—ñ—Ç–æ—Ñ—Ç–æ—Ä–æ–∑ (–∫–∞—Ä—Ç–æ–ø–ª—è)', '2 –¥–æ–±–∏: Tmin‚â•10¬∞C —Ç–∞ ‚â•11 –≥–æ–¥ RH‚â•90%/–¥–æ—â –∫–æ–∂–Ω–æ–≥–æ –¥–Ω—è', sp, smith.active?'–≤–∏—Å–æ–∫–∏–π':'–Ω–∏–∑—å–∫–∏–π', smith.active?'bad': 'ok'));
  // Septoria
  const se=base.sept; 
  tb.appendChild(tr('–°–µ–ø—Ç–æ—Ä—ñ–æ–∑ (–ø—à–µ–Ω–∏—Ü—è)','48 –≥–æ–¥: –º–æ–∫—Ä–æ—Ç–∞ ‚â•12/20 –≥–æ–¥; T 12‚Äì20¬∞C (–≤–∏—Å–æ–∫–∏–π)','–º–æ–∫—Ä–æ—Ç–∞ '+se.wet+' –≥–æ–¥; TÃÑ='+se.avgT+'¬∞C', se.level, cls(se.level)));
  // PM
  const pm=base.pm;
  tb.appendChild(tr('–ë–æ—Ä–æ—à–Ω–∏—Å—Ç–∞ —Ä–æ—Å–∞ (–ø—à–µ–Ω–∏—Ü—è)','48 –≥–æ–¥: 15‚Äì25¬∞C & RH 40‚Äì80% –±–µ–∑ –æ–ø–∞–¥—ñ–≤ (>60% ‚Äî –≤–∏—Å–æ–∫–∏–π)','—Å–ø—Ä–∏—è—Ç–ª–∏–≤—ñ –≥–æ–¥–∏–Ω–∏: '+pm.share+'%', pm.level, cls(pm.level)));
  // –±–µ–π–¥–∂ what-if
  $('#badgeWI').textContent = `What-if: SP=${smith.active?1:0}/SE=${se.level}/PM=${pm.level}`;
  // –ª–æ–≥
  log(`–û–Ω–æ–≤–ª–µ–Ω–æ —Ä–∏–∑–∏–∫–∏ ‚Üí Smith:${smith.active?'ON':'off'}; Septoria:${se.level}; PM:${pm.level}`);
}
function cls(level){ return level==='–≤–∏—Å–æ–∫–∏–π'?'bad':(level==='—Å–µ—Ä–µ–¥–Ω—ñ–π'?'warn':'ok'); }
function tr(name,rule,summary,level,klass){
  const tr=document.createElement('tr');
  tr.innerHTML=`<td>${name}</td><td class="small">${rule}</td><td>${summary}</td><td class="${klass}">${level}</td>`;
  return tr;
}

// ======= –ü—Ä–æ–º–ø—Ç –¥–ª—è LLM =======
function buildPrompt(){
  if(rows.length===0) return '// –°–ø–æ—á–∞—Ç–∫—É —ñ–º–ø–æ—Ä—Ç—É–π –ø–æ–≥–æ–¥—É';
  const dT=parseFloat($('#dT').value)||0, dRH=parseFloat($('#dRH').value)||0, mul=parseFloat($('#mulRain').value)||1;
  const base=applyWhatIf(0,0,1), whatif=applyWhatIf(dT,dRH,mul);
  const crop=$('#crop').value, bbch=$('#bbch').value||'–Ω–µ –≤–∫–∞–∑–∞–Ω–æ', field=$('#field').value||'‚Äî', cons=$('#constraints').value||'‚Äî';
  // –ö–æ—Ä–æ—Ç–∫—ñ –∑–≤–µ–¥–µ–Ω—ñ –º–µ—Ç—Ä–∏–∫–∏
  const last48=rows.slice(-48);
  const wet48=last48.filter(isWet).length;
  const tAvg=(last48.reduce((a,b)=>a+b.T,0)/Math.max(1,last48.length)).toFixed(1);
  // –û–ø–∏—Å —Ä–∏–∑–∏–∫—ñ–≤
  const sp= base.smith.active? '–∞–∫—Ç–∏–≤–Ω–∏–π Smith Period –∑–∞ –æ—Å—Ç–∞–Ω–Ω—ñ –¥–Ω—ñ' : 'Smith Period –Ω–µ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–æ';
  const se=`—Å–µ–ø—Ç–æ—Ä—ñ–æ–∑=${base.sept.level} (–º–æ–∫—Ä–æ—Ç–∞ ${base.sept.wet} –≥–æ–¥, TÃÑ ${base.sept.avgT}¬∞C)`;
  const pm=`–±–æ—Ä–æ—à–Ω–∏—Å—Ç–∞ —Ä–æ—Å–∞=${base.pm.level} (${base.pm.share}%)`;
  const spW= whatif.smith.active? '–∞–∫—Ç–∏–≤–Ω–∏–π' : '–Ω—ñ';
  const seW=`${whatif.sept.level} (–º–æ–∫—Ä–æ—Ç–∞ ${whatif.sept.wet} –≥–æ–¥, TÃÑ ${whatif.sept.avgT}¬∞C)`;
  const pmW=`${whatif.pm.level} (${whatif.pm.share}%)`;

  return `–¢–∏ ‚Äî –∞–≥—Ä–æ–Ω–æ–º-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç (IPM). –ü–æ–±—É–¥—É–π –ø–ª–∞–Ω –¥—ñ–π –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º —Ä–∏–∑–∏–∫—ñ–≤ —Ö–≤–æ—Ä–æ–± —ñ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–∏—Ö –æ–±–º–µ–∂–µ–Ω—å. 
–ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–ª—è: –∫—É–ª—å—Ç—É—Ä–∞=${crop}, —Ñ–∞–∑–∞=${bbch}, –ª–æ–∫–∞—Ü—ñ—è=${field}. –î–∞–Ω—ñ –ø–æ–≥–æ–¥–∏ ‚Äî –ø–æ–≥–æ–¥–∏–Ω–Ω—ñ –∑–∞ 3‚Äì4 –¥–æ–±–∏ (T,RH,–æ–ø–∞–¥–∏).
–ö–æ—Ä–æ—Ç–∫–µ –∑–≤–µ–¥–µ–Ω–Ω—è (–æ—Å—Ç.48 –≥–æ–¥): –º–æ–∫—Ä–æ—Ç–∞=${wet48} –≥–æ–¥ (RH‚â•90% –∞–±–æ –¥–æ—â), TÃÑ=${tAvg}¬∞C.
–û—Ü—ñ–Ω–∫–∞ —Ä–∏–∑–∏–∫—ñ–≤ (–±–∞–∑–∞): ${sp}; ${se}; ${pm}.
–°—Ü–µ–Ω–∞—Ä—ñ–π ¬´—â–æ —è–∫—â–æ¬ª (ŒîT=${dT}¬∞C, ŒîRH=${dRH}%, √órain=${mul}): Smith=${spW}; —Å–µ–ø—Ç–æ—Ä—ñ–æ–∑=${seW}; –ø–æ—Ä–æ—à.—Ä–æ–∑–∞=${pmW}.
–û–±–º–µ–∂–µ–Ω–Ω—è/—Ä–µ—Å—É—Ä—Å–∏: ${cons}.

–í–∏–º–æ–≥–∏ –¥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:
1) –ó–∞–ø—Ä–æ–ø–æ–Ω—É–π 3 —Å—Ü–µ–Ω–∞—Ä—ñ—ó IPM: –∞–≥—Ä–æ—Ç–µ—Ö–Ω—ñ—á–Ω–∏–π / –±—ñ–æ / —Ö—ñ–º—ñ—á–Ω–∏–π + ‚Äú–Ω—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–∏—Ç–∏‚Äù (–∑ —Ä–∏–∑–∏–∫–∞–º–∏).
2) –î–ª—è —Ö—ñ–º—ñ—á–Ω–æ–≥–æ ‚Äî –∞–∫—Ç–∏–≤–Ω–∞ —Ä–µ—á–æ–≤–∏–Ω–∞(–∏), FRAC, –æ–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è –∑–∞ —Å–∏–º–ø—Ç–æ–º–∞–º–∏ —Ç–∞ —Ä–∏–∑–∏–∫–∞–º–∏, –≤—ñ–∫–Ω–æ –ø–æ–≥–æ–¥–∏ —ñ –±–µ–∑–ø–µ–∫–∞ (–ó–Ü–ó, REI/PHI).
3) –ü–æ–∫–∞–∂–∏, —è–∫ –ø–ª–∞–Ω –∑–º—ñ–Ω–∏—Ç—å—Å—è –ø—ñ–¥ —Å—Ü–µ–Ω–∞—Ä—ñ—î–º ¬´—â–æ —è–∫—â–æ¬ª.
4) –î–æ–¥–∞–π 3 —É—Ç–æ—á–Ω—é–≤–∞–ª—å–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è —è–∫—â–æ –¥–∞–Ω–∏—Ö –±—Ä–∞–∫—É—î.
–§–æ—Ä–º–∞—Ç: —á—ñ—Ç–∫–∏–π –ø–ª–∞–Ω –∑ –ø—ñ–¥–∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ —ñ –º–∞—Ä–∫–æ–≤–∞–Ω–∏–º–∏ –ø—É–Ω–∫—Ç–∞–º–∏.`;
}

// ======= –ñ—É—Ä–Ω–∞–ª/–∑–≤—ñ—Ç–∏ =======
const logEl=$('#log');
function log(msg){ const t=new Date().toLocaleTimeString(); logEl.textContent+=`[${t}] ${msg}\n`; logEl.scrollTop=logEl.scrollHeight; }

// ======= –ü–æ–¥—ñ—ó =======
$('#emu').addEventListener('click', ()=>{ genDemo(); $('#badgeN').textContent='–ó–∞–ø–∏—Å—ñ–≤: '+rows.length; draw(); const base=applyWhatIf(0,0,1); renderRisks(base); });
$('#parse').addEventListener('click', ()=>{ parseCSV($('#csv').value); $('#badgeN').textContent='–ó–∞–ø–∏—Å—ñ–≤: '+rows.length; draw(); const base=applyWhatIf(0,0,1); renderRisks(base); });
$('#clear').addEventListener('click', ()=>{ rows.length=0; $('#badgeN').textContent='–ó–∞–ø–∏—Å—ñ–≤: 0'; draw(); $('#riskTable tbody').innerHTML=''; $('#promptPreview').textContent='// –°–ø–æ—á–∞—Ç–∫—É —ñ–º–ø–æ—Ä—Ç—É–π –ø–æ–≥–æ–¥—É'; log('–î–∞–Ω—ñ –æ—á–∏—â–µ–Ω–æ'); });
$('#applyWhatIf').addEventListener('click', ()=>{ const dT=parseFloat($('#dT').value)||0, dRH=parseFloat($('#dRH').value)||0, mul=parseFloat($('#mulRain').value)||1; const base=applyWhatIf(dT,dRH,mul); renderRisks(base); });
$('#genPrompt').addEventListener('click', ()=>{ const txt=buildPrompt(); $('#promptPreview').textContent=txt; log('–ü—Ä–æ–º–ø—Ç –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ'); });
$('#copyPrompt').addEventListener('click', ()=>{ const ta=document.createElement('textarea'); ta.value=$('#promptPreview').textContent; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove(); log('–ü—Ä–æ–º–ø—Ç —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'); });
$('#savePrompt').addEventListener('click', ()=>{ const txt=$('#promptPreview').textContent||buildPrompt(); download('agro_para22_prompt_'+stamp()+'.txt',txt); });

$('#saveTxt').addEventListener('click', ()=>{
  const fio=($('#fio').value||'').trim();
  const base=applyWhatIf(0,0,1), wi=applyWhatIf(parseFloat($('#dT').value)||0, parseFloat($('#dRH').value)||0, parseFloat($('#mulRain').value)||1);
  const lines=[
    '–ü–∞—Ä–∞ 22 ‚Äî –®–Ü-–ø—Ä–æ–≥–Ω–æ–∑ —Ä–∏–∑–∏–∫—ñ–≤ —Ö–≤–æ—Ä–æ–±',
    '–°—Ç—É–¥–µ–Ω—Ç: '+fio,
    '–ó–∞–ø–∏—Å—ñ–≤: '+rows.length,
    '–†–∏–∑–∏–∫–∏ (–±–∞–∑–∞): Smith='+(base.smith.active?'—Ç–∞–∫':'–Ω—ñ')+', Septoria='+base.sept.level+', PM='+base.pm.level,
    '–†–∏–∑–∏–∫–∏ (what-if): Smith='+(wi.smith.active?'—Ç–∞–∫':'–Ω—ñ')+', Septoria='+wi.sept.level+', PM='+wi.pm.level,
    '–ü—Ä–æ–º–ø—Ç:','---',($('#promptPreview').textContent||buildPrompt()),'---'
  ].join('\n');
  download('agro_para22_'+stamp()+'.txt',lines);
});
$('#saveCsv').addEventListener('click', ()=>{
  const csv='timestamp,T,RH,rain_mm\n'+rows.map(r=>`${r.t.toISOString()},${r.T},${r.RH},${r.rain}`).join('\n');
  download('agro_para22_weather_'+stamp()+'.csv',csv,'text/csv');
});

// –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
if (window.self !== window.top) document.documentElement.classList.add('embedded'); // Moodle-friendly
</script>


</body></html>