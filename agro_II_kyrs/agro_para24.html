<!DOCTYPE html><html lang="uk"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>–ü–∞—Ä–∞ 24 ‚Äî –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞ —Ñ–æ—Ç–æ + –¥–æ–∫–∞–∑–æ–≤—ñ—Å—Ç—å (LLM-—à–∞–±–ª–æ–Ω–∏ + —á–µ–∫–µ—Ä –¥–∂–µ—Ä–µ–ª)</title>
<meta name="description" content="–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–æ—Ç–æ —Å–∏–º–ø—Ç–æ–º—ñ–≤, –∞–Ω–æ—Ç–∞—Ü—ñ—ó –Ω–∞ –∑–Ω—ñ–º–∫—É, –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—Ä–æ–º–ø—Ç–∞ –¥–æ LLM –¥–ª—è –¥–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ–π–Ω–æ—ó –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∑ –¥–∂–µ—Ä–µ–ª–∞–º–∏, —á–µ–∫–µ—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –®–Ü, –∂—É—Ä–Ω–∞–ª —Ä—ñ—à–µ–Ω—å, –µ–∫—Å–ø–æ—Ä—Ç —ñ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—á–µ–Ω–æ–≥–æ –∑–Ω—ñ–º–∫–∞.">
<meta name="color-scheme" content="light dark">
<style>
:root{--bg:#0b1220;--panel:#0f172a;--muted:#94a3b8;--text:#e6eef9;--line:#223049;--brand:#38bdf8;--ok:#22c55e;--warn:#fbbf24;--bad:#f87171}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,"Segoe UI",Inter,Roboto,Arial,sans-serif}
.wrap{max-width:1040px;margin:0 auto;padding:16px}
header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.logo{display:flex;align-items:center;gap:10px}
.logo .emoji{font-size:28px}
.logo .badge{font-size:.9rem;color:var(--muted);border:1px solid var(--line);padding:2px 8px;border-radius:999px}
h1{margin:.2em 0 .3em 0}
.muted{color:var(--muted)}
.card{border:1px solid var(--line);border-radius:16px;background:var(--panel);padding:14px;margin-top:14px}
.row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.btn{border:1px solid var(--line);background:#0f1f39;color:var(--text);padding:8px 12px;border-radius:10px;cursor:pointer}
.btn.secondary{background:transparent}
.btn.good{border-color:#204b2a;background:#12341b}
.input,select,textarea{width:100%;padding:8px;border-radius:10px;border:1px solid var(--line);background:#0b1220;color:var(--text)}
small.mono,.mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,"Courier New",monospace}
.grid{display:grid;gap:14px;grid-template-columns:1.35fr 1fr}
@media(max-width:1040px){.grid{grid-template-columns:1fr}}
hr.sep{border:none;border-top:1px solid var(--line);margin:16px 0}
.note{border:1px dashed var(--line);border-radius:12px;padding:10px;background:#0c182a}
svg{max-width:100%;height:auto;display:block}
pre.code{background:#0b1220;border:1px solid var(--line);border-radius:12px;padding:12px;overflow:auto;white-space:pre-wrap}
kbd{background:#111827;border:1px solid #334155;border-radius:6px;padding:2px 6px}
.canvasWrap{border:1px solid var(--line);border-radius:12px;overflow:hidden;background:#0b1220;display:grid;grid-template-columns:1fr}
canvas{display:block;width:100%;height:auto;image-rendering:auto}
.badge{display:inline-block;border:1px solid #334155;border-radius:999px;padding:2px 8px;color:var(--muted);margin-right:6px}
.tbl{width:100%;border-collapse:collapse;font-size:.95rem}
.tbl th,.tbl td{border:1px solid var(--line);padding:6px;text-align:left;vertical-align:top}
.tbl th{background:#0b1a2f}
.log{max-height:170px;overflow:auto;border:1px solid var(--line);border-radius:10px;padding:8px;background:#0b1220;font-family:ui-monospace,monospace;font-size:13px;white-space:pre-wrap}
.footer{margin-top:20px;color:var(--muted);font-size:.9rem}
.tag{display:inline-block;border:1px solid var(--line);border-radius:999px;padding:2px 8px;color:var(--muted);margin-right:6px;margin-top:6px}
.ok{color:var(--ok)}.warn{color:var(--warn)}.bad{color:var(--bad)}
.small{font-size:.9rem}
</style>
<link rel="canonical" href="https://edlab.pp.ua/agro_II_kyrs/agro_para24.html"><meta property="og:type" content="article"><meta property="og:title" content="–ê–≥—Ä–æ–Ω–æ–º—ñ—è ‚Äî –ü–∞—Ä–∞ 24"><meta property="og:description" content="–ú–µ—Ç–∞: –Ω–∞–≤—á–∏—Ç–∏—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–æ –æ–ø–∏—Å—É–≤–∞—Ç–∏ –∑–Ω—ñ–º–∫–∏, —Ä–æ–±–∏—Ç–∏ –¥–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ–π–Ω—É –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫—É –∑–∞ –æ–∑–Ω–∞–∫–∞–º–∏, —Ñ–æ—Ä–º—É–ª—é–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç –¥–æ –®–Ü –∑ –≤–∏–º–æ–≥–æ—é –¥–∂–µ—Ä–µ–ª —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ"><meta property="og:url" content="https://edlab.pp.ua/agro_II_kyrs/agro_para24.html"><script type="application/ld+json">{"@context":"https://schema.org","@type":"LearningResource","name":"–ê–≥—Ä–æ–Ω–æ–º—ñ—è ‚Äî –ü–∞—Ä–∞ 24","description":"–ú–µ—Ç–∞: –Ω–∞–≤—á–∏—Ç–∏—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–æ –æ–ø–∏—Å—É–≤–∞—Ç–∏ –∑–Ω—ñ–º–∫–∏, —Ä–æ–±–∏—Ç–∏ –¥–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ–π–Ω—É –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫—É –∑–∞ –æ–∑–Ω–∞–∫–∞–º–∏, —Ñ–æ—Ä–º—É–ª—é–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç –¥–æ –®–Ü –∑ –≤–∏–º–æ–≥–æ—é –¥–∂–µ—Ä–µ–ª —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ","inLanguage":"uk","educationalLevel":"college","url":"https://edlab.pp.ua/agro_II_kyrs/agro_para24.html","provider":{"@type":"Organization","name":"EDLab"}}</script></head>
<body>
<div class="wrap">
  <header>
    <div class="logo">
      <span class="emoji">üñºÔ∏è</span>
      <div>
        <b>–ü–∞—Ä–∞ 24 ‚Äî –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞ —Ñ–æ—Ç–æ + –¥–æ–∫–∞–∑–æ–≤—ñ—Å—Ç—å</b><br>
        <span class="badge">–§–æ—Ç–æ ‚Üí –∞–Ω–æ—Ç–∞—Ü—ñ—ó ‚Üí –¥–∏—Ñ–¥—ñ–∞–≥–Ω–æ–∑ ‚Üí –ø—Ä–æ–º–ø—Ç –¥–æ LLM ‚Üí —á–µ–∫–µ—Ä –¥–∂–µ—Ä–µ–ª ‚Üí —Ä—ñ—à–µ–Ω–Ω—è</span>
      </div>
    </div>
    <a class="btn" href="../index.html" target="_blank" rel="noopener">üè† –ù–∞ –≥–æ–ª–æ–≤–Ω—É</a>
  </header>

  <p class="muted">
    –ú–µ—Ç–∞: –Ω–∞–≤—á–∏—Ç–∏—Å—è <b>—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–æ –æ–ø–∏—Å—É–≤–∞—Ç–∏ –∑–Ω—ñ–º–∫–∏</b>, —Ä–æ–±–∏—Ç–∏ <b>–¥–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ–π–Ω—É –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫—É</b> –∑–∞ –æ–∑–Ω–∞–∫–∞–º–∏, —Ñ–æ—Ä–º—É–ª—é–≤–∞—Ç–∏ –∑–∞–ø–∏—Ç –¥–æ –®–Ü –∑ –≤–∏–º–æ–≥–æ—é <b>–¥–∂–µ—Ä–µ–ª</b> —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∑–∞ <b>—á–µ–∫-–ª–∏—Å—Ç–æ–º –¥–æ–∫–∞–∑–æ–≤–æ—Å—Ç—ñ</b>. –Ñ –∂—É—Ä–Ω–∞–ª —Ä—ñ—à–µ–Ω—å —ñ –µ–∫—Å–ø–æ—Ä—Ç.
  </p>

  <div class="grid">
    <!-- –õ–Ü–í–ê –ö–û–õ–û–ù–ö–ê -->
    <div class="card">
      <h2>üñºÔ∏è –§–æ—Ç–æ + –∞–Ω–æ—Ç–∞—Ü—ñ—ó</h2>
      <div class="row">
        <input id="file" class="input" type="file" accept="image/*" multiple="">
        <button class="btn secondary" id="demo">üé≤ –î–µ–º–æ–∫–µ–π—Å</button>
        <button class="btn secondary" id="clearImg">üßπ –û—á–∏—Å—Ç–∏—Ç–∏</button>
        <span id="badgeImg" class="badge">–ó–æ–±—Ä–∞–∂–µ–Ω—å: 0</span>
      </div>

      <div class="row">
        <div style="flex:1">
          <label for="crop">–ö—É–ª—å—Ç—É—Ä–∞</label>
          <select id="crop" class="input">
            <option>–ü—à–µ–Ω–∏—Ü—è –æ–∑–∏–º–∞</option><option>–ö–∞—Ä—Ç–æ–ø–ª—è</option><option>–ö—É–∫—É—Ä—É–¥–∑–∞</option><option>–°–æ–Ω—è—à–Ω–∏–∫</option><option>–°–æ—è</option><option>–†—ñ–ø–∞–∫</option>
          </select>
        </div>
        <div style="flex:1">
          <label for="bbch">–§–∞–∑–∞ (BBCH)</label>
          <input id="bbch" class="input" placeholder="–Ω–∞–ø—Ä. BBCH 37">
        </div>
      </div>

      <div class="row">
        <div style="flex:1">
          <label for="weather">–ü–æ–≥–æ–¥–∞ (–æ—Å—Ç. 3‚Äì5 –¥–Ω—ñ–≤)</label>
          <input id="weather" class="input" placeholder="t–º–∞–∫—Å/–º—ñ–Ω, RH, –æ–ø–∞–¥–∏, —Ä–æ—Å–∞">
        </div>
        <div style="flex:1">
          <label for="field">–ü–æ–ª–µ/–ª–æ–∫–∞—Ü—ñ—è</label>
          <input id="field" class="input" placeholder="–ü–æ–ª–µ ‚Ññ3, –¢–∞–ª—å–Ω–µ">
        </div>
      </div>

      <div class="row">
        <div style="flex:1">
          <label for="suspects">–ü—ñ–¥–æ–∑—Ä–∏</label>
          <input id="suspects" class="input" placeholder="—Å–µ–ø—Ç–æ—Ä—ñ–æ–∑ / —Ñ—ñ—Ç–æ—Ñ—Ç–æ—Ä–æ–∑ / –±–æ—Ä–æ—à–Ω–∏—Å—Ç–∞ —Ä–æ—Å–∞ / –¥–µ—Ñ—ñ—Ü–∏—Ç N / —à–∫—ñ–¥–Ω–∏–∫">
        </div>
        <div style="flex:1">
          <label for="prehistory">–ü–µ—Ä–µ–¥—ñ—Å—Ç–æ—Ä—ñ—è</label>
          <input id="prehistory" class="input" placeholder="–ø–æ–ø–µ—Ä–µ–¥–Ω—è –æ–±—Ä–æ–±–∫–∞, —Å—Ç—Ä–µ—Å–∏, –ø–æ–ø–µ—Ä–µ–¥–Ω–∏–∫, “ë—Ä—É–Ω—Ç">
        </div>
      </div>

      <div class="note small" style="margin-top:6px">
        <b>–ê–Ω–æ—Ç–∞—Ü—ñ—ó:</b> –º–∏—à–∫–æ—é –Ω–∞–º–∞–ª—é–π –ø—Ä—è–º–æ–∫—É—Ç–Ω–∏–∫, –ø–æ—Ç—ñ–º –≤–∏–±–µ—Ä–∏ —Ç–∏–ø –æ–∑–Ω–∞–∫–∏. –ó–±–µ—Ä—ñ–≥–∞–π —Ä–æ–∑–º—ñ—á–µ–Ω–∏–π –∑–Ω—ñ–º–æ–∫ —è–∫ PNG.
      </div>

      <div class="row" style="align-items:flex-start">
        <div class="canvasWrap" style="flex:2">
          <canvas id="cvs" width="900" height="560" aria-label="–ü–æ–ª–æ—Ç–Ω–æ –¥–ª—è –∞–Ω–æ—Ç–∞—Ü—ñ–π"></canvas>
        </div>
        <div style="flex:1">
          <label for="labelSel">–¢–∏–ø –æ–∑–Ω–∞–∫–∏</label>
          <select id="labelSel" class="input">
            <option value="–ø–ª—è–º–∞">–ø–ª—è–º–∞</option>
            <option value="–Ω–∞–ª—ñ—Ç/–º—ñ—Ü–µ–ª—ñ–π">–Ω–∞–ª—ñ—Ç/–º—ñ—Ü–µ–ª—ñ–π</option>
            <option value="–ø—É—Å—Ç—É–ª–∏/–ø—ñ–∫–Ω—ñ–¥–∏">–ø—É—Å—Ç—É–ª–∏/–ø—ñ–∫–Ω—ñ–¥–∏</option>
            <option value="—à–∫—ñ–¥–Ω–∏–∫/—Ö–æ–¥–∏">—à–∫—ñ–¥–Ω–∏–∫/—Ö–æ–¥–∏</option>
            <option value="–¥–µ—Ñ—ñ—Ü–∏—Ç/—Ö–ª–æ—Ä–æ–∑">–¥–µ—Ñ—ñ—Ü–∏—Ç/—Ö–ª–æ—Ä–æ–∑</option>
            <option value="–º–µ—Ö–∞–Ω—ñ—á–Ω–µ/–æ–ø—ñ–∫">–º–µ—Ö–∞–Ω—ñ—á–Ω–µ/–æ–ø—ñ–∫</option>
          </select>
          <div class="row" style="margin-top:8px">
            <button class="btn" id="undo">‚Ü©Ô∏è –°–∫–∞—Å—É–≤–∞—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—î</button>
            <button class="btn secondary" id="savePng">‚¨áÔ∏è –ó–±–µ—Ä–µ–≥—Ç–∏ PNG</button>
          </div>
          <h3 style="margin-top:10px">üìã –î–æ–∫–∞–∑–∏ (–∞–Ω–æ—Ç–∞—Ü—ñ—ó)</h3>
          <table class="tbl" id="evTbl">
            <thead><tr><th>#</th><th>–¢–∏–ø</th><th>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏</th><th>–û–ø–∏—Å (–Ω–µ–æ–±–æ–≤‚Äô—è–∑–∫.)</th></tr></thead>
            <tbody></tbody>
          </table>
          <div class="row" style="margin-top:8px">
            <input id="evDesc" class="input" placeholder="–ö–æ—Ä–æ—Ç–∫–∏–π –æ–ø–∏—Å –≤–∏–¥—ñ–ª–µ–Ω–æ–≥–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞">
            <button class="btn" id="attachDesc">‚ûï –î–æ–¥–∞—Ç–∏ –æ–ø–∏—Å –¥–æ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ</button>
          </div>
        </div>
      </div>

      <h3 style="margin-top:12px">üß© –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è LLM</h3>
      <div class="row">
        <button class="btn good" id="genPrompt">‚öôÔ∏è –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏</button>
        <button class="btn secondary" id="copyPrompt">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
        <button class="btn secondary" id="dlPrompt">‚¨áÔ∏è TXT</button>
      </div>
      <pre class="code" id="prompt">// –ó—Ä–æ–±–∏ –∞–Ω–æ—Ç–∞—Ü—ñ—ó –∞–±–æ –Ω–∞—Ç–∏—Å–Ω–∏ ¬´üé≤ –î–µ–º–æ–∫–µ–π—Å¬ª</pre>
    </div>

    <!-- –ü–†–ê–í–ê –ö–û–õ–û–ù–ö–ê -->
    <div class="card">
      <h2>üß™ –ß–µ–∫–µ—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –®–Ü (–¥–æ–∫–∞–∑–æ–≤—ñ—Å—Ç—å)</h2>
      <p class="small muted">–í—Å—Ç–∞–≤ –≤—ñ–¥–ø–æ–≤—ñ–¥—å LLM –Ω–∏–∂—á–µ ‚Äî –æ—Ç—Ä–∏–º–∞—î—à –æ—Ü—ñ–Ω–∫—É –¥–∂–µ—Ä–µ–ª, —Ä–∏–∑–∏–∫—ñ–≤ —ñ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è.</p>
      <textarea id="llm" class="input" rows="12" placeholder="–í—Å—Ç–∞–≤ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –®–Ü —Ç—É—Ç..."></textarea>
      <div class="row" style="margin-top:6px">
        <button class="btn" id="checkLLM">üîç –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
        <span id="badgeScore" class="badge">Score: ‚Äî/100</span>
      </div>
      <table class="tbl" style="margin-top:8px">
        <thead><tr><th>–ö—Ä–∏—Ç–µ—Ä—ñ–π</th><th>–û–ø–∏—Å</th><th>–°—Ç–∞—Ç—É—Å</th></tr></thead>
        <tbody id="critTbl"></tbody>
      </table>

      <h2 style="margin-top:12px">üîÅ –°—Ö–µ–º–∞ –ø—Ä–æ—Ü–µ—Å—É (SVG)</h2>
      <svg viewBox="0 0 760 420" role="img" aria-label="–ü—Ä–æ—Ü–µ—Å –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∑–∞ —Ñ–æ—Ç–æ">
        <rect x="40" y="40" width="170" height="80" rx="12" fill="#0e2a47" stroke="#3b82f6"></rect>
        <text x="125" y="70" fill="#e5e7eb" font-size="14" text-anchor="middle">–§–æ—Ç–æ</text>
        <text x="125" y="88" fill="#93c5fd" font-size="12" text-anchor="middle">—è–∫—ñ—Å—Ç—å/—Ä–∞–∫—É—Ä—Å</text>

        <rect x="240" y="40" width="200" height="80" rx="12" fill="#14532d" stroke="#22c55e"></rect>
        <text x="340" y="70" fill="#dcfce7" font-size="14" text-anchor="middle">–ê–Ω–æ—Ç–∞—Ü—ñ—ó</text>
        <text x="340" y="88" fill="#a7f3d0" font-size="12" text-anchor="middle">–æ–∑–Ω–∞–∫–∏/–ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—è</text>

        <rect x="480" y="40" width="240" height="80" rx="12" fill="#1f2937" stroke="#9ca3af"></rect>
        <text x="600" y="70" fill="#e5e7eb" font-size="14" text-anchor="middle">LLM-–ø—Ä–æ–º–ø—Ç</text>
        <text x="600" y="88" fill="#94a3b8" font-size="12" text-anchor="middle">–≤–∏–º–æ–≥–∞ –¥–∂–µ—Ä–µ–ª</text>

        <line x1="210" y1="80" x2="240" y2="80" stroke="#93c5fd" stroke-width="3"></line>
        <line x1="440" y1="80" x2="480" y2="80" stroke="#93c5fd" stroke-width="3"></line>

        <rect x="40" y="170" width="240" height="90" rx="12" fill="#0b3f5a" stroke="#22d3ee"></rect>
        <text x="160" y="200" fill="#a5f3fc" font-size="14" text-anchor="middle">–í—ñ–¥–ø–æ–≤—ñ–¥—å –®–Ü</text>
        <text x="160" y="220" fill="#a5f3fc" font-size="12" text-anchor="middle">–¥–∏—Ñ–¥—ñ–∞–≥–Ω–æ–∑</text>

        <rect x="320" y="170" width="180" height="90" rx="12" fill="#7c2d12" stroke="#fb923c"></rect>
        <text x="410" y="200" fill="#fed7aa" font-size="14" text-anchor="middle">–ß–µ–∫–µ—Ä</text>
        <text x="410" y="220" fill="#fed7aa" font-size="12" text-anchor="middle">–¥–∂–µ—Ä–µ–ª–∞/—Ä–∏–∑–∏–∫–∏</text>

        <rect x="540" y="170" width="180" height="90" rx="12" fill="#111827" stroke="#4b5563"></rect>
        <text x="630" y="200" fill="#e5e7eb" font-size="14" text-anchor="middle">–†—ñ—à–µ–Ω–Ω—è</text>
        <text x="630" y="220" fill="#9ca3af" font-size="12" text-anchor="middle">IPM + –±–µ–∑–ø–µ–∫–∞</text>
      </svg>

      <div class="card" style="margin-top:12px">
        <h3>üìú –ù–æ—Ç–∞—Ç–∫–∞ –∑ —ñ—Å—Ç–æ—Ä—ñ—ó</h3>
        <p class="muted small">
          –£ 1980-—Ö –µ–∫—Å–ø–µ—Ä—Ç–Ω—ñ —Å–∏—Å—Ç–µ–º–∏ –∞–Ω–∞–ª—ñ–∑—É–≤–∞–ª–∏ —Ñ–æ—Ç–æ –∑–∞ –Ω–∞–±–æ—Ä–∞–º–∏ ¬´—è–∫—â–æ-—Ç–æ¬ª. 
          –°—É—á–∞—Å–Ω—ñ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ñ LLM —Ä–æ–∑–ø—ñ–∑–Ω–∞—é—Ç—å –æ–±—Ä–∞–∑–∏ –∫—Ä–∞—â–µ, –∞–ª–µ <b>–¥–æ–∫–∞–∑–æ–≤—ñ—Å—Ç—å</b> ‚Äî –Ω–∞ –Ω–∞—Å: –ø–æ—Ç—Ä—ñ–±–Ω—ñ –∞–Ω–æ—Ç–∞—Ü—ñ—ó, –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤ —ñ <b>–¥–∂–µ—Ä–µ–ª–∞</b>.
        </p>
      </div>

      <h3 style="margin-top:12px">üíæ –ü—ñ–¥—Å—É–º–æ–∫/–∂—É—Ä–Ω–∞–ª</h3>
      <div class="row">
        <input id="fio" class="input" placeholder="–ü–Ü–ë —Å—Ç—É–¥–µ–Ω—Ç–∞">
        <input id="decision" class="input" placeholder="–†—ñ—à–µ–Ω–Ω—è (–∫–æ—Ä–æ—Ç–∫–æ)">
        <button class="btn" id="addLog">‚ûï –î–æ–¥–∞—Ç–∏</button>
        <button class="btn secondary" id="saveTxt">üíæ TXT</button>
        <button class="btn secondary" id="saveCsv">üìÑ CSV</button>
      </div>
      <div id="log" class="log" aria-live="polite"></div>

      <h3 style="margin-top:12px">üß∑ –¢–µ–≥–∏</h3>
      <div>
        <span class="tag">#photo_diagnostics</span>
        <span class="tag">#differential</span>
        <span class="tag">#evidence_based</span>
        <span class="tag">#prompt_engineering</span>
        <span class="tag">#IPM</span>
      </div>
    </div>
  </div>

  <div class="card">
    <h2>üìã –ü—ñ–¥—Å—É–º–æ–∫ –¥–ª—è –∑–≤—ñ—Ç—É</h2>
    <ul>
      <li>–†–æ–∑–º—ñ—á–µ–Ω–∏–π PNG + —Ç–∞–±–ª–∏—Ü—è –∞–Ω–æ—Ç–∞—Ü—ñ–π.</li>
      <li>–ü—Ä–æ–º–ø—Ç –¥–æ LLM —ñ –≤—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å.</li>
      <li>–û—Ü—ñ–Ω–∫–∞ —á–µ–∫–µ—Ä–∞ (Score) —Ç–∞ –≤–∏—Å–Ω–æ–≤–æ–∫/—Ä—ñ—à–µ–Ω–Ω—è.</li>
    </ul>
  </div>

  <div class="footer">
    –û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: <time datetime="2025-10-18">18.10.2025</time>. –ê–≤—Ç–æ—Ä: –°–µ—Ä–≥—ñ–π –ü–æ–ª—ñ—â—É–∫.
  </div>
</div>

<script>
// ===== –£—Ç–∏–ª—ñ—Ç–∏ =====
const $=s=>document.querySelector(s);
function download(name,text,type="text/plain"){const b=new Blob([text],{type:type+";charset=utf-8"});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download=name;document.body.appendChild(a);a.click();a.remove();URL.revokeObjectURL(u);}
function stamp(){return new Date().toISOString().replace(/[:T]/g,'-').slice(0,16);}
function log(msg){const t=new Date().toLocaleTimeString(); LOG.textContent+=`[${t}] ${msg}\n`; LOG.scrollTop=LOG.scrollHeight;}

// ===== –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ç–∞ –ø–æ–ª–æ—Ç–Ω–æ =====
const cvs=$('#cvs'), ctx=cvs.getContext('2d',{alpha:false});
const IMG_BADGE=$('#badgeImg'), LOG=$('#log');
let img=null; // Image object
let scale=1, offsetX=0, offsetY=0;

function fitImage(w,h){
  const W=cvs.width, H=cvs.height;
  const s=Math.min(W/w, H/h);
  const x=(W - w*s)/2, y=(H - h*s)/2;
  return {s, x, y};
}

function drawAll(){
  ctx.fillStyle='#0b1220'; ctx.fillRect(0,0,cvs.width,cvs.height);
  if(img){
    const f=fitImage(img.width,img.height); scale=f.s; offsetX=f.x; offsetY=f.y;
    ctx.drawImage(img, offsetX, offsetY, img.width*scale, img.height*scale);
  } else {
    // –ü–æ—Ä–æ–∂–Ω—è —Å—ñ—Ç–∫–∞
    ctx.strokeStyle='#223049'; ctx.strokeRect(0.5,0.5,cvs.width-1,cvs.height-1);
    for(let x=0;x<cvs.width;x+=40){ ctx.beginPath(); ctx.strokeStyle='#132037'; ctx.moveTo(x,0); ctx.lineTo(x,cvs.height); ctx.stroke(); }
    for(let y=0;y<cvs.height;y+=40){ ctx.beginPath(); ctx.strokeStyle='#132037'; ctx.moveTo(0,y); ctx.lineTo(cvs.width,y); ctx.stroke(); }
  }
  // –ê–Ω–æ—Ç–∞—Ü—ñ—ó
  drawBoxes();
}

// ===== –ê–Ω–æ—Ç–∞—Ü—ñ—ó =====
let boxes=[]; // {x,y,w,h,label,desc}
let drag=null; // {sx,sy}

const COLORS={
  '–ø–ª—è–º–∞':'#38bdf8','–Ω–∞–ª—ñ—Ç/–º—ñ—Ü–µ–ª—ñ–π':'#22c55e','–ø—É—Å—Ç—É–ª–∏/–ø—ñ–∫–Ω—ñ–¥–∏':'#fbbf24',
  '—à–∫—ñ–¥–Ω–∏–∫/—Ö–æ–¥–∏':'#e879f9','–¥–µ—Ñ—ñ—Ü–∏—Ç/—Ö–ª–æ—Ä–æ–∑':'#a3e635','–º–µ—Ö–∞–Ω—ñ—á–Ω–µ/–æ–ø—ñ–∫':'#f87171'
};

function imgToCanvas(x,y){ return {x: Math.round(offsetX + x*scale), y: Math.round(offsetY + y*scale)} }
function canvasToImg(x,y){ return {x: Math.round((x - offsetX)/scale), y: Math.round((y - offsetY)/scale)} }

function drawBoxes(){
  boxes.forEach((b,i)=>{
    ctx.strokeStyle=COLORS[b.label]||'#fff'; ctx.lineWidth=2;
    ctx.strokeRect(offsetX+b.x*scale, offsetY+b.y*scale, b.w*scale, b.h*scale);
    ctx.fillStyle='rgba(0,0,0,0.5)'; ctx.fillRect(offsetX+b.x*scale, offsetY+b.y*scale-18, Math.max(60, b.label.length*8), 18);
    ctx.fillStyle='#e6eef9'; ctx.font='12px ui-monospace';
    ctx.fillText(`${i+1}. ${b.label}`, offsetX+b.x*scale+4, offsetY+b.y*scale-5);
  });
  renderEvTable();
}

cvs.addEventListener('mousedown', (e)=>{
  if(!img) return;
  const rect=cvs.getBoundingClientRect();
  const x=e.clientX-rect.left, y=e.clientY-rect.top;
  drag={sx:x, sy:y};
});
cvs.addEventListener('mousemove', (e)=>{
  if(!img || !drag) return;
  drawAll();
  const rect=cvs.getBoundingClientRect(), x=e.clientX-rect.left, y=e.clientY-rect.top;
  const w=x-drag.sx, h=y-drag.sy;
  ctx.setLineDash([6,4]); ctx.strokeStyle='#94a3b8'; ctx.strokeRect(drag.sx, drag.sy, w, h); ctx.setLineDash([]);
});
cvs.addEventListener('mouseup', (e)=>{
  if(!img || !drag) return;
  const rect=cvs.getBoundingClientRect(), x=e.clientX-rect.left, y=e.clientY-rect.top;
  const p1=canvasToImg(drag.sx,drag.sy), p2=canvasToImg(x,y);
  const bx=Math.min(p1.x,p2.x), by=Math.min(p1.y,p2.y), bw=Math.abs(p2.x-p1.x), bh=Math.abs(p2.y-p1.y);
  drag=null;
  if(bw<5 || bh<5) { drawAll(); return; }
  const label=$('#labelSel').value;
  boxes.push({x:bx,y:by,w:bw,h:bh,label,desc:''});
  drawAll();
});

$('#undo').addEventListener('click', ()=>{ boxes.pop(); drawAll(); });

function renderEvTable(){
  const tb=$('#evTbl tbody'); tb.innerHTML='';
  boxes.forEach((b,i)=>{
    const tr=document.createElement('tr');
    const coords=`x=${b.x},y=${b.y},w=${b.w},h=${b.h}`;
    tr.innerHTML=`<td>${i+1}</td><td>${b.label}</td><td class="small">${coords}</td><td class="small">${b.desc||''}</td>`;
    tb.appendChild(tr);
  });
}

$('#attachDesc').addEventListener('click', ()=>{
  if(boxes.length===0) return;
  boxes[boxes.length-1].desc = ($('#evDesc').value||'').trim();
  $('#evDesc').value=''; renderEvTable();
});

$('#savePng').addEventListener('click', ()=>{
  const out=document.createElement('canvas');
  out.width=cvs.width; out.height=cvs.height;
  const octx=out.getContext('2d');
  // —Ñ–æ–Ω + –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è + —Ä–∞–º–∫–∏
  octx.fillStyle='#0b1220'; octx.fillRect(0,0,out.width,out.height);
  if(img){ octx.drawImage(img, offsetX, offsetY, img.width*scale, img.height*scale); }
  // –ø–µ—Ä–µ–Ω–∞–º–∞–ª—é—î–º–æ –±–æ–∫—Å–∏
  boxes.forEach((b,i)=>{
    octx.strokeStyle=COLORS[b.label]||'#fff'; octx.lineWidth=2;
    octx.strokeRect(offsetX+b.x*scale, offsetY+b.y*scale, b.w*scale, b.h*scale);
    octx.fillStyle='rgba(0,0,0,0.5)'; octx.fillRect(offsetX+b.x*scale, offsetY+b.y*scale-18, Math.max(60, b.label.length*8), 18);
    octx.fillStyle='#e6eef9'; octx.font='12px ui-monospace';
    octx.fillText(`${i+1}. ${b.label}`, offsetX+b.x*scale+4, offsetY+b.y*scale-5);
  });
  const url=out.toDataURL('image/png');
  const a=document.createElement('a'); a.href=url; a.download='para24_annotated_'+stamp()+'.png'; document.body.appendChild(a); a.click(); a.remove();
});

// –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å
$('#file').addEventListener('change', async (e)=>{
  const files=[...e.target.files];
  IMG_BADGE.textContent='–ó–æ–±—Ä–∞–∂–µ–Ω—å: '+files.length;
  if(files.length===0) { img=null; boxes=[]; drawAll(); return; }
  const f=files[0]; const url=URL.createObjectURL(f);
  img=new Image(); img.onload=()=>{ URL.revokeObjectURL(url); drawAll(); }; img.src=url;
  boxes=[]; // –Ω–æ–≤–µ —Ñ–æ—Ç–æ ‚Äî —á–∏—Å—Ç—ñ –∞–Ω–æ—Ç–∞—Ü—ñ—ó
});

// –î–µ–º–æ–∫–µ–π—Å ‚Äî –º–∞–ª—é—î–º–æ —à—Ç—É—á–Ω–µ –ª–∏—Å—Ç—è –∑ ¬´–ø–ª—è–º–∞–º–∏¬ª
$('#demo').addEventListener('click', ()=>{
  img=null; boxes=[]; drawAll();
  // –ú–∞–ª—é—î–º–æ –ª–∏—Å—Ç
  ctx.fillStyle='#0b1220'; ctx.fillRect(0,0,cvs.width,cvs.height);
  ctx.strokeStyle='#223049'; ctx.strokeRect(0.5,0.5,cvs.width-1,cvs.height-1);
  // –ª–∏—Å—Ç
  ctx.fillStyle='#0b3f24';
  ctx.beginPath();
  ctx.ellipse(460,300,280,140, -0.2, 0, Math.PI*2); ctx.fill();
  // –∂–∏–ª–∫–∏
  ctx.strokeStyle='#14532d'; ctx.lineWidth=3;
  ctx.beginPath(); ctx.moveTo(240,300); ctx.lineTo(680,300); ctx.stroke();
  // ¬´–ø–ª—è–º–∏¬ª
  ctx.fillStyle='#6b7280'; ctx.beginPath(); ctx.ellipse(520,260,40,18,0,0,Math.PI*2); ctx.fill();
  ctx.fillStyle='#9ca3af'; ctx.beginPath(); ctx.ellipse(400,340,32,14,0,0,Math.PI*2); ctx.fill();
  // ¬´–ø—ñ–∫–Ω—ñ–¥–∏¬ª
  ctx.fillStyle='#1f2937'; for(let i=0;i<18;i++){ ctx.beginPath(); ctx.arc(505+Math.random()*26-13, 252+Math.random()*16-8, 2, 0, Math.PI*2); ctx.fill(); }
  // –ó–∞–ø–æ–≤–Ω—é—î–º–æ –ø–æ–ª—è
  $('#crop').value='–ü—à–µ–Ω–∏—Ü—è –æ–∑–∏–º–∞'; $('#bbch').value='BBCH 37'; $('#weather').value='t 24‚Äì27/10‚Äì12¬∞C; RH 70‚Äì95%; —Ä–æ—Å–∞ –∑—Ä–∞–Ω–∫—É'; $('#field').value='–ü–æ–ª–µ ‚Ññ3, –¢–∞–ª—å–Ω–µ'; $('#suspects').value='—Å–µ–ø—Ç–æ—Ä—ñ–æ–∑ / –±–æ—Ä–æ—à–Ω–∏—Å—Ç–∞ —Ä–æ—Å–∞'; $('#prehistory').value='–∑–∞–≥—É—â–µ–Ω–Ω—è –Ω–∞ –∫—Ä–∞—ó; –±–µ–∑ —Ñ—É–Ω–≥—ñ—Ü–∏–¥—É 18 –¥–Ω—ñ–≤';
  // –ê–Ω–æ—Ç–∞—Ü—ñ—ó
  boxes=[
    {x:520-40,y:260-18,w:80,h:36,label:'–ø–ª—è–º–∞',desc:'–æ–≤–∞–ª—å–Ω–∞ –ø–ª—è–º–∞ –∑—ñ —Å–≤—ñ—Ç–ª—ñ—à–æ—é —Å–µ—Ä–µ–¥–∏–Ω–æ—é'},
    {x:400-32,y:340-14,w:64,h:28,label:'–ø–ª—è–º–∞',desc:'–ø–æ–¥–æ–≤–∂–µ–Ω–∞ –ø–ª—è–º–∞ –∑ –∂–æ–≤—Ç–∏–º –æ—Ä–µ–æ–ª–æ–º'},
    {x:492,y:244,w:26,h:16,label:'–ø—É—Å—Ç—É–ª–∏/–ø—ñ–∫–Ω—ñ–¥–∏',desc:'—Ç–æ—á–∫–∏ –≤ —Ü–µ–Ω—Ç—Ä—ñ –ø–ª—è–º–∏ (–ø—ñ–∫–Ω—ñ–¥–∏)'}
  ];
  IMG_BADGE.textContent='–ó–æ–±—Ä–∞–∂–µ–Ω—å: 1 (–¥–µ–º–æ-–ø–æ–ª–æ—Ç–Ω–æ)'; drawAll(); log('–î–µ–º–æ–∫–µ–π—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ');
});

$('#clearImg').addEventListener('click', ()=>{ img=null; boxes=[]; drawAll(); IMG_BADGE.textContent='–ó–æ–±—Ä–∞–∂–µ–Ω—å: 0'; });

// ===== –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—Ä–æ–º–ø—Ç–∞ =====
function buildPrompt(){
  const crop=$('#crop').value.trim();
  const bbch=$('#bbch').value.trim()||'–Ω–µ –≤–∫–∞–∑–∞–Ω–æ';
  const field=$('#field').value.trim()||'‚Äî';
  const weather=$('#weather').value.trim()||'‚Äî';
  const suspects=$('#suspects').value.trim()||'‚Äî';
  const prehistory=$('#prehistory').value.trim()||'‚Äî';
  // –°—Ç–∏—Å–ª–∏–π –æ–ø–∏—Å –∞–Ω–æ—Ç–∞—Ü—ñ–π
  const ev=boxes.map((b,i)=>({i:i+1,type:b.label,rect:{x:b.x,y:b.y,w:b.w,h:b.h},desc:b.desc||''}));
  const evText=ev.map(e=>`#${e.i}: ${e.type}; rect(${e.rect.x},${e.rect.y},${e.rect.w}√ó${e.rect.h}); ${e.desc}`).join('\n');

  return `–¢–∏ ‚Äî –∞–≥—Ä–æ–Ω–æ–º-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç (IPM) –∑ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–∏–º–∏ –º–æ–∂–ª–∏–≤–æ—Å—Ç—è–º–∏. –û—Ç—Ä–∏–º–∞—î—à —Ñ–æ—Ç–æ –ª–∏—Å—Ç–∫–∞/—Ä–æ—Å–ª–∏–Ω–∏ (–ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–µ), –∑—Ä–æ–±–∏ –¥–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ–π–Ω—É –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫—É.
–ö–æ–Ω—Ç–µ–∫—Å—Ç:
‚Ä¢ –ö—É–ª—å—Ç—É—Ä–∞: ${crop}; –§–∞–∑–∞ (BBCH): ${bbch}; –ü–æ–ª–µ: ${field}
‚Ä¢ –ü–æ–≥–æ–¥–∞ (–æ—Å—Ç. 3‚Äì5 –¥–Ω—ñ–≤): ${weather}
‚Ä¢ –ü–µ—Ä–µ–¥—ñ—Å—Ç–æ—Ä—ñ—è: ${prehistory}
‚Ä¢ –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ –ø—ñ–¥–æ–∑—Ä–∏: ${suspects}

–ê–Ω–æ—Ç–∞—Ü—ñ—ó –Ω–∞ —Ñ–æ—Ç–æ (ROI):
${evText || '(–∞–Ω–æ—Ç–∞—Ü—ñ—ó –≤—ñ–¥—Å—É—Ç–Ω—ñ ‚Äî –ø–æ–ø—Ä–æ—Å–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫—Ä–∞—â–∏–π —Ä–∞–∫—É—Ä—Å/–º–∞–∫—Ä–æ/–±—ñ–ª–∏–π —Ñ–æ–Ω)'}

–í–∏–º–æ–≥–∏:
1) –í–∏–∑–Ω–∞—á 2‚Äì4 –Ω–∞–π—ñ–º–æ–≤—ñ—Ä–Ω—ñ—à—ñ –ø—Ä–∏—á–∏–Ω–∏ (—Ö–≤–æ—Ä–æ–±–∞/—à–∫—ñ–¥–Ω–∏–∫/–¥–µ—Ñ—ñ—Ü–∏—Ç) –∑ –æ–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è–º ¬´–æ–∑–Ω–∞–∫–∞ ‚Üí –ø—Ä–∏—á–∏–Ω–∞¬ª.
2) –ü–æ–±—É–¥—É–π –∫–æ—Ä–æ—Ç–∫—É —Ç–∞–±–ª–∏—Ü—é –¥–∏—Ñ–¥—ñ–∞–≥–Ω–æ–∑—É: {–ø—Ä–∏—á–∏–Ω–∞ | –æ–∑–Ω–∞–∫–∏ –∑–∞/–ø—Ä–æ—Ç–∏ | —â–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤–æ}.
3) –û–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ –Ω–∞–≤–µ–¥–∏ 3‚Äì6 <–î–ñ–ï–†–ï–õ–ê> (–ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –¥–æ–≤—ñ–¥–Ω–∏–∫–∏/–µ—Ç–∏–∫–µ—Ç–∫–∏/–Ω–∞—É–∫–æ–≤—ñ —Å—Ç–∞—Ç—Ç—ñ); —á—ñ—Ç–∫–æ –ø–æ–∑–Ω–∞—á ¬´—Ñ–∞–∫—Ç¬ª vs ¬´–≥—ñ–ø–æ—Ç–µ–∑–∞¬ª.
4) –î–∞–π –ø–ª–∞–Ω IPM: –∞–≥—Ä–æ—Ç–µ—Ö–Ω—ñ—á–Ω–∏–π, –±—ñ–æ–ª–æ–≥—ñ—á–Ω–∏–π, —Ö—ñ–º—ñ—á–Ω–∏–π + ¬´–Ω—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–∏—Ç–∏¬ª –∑ —Ä–∏–∑–∏–∫–∞–º–∏. –î–ª—è —Ö—ñ–º—ñ—ó ‚Äî –ê–† —Ç–∞ FRAC/HRAC, REI/PHI, –ó–Ü–ó.
5) –ó–∞–ø—Ä–æ—Å–∏ —É—Ç–æ—á–Ω–µ–Ω–Ω—è, —è–∫—â–æ –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö –±—Ä–∞–∫—É—î (—Ä–∞–∫—É—Ä—Å, –º–∞—Å—à—Ç–∞–±–∏, –≤—ñ–¥—Å–æ—Ç–æ–∫ —É—Ä–∞–∂–µ–Ω–Ω—è, –ª–æ–∫–∞—Ü—ñ—è –ø–ª—è–º ‚Äî –Ω–∏–∂–Ω—ñ–π/–≤–µ—Ä—Ö–Ω—ñ–π —è—Ä—É—Å, –≤–µ–≥–µ—Ç–∞—Ç–∏–≤–Ω—ñ/–≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ñ –æ—Ä–≥–∞–Ω–∏).
–§–æ—Ä–º–∞—Ç: –∑–∞–≥–æ–ª–æ–≤–∫–∏, —Å–ø–∏—Å–∫–∏, –≤ –∫—ñ–Ω—Ü—ñ —Ä–æ–∑–¥—ñ–ª ¬´–î–ñ–ï–†–ï–õ–ê¬ª.`;
}

$('#genPrompt').addEventListener('click', ()=>{ $('#prompt').textContent=buildPrompt(); log('–ü—Ä–æ–º–ø—Ç –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ'); });
$('#copyPrompt').addEventListener('click', ()=>{ const ta=document.createElement('textarea'); ta.value=$('#prompt').textContent; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove(); log('–ü—Ä–æ–º–ø—Ç —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'); });
$('#dlPrompt').addEventListener('click', ()=>{ const txt=$('#prompt').textContent||buildPrompt(); download('para24_prompt_'+stamp()+'.txt',txt); });

// ===== –ß–µ–∫–µ—Ä –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –®–Ü =====
function checkLLMText(txt){
  const lines=(txt||'').split(/\r?\n/);
  const urlRE=/(https?:\/\/[^\s)]+|doi:\S+)/ig;
  const urls=(txt.match(urlRE)||[]);
  const hasSources=/–¥–∂–µ—Ä–µ–ª–∞|sources|references/i.test(txt);
  const tableLike=/(—Ç–∞–±–ª–∏—Ü|table|\|.+\|.+\|)/i.test(txt);
  const mentionsFRAC=/\bFRAC|HRAC|IRAC\b/i.test(txt);
  const safety=/(REI|PHI|–ó–Ü–ó|PPE)/i.test(txt);
  const factsHypo=/(—Ñ–∞–∫—Ç|–≥—ñ–ø–æ—Ç–µ–∑)/i.test(txt);
  const asks=/\?/.test(txt) && /(—É—Ç–æ—á–Ω|–ø–∏—Ç–∞–Ω–Ω—è|clarify|question)/i.test(txt);
  const ipm=/–∞–≥—Ä–æ—Ç–µ—Ö–Ω|–±—ñ–æ–ª–æ–≥—ñ—á–Ω|—Ö—ñ–º—ñ—á–Ω|–Ω—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–∏—Ç–∏|IPM/i.test(txt);

  // —Å–∫–æ—Ä–∏–Ω–≥ 0..100
  let score=0;
  if(urls.length>=3) score+=25; else if(urls.length>=1) score+=15;
  if(hasSources) score+=10;
  if(tableLike) score+=15;
  if(ipm) score+=15;
  if(mentionsFRAC) score+=10;
  if(safety) score+=10;
  if(factsHypo) score+=10;
  if(asks) score+=5;

  const crits=[
    {name:'–î–∂–µ—Ä–µ–ª–∞ (–ø–æ—Å–∏–ª–∞–Ω–Ω—è)', ok:urls.length>=3, msg:`–∑–Ω–∞–π–¥–µ–Ω–æ ${urls.length}`},
    {name:'–†–æ–∑–¥—ñ–ª ¬´–î–ñ–ï–†–ï–õ–ê¬ª', ok:hasSources, msg: hasSources?'—î':'–Ω–µ–º–∞'},
    {name:'–¢–∞–±–ª–∏—Ü—è –¥–∏—Ñ–¥—ñ–∞–≥–Ω–æ–∑—É', ok:tableLike, msg: tableLike?'—î':'–Ω–µ–º–∞'},
    {name:'IPM (4 –≤–∞—Ä—ñ–∞–Ω—Ç–∏)', ok:ipm, msg: ipm?'—î':'–Ω–µ–º–∞ –≤—Å—ñ—Ö –±–ª–æ–∫—ñ–≤'},
    {name:'FRAC/HRAC/IRAC', ok:mentionsFRAC, msg: mentionsFRAC?'—î':'–Ω–µ–º–∞'},
    {name:'REI/PHI/–ó–Ü–ó', ok:safety, msg: safety?'—î':'–Ω–µ–º–∞'},
    {name:'–§–∞–∫—Ç vs –≥—ñ–ø–æ—Ç–µ–∑–∞', ok:factsHypo, msg: factsHypo?'—î':'–Ω–µ–º–∞'},
    {name:'–£—Ç–æ—á–Ω—é–≤–∞–ª—å–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è', ok:asks, msg: asks?'—î':'–Ω–µ–º–∞'}
  ];
  return {score:Math.min(100,score), urls, crits};
}

$('#checkLLM').addEventListener('click', ()=>{
  const txt=$('#llm').value||'';
  const res=checkLLMText(txt);
  $('#badgeScore').textContent=`Score: ${res.score}/100`;
  const tb=$('#critTbl'); tb.innerHTML='';
  res.crits.forEach(c=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${c.name}</td><td class="small">${c.msg}</td><td class="${c.ok?'ok':'bad'}">${c.ok?'OK':'MISS'}</td>`;
    tb.appendChild(tr);
  });
  log('–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –®–Ü: Score '+res.score);
});

// ===== –ñ—É—Ä–Ω–∞–ª/–∑–≤—ñ—Ç–∏ =====
const rows=[]; // –∂—É—Ä–Ω–∞–ª
$('#addLog').addEventListener('click', ()=>{
  const fio=($('#fio').value||'').trim(), dec=($('#decision').value||'').trim();
  rows.push({ts:new Date().toISOString(), fio, decision:dec, nBoxes:boxes.length});
  log(`–ñ—É—Ä–Ω–∞–ª ‚Üí ${fio}: ${dec} (–∞–Ω–æ—Ç–∞—Ü—ñ–π: ${boxes.length})`);
});
$('#saveTxt').addEventListener('click', ()=>{
  const lines=[
    '–ü–∞—Ä–∞ 24 ‚Äî –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞ —Ñ–æ—Ç–æ + –¥–æ–∫–∞–∑–æ–≤—ñ—Å—Ç—å',
    '–°—Ç—É–¥–µ–Ω—Ç: '+($('#fio').value||'').trim(),
    '–ö—É–ª—å—Ç—É—Ä–∞/BBCH: '+$('#crop').value+' / '+($('#bbch').value||'‚Äî'),
    '–õ–æ–∫–∞—Ü—ñ—è/–ø–æ–≥–æ–¥–∞: '+($('#field').value||'‚Äî')+' / '+($('#weather').value||'‚Äî'),
    '–ü—ñ–¥–æ–∑—Ä–∏/—ñ—Å—Ç–æ—Ä—ñ—è: '+($('#suspects').value||'‚Äî')+' / '+($('#prehistory').value||'‚Äî'),
    '–ê–Ω–æ—Ç–∞—Ü—ñ–π: '+boxes.length,
    '–ü—Ä–æ–º–ø—Ç:', $('#prompt').textContent||buildPrompt(),
    '–í—ñ–¥–ø–æ–≤—ñ–¥—å –®–Ü:', ($('#llm').value||'‚Äî'),
  ].join('\n');
  download('agro_para24_'+stamp()+'.txt',lines);
});
$('#saveCsv').addEventListener('click', ()=>{
  const evHeader='i,type,x,y,w,h,desc\n';
  const evBody=boxes.map((b,i)=>`${i+1},"${b.label.replace(/"/g,'""')}",${b.x},${b.y},${b.w},${b.h},"${(b.desc||'').replace(/"/g,'""')}"`).join('\n');
  download('agro_para24_annotations_'+stamp()+'.csv', evHeader+evBody, 'text/csv');
});

// –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
drawAll();
if (window.self !== window.top) document.documentElement.classList.add('embedded'); // Moodle-friendly
</script>


</body></html>