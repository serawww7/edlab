<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>–ü–∞—Ä–∞ 7 (–≥–∞–∑–æ–≤–∏–∫–∏) ‚Äî –û–≥–ª—è–¥ –¥–∏–º–æ–≤–µ–Ω—Ç–∫–∞–Ω–∞–ª—ñ–≤: —á–µ–∫-–ª–∏—Å—Ç, —Ç—è–≥–∞/CO, –≥—Ä–∞—Ñ—ñ–∫, —Ñ–æ—Ç–æ, —á–µ–∫ 58 –º–º, CSV/TXT, QR</title>
<meta name="description" content="–ü—Ä–∞–∫—Ç–∏–∫–∞ –æ–≥–ª—è–¥—É –¥–∏–º–æ–≤–∏—Ö —ñ –≤–µ–Ω—Ç–∏–ª—è—Ü—ñ–π–Ω–∏—Ö –∫–∞–Ω–∞–ª—ñ–≤: —á–µ–∫-–ª–∏—Å—Ç –∑ —Ç–∞–π–º–µ—Ä–∞–º–∏, –µ–º—É–ª—å–æ–≤–∞–Ω—ñ –≤–∏–º—ñ—Ä–∏ —Ç—è–≥–∏ (–ü–∞) —ñ CO (ppm) –∑ –ø–æ—Ä–æ–≥–∞–º–∏, –∂–∏–≤–∏–π –≥—Ä–∞—Ñ—ñ–∫, —Ñ–æ—Ç–æ, NFC/ID, –∞—É–¥—ñ–æ, —á–µ–∫ 58 –º–º, –µ–∫—Å–ø–æ—Ä—Ç CSV/TXT, QR."/>
<meta name="color-scheme" content="light dark"/>
<style>
:root{--bg:#0b1220;--panel:#0f172a;--muted:#94a3b8;--text:#e6eef9;--line:#223049;--brand:#38bdf8;--ok:#22c55e;--warn:#fbbf24;--bad:#f87171}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,"Segoe UI",Roboto,Inter,Arial,sans-serif}
.wrap{max-width:1280px;margin:0 auto;padding:16px}
header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;gap:12px}
.logo{display:flex;align-items:center;gap:10px}
.logo .emoji{font-size:28px}
.logo .badge{font-size:.9rem;color:var(--muted);border:1px solid var(--line);padding:2px 8px;border-radius:999px}
h1{margin:.2em 0 .3em 0}
.muted{color:var(--muted)}
.card{border:1px solid var(--line);border-radius:16px;background:var(--panel);padding:14px;margin-top:14px}
.row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.grid{display:grid;gap:14px;grid-template-columns:1.25fr 1fr}
@media(max-width:1140px){.grid{grid-template-columns:1fr}}
.input,select,textarea{width:100%;padding:8px;border-radius:10px;border:1px solid var(--line);background:#0b1220;color:var(--text)}
textarea{min-height:90px}
.btn{border:1px solid var(--line);background:#0f1f39;color:#e6eef9;padding:8px 12px;border-radius:10px;cursor:pointer}
.btn.secondary{background:transparent}
.btn.good{border-color:#204b2a;background:#12341b}
small.mono,.mono{font-family:ui-monospace,monospace}
.tbl{width:100%;border-collapse:collapse;font-size:.95rem}
.tbl th,.tbl td{border:1px solid var(--line);padding:6px;text-align:left;vertical-align:top}
.tbl th{background:#0b1a2f}
canvas.chart{display:block;width:100%;height:240px;background:#0b1220;border:1px solid var(--line);border-radius:12px}
.canvasWrap{overflow:hidden;border-radius:12px}
.receipt{background:#0b1220;border:1px dashed #334155;border-radius:12px;padding:10px;font-family:ui-monospace,monospace;white-space:pre;min-height:140px}
.badge{display:inline-block;border:1px solid var(--line);border-radius:999px;padding:0 8px;color:var(--muted);margin-right:6px;margin-top:6px}
.ok{color:var(--ok)} .warn{color:var(--warn)} .bad{color:var(--bad)}
.footer{margin-top:20px;color:var(--muted);font-size:.9rem}
.photo{width:100%;max-width:240px;border:1px solid var(--line);border-radius:12px;display:block}
.gallery{display:flex;gap:8px;flex-wrap:wrap}
.block{border:1px dashed var(--line);border-radius:12px;padding:10px;margin-top:10px;background:#0c182a}
hr.sep{border:none;border-top:1px solid var(--line);margin:10px 0}
.kpi{display:flex;gap:8px;flex-wrap:wrap}
.kpi .tag{display:inline-block;border:1px solid var(--line);border-radius:999px;padding:0 10px;color:#e5e7eb}
.tag.ok{border-color:#1d3e2a;background:#0f2f1e}
.tag.warn{border-color:#4a3b13;background:#2b2310}
.tag.bad{border-color:#5a1f1f;background:#2a1212}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="logo">
      <span class="emoji">üå´Ô∏è</span>
      <div>
        <b>–ü–∞—Ä–∞ 7 ‚Äî –û–≥–ª—è–¥ –¥–∏–º–æ–≤–µ–Ω—Ç–∫–∞–Ω–∞–ª—ñ–≤</b><br/>
        <span class="badge">–ß–µ–∫-–ª–∏—Å—Ç ‚Üí —Ç—è–≥–∞/CO ‚Üí –≥—Ä–∞—Ñ—ñ–∫ ‚Üí —Ñ–æ—Ç–æ ‚Üí NFC/ID ‚Üí —á–µ–∫ 58 –º–º ‚Üí CSV/TXT ‚Üí QR</span>
      </div>
    </div>
    <a class="btn" href="../index.html" target="_blank" rel="noopener">üè† –ù–∞ –≥–æ–ª–æ–≤–Ω—É</a>
  </header>

  <!-- –í–≤—ñ–¥–Ω—ñ -->
  <div class="card">
    <h2>üìö –°—Ü–µ–Ω–∞—Ä—ñ–π</h2>
    <p>–û–≥–ª—è–¥–∞—î–º–æ <b>–¥–∏–º–æ–≤–∏–π/–≤–µ–Ω—Ç–∫–∞–Ω–∞–ª</b>: –ø—Ä–æ—Ö—ñ–¥–Ω—ñ—Å—Ç—å/–∑–∞—Å–º—ñ—á–µ–Ω–Ω—è, –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Ç—è–≥–∏ (–ü–∞), —Ä—ñ–≤–µ–Ω—å <b>CO</b> —É –ø—Ä–∏–º—ñ—â–µ–Ω–Ω—ñ –ø—ñ–¥ —á–∞—Å —Ä–æ–±–æ—Ç–∏ –ø—Ä–∏–ª–∞–¥—É, 
      –¥–µ—Ñ–µ–∫—Ç–∏ (—Å–∞–∂a, –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç, –ø—ñ–¥—Å–º–æ–∫—Ç—É–≤–∞–Ω–Ω—è). –ó–∞–ø–∏—Å—É—î–º–æ —á–µ–∫-–ª–∏—Å—Ç –∑ —Ç–∞–π–º–µ—Ä–∞–º–∏, –≤–µ–¥–µ–º–æ <b>–∂–∏–≤–∏–π –≥—Ä–∞—Ñ—ñ–∫</b> (—Ç—è–≥–∞/CO), —Ä–æ–±–∏–º–æ <b>—Ñ–æ—Ç–æ</b> —ñ <b>–∞—É–¥—ñ–æ</b>, 
      –ø—Ä–∏–≤‚Äô—è–∑—É—î–º–æ <b>NFC/ID</b>, —Ñ–æ—Ä–º—É—î–º–æ <b>—á–µ–∫ 58 –º–º</b>, <b>CSV/TXT</b>, <b>QR</b>.</p>
    <div class="row">
      <label style="flex:1">–ê–¥—Ä–µ—Å–∞/–æ–±‚Äô—î–∫—Ç<input id="addr" class="input" placeholder="–º. –¢–∞–ª—å–Ω–µ, –≤—É–ª. ..., –∫–≤. ..."/></label>
      <label style="flex:1">–¢–∏–ø –ø—Ä–∏–ª–∞–¥—É
        <select id="appliance" class="input">
          <option>–ö–æ–ª–æ–Ω–∫–∞</option><option selected>–ö–æ—Ç–µ–ª</option><option>–ü–ª–∏—Ç–∞</option><option>–Ü–Ω—à–µ</option>
        </select>
      </label>
      <label style="flex:1">–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å<input id="tech" class="input" placeholder="–ü—Ä—ñ–∑–≤–∏—â–µ –Ü.–ü."/></label>
      <label style="flex:1">–î–∞—Ç–∞<input id="day" class="input" type="date"/></label>
    </div>
    <div class="row">
      <button class="btn good" id="mkCase">üß∞ –°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–µ–π—Å</button>
      <span class="badge" id="cid">–ö–µ–π—Å: ‚Äî</span>
    </div>
  </div>

  <div class="grid">
    <!-- –õ—ñ–≤–∞ –∫–æ–ª–æ–Ω–∫–∞: –ß–µ–∫-–ª–∏—Å—Ç / –°–µ–Ω—Å–æ—Ä–∏ / –ö–∞–º–µ—Ä–∞ / –ê—É–¥—ñ–æ / NFC -->
    <div class="card">
      <h2>üìù –ß–µ–∫-–ª–∏—Å—Ç –∑ —Ç–∞–π–º–µ—Ä–∞–º–∏</h2>
      <div id="steps" class="block"></div>

      <h2 style="margin-top:10px">üõ∞Ô∏è –í–∏–º—ñ—Ä–∏ (–µ–º—É–ª—è—Ç–æ—Ä): –¢—è–≥–∞ (–ü–∞) —ñ CO (ppm)</h2>
      <div class="row">
        <label style="flex:1">–¢—è–≥–∞, –ü–∞
          <input type="range" id="draft" class="input" min="-10" max="40" step="1" value="8"/>
        </label>
        <span class="badge">–ü–æ—Ç–æ—á–Ω–µ: <b id="draftNum">8</b> –ü–∞</span>
        <button class="btn" id="markDraft">üìç –î–æ–¥–∞—Ç–∏ —Ç–æ—á–∫—É</button>
      </div>
      <div class="row">
        <label style="flex:1">CO, ppm
          <input type="range" id="co" class="input" min="0" max="400" step="5" value="15"/>
        </label>
        <span class="badge">–ü–æ—Ç–æ—á–Ω–µ: <b id="coNum">15</b> ppm</span>
        <button class="btn" id="markCO">üìç –î–æ–¥–∞—Ç–∏ —Ç–æ—á–∫—É</button>
      </div>
      <div class="row">
        <label>–ú—ñ–Ω. —Ç—è–≥–∞ OK (–ü–∞)<input id="thDraft" type="number" class="input" step="1" value="5"/></label>
        <label>CO Warn (ppm)<input id="thCOWarn" type="number" class="input" step="5" value="50"/></label>
        <label>CO Alarm (ppm)<input id="thCOAlarm" type="number" class="input" step="5" value="200"/></label>
        <button class="btn secondary" id="applyTh">‚öôÔ∏è –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –ø–æ—Ä–æ–≥–∏</button>
      </div>
      <div class="kpi" style="margin-top:6px">
        <span class="tag ok">‚è±Ô∏è –ß–∞—Å —Ç—è–≥–∏ <b>&ge;</b> OK: <b id="tDraftOk">0</b> —Å</span>
        <span class="tag warn">‚è±Ô∏è –ß–∞—Å CO > Warn: <b id="tCOWarn">0</b> —Å</span>
        <span class="tag bad">‚è±Ô∏è –ß–∞—Å CO > Alarm: <b id="tCOAlarm">0</b> —Å</span>
      </div>
      <div class="canvasWrap" style="margin-top:8px"><canvas id="chart" class="chart" width="520" height="240"></canvas></div>
      <div class="row">
        <button class="btn secondary" id="clearSeries">üßπ –û—á–∏—Å—Ç–∏—Ç–∏ –≥—Ä–∞—Ñ—ñ–∫</button>
      </div>

      <h2 style="margin-top:10px">üé• –§–æ—Ç–æ (3 —à—Ç.)</h2>
      <div class="row">
        <video id="vid" class="photo" autoplay playsinline muted></video>
        <div>
          <button class="btn" id="camOn">üé• –£–≤—ñ–º–∫–Ω—É—Ç–∏ –∫–∞–º–µ—Ä—É</button>
          <button class="btn" data-kind="inlet">üì∑ –í—Ö—ñ–¥ —É –∫–∞–Ω–∞–ª (—Ä–µ—à—ñ—Ç–∫–∞/–ø–∞—Ç—Ä—É–±–æ–∫)</button>
          <button class="btn" data-kind="outlet">üì∑ –í–∏—Ö—ñ–¥ –Ω–∞ –¥–∞—Ö—É/—à–∞—Ö—Ç—ñ</button>
          <button class="btn" data-kind="defect">üì∑ –î–µ—Ñ–µ–∫—Ç/—Å–∞–∂a/–∫–æ–Ω–¥–µ–Ω—Å–∞—Ç</button><br/>
          <small class="muted">–§–æ—Ç–æ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É ¬´–ì–∞–ª–µ—Ä–µ—ó –¥–æ–∫–∞–∑—ñ–≤¬ª.</small>
        </div>
      </div>
      <div class="gallery" id="gal"></div>

      <h2 style="margin-top:10px">üéôÔ∏è –ê—É–¥—ñ–æ-–Ω–æ—Ç–∞—Ç–∫–∞</h2>
      <div class="row">
        <button class="btn" id="recStart">‚è∫Ô∏è –ó–∞–ø–∏—Å</button>
        <button class="btn secondary" id="recStop" disabled>‚èπÔ∏è –°—Ç–æ–ø</button>
        <span class="badge" id="rstat">–ù–µ–º–∞—î –∑–∞–ø–∏—Å—É</span>
      </div>
      <audio id="player" controls style="margin-top:8px;max-width:100%"></audio>

      <h2 style="margin-top:10px">üì∂ NFC / ID –æ–±‚Äô—î–∫—Ç–∞</h2>
      <div class="block">
        <div class="row">
          <button class="btn" id="nfcBtn">üì∂ NFC</button>
          <input id="asset" class="input" placeholder="ID –æ–±‚Äô—î–∫—Ç–∞ (—è–∫—â–æ NFC –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π)"/>
          <button class="btn secondary" id="saveAsset">üíæ –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
          <span class="badge" id="nfcs">–°—Ç–∞—Ç—É—Å NFC: –æ—á—ñ–∫—É—î—Ç—å—Å—è</span>
        </div>
      </div>
    </div>

    <!-- –ü—Ä–∞–≤–∞ –∫–æ–ª–æ–Ω–∫–∞: –ü—Ä–æ–≥—Ä–µ—Å/–ú–µ—Ç—Ä–∏–∫–∏/–ï–∫—Å–ø–æ—Ä—Ç -->
    <div class="card">
      <h2>üìà –ü—Ä–æ–≥—Ä–µ—Å —Ç–∞ –º–µ—Ç—Ä–∏–∫–∏</h2>
      <table class="tbl">
        <tbody>
          <tr><th>–ö–µ–π—Å</th><td id="mCase">‚Äî</td></tr>
          <tr><th>ID –æ–±‚Äô—î–∫—Ç–∞</th><td id="mAsset">‚Äî</td></tr>
          <tr><th>–ü—Ä–∏–ª–∞–¥</th><td id="mApp">‚Äî</td></tr>
          <tr><th>–ö—Ä–æ–∫–∏ Done</th><td id="mSteps">0/6</td></tr>
          <tr><th>–¢–æ—á–æ–∫ (—Ç—è–≥–∞/CO)</th><td id="mPts">0 / 0</td></tr>
          <tr><th>–§–æ—Ç–æ (–≤—Ö—ñ–¥/–≤–∏—Ö—ñ–¥/–¥–µ—Ñ–µ–∫—Ç)</th><td id="mPhotos">0 / 0 / 0</td></tr>
          <tr><th>–ê—É–¥—ñ–æ</th><td id="mAudio">‚Äî</td></tr>
          <tr><th>–ü–æ—Ä–æ–≥–∏</th><td id="mThr">Draft‚â•<span id="mTD">5</span>Pa; CO W<span id="mTCW">50</span>/A<span id="mTCA">200</span></td></tr>
          <tr><th>–°—Ç–∞—Ç—É—Å</th><td id="mState"><b class="warn">–ü–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫—Ä–æ–∫–∏</b></td></tr>
        </tbody>
      </table>

      <h2 style="margin-top:10px">‚úÖ –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è (10 –±–∞–ª—ñ–≤)</h2>
      <ul>
        <li>–ö–µ–π—Å —Å—Ç–≤–æ—Ä–µ–Ω–æ (–∞–¥—Ä–µ—Å–∞/–ø—Ä–∏–ª–∞–¥/–≤–∏–∫–æ–Ω–∞–≤–µ—Ü—å/–¥–∞—Ç–∞) ‚Äî <b>2</b></li>
        <li>ID –æ–±‚Äô—î–∫—Ç–∞ (NFC/–∫–æ–¥) ‚Äî <b>2</b></li>
        <li>–ß–µ–∫-–ª–∏—Å—Ç: —É—Å—ñ –∫—Ä–æ–∫–∏ –∑ —Ç–∞–π–º–µ—Ä–∞–º–∏ ‚Äî <b>2</b></li>
        <li>–ì—Ä–∞—Ñ—ñ–∫: ‚â•8 —Ç–æ—á–æ–∫ —Å—É–º–∞—Ä–Ω–æ ‚Äî <b>1</b></li>
        <li>–§–æ—Ç–æ (–≤—Å—ñ —Ç—Ä–∏) ‚Äî <b>2</b></li>
        <li>–ê—É–¥—ñ–æ-–Ω–æ—Ç–∞—Ç–∫–∞ ‚Äî <b>1</b></li>
      </ul>

      <h2 style="margin-top:10px">üíæ –ï–∫—Å–ø–æ—Ä—Ç / –¥—Ä—É–∫</h2>
      <div class="row">
        <button class="btn" id="saveCsv">üìÑ CSV</button>
        <button class="btn" id="saveTxt">üíæ TXT</button>
        <button class="btn" id="print58">üñ®Ô∏è –ß–µ–∫ 58 –º–º</button>
        <button class="btn secondary" id="qrGen">üîó QR (Case/Asset)</button>
      </div>
      <div id="rc" class="receipt" hidden></div>
      <div class="canvasWrap" style="margin-top:8px"><canvas id="qr" width="220" height="220"></canvas></div>

      <h2 style="margin-top:10px">üõéÔ∏è –ñ—É—Ä–Ω–∞–ª –ø–æ–¥—ñ–π</h2>
      <pre id="alog" class="card" style="max-height:240px;overflow:auto;margin-top:6px">// –ü–æ–∫–∏ –±–µ–∑ –ø–æ–¥—ñ–π</pre>
    </div>
  </div>

  <div class="footer">
    –û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: <time id="upd"></time>. –ê–≤—Ç–æ—Ä: –°–µ—Ä–≥—ñ–π –ü–æ–ª—ñ—â—É–∫.
  </div>
</div>

<script>
const $=s=>document.querySelector(s), $$=s=>Array.from(document.querySelectorAll(s));
function stamp(){return new Date().toISOString().replace(/[:T]/g,'-').slice(0,16);}
function download(name,text,type="text/plain"){const b=new Blob([text],{type:type+";charset=utf-8"});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download=name;document.body.appendChild(a);a.click();a.remove();URL.revokeObjectURL(u);}
function log(msg){const t=new Date().toLocaleTimeString();const box=$('#alog');if(box.textContent.startsWith('//'))box.textContent='';box.textContent+=`[${t}] ${msg}\n`;box.scrollTop=box.scrollHeight;}
function clean(s){return String(s).replace(/\s+/g,' ').trim();}
$('#upd').textContent = new Date().toLocaleDateString('uk-UA');
(function(){ const d=new Date(); $('#day').value=d.toISOString().slice(0,10); })();

// ===== –°—Ç–∞–Ω –∫–µ–π—Å—É
let CASE_ID=null, ASSET_ID=null;
let photos={inlet:null,outlet:null,defect:null};
let audioUrl=null;

// ===== –ö–µ–π—Å
$('#mkCase').addEventListener('click',()=>{
  const addr=clean($('#addr').value||''); const tech=clean($('#tech').value||''); const day=$('#day').value; 
  if(!addr||!tech||!day){ alert('–í–∫–∞–∂–∏ –∞–¥—Ä–µ—Å—É, –≤–∏–∫–æ–Ω–∞–≤—Ü—è —Ç–∞ –¥–∞—Ç—É'); return; }
  CASE_ID='F-'+Math.random().toString(36).slice(2,8).toUpperCase();
  $('#cid').textContent='–ö–µ–π—Å: '+CASE_ID;
  log(`–ö–µ–π—Å ${CASE_ID}: ${addr}, ${$('#appliance').value}, ${tech}, ${day}`);
  updateMetrics();
});

// ===== NFC / ID
async function tryNFC(){
  if('NDEFReader' in window){
    try{
      const reader=new NDEFReader(); await reader.scan();
      $('#nfcs').textContent='–°—Ç–∞—Ç—É—Å NFC: —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è...';
      reader.addEventListener('reading', ({message, serialNumber})=>{
        let text=''; for(const rec of message.records){ if(rec.recordType==='text'){ const dec=new TextDecoder(rec.encoding||'utf-8'); text = dec.decode(rec.data); } }
        ASSET_ID = (text||serialNumber||'NFC-'+Math.random().toString(36).slice(2,7)).toString();
        $('#asset').value=ASSET_ID; $('#nfcs').textContent='–°—Ç–∞—Ç—É—Å NFC: –∑—á–∏—Ç–∞–Ω–æ';
        log('NFC: '+ASSET_ID); updateMetrics();
      });
    }catch(e){ $('#nfcs').textContent='–°—Ç–∞—Ç—É—Å NFC: –ø–æ–º–∏–ª–∫–∞'; alert('NFC –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π/–∑–∞–±–æ—Ä–æ–Ω–µ–Ω–∏–π'); }
  }else{ alert('Web NFC –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è. –í–≤–µ–¥–∏ –∫–æ–¥ –≤—Ä—É—á–Ω—É.'); }
}
$('#nfcBtn').addEventListener('click', tryNFC);
$('#saveAsset').addEventListener('click',()=>{ const v=clean($('#asset').value||''); if(!v){ alert('–í–≤–µ–¥–∏ ID –æ–±‚Äô—î–∫—Ç–∞'); return; } ASSET_ID=v; $('#nfcs').textContent='–°—Ç–∞—Ç—É—Å NFC: –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–æ –≤—Ä—É—á–Ω—É'; log('ID –æ–±‚Äô—î–∫—Ç–∞: '+ASSET_ID); updateMetrics(); });

// ===== –ß–µ–∫-–ª–∏—Å—Ç
const STEPS_DEF = [
  {k:'access',  name:'–î–æ—Å—Ç—É–ø –¥–æ –∫–∞–Ω–∞–ª—É/—Ä–µ–≤—ñ–∑—ñ—ó'},
  {k:'visual',  name:'–í—ñ–∑—É–∞–ª—å–Ω–∏–π –æ–≥–ª—è–¥ (—Å–∞–∂a/–∑–∞—Å–º—ñ—á–µ–Ω–Ω—è/–∫–æ–Ω–¥–µ–Ω—Å–∞—Ç)'},
  {k:'draft',   name:'–í–∏–º—ñ—Ä —Ç—è–≥–∏ (–ü–∞) —É —Ä–µ–∂–∏–º—ñ —Ä–æ–±–æ—Ç–∏ –ø—Ä–∏–ª–∞–¥—É'},
  {k:'co',      name:'–í–∏–º—ñ—Ä CO (ppm) —É –ø—Ä–∏–º—ñ—â–µ–Ω–Ω—ñ'},
  {k:'seal',    name:'–ì–µ—Ä–º–µ—Ç–∏—á–Ω—ñ—Å—Ç—å —Å—Ç–∏–∫—ñ–≤/–ø–∞—Ç—Ä—É–±–∫—ñ–≤'},
  {k:'restore', name:'–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–±–ª–∏—Ü—é–≤–∞–Ω–Ω—è/–∫—Ä–∏—à–æ–∫/—Ä–µ—à—ñ—Ç–æ–∫'}
];
let STEPS = STEPS_DEF.map(s=>({...s, tsStart:null, tsStop:null, dur:0, ok:false}));

function renderSteps(){
  const box=$('#steps'); box.innerHTML='';
  STEPS.forEach((s,idx)=>{
    const d=document.createElement('div'); d.className='block'; d.dataset.key=s.k;
    d.innerHTML = `
      <b>${idx+1}. ${s.name}</b> <span class="badge mono">${s.k}</span><br/>
      <div class="row" style="margin-top:6px">
        <button class="btn btn-start">‚ñ∂Ô∏è Start</button>
        <button class="btn secondary btn-stop">‚èπÔ∏è Stop</button>
        <button class="btn good btn-done">‚úÖ Done</button>
        <span class="badge">–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å: <b class="dur">0</b> —Å</span>
      </div>
    `;
    box.appendChild(d);
  });
}
renderSteps();

function stepByKey(k){ return STEPS.find(x=>x.k===k); }

$('#steps').addEventListener('click',(e)=>{
  const wrap=e.target.closest('.block'); if(!wrap) return;
  const key=wrap.dataset.key; const s=stepByKey(key); const now=Date.now();

  if(e.target.classList.contains('btn-start')){ s.tsStart=now; s.tsStop=null; s.ok=false; log(`–ö—Ä–æ–∫ ${key}: Start`); }
  if(e.target.classList.contains('btn-stop')){
    if(s.tsStart){ s.tsStop=now; s.dur += Math.max(0, Math.round((s.tsStop - s.tsStart)/1000)); s.tsStart=null; wrap.querySelector('.dur').textContent=String(s.dur); log(`–ö—Ä–æ–∫ ${key}: Stop (+${s.dur}s)`); }
  }
  if(e.target.classList.contains('btn-done')){
    if(s.tsStart){ s.tsStop=now; s.dur += Math.max(0, Math.round((s.tsStop - s.tsStart)/1000)); s.tsStart=null; wrap.querySelector('.dur').textContent=String(s.dur); }
    s.ok=true; log(`–ö—Ä–æ–∫ ${key}: Done (total ${s.dur}s)`);
  }
  updateMetrics();
});

// –∞–≤—Ç–æ-–æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ –∞–∫—Ç–∏–≤–Ω–∏—Ö –∫—Ä–æ–∫—ñ–≤
setInterval(()=>{
  const now=Date.now();
  STEPS.forEach(s=>{
    if(s.tsStart){ const curr=Math.max(0, Math.round((now - s.tsStart)/1000)); const wrap=$(`[data-key="${s.k}"]`); if(wrap){ wrap.querySelector('.dur').textContent = String(s.dur + curr); } }
  });
},1000);

// ===== –°–µ–Ω—Å–æ—Ä–∏: —Ç—è–≥–∞/CO –∑ –≥—Ä–∞—Ñ—ñ–∫–æ–º
const chart=$('#chart'), gc=chart.getContext('2d');
let t0=null;
let seriesDraft=[]; // {t, v}
let seriesCO=[];    // {t, v}
let thr = { draftOK:5, coWarn:50, coAlarm:200 };
let acc = { draftOk:0, coWarn:0, coAlarm:0 };

function applyThresh(){
  thr.draftOK = parseFloat($('#thDraft').value)||5;
  thr.coWarn  = Math.max(0, parseFloat($('#thCOWarn').value)||50);
  thr.coAlarm = Math.max(thr.coWarn, parseFloat($('#thCOAlarm').value)||200);
  $('#mTD').textContent=String(thr.draftOK);
  $('#mTCW').textContent=String(thr.coWarn);
  $('#mTCA').textContent=String(thr.coAlarm);
  log(`–ü–æ—Ä–æ–≥–∏: Draft‚â•${thr.draftOK}Pa; CO Warn ${thr.coWarn}/Alarm ${thr.coAlarm}`);
  drawChart();
  updateMetrics();
}
$('#applyTh').addEventListener('click', applyThresh);
applyThresh();

function addPoint(series, val){
  const now=Date.now(); if(!t0) t0=now;
  series.push({t:now, v:val});
  // –∞–∫—É–º—É–ª—è—Ç–æ—Ä–∏ —á–∞—Å—É (–≥—Ä—É–±–∞ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü—ñ—è –ø–æ –∫—Ä–æ–∫–∞—Ö)
  const lastOther = (series===seriesDraft? seriesCO: seriesDraft);
  const prevT = Math.max(series.length>1?series[series.length-2].t:t0, lastOther.length? lastOther[lastOther.length-1].t : t0);
  const dt = (now - prevT)/1000;
  // –ø—Ä–∞–≤–∏–ª–∞
  const draft = (series===seriesDraft? val : (seriesDraft[seriesDraft.length-1]?.v ?? 0));
  const co    = (series===seriesCO?    val : (seriesCO[seriesCO.length-1]?.v    ?? 0));
  if(draft>=thr.draftOK) acc.draftOk += Math.max(0,dt);
  if(co>thr.coWarn)  acc.coWarn  += Math.max(0,dt);
  if(co>thr.coAlarm) acc.coAlarm += Math.max(0,dt);
  $('#tDraftOk').textContent = String(Math.round(acc.draftOk));
  $('#tCOWarn').textContent  = String(Math.round(acc.coWarn));
  $('#tCOAlarm').textContent = String(Math.round(acc.coAlarm));
  drawChart();
  updateMetrics();
}

$('#draft').addEventListener('input',()=>$('#draftNum').textContent=$('#draft').value);
$('#co').addEventListener('input',()=>$('#coNum').textContent=$('#co').value);
$('#markDraft').addEventListener('click',()=>{ addPoint(seriesDraft, parseFloat($('#draft').value)); log('–¢–æ—á–∫–∞ —Ç—è–≥–∏: '+$('#draft').value+' –ü–∞'); });
$('#markCO').addEventListener('click',()=>{ addPoint(seriesCO, parseFloat($('#co').value)); log('–¢–æ—á–∫–∞ CO: '+$('#co').value+' ppm'); });
$('#clearSeries').addEventListener('click',()=>{ seriesDraft=[]; seriesCO=[]; t0=null; acc={draftOk:0,coWarn:0,coAlarm:0}; $('#tDraftOk').textContent='0'; $('#tCOWarn').textContent='0'; $('#tCOAlarm').textContent='0'; drawChart(); updateMetrics(); log('–û—á–∏—â–µ–Ω–æ –≥—Ä–∞—Ñ—ñ–∫'); });

function drawChart(){
  const W=chart.width,H=chart.height; gc.clearRect(0,0,W,H);
  gc.strokeStyle='#223049'; gc.strokeRect(0.5,0.5,W-1,H-1);
  const left=40,right=W-50,top=24,bottom=H-30;

  // —Å—ñ—Ç–∫–∞
  gc.strokeStyle='#1f2a44';
  for(let y=0;y<5;y++){ const yy=top+y*(bottom-top)/4; gc.beginPath(); gc.moveTo(left,yy); gc.lineTo(right,yy); gc.stroke(); }

  // —è–∫—â–æ –º–∞–ª–æ —Ç–æ—á–æ–∫
  if(seriesDraft.length+seriesCO.length<2){
    gc.fillStyle='#94a3b8'; gc.fillText('–î–æ–¥–∞–π—Ç–µ —Ç–æ—á–∫–∏ —Ç—è–≥–∏/CO', left+8, top+14); return;
  }

  const all = [...seriesDraft, ...seriesCO].sort((a,b)=>a.t-b.t);
  const tMin=all[0].t, tMax=all[all.length-1].t, span=tMax-tMin||1;

  const draftMax=Math.max(thr.draftOK+5, ...seriesDraft.map(p=>p.v), 10);
  const coMax=Math.max(thr.coAlarm+50, ...seriesCO.map(p=>p.v), 100);

  function X(t){ return left + (t - tMin)/span*(right-left); }
  // –¥–≤—ñ —à–∫–∞–ª–∏: –∑–ª—ñ–≤–∞ –ü–∞, —Å–ø—Ä–∞–≤–∞ ppm
  function Yd(v){ return bottom - (v/draftMax)*(bottom-top); }
  function Yc(v){ return bottom - (v/coMax)*(bottom-top); }

  // –ª—ñ–Ω—ñ—è —Ç—è–≥–∏
  if(seriesDraft.length){
    gc.beginPath(); gc.strokeStyle='#38bdf8';
    seriesDraft.forEach((p,i)=>{ const x=X(p.t), y=Yd(p.v); if(i===0) gc.moveTo(x,y); else gc.lineTo(x,y); }); gc.stroke();
    seriesDraft.forEach(p=>{ const x=X(p.t), y=Yd(p.v); gc.fillStyle='#38bdf8'; gc.fillRect(x-2,y-2,4,4); });
  }
  // –ª—ñ–Ω—ñ—è CO
  if(seriesCO.length){
    gc.beginPath(); gc.strokeStyle='#fbbf24';
    seriesCO.forEach((p,i)=>{ const x=X(p.t), y=Yc(p.v); if(i===0) gc.moveTo(x,y); else gc.lineTo(x,y); }); gc.stroke();
    seriesCO.forEach(p=>{ const x=X(p.t), y=Yc(p.v); gc.fillStyle='#fbbf24'; gc.fillRect(x-2,y-2,4,4); });
  }

  // –ø–æ—Ä–æ–≥–∏
  // —Ç—è–≥–∞ OK
  gc.strokeStyle='#22c55e'; gc.beginPath(); gc.moveTo(left, Yd(thr.draftOK)); gc.lineTo(right, Yd(thr.draftOK)); gc.stroke();
  // CO warn/alarm
  gc.strokeStyle='#fbbf24'; gc.beginPath(); gc.moveTo(left, Yc(thr.coWarn)); gc.lineTo(right, Yc(thr.coWarn)); gc.stroke();
  gc.strokeStyle='#f87171'; gc.beginPath(); gc.moveTo(left, Yc(thr.coAlarm)); gc.lineTo(right, Yc(thr.coAlarm)); gc.stroke();

  // –ø—ñ–¥–ø–∏—Å–∏ –æ—Å–µ–π
  gc.fillStyle='#94a3b8'; gc.font='11px ui-monospace';
  gc.fillText('–ü–∞ (–ª—ñ–≤–∞ –≤—ñ—Å—å) / ppm (–ø—Ä–∞–≤–∞ –≤—ñ—Å—å)', left, top-6);
  // –ª–µ–≥–µ–Ω–¥–∞
  gc.fillStyle='#38bdf8'; gc.fillRect(right+4, top, 12, 4); gc.fillStyle='#e5e7eb'; gc.fillText('–¢—è–≥–∞', right+20, top+4);
  gc.fillStyle='#fbbf24'; gc.fillRect(right+4, top+16, 12, 4); gc.fillStyle='#e5e7eb'; gc.fillText('CO', right+20, top+20);
}

// ===== –ö–∞–º–µ—Ä–∞ / —Ñ–æ—Ç–æ
let stream=null;
async function startCam(){
  try{ stream = await navigator.mediaDevices.getUserMedia({video:true,audio:false}); $('#vid').srcObject=stream; log('–ö–∞–º–µ—Ä—É —É–≤—ñ–º–∫–Ω–µ–Ω–æ'); }
  catch(e){ alert('–ö–∞–º–µ—Ä—É –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ –∞–±–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ'); }
}
$('#camOn').addEventListener('click', startCam);

function takeShot(kind){
  const video=$('#vid'); if(!video.srcObject){ alert('–°–ø–µ—Ä—à—É —É–≤—ñ–º–∫–Ω–∏ –∫–∞–º–µ—Ä—É'); return; }
  const c=document.createElement('canvas'); c.width=video.videoWidth||640; c.height=video.videoHeight||480;
  c.getContext('2d').drawImage(video,0,0,c.width,c.height);
  const url=c.toDataURL('image/png'); photos[kind]=url; renderGallery(); log(`–§–æ—Ç–æ: ${kind}`); updateMetrics();
}
$$('button[data-kind]').forEach(b=>b.addEventListener('click',()=>takeShot(b.dataset.kind)));
function renderGallery(){
  const gal=$('#gal'); gal.innerHTML='';
  if(photos.inlet){ const i=document.createElement('img'); i.className='photo'; i.src=photos.inlet; i.alt='–≤—Ö—ñ–¥'; gal.appendChild(i); }
  if(photos.outlet){ const i=document.createElement('img'); i.className='photo'; i.src=photos.outlet; i.alt='–≤–∏—Ö—ñ–¥'; gal.appendChild(i); }
  if(photos.defect){ const i=document.createElement('img'); i.className='photo'; i.src=photos.defect; i.alt='–¥–µ—Ñ–µ–∫—Ç'; gal.appendChild(i); }
}

// ===== –ê—É–¥—ñ–æ
let mediaRec=null; let chunks=[]; 
$('#recStart').addEventListener('click', async ()=>{
  try{
    const st = await navigator.mediaDevices.getUserMedia({audio:true, video:false});
    mediaRec = new MediaRecorder(st);
    chunks=[];
    mediaRec.ondataavailable = e=>{ if(e.data.size>0) chunks.push(e.data); };
    mediaRec.onstop = ()=>{
      const blob=new Blob(chunks,{type:'audio/webm'});
      audioUrl = URL.createObjectURL(blob);
      $('#player').src=audioUrl;
      $('#rstat').textContent='–ó–∞–ø–∏—Å –≥–æ—Ç–æ–≤–∏–π';
      const a=document.createElement('a'); a.href=audioUrl; a.download='voice_'+(CASE_ID||'case')+'_'+stamp()+'.webm'; document.body.appendChild(a); a.click(); a.remove();
      log('–ê—É–¥—ñ–æ –∑–±–µ—Ä–µ–∂–µ–Ω–æ (webm)'); updateMetrics();
    };
    mediaRec.start();
    $('#recStart').disabled=true; $('#recStop').disabled=false;
    $('#rstat').textContent='–ô–¥–µ –∑–∞–ø–∏—Å...'; log('–ü–æ—á–∞—Ç–æ –∞—É–¥—ñ–æ–∑–∞–ø–∏—Å');
  }catch(e){ alert('–ú—ñ–∫—Ä–æ—Ñ–æ–Ω –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π'); }
});
$('#recStop').addEventListener('click', ()=>{
  if(mediaRec && mediaRec.state!=='inactive'){ mediaRec.stop(); }
  $('#recStart').disabled=false; $('#recStop').disabled=true;
});

// ===== –ú–µ—Ç—Ä–∏–∫–∏ / —Å—Ç–∞—Ç—É—Å
function updateMetrics(){
  $('#mCase').textContent = CASE_ID || '‚Äî';
  $('#mAsset').textContent = ASSET_ID || ($('#asset').value||'‚Äî');
  $('#mApp').textContent   = $('#appliance').value;
  $('#mSteps').textContent = `${STEPS.filter(s=>s.ok).length}/${STEPS.length}`;
  $('#mPts').textContent   = `${seriesDraft.length} / ${seriesCO.length}`;
  $('#mPhotos').textContent = `${photos.inlet?1:0} / ${photos.outlet?1:0} / ${photos.defect?1:0}`;
  $('#mAudio').textContent = audioUrl?'—î':'‚Äî';

  // —Å–∫–æ—Ä–∏–Ω–≥
  let score=0;
  const caseOk=!!CASE_ID, assetOk=!!(ASSET_ID||clean($('#asset').value||'')); 
  const stepsOk=STEPS.every(s=>s.ok) && STEPS.every(s=>s.dur>0);
  const pointsOk=(seriesDraft.length + seriesCO.length) >= 8;
  const photosOk=!!photos.inlet && !!photos.outlet && !!photos.defect;
  const audioOk=!!audioUrl;
  if(caseOk)score+=2; if(assetOk)score+=2; if(stepsOk)score+=2; if(pointsOk)score+=1; if(photosOk)score+=2; if(audioOk)score+=1;

  const html = score>=9? `<b class="ok">–ì–æ—Ç–æ–≤–æ (‚âà${score}/10)</b>`:
               score>=6? `<b class="warn">–ë—ñ–ª—å—à—ñ—Å—Ç—å –≤–∏–∫–æ–Ω–∞–Ω–æ (‚âà${score}/10)</b>`:
                         `<b class="bad">–ü–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ—Ä–æ–±–∏—Ç–∏ (‚âà${score}/10)</b>`;
  $('#mState').innerHTML = html;
}
drawChart();

// ===== –ï–∫—Å–ø–æ—Ä—Ç / —á–µ–∫ / QR
function summary(){
  const addr=$('#addr').value||'‚Äî', app=$('#appliance').value||'‚Äî', tech=$('#tech').value||'‚Äî', day=$('#day').value||'‚Äî';
  return {
    case: CASE_ID||'‚Äî', addr, appliance: app, tech, day,
    asset: ASSET_ID||($('#asset').value||'‚Äî'),
    thresholds: {...thr},
    time_acc_s: {draft_ok:Math.round(acc.draftOk), co_warn:Math.round(acc.coWarn), co_alarm:Math.round(acc.coAlarm)},
    steps: STEPS.map(s=>({key:s.k, name:s.name, duration_s:s.dur, done:s.ok})),
    points: {
      draft: seriesDraft.map(p=>({t:new Date(p.t).toISOString(), v:p.v})),
      co:    seriesCO.map(p=>({t:new Date(p.t).toISOString(), v:p.v}))
    },
    photos: {inlet:!!photos.inlet, outlet:!!photos.outlet, defect:!!photos.defect},
    audio: !!audioUrl
  };
}
$('#saveCsv').addEventListener('click',()=>{
  const s=summary();
  let csv='field,value\n';
  for(const [k,v] of Object.entries(s)){
    if(k==='steps'||k==='points') continue;
    if(typeof v==='object'){ csv+=`${k},${JSON.stringify(v).replace(/,/g,';')}\n`; }
    else csv+=`${k},${String(v).replace(/,/g,';')}\n`;
  }
  csv+='\n# steps\nkey,name,duration_s,done\n';
  s.steps.forEach(st=>{ csv+=`${st.key},"${st.name.replace(/"/g,'""')}",${st.duration_s},${st.done?1:0}\n`; });
  csv+='\n# draft_points\niso_time,Pa\n';
  s.points.draft.forEach(p=>{ csv+=`${p.t},${p.v}\n`; });
  csv+='\n# co_points\niso_time,ppm\n';
  s.points.co.forEach(p=>{ csv+=`${p.t},${p.v}\n`; });
  download('gas_para7_flue_'+stamp()+'.csv', csv, 'text/csv'); log('–ï–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω–æ CSV');
});
$('#saveTxt').addEventListener('click',()=>{
  const s=summary();
  const lines=[
    '–ü–∞—Ä–∞ 7 ‚Äî –û–≥–ª—è–¥ –¥–∏–º–æ–≤–µ–Ω—Ç–∫–∞–Ω–∞–ª—ñ–≤: –ø—ñ–¥—Å—É–º–æ–∫',
    `–ö–µ–π—Å: ${s.case}`, `–ê–¥—Ä–µ—Å–∞: ${s.addr}`, `–ü—Ä–∏–ª–∞–¥: ${s.appliance}`,
    `–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å: ${s.tech}`, `–î–∞—Ç–∞: ${s.day}`,
    `–û–±‚Äô—î–∫—Ç (ID): ${s.asset}`,
    `–ü–æ—Ä–æ–≥–∏: Draft‚â•${s.thresholds.draftOK} Pa; CO Warn ${s.thresholds.coWarn}/Alarm ${s.thresholds.coAlarm} ppm`,
    `–ß–∞—Å: Draft OK ${s.time_acc_s.draft_ok}s; CO >Warn ${s.time_acc_s.co_warn}s; CO >Alarm ${s.time_acc_s.co_alarm}s`,
    `–§–æ—Ç–æ (–≤—Ö—ñ–¥/–≤–∏—Ö—ñ–¥/–¥–µ—Ñ–µ–∫—Ç): ${s.photos.inlet?'1':'0'} / ${s.photos.outlet?'1':'0'} / ${s.photos.defect?'1':'0'}`,
    `–ê—É–¥—ñ–æ: ${s.audio?'—î':'‚Äî'}`,
    '--- –ö—Ä–æ–∫–∏ ---'
  ];
  s.steps.forEach((st,i)=> lines.push(`${i+1}) ${st.name} ‚Äî ${st.duration_s}s ‚Äî ${st.done?'DONE':'‚Ä¶'}`));
  lines.push('--- –¢–æ—á–∫–∏ ---');
  lines.push(`Draft points: ${s.points.draft.length}, CO points: ${s.points.co.length}`);
  download('gas_para7_flue_'+stamp()+'.txt', lines.join('\n')); log('–ï–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω–æ TXT');
});
$('#print58').addEventListener('click',()=>{
  const s=summary(); const rc=$('#rc'); rc.hidden=false;
  const lines=[
'=== FLUE/VENT CHECK (58–º–º) ===',
'Case: '+s.case,
'Date: '+s.day,
'Addr: '+s.addr,
'App:  '+s.appliance,
'Tech: '+s.tech,
'Asset:'+s.asset,
'Pts:  D'+s.points.draft.length+' / CO'+s.points.co.length,
'Thr:  D‚â•'+s.thresholds.draftOK+'Pa CO W'+s.thresholds.coWarn+'/A'+s.thresholds.coAlarm,
'Time: DOK '+s.time_acc_s.draft_ok+'s; COW '+s.time_acc_s.co_warn+'s; COA '+s.time_acc_s.co_alarm+'s',
'Photos:'+(s.photos.inlet?1:0)+'/'+(s.photos.outlet?1:0)+'/'+(s.photos.defect?1:0)+' Audio:'+(s.audio?'Y':'N'),
'--------------------------'
  ];
  rc.textContent=lines.join('\n');
  download('gas_para7_receipt_'+stamp()+'.txt', rc.textContent);
  log('–ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ —á–µ–∫ 58–º–º');
});
$('#qrGen').addEventListener('click',()=>{
  const def = CASE_ID || ASSET_ID || 'flue-vent';
  const data = prompt('–í—Å—Ç–∞–≤ URL/ID (Case –∞–±–æ Asset):', def);
  if(data===null) return;
  const url='https://api.qrserver.com/v1/create-qr-code/?size=220x220&margin=2&data='+encodeURIComponent(data);
  const img=new Image(); img.crossOrigin='anonymous';
  img.onload=()=>{ const q=$('#qr').getContext('2d'); q.clearRect(0,0,220,220); q.drawImage(img,0,0,220,220); };
  img.onerror=()=>{ const q=$('#qr').getContext('2d'); q.clearRect(0,0,220,220); q.fillStyle='#e5e7eb'; q.font='14px ui-monospace'; q.fillText('QR offline', 62,110); q.fillText((data.length>14?data.slice(0,14)+'‚Ä¶':data), 36,132); };
  img.src=url; log('–ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ QR');
});

// ===== –ö–∞–º–µ—Ä–∞ —ñ–Ω—ñ—Ç
function renderGallery(){/* —É–∂–µ –≤–∏–∑–Ω–∞—á–µ–Ω–æ –≤–∏—â–µ */}
// ===== –Ü–Ω—ñ—Ç –º–µ—Ç—Ä–∏–∫
updateMetrics();
(function(){ if (window.self !== window.top) document.documentElement.classList.add('embedded'); })();
</script>
</body>
</html>
