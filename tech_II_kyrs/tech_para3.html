<!-- tech_para3.html
     –ü–ê–†–ê 3 (–∞—É–¥–∏—Ç–æ—Ä–Ω–æ) –¥–ª—è —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ–≤ –∑ –ø–µ—Ä–µ—Ä–æ–±–∫–∏ –ø—Ä–æ–¥—É–∫—Ü—ñ—ó —Ç–≤–∞—Ä–∏–Ω–Ω–∏—Ü—Ç–≤–∞
     –¢–µ–º–∞: –†–ï–¶–ï–ü–¢–£–†–ò –¢–ê –ü–û–°–Ü–õ ‚Äî —Ä–æ–∑—Å–æ–ª, –∫—É—Ö–æ–Ω–Ω–∞ —Å—ñ–ª—å, –Ω—ñ—Ç—Ä–∏—Ç–Ω–∞ —Å—ñ–ª—å, ppm –Ω—ñ—Ç—Ä–∏—Ç—É,
           –≤–æ–¥–æ–∑–≤‚Äô—è–∑—É–≤–∞–Ω–Ω—è —Ç–∞ –≤—Ç—Ä–∞—Ç–∏ –ø—Ä–∏ —Ç–µ—Ä–º–æ–æ–±—Ä–æ–±—Ü—ñ, —Ö–∞—Ä—á–æ–≤–∞ —Ü—ñ–Ω–Ω—ñ—Å—Ç—å, –∫–≤–∏—Ç–æ–∫ 58 –º–º, NFC, CSV-–∂—É—Ä–Ω–∞–ª.
     –§–æ–∫—É—Å: —Ç–µ–ª–µ—Ñ–æ–Ω–∏/–ü–ö; –±–µ–∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫; –≥–æ—Ç–æ–≤–æ –¥–ª—è GitHub Pages —Ç–∞ Moodle (iframe).
     –û–±–ª–∞–¥–Ω–∞–Ω–Ω—è: —Ç–µ–ª–µ—Ñ–æ–Ω–∏; (–æ–ø—Ü.) —Ç–µ—Ä–º–æ–ø—Ä–∏–Ω—Ç–µ—Ä 58 –º–º; NFC-–º—ñ—Ç–∫–∏.

     –ü—Ä–∏–º—ñ—Ç–∫–∞ –∫–æ–Ω—Ç—Ä–∞—Å—Ç—É: —Ç–µ–º–Ω—ñ –∫–ª—ñ—Ç–∏–Ω–∫–∏ —Ç–∞–±–ª–∏—Ü—å –º–∞—é—Ç—å —Å–≤—ñ—Ç–ª–∏–π —Ç–µ–∫—Å—Ç (.dark).
     –í–ê–ñ–õ–ò–í–û: —Ü–µ –Ω–∞–≤—á–∞–ª—å–Ω–∏–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä. –§–∞–∫—Ç–∏—á–Ω—ñ –Ω–æ—Ä–º–∏ (–Ω—ñ—Ç—Ä–∏—Ç/—Å—ñ–ª—å/–¥–æ–±–∞–≤–∫–∏) –ø–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ –∑–∞ —á–∏–Ω–Ω–∏–º–∏ –¢–£, —Ä–µ—Ü–µ–ø—Ç—É—Ä–∞–º–∏ —Ç–∞ HACCP-–ø–ª–∞–Ω–æ–º.
-->
<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>–ü–∞—Ä–∞ 3 (—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏) ‚Äî –†–µ—Ü–µ–ø—Ç—É—Ä–∏ —Ç–∞ –ø–æ—Å—ñ–ª: —Ä–æ–∑—Å–æ–ª, –Ω—ñ—Ç—Ä–∏—Ç, ppm, –≤—Ç—Ä–∞—Ç–∏, –∫–≤–∏—Ç–æ–∫ 58 –º–º, NFC</title>
<meta name="color-scheme" content="light dark">
<style>
  :root{
    --bg:#0b1220; --card:#0f172a; --muted:#94a3b8; --text:#e2e8f0;
    --accent:#22c55e; --accent-2:#60a5fa; --warn:#f59e0b; --bad:#ef4444; --good:#10b981; --line:#1f2937;
    --darkcell:#0b1324; --darkink:#e6eef9; --darkink2:#e5e7eb;
  }
  *{box-sizing:border-box}
  body{margin:0;background:linear-gradient(180deg,#0b1220,#111827 30%,#0b1220);color:var(--text);
       font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;line-height:1.55}
  .wrap{max-width:1100px;margin:0 auto;padding:24px 16px 64px}
  .badge{display:inline-block;padding:6px 10px;border:1px solid var(--line);background:#0b1220;border-radius:999px;
         font-size:12px;color:var(--muted);letter-spacing:.3px}
  h1{font-size:34px;margin:6px 0 12px;line-height:1.15;
     background:linear-gradient(90deg,#60a5fa,#22c55e);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
  h2{font-size:22px;margin:28px 0 12px} h3{font-size:18px;margin:20px 0 8px;color:#cbd5e1}
  p{margin:10px 0}.small{font-size:12px;color:#9fb0c8}.muted{color:#93a3b5}.mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Courier New",monospace}
  .btn{display:inline-block;padding:10px 14px;border-radius:10px;border:1px solid #223049;background:#0d1a2e;color:#dbeafe;text-decoration:none;cursor:pointer}
  .btn:hover{background:#0f1f39}
  .grid{display:grid;gap:12px}.g2{grid-template-columns:repeat(2,minmax(0,1fr))}.g3{grid-template-columns:repeat(3,minmax(0,1fr))}
  @media (max-width:1000px){.g2,.g3{grid-template-columns:1fr}}
  .row{display:flex;gap:10px;flex-wrap:wrap}
  .card{background:linear-gradient(180deg,#0f172a,#0b1220);border:1px solid var(--line);border-radius:16px;padding:16px;margin:12px 0;box-shadow:0 6px 24px rgba(0,0,0,.25)}
  .box{border:1px solid #223049;border-radius:12px;padding:12px;background:var(--darkcell);color:var(--darkink)}
  .ok{color:var(--good)} .warn{color:var(--warn)} .bad{color:var(--bad)}
  .table{width:100%;border-collapse:separate;border-spacing:0;overflow:auto;border-radius:12px;border:1px solid #223049}
  .table th,.table td{padding:8px 10px;border-bottom:1px solid #1f2937;font-size:14px;vertical-align:top}
  .table thead th{background:#0c1629;color:#a5b4fc;text-align:left;position:sticky;top:0}
  .table tbody tr:nth-child(even){background:var(--darkcell);color:var(--darkink2)}
  .table td.dark,.table th.dark{background:var(--darkcell)!important;color:var(--darkink2)!important}
  .out{background:var(--darkcell);color:var(--darkink2);border:1px dashed #263042;padding:10px 12px;border-radius:10px;word-break:break-all}
  input[type="text"],input[type="number"],input[type="date"],input[type="time"],select,textarea{width:100%;padding:8px 10px;border-radius:10px;border:1px solid #223049;background:#0d1a2e;color:#e6eef9}
  textarea{min-height:84px}
  /* –ß–µ–∫ 58 –º–º */
  .ticket{width:58mm;background:#fff;color:#000;padding:6mm 4mm;border-radius:6px;box-shadow:0 0 0 1px #e5e7eb inset;font-family:"Courier New",ui-monospace,monospace}
  .ticket h4{margin:0 0 6px;font-size:13px;text-align:center}.ticket p{margin:2px 0;font-size:12px}.ticket .line{border-top:1px dashed #111;margin:6px 0}
  .ticket small{font-size:10px}
  /* –í–±—É–¥–æ–≤–∞–Ω–æ –≤ Moodle (iframe) ‚Üí —Å–≤—ñ—Ç–ª–∏–π –≤–∏–≥–ª—è–¥ */
  html.embedded body{background:#fff;color:#111}
  html.embedded .card{background:#fff;border:1px solid #e5e7eb;box-shadow:none}
  html.embedded h1{-webkit-text-fill-color:initial;background:none;color:#111}
  html.embedded .box{background:#f8fafc;color:#111}
  html.embedded .table tbody tr:nth-child(even){background:#f3f4f6;color:#111}
  @media print{@page{margin:4mm}.no-print{display:none!important}}
</style>

<style>
/* PRINT PATCH v1 CSS (auto) */
.ticket{ font-weight:700; letter-spacing:0.1px }
.ticket h4{ font-weight:700 }
.ticket p,
.ticket b,
.ticket strong,
.ticket span,
.ticket small{ font-weight:700 }
</style>

</head>
<body>
<div class="wrap">
  <span class="badge">–ü–∞—Ä–∞ 3 ¬∑ –∞—É–¥–∏—Ç–æ—Ä–Ω–æ ¬∑ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏ –ø–µ—Ä–µ—Ä–æ–±–∫–∏</span>
  <h1>üßÇ –†–µ—Ü–µ–ø—Ç—É—Ä–∏ —Ç–∞ –ø–æ—Å—ñ–ª: —Ä–æ–∑—Å–æ–ª, –Ω—ñ—Ç—Ä–∏—Ç, ppm, –≤—Ç—Ä–∞—Ç–∏, –∫–≤–∏—Ç–æ–∫ 58 –º–º, NFC</h1>

  <div class="card">
    <h2>üéØ –ú–µ—Ç–∞ –ø–∞—Ä–∏</h2>
    <p>
      –ó–∞ –∑–∞–Ω—è—Ç—Ç—è —Å—Ç—É–¥–µ–Ω—Ç–∏: (1) —Å—Ñ–æ—Ä–º—É—é—Ç—å <b>—Ä–æ–∑—Å–æ–ª</b> (%, –≥/–ª), (2) —Ä–æ–∑—Ä–∞—Ö—É—é—Ç—å <b>–¥–æ–∑—É –Ω—ñ—Ç—Ä–∏—Ç–Ω–æ—ó —Å–æ–ª—ñ</b> —Ç–∞ <b>ppm –Ω—ñ—Ç—Ä–∏—Ç—É</b>,
      (3) –æ—Ü—ñ–Ω—è—Ç—å <b>–≤—Ç—Ä–∞—Ç–∏ –ø—Ä–∏ —Ç–µ—Ä–º–æ–æ–±—Ä–æ–±—Ü—ñ</b> —ñ <b>–≤–∏—Ö—ñ–¥</b>, (4) –ø—Ä–∏–±–ª–∏–∑–Ω–æ –≤–∏–∑–Ω–∞—á–∞—Ç—å <b>—Ö–∞—Ä—á–æ–≤—É —Ü—ñ–Ω–Ω—ñ—Å—Ç—å</b> –Ω–∞ 100&nbsp;–≥,
      (5) –æ—Ñ–æ—Ä–º–ª—è—Ç—å <b>–∂—É—Ä–Ω–∞–ª</b>, <b>–∫–≤–∏—Ç–æ–∫ 58&nbsp;–º–º</b>, <b>NFC</b> —Ç–∞ <b>CSV</b>.
    </p>
    <p class="small muted">–î–æ–ø—É—â–µ–Ω–Ω—è: –Ω—ñ—Ç—Ä–∏—Ç–Ω–∞ —Å—ñ–ª—å –º—ñ—Å—Ç–∏—Ç—å <span class="mono">0.6% NaNO‚ÇÇ</span> —É —Å—É–º—ñ—à—ñ –∑ –∫—É—Ö–æ–Ω–Ω–æ—é —Å—ñ–ª–ª—é (—Ç–∏–ø Prague Powder #1).
      –î–ª—è –∫–æ–≤–±–∞—Å –≤–∞—Ä–µ–Ω–∏—Ö/–Ω–∞–ø—ñ–≤–∫–æ–ø—á–µ–Ω–∏—Ö —Ü—ñ–ª—å ‚Äî –æ—Ä—ñ—î–Ω—Ç–∏—Ä <span class="mono">‚â§ 150 ppm</span> NaNO‚ÇÇ —É –≥–æ—Ç–æ–≤–æ–º—É –ø—Ä–æ–¥—É–∫—Ç—ñ (–ø—ñ—Å–ª—è —Ç–µ–ø–ª–æ–≤–æ—ó –æ–±—Ä–æ–±–∫–∏).
      –ó–∞–≤–∂–¥–∏ –∑–≤—ñ—Ä—è–π—Ç–µ –∑ —á–∏–Ω–Ω–∏–º–∏ –Ω–æ—Ä–º–∞–º–∏ —Ç–∞ –¢–£.</p>
  </div>

  <!-- 1. –†–ï–¶–ï–ü–¢–£–†–ê –¢–ê –†–û–ó–°–û–õ -->
  <div class="card">
    <h2>ü•© –†–µ—Ü–µ–ø—Ç—É—Ä–∞ —Ç–∞ —Ä–æ–∑—Å–æ–ª</h2>
    <div class="grid g3">
      <div class="box">
        <h3>–ü–∞—Ä—Ç—ñ—è</h3>
        <div class="row">
          <div style="flex:1"><label>–ú–∞—Å–∞ –º'—è—Å–∞, –∫–≥</label><input id="meatKg" type="number" step="0.1" value="50"></div>
          <div style="flex:1"><label>–í–æ–¥–∞/–ª—ñ–¥, –∫–≥</label><input id="waterKg" type="number" step="0.1" value="10"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <div style="flex:1"><label>–°—ñ–ª—å –∫—É—Ö–æ–Ω–Ω–∞, % –≤—ñ–¥ –º–∞—Å–∏ —Ñ–∞—Ä—à—É</label><input id="saltPct" type="number" step="0.01" value="1.8"></div>
          <div style="flex:1"><label>–ù—ñ—Ç—Ä–∏—Ç–Ω–∞ —Å—ñ–ª—å, % –≤—ñ–¥ –º–∞—Å–∏ —Ñ–∞—Ä—à—É</label><input id="nsPct" type="number" step="0.01" value="0.2"></div>
        </div>
        <p class="small muted">–§–∞—Ä—à–æ–≤–∞ –º–∞—Å–∞ = –º'—è—Å–æ + –≤–æ–¥–∞ + –≤—Å—ñ –¥–æ–±–∞–≤–∫–∏ (–Ω–∞–±–ª–∏–∂–µ–Ω–æ).</p>
      </div>

      <div class="box">
        <h3>–†–æ–∑—Å–æ–ª (–¥–ª—è —ñ–Ω'—î–∫—Ü—ñ—ó/–º–∞—Å–∞–∂—É)</h3>
        <div class="row">
          <div style="flex:1"><label>–¶—ñ–ª—å–æ–≤–∞ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü—ñ—è —Å–æ–ª—ñ –≤ —Ä–æ–∑—Å–æ–ª—ñ, %</label><input id="brineSaltPct" type="number" step="0.1" value="8"></div>
          <div style="flex:1"><label>–û–±'—î–º —Ä–æ–∑—Å–æ–ª—É, –ª</label><input id="brineL" type="number" step="0.1" value="15"></div>
        </div>
        <p class="small muted">–ü—ñ–¥–∫–∞–∑–∫–∞: 8‚Äì12% NaCl —É —Ä–æ–∑—Å–æ–ª—ñ ‚Äî —Ç–∏–ø–æ–≤–æ –¥–ª—è –º–∞—Å–∞–∂—É/—ñ–Ω'—î–∫—Ü—ñ—ó –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –ø—Ä–æ–¥—É–∫—Ç—É.</p>
      </div>

      <div class="box">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
        <p>–§–∞—Ä—à–æ–≤–∞ –º–∞—Å–∞: <b><span id="mixKg">‚Äî</span></b> –∫–≥</p>
        <p>–°—ñ–ª—å –∫—É—Ö–æ–Ω–Ω–∞: <b><span id="saltG">‚Äî</span></b> –≥</p>
        <p>–ù—ñ—Ç—Ä–∏—Ç–Ω–∞ —Å—ñ–ª—å (0.6% NaNO‚ÇÇ): <b><span id="nsG">‚Äî</span></b> –≥</p>
        <p>–†–æ–∑—Å–æ–ª: <b><span id="brineSaltG">‚Äî</span></b> –≥ —Å–æ–ª—ñ –Ω–∞ <span id="brineVolL">‚Äî</span> –ª</p>
        <div class="row" style="margin-top:6px">
          <button class="btn" onclick="calcRecipe()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="presetRecipe()">üß™ –ü—Ä–∏–∫–ª–∞–¥</button>
          <button class="btn" onclick="copyCSV('csvRecipe')">üìã CSV (recipe)</button>
        </div>
        <div id="csvRecipe" class="out" style="margin-top:8px">‚Äî</div>
      </div>
    </div>
  </div>

  <!-- 2. –ù–Ü–¢–†–ò–¢: –†–û–ó–†–ê–•–£–ù–û–ö ppm -->
  <div class="card">
    <h2>üß™ –ù—ñ—Ç—Ä–∏—Ç: ppm —É –≥–æ—Ç–æ–≤–æ–º—É –ø—Ä–æ–¥—É–∫—Ç—ñ</h2>
    <div class="grid g3">
      <div class="box">
        <h3>–ü–∞—Ä–∞–º–µ—Ç—Ä–∏</h3>
        <div class="row">
          <div style="flex:1"><label>–ß–∞—Å—Ç–∫–∞ NaNO‚ÇÇ —É –Ω—ñ—Ç—Ä–∏—Ç–Ω—ñ–π —Å–æ–ª—ñ, %</label><input id="naNo2Pct" type="number" step="0.01" value="0.6"></div>
          <div style="flex:1"><label>–í—Ç—Ä–∞—Ç–∏ –ø—Ä–∏ –≤–∞—Ä—Ü—ñ/–∑–∞–ø—ñ–∫–∞–Ω–Ω—ñ, %</label><input id="cookLossPct" type="number" step="0.1" value="8"></div>
        </div>
        <p class="small muted">–î–æ–ø—É—â–µ–Ω–Ω—è: —Ä—ñ–≤–Ω–æ–º—ñ—Ä–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª, –≤—Ç—Ä–∞—Ç–∏ –º–∞—Å–∏ –∑–º–µ–Ω—à—É—é—Ç—å <i>–º–∞—Å—É</i> –≥–æ—Ç–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç—É, –∞ –Ω–µ –≤–Ω–µ—Å–µ–Ω–∏–π NaNO‚ÇÇ.</p>
      </div>

      <div class="box">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
        <p>–í–Ω–µ—Å–µ–Ω–∏–π NaNO‚ÇÇ: <b><span id="naNo2_mg">‚Äî</span></b> –º–≥</p>
        <p>–ú–∞—Å–∞ –≥–æ—Ç–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç—É: <b><span id="readyKg">‚Äî</span></b> –∫–≥</p>
        <p>–û—Ü—ñ–Ω–æ—á–Ω–∏–π —Ä—ñ–≤–µ–Ω—å: <b><span id="ppm">‚Äî</span></b> ppm</p>
        <p>–°—Ç–∞—Ç—É—Å: <b><span id="ppmFlag">‚Äî</span></b></p>
      </div>

      <div class="box">
        <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
        <div class="row">
          <button class="btn" onclick="calcNitrite()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="copyCSV('csvNitrite')">üìã CSV (nitrite)</button>
        </div>
        <div id="csvNitrite" class="out" style="margin-top:8px">‚Äî</div>
      </div>
    </div>
    <p class="small muted">–ù–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è: –≤–µ—Ä—Ö–Ω—ñ –º–µ–∂—ñ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –ø—Ä–æ–¥—É–∫—Ç—ñ–≤ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å—Å—è –∑–∞–∫–æ–Ω–æ–¥–∞–≤—Å—Ç–≤–æ–º/–¢–£. –î–æ—Ç—Ä–∏–º—É–π—Ç–µ—Å—è HACCP-–ø—Ä–æ—Ü–µ–¥—É—Ä —ñ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—é.</p>
  </div>

  <!-- 3. –•–ê–†–ß–û–í–ê –¶–Ü–ù–ù–Ü–°–¢–¨ (–ù–ê–ë–õ–ò–ñ–ï–ù–û) -->
  <div class="card">
    <h2>ü•ó –•–∞—Ä—á–æ–≤–∞ —Ü—ñ–Ω–Ω—ñ—Å—Ç—å (–Ω–∞ 100 –≥, –ø—Ä–∏–±–ª–∏–∑–Ω–æ)</h2>
    <div class="grid g3">
      <div class="box">
        <h3>–í—Ö—ñ–¥–Ω—ñ</h3>
        <div class="row">
          <div style="flex:1"><label>–ë—ñ–ª–æ–∫, % —É –≥–æ—Ç–æ–≤–æ–º—É</label><input id="protPct" type="number" step="0.1" value="16"></div>
          <div style="flex:1"><label>–ñ–∏—Ä, % —É –≥–æ—Ç–æ–≤–æ–º—É</label><input id="fatPct" type="number" step="0.1" value="18"></div>
        </div>
        <p class="small muted">–ï–Ω–µ—Ä–≥–µ—Ç–∏—á–Ω—ñ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏: –±—ñ–ª–æ–∫ ~4 –∫–∫–∞–ª/–≥, –∂–∏—Ä ~9 –∫–∫–∞–ª/–≥, –≤—É–≥–ª–µ–≤–æ–¥–∏ (–∑–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ) ~4 –∫–∫–∞–ª/–≥.</p>
      </div>
      <div class="box">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
        <p>–ï–Ω–µ—Ä–≥—ñ—è: <b><span id="kcal">‚Äî</span></b> –∫–∫–∞–ª</p>
        <p>–°—ñ–ª—å, –≥/100–≥ (–æ—Ü—ñ–Ω–∫–∞): <b><span id="saltPer100">‚Äî</span></b></p>
        <p>–ü–Ü–î–í–ê–õ –ï–¢–ò–ö–ï–¢–ö–ò: <b><span id="labelLine">‚Äî</span></b></p>
      </div>
      <div class="box">
        <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
        <div class="row">
          <button class="btn" onclick="calcNutrition()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="copyCSV('csvNutri')">üìã CSV (nutrition)</button>
        </div>
        <div id="csvNutri" class="out" style="margin-top:8px">‚Äî</div>
      </div>
    </div>
  </div>

  <!-- 4. –ñ–£–†–ù–ê–õ –†–ï–¶–ï–ü–¢–£–† -->
  <div class="card">
    <h2>üìí –ñ—É—Ä–Ω–∞–ª —Ä–µ—Ü–µ–ø—Ç—É—Ä</h2>
    <div class="row">
      <button class="btn" onclick="addRow()">‚ûï –î–æ–¥–∞—Ç–∏ —Ä—è–¥–æ–∫</button>
      <button class="btn" onclick="presetRows()">üß™ –ü—Ä–∏–∫–ª–∞–¥</button>
      <button class="btn" onclick="copyCSV('csvLog')">üìã CSV (journal)</button>
    </div>
    <div style="overflow:auto;margin-top:8px">
      <table class="table" id="tbl">
        <thead>
          <tr>
            <th>#</th>
            <th>–í–∏—Ä—ñ–±</th>
            <th class="dark">–§–∞—Ä—à, –∫–≥</th>
            <th class="dark">NaCl, –≥</th>
            <th class="dark">NO‚ÇÇ, ppm</th>
            <th>–í—Ç—Ä–∞—Ç–∏, %</th>
            <th>–í–∏—Ö—ñ–¥, –∫–≥</th>
            <th>–ö–∫–∞–ª/100–≥</th>
            <th>–ü—Ä–∏–º—ñ—Ç–∫–∞</th>
          </tr>
        </thead>
        <tbody id="body"></tbody>
      </table>
    </div>
    <div id="csvLog" class="out" style="margin-top:8px">‚Äî</div>
  </div>

  <!-- 5. –ö–í–ò–¢–û–ö + NFC -->
  <div class="card">
    <h2>üßæ –ö–≤–∏—Ç–æ–∫ 58 –º–º —Ç–∞ NFC</h2>
    <div class="grid g2">
      <div class="box">
        <h3>NFC ‚Äî ‚ÄúCURE BATCH CARD‚Äù</h3>
        <div class="row">
          <div style="flex:1"><label>–ù–∞–∑–≤–∞ –≤–∏—Ä–æ–±—É</label><input id="prodName" type="text" value="–ö–æ–≤–±–∞—Å–∞ –≤–∞—Ä–µ–Ω–∞"></div>
          <div style="flex:1"><label>–õ–æ—Ç</label><input id="lotId" type="text" value="LOT-REC-0003"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <div style="flex:1"><label>–ö–æ–Ω—Ç–∞–∫—Ç</label><input id="nfcPhone" type="text" value="+380XXXXXXXXX"></div>
          <div style="flex:1"><label>–û–ø–µ—Ä–∞—Ç–æ—Ä</label><input id="operator" type="text" value="–°—Ç—É–¥–µ–Ω—Ç –¢–ü–¢"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <button class="btn" onclick="buildNFC()">üß© –ó—ñ–±—Ä–∞—Ç–∏</button>
          <button class="btn" onclick="copyEl('nfcOut')">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
        </div>
        <div id="nfcOut" class="out">‚Äî</div>
      </div>

      <div class="box">
        <h3>–ö–≤–∏—Ç–æ–∫ –¥–ª—è –ø—Ä–∏–Ω—Ç–µ—Ä–∞ 58 –º–º</h3>
        <div class="row">
          <button class="btn" onclick="buildTicket()">üßæ –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="printTicketNewTab()">üñ®Ô∏è –î—Ä—É–∫</button>
        </div>
        <div class="ticket" id="ticket" style="margin-top:8px">
          <h4>RECIPE & CURE TICKET</h4>
          <p><b>–í–∏—Ä—ñ–±:</b> <span id="tProd">‚Äî</span></p>
          <p><b>–õ–û–¢:</b> <span id="tLot">‚Äî</span></p>
          <div class="line"></div>
          <p><b>–§–∞—Ä—à:</b> <span id="tMix">‚Äî</span> –∫–≥</p>
          <p><b>NaCl:</b> <span id="tSalt">‚Äî</span> –≥ ¬∑ <b>NO‚ÇÇ:</b> <span id="tPPM">‚Äî</span> ppm</p>
          <p><b>–í—Ç—Ä–∞—Ç–∏:</b> <span id="tLoss">‚Äî</span>% ¬∑ <b>–í–∏—Ö—ñ–¥:</b> <span id="tYield">‚Äî</span> –∫–≥</p>
          <p><b>–ï–Ω–µ—Ä–≥—ñ—è:</b> <span id="tKcal">‚Äî</span> –∫–∫–∞–ª/100–≥</p>
          <div class="line"></div>
          <p><small id="tNote">–ù–æ—Ä–º–∏ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ –∑–∞ –¢–£/–∑–∞–∫–æ–Ω–æ–¥–∞–≤—Å—Ç–≤–æ–º. –õ–∞–±. –∫–æ–Ω—Ç—Ä–æ–ª—å ‚Äî –æ–±–æ–≤ º—è–∑–∫–æ–≤–æ.</small></p>
        </div>
      </div>
    </div>
  </div>

  <!-- 6. –•–Ü–î –†–û–ë–û–¢–ò + –û–¶–Ü–ù–Æ–í–ê–ù–ù–Ø -->
  <div class="card">
    <h2>ü™ú –•—ñ–¥ —Ä–æ–±–æ—Ç–∏ (45‚Äì70 —Ö–≤)</h2>
    <ol>
      <li>–ó–∞–¥–∞–π—Ç–µ <b>–ø–∞—Ä—Ç—ñ—é</b> (–º'—è—Å–æ, –≤–æ–¥–∞, % —Å–æ–ª–µ–π) —Ç–∞ —Å—Ñ–æ—Ä–º—É–π—Ç–µ <b>—Ä–æ–∑—Å–æ–ª</b>.</li>
      <li>–û–±—á–∏—Å–ª—ñ—Ç—å <b>ppm –Ω—ñ—Ç—Ä–∏—Ç—É</b> –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º <b>–≤—Ç—Ä–∞—Ç</b> –º–∞—Å–∏ –ø—Ä–∏ —Ç–µ—Ä–º–æ–æ–±—Ä–æ–±—Ü—ñ.</li>
      <li>–û—Ü—ñ–Ω—ñ—Ç—å <b>—Ö–∞—Ä—á–æ–≤—É —Ü—ñ–Ω–Ω—ñ—Å—Ç—å</b> (–∫–∫–∞–ª, —Å—ñ–ª—å/100–≥), –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Å—Ç–∞—Ç—É—Å.</li>
      <li>–ó–∞–ø–æ–≤–Ω—ñ—Ç—å <b>–∂—É—Ä–Ω–∞–ª</b> (‚â•2 —Ä—è–¥–∫–∏), —Å—Ñ–æ—Ä–º—É–π—Ç–µ <b>NFC</b>, <b>–∫–≤–∏—Ç–æ–∫</b> —Ç–∞ <b>CSV</b>.</li>
    </ol>
  </div>

  <div class="card">
    <h2>‚úÖ –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è (10 –±–∞–ª—ñ–≤)</h2>
    <table class="table">
      <thead><tr><th>–ö—Ä–∏—Ç–µ—Ä—ñ–π</th><th>–ë–∞–ª–∏</th></tr></thead>
      <tbody>
        <tr><td>–ö–æ—Ä–µ–∫—Ç–Ω–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Ä–æ–∑—Å–æ–ª—É —ñ —Å–æ–ª–µ–π</td><td>3</td></tr>
        <tr><td>ppm –Ω—ñ—Ç—Ä–∏—Ç—É –∑ –æ–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è–º –≤—Ç—Ä–∞—Ç</td><td>3</td></tr>
        <tr><td>–•–∞—Ä—á–æ–≤–∞ —Ü—ñ–Ω–Ω—ñ—Å—Ç—å + –∂—É—Ä–Ω–∞–ª + CSV</td><td>3</td></tr>
        <tr><td>–ö–≤–∏—Ç–æ–∫/NFC –æ—Ñ–æ—Ä–º–ª–µ–Ω—ñ</td><td>1</td></tr>
      </tbody>
    </table>
  </div>
</div>

<script>
  // –í–±—É–¥–æ–≤–∞–Ω–∏–π —Ä–µ–∂–∏–º (Moodle iFrame)
  (function(){ if (window.self !== window.top) document.documentElement.classList.add('embedded'); })();

  const byId = id => document.getElementById(id);
  const rnd = (n,d=2)=>Number((+n).toFixed(d));
  const bodyEl = document.getElementById('body');

  // ==== 1) –†–µ—Ü–µ–ø—Ç—É—Ä–∞ / —Ä–æ–∑—Å–æ–ª ====
  function calcRecipe(){
    const meat = +byId('meatKg').value||0;
    const water = +byId('waterKg').value||0;
    const saltPct = (+byId('saltPct').value||0)/100;
    const nsPct = (+byId('nsPct').value||0)/100;

    const mix = meat + water; // –±–µ–∑ —É—Ä–∞—Ö. –º–∞—Å–∏ –¥–æ–±–∞–≤–æ–∫ (–Ω–∞–±–ª–∏–∂–µ–Ω–æ)
    const saltG = mix * saltPct * 1000;
    const nsG   = mix * nsPct   * 1000;

    const brinePct = (+byId('brineSaltPct').value||0)/100;
    const brineL   = +byId('brineL').value||0;
    const brineSaltG = brinePct * brineL * 1000 * 1.0; // 1 –ª ‚âà 1 –∫–≥ –≤–æ–¥–∏

    byId('mixKg').textContent = rnd(mix,2);
    byId('saltG').textContent = rnd(saltG,0);
    byId('nsG').textContent   = rnd(nsG,0);
    byId('brineSaltG').textContent = rnd(brineSaltG,0);
    byId('brineVolL').textContent  = rnd(brineL,1);

    const csv = `RECIPE|meat=${meat}kg|water=${water}kg|mix=${rnd(mix,2)}kg|NaCl=${rnd(saltG,0)}g|nitriteSalt=${rnd(nsG,0)}g|brine:${byId('brineSaltPct').value}%*${brineL}L=>${rnd(brineSaltG,0)}g`;
    byId('csvRecipe').textContent = csv;

    return {mix, saltG, nsG};
  }
  function presetRecipe(){
    byId('meatKg').value=40; byId('waterKg').value=12;
    byId('saltPct').value=1.9; byId('nsPct').value=0.25;
    byId('brineSaltPct').value=10; byId('brineL').value=18;
    calcRecipe(); calcNitrite(); calcNutrition();
  }

  // ==== 2) –ù—ñ—Ç—Ä–∏—Ç (ppm) ====
  function calcNitrite(){
    const r = calcRecipe();
    const naNo2Pct = (+byId('naNo2Pct').value||0)/100; // —á–∞—Å—Ç–∫–∞ —É –Ω—ñ—Ç—Ä–∏—Ç–Ω—ñ–π —Å–æ–ª—ñ
    const cookLoss = (+byId('cookLossPct').value||0)/100;

    const NaNO2_g = r.nsG * naNo2Pct;          // –≥ —á–∏—Å—Ç–æ–≥–æ NaNO2
    const NaNO2_mg = NaNO2_g * 1000;           // –º–≥
    const readyKg = r.mix * (1 - cookLoss);    // –∫–≥
    const ppm = (readyKg>0) ? (NaNO2_mg / readyKg) : 0;

    let flag='üü¢ –æ–∫ (‚â§150 ppm –æ—Ä—ñ—î–Ω—Ç–∏—Ä)'; let color='#10b981';
    if(ppm>150 && ppm<=200){ flag='üü† –±–ª–∏–∑—å–∫–æ/–≤–∏—â–µ –æ—Ä—ñ—î–Ω—Ç–∏—Ä—É ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –¢–£'; color='#f59e0b'; }
    if(ppm>200){ flag='üî¥ –ø–µ—Ä–µ–≤–∏—â–µ–Ω–Ω—è ‚Äî –Ω–µ–ø—Ä–∏–ø—É—Å—Ç–∏–º–æ'; color='#ef4444'; }

    byId('naNo2_mg').textContent = rnd(NaNO2_mg,0);
    byId('readyKg').textContent  = rnd(readyKg,2);
    byId('ppm').textContent      = rnd(ppm,0);
    const el=byId('ppmFlag'); el.textContent=flag; el.style.color=color;

    const csv = `NITRITE|NaNO2=${rnd(NaNO2_mg,0)}mg|ready=${rnd(readyKg,2)}kg|ppm=${rnd(ppm,0)}|status=${flag}`;
    byId('csvNitrite').textContent = csv;

    return {ppm, readyKg, NaNO2_mg};
  }

  // ==== 3) –•–∞—Ä—á–æ–≤–∞ —Ü—ñ–Ω–Ω—ñ—Å—Ç—å ====
  function calcNutrition(){
    const prot = +byId('protPct').value||0;
    const fat  = +byId('fatPct').value ||0;
    const kcal = prot*4 + fat*9;
    // –û—Ü—ñ–Ω–∫–∞ —Å–æ–ª—ñ –Ω–∞ 100 –≥: –±–µ—Ä–µ–º–æ –∑–∞–≥–∞–ª—å–Ω—É —Å—ñ–ª—å (NaCl+–Ω—ñ—Ç—Ä–∏—Ç–Ω–∞) / –º–∞—Å–∞ –≥–æ—Ç–æ–≤–æ–≥–æ
    const r = calcRecipe(); const n = calcNitrite();
    const totalSaltG = r.saltG + r.nsG; // –≥
    const saltPer100 = (n.readyKg>0) ? (totalSaltG / (n.readyKg*10)) : 0; // –≥ –Ω–∞ 100 –≥

    byId('kcal').textContent = rnd(kcal,0);
    byId('saltPer100').textContent = rnd(saltPer100,2);
    byId('labelLine').textContent = `–ï–Ω–µ—Ä–≥–µ—Ç–∏—á–Ω–∞ —Ü—ñ–Ω–Ω—ñ—Å—Ç—å ${rnd(kcal,0)} –∫–∫–∞–ª; –ë—ñ–ª–æ–∫ ${prot}% ¬∑ –ñ–∏—Ä ${fat}% ¬∑ –°—ñ–ª—å ${rnd(saltPer100,2)} –≥/100–≥`;

    const csv = `NUTRITION|kcal=${rnd(kcal,0)}|protein=${prot}%|fat=${fat}%|salt_per_100g=${rnd(saltPer100,2)}g`;
    byId('csvNutri').textContent = csv;

    return {kcal, prot, fat, saltPer100};
  }

  // ==== 4) –ñ—É—Ä–Ω–∞–ª ====
  function addRow(sample){
    const rec = calcRecipe(); const nit = calcNitrite(); const nut = calcNutrition();
    const loss = +byId('cookLossPct').value||0;
    const outKg = rnd(nit.readyKg,2);
    const def = {
      name: byId('prodName').value || '–í–∏—Ä—ñ–±',
      mix: rnd(rec.mix,2),
      nacl: rnd(rec.saltG,0),
      ppm: rnd(nit.ppm,0),
      loss: loss,
      yield: outKg,
      kcal: rnd(nut.kcal,0),
      note: ''
    };
    const s = Object.assign({}, def, sample||{});
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td class="idx">1</td>
      <td><input type="text" value="${s.name}"></td>
      <td class="dark">${s.mix}</td>
      <td class="dark">${s.nacl}</td>
      <td class="dark">${s.ppm}</td>
      <td>${s.loss}</td>
      <td>${s.yield}</td>
      <td>${s.kcal}</td>
      <td><input type="text" value="${s.note}"></td>
    `;
    bodyEl.appendChild(tr); reindex(); buildCSVlog();
  }
  function reindex(){ [...bodyEl.querySelectorAll('tr')].forEach((tr,i)=>tr.querySelector('.idx').textContent=i+1); }
  function presetRows(){
    bodyEl.innerHTML='';
    presetRecipe();
    addRow({name:'–ö–æ–≤–±–∞—Å–∞ –≤–∞—Ä–µ–Ω–∞ ‚Äú–ö–ª–∞—Å–∏—á–Ω–∞‚Äù', note:'–º–∞—Å–∞–∂ 60 —Ö–≤'});
    byId('nsPct').value=0.18; calcRecipe(); calcNitrite(); calcNutrition();
    addRow({name:'–®–∏–Ω–∫–∞ –≤–∞—Ä–µ–Ω–∞', note:'—ñ–Ω º—î–∫—Ü—ñ—è 20%'});
    buildCSVlog();
  }
  function buildCSVlog(){
    const rows = [...bodyEl.querySelectorAll('tr')].map(r=>{
      const idx=r.querySelector('.idx').textContent.trim();
      const name=r.children[1].querySelector('input').value.trim();
      const mix=r.children[2].textContent.trim();
      const nacl=r.children[3].textContent.trim();
      const ppm=r.children[4].textContent.trim();
      const loss=r.children[5].textContent.trim();
      const y=r.children[6].textContent.trim();
      const kcal=r.children[7].textContent.trim();
      const note=r.children[8].querySelector('input').value.trim();
      return [idx,name,mix,nacl,ppm,loss,y,kcal,note].join(' | ');
    });
    byId('csvLog').textContent = rows.join('\n') || '‚Äî';
  }

  // ==== 5) –ö–≤–∏—Ç–æ–∫ / NFC ====
  function buildTicket(){
    const rec = calcRecipe(); const nit = calcNitrite(); const nut = calcNutrition();
    byId('tProd').textContent = byId('prodName').value || '–í–∏—Ä—ñ–±';
    byId('tLot').textContent  = byId('lotId').value || '‚Äî';
    byId('tMix').textContent  = rnd(rec.mix,2);
    byId('tSalt').textContent = rnd(rec.saltG,0);
    byId('tPPM').textContent  = rnd(nit.ppm,0);
    byId('tLoss').textContent = byId('cookLossPct').value || '‚Äî';
    byId('tYield').textContent= rnd(nit.readyKg,2);
    byId('tKcal').textContent = rnd(nut.kcal,0);
  }
  function buildNFC(){
    const rec = calcRecipe(); const nit = calcNitrite(); const nut = calcNutrition();
    const txt = [
      `CURE_BATCH_NFC`,
      `PROD:${byId('prodName').value} LOT:${byId('lotId').value}`,
      `MIX:${rnd(rec.mix,2)}kg | NaCl:${rnd(rec.saltG,0)}g | NO2:${rnd(nit.ppm,0)}ppm`,
      `LOSS:${byId('cookLossPct').value}% | YIELD:${rnd(nit.readyKg,2)}kg`,
      `ENERGY:${rnd(nut.kcal,0)}kcal/100g | SALT:${rnd(nut.saltPer100,2)}g/100g`,
      `OPER:${byId('operator').value} CONTACT:${byId('nfcPhone').value}`,
      `STAMP:${new Date().toISOString().slice(0,19).replace('T',' ')}`
    ].join('\n');
    byId('nfcOut').textContent = txt;
  }

  // ==== –£—Ç–∏–ª—ñ—Ç–∏ ====
  function copyCSV(id){
    const t = document.getElementById(id).textContent.trim();
    if(!t||t==='‚Äî'){ alert('–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è'); return; }
    navigator.clipboard.writeText(t).then(()=>flash('‚úÖ CSV —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'),()=>flash('–ù–µ –≤–¥–∞–ª–æ—Å—è'));
  }
  function copyEl(id){
    const t = byId(id).textContent.trim();
    if(!t||t==='‚Äî'){ alert('–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö'); return; }
    navigator.clipboard.writeText(t).then(()=>flash('‚úÖ –°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'),()=>flash('–ù–µ –≤–¥–∞–ª–æ—Å—è'));
  }
  function flash(msg){ const o=document.title; document.title=msg; setTimeout(()=>document.title=o,900); }

  // ==== –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è ====
  (function init(){
    calcRecipe(); calcNitrite(); calcNutrition();
    document.addEventListener('change', e=>{
      if(e.target.matches('input,select,textarea')) { calcRecipe(); calcNitrite(); calcNutrition(); buildCSVlog(); }
    });
  })();
</script>

<script>
// PRINT PATCH v1 (auto)
function printTicketNewTab(){
  var ticket = document.getElementById('ticket');
  if(!ticket){ alert('–ù–µ–º–∞—î #ticket –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ'); return; }
  try{
    var someTxt = (document.querySelector('#ticket span, #ticket p, #ticket h4')||{}).textContent||'';
    if(!someTxt || someTxt.trim()==='‚Äî'){ if(typeof buildTicket==='function') buildTicket(); }
  }catch(_){}

  var css = `
    @media print { @page { size:58mm auto; margin:0 } }
    html,body{ margin:0; padding:0; background:#fff; color:#000 }
    .ticket{
      width:58mm; margin:0; padding:6mm 4mm; background:#fff; color:#000;
      font-family:"Courier New", Courier, monospace; font-weight:700; letter-spacing:0.1px;
      border:none; box-shadow:none; border-radius:0
    }
    .ticket h4{ margin:0 0 6px; font-size:13px; text-align:center; font-weight:700 }
    .ticket p{ margin:2px 0; font-size:12px; font-weight:700 }
    .ticket b,.ticket strong,.ticket span{ font-weight:700 }
    .line{ border-top:1px dashed #111; margin:6px 0 }
    small{ font-size:10px; font-weight:700 }
  `;
  var html = `<!DOCTYPE html><html><head><meta charset="utf-8"><title>–ß–µ–∫ 58 –º–º</title><style>${css}</style></head><body>${ticket.outerHTML}
  <script>
    window.addEventListener('load',()=>{
      try{ window.focus(); window.print(); if(window.opener) window.opener.postMessage({type:'ticketPrint',status:'invoked'},'*'); }
      catch(e){ if(window.opener) window.opener.postMessage({type:'ticketPrint',status:'error'},'*'); }
    });
  <\/script>
  </body></html>`;

  var w = window.open('', '_blank');
  if(!w){ openTicketOnly(); return; }  // –ø–æ–ø–∞–ø –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ ‚Äî —Ñ–æ–ª–±–µ–∫
  w.document.open(); w.document.write(html); w.document.close();

  var timer = setTimeout(()=>{ openTicketOnly(); }, 1200);
  window.addEventListener('message', (ev)=>{
    if(ev && ev.data && ev.data.type==='ticketPrint'){ clearTimeout(timer); }
  }, {once:true});
}

function openTicketOnly(){
  var ticket = document.getElementById('ticket');
  if(!ticket){ alert('–ù–µ–º–∞—î #ticket –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ'); return; }
  try{
    var someTxt = (document.querySelector('#ticket span, #ticket p, #ticket h4')||{}).textContent||'';
    if(!someTxt || someTxt.trim()==='‚Äî'){ if(typeof buildTicket==='function') buildTicket(); }
  }catch(_){}

  var css = `
    @media print { @page { size:58mm auto; margin:0 } }
    html,body{ margin:0; background:#fff; color:#000 }
    .ticket{
      width:58mm; margin:0; padding:6mm 4mm; background:#fff; color:#000;
      font-family:"Courier New", Courier, monospace; font-weight:700; letter-spacing:0.1px;
      border:none; box-shadow:none; border-radius:0
    }
    .ticket h4{ margin:0 0 6px; font-size:13px; text-align:center; font-weight:700 }
    .ticket p{ margin:2px 0; font-size:12px; font-weight:700 }
    .line{ border-top:1px dashed #111; margin:6px 0 }
    small{ font-size:10px; font-weight:700 }
  `;
  var html = `<!DOCTYPE html><html><head><meta charset="utf-8"><title>–ß–µ–∫ 58 –º–º</title><style>${css}</style></head><body>${ticket.outerHTML}
<script>window.addEventListener('load',()=>{ try{ window.focus(); window.print(); }catch(e){} });<\/script>
</body></html>`;

  var blob = new Blob([html], {type:'text/html'});
  var url = URL.createObjectURL(blob);
  window.open(url, '_blank');
  setTimeout(()=>URL.revokeObjectURL(url), 60000);
}
</script>

</body>
</html>
