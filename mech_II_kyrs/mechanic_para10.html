<!-- mechanic_para10.html
     –ü–ê–†–ê 10 (–∞—É–¥–∏—Ç–æ—Ä–Ω–æ) –¥–ª—è –º–µ—Ö–∞–Ω—ñ–∫—ñ–≤
     –¢–µ–º–∞: –ì–Ü–î–†–ê–í–õ–Ü–ö–ê ‚Äî —Ç–∏—Å–∫/–≤–∏—Ç—Ä–∞—Ç–∞, —Å–∏–ª–∞/—à–≤–∏–¥–∫—ñ—Å—Ç—å —Ü–∏–ª—ñ–Ω–¥—Ä–∞, –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ä–µ–¥—É–∫—Ü—ñ–π–Ω–æ–≥–æ (–ø–µ—Ä–µ–ø—É—Å–∫–Ω–æ–≥–æ) –∫–ª–∞–ø–∞–Ω–∞,
           –ø—ñ–¥–±—ñ—Ä —Ä—É–∫–∞–≤—ñ–≤/—Ç—Ä—É–± –∑–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—é –ø–æ—Ç–æ–∫—É, —Ç–µ–ø–ª–æ–Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, —á–∏—Å—Ç–æ—Ç–∞ ISO 4406, —á–µ–∫ 58 –º–º, NFC, CSV.
     –§–æ–∫—É—Å: —Ç–µ–ª–µ—Ñ–æ–Ω–∏/–ü–ö; –±–µ–∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫; –≥–æ—Ç–æ–≤–æ –¥–ª—è GitHub Pages —Ç–∞ Moodle (iframe).
     –û–±–ª–∞–¥–Ω–∞–Ω–Ω—è: —Ç–µ–ª–µ—Ñ–æ–Ω–∏; –∑–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ ‚Äî –º–∞–Ω–æ–º–µ—Ç—Ä, –≤–∏—Ç—Ä–∞—Ç–æ–º—ñ—Ä-–Ω–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—á (–¥–µ–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è –≤–≤–æ–¥—è—Ç—å—Å—è –≤—Ä—É—á–Ω—É).
     –ü—Ä–∏–º—ñ—Ç–∫–∞ —â–æ–¥–æ –∫–æ–Ω—Ç—Ä–∞—Å—Ç—É: —Ç–µ–º–Ω—ñ –∫–ª—ñ—Ç–∏–Ω–∫–∏ —Ç–∞–±–ª–∏—Ü—å –º–∞—é—Ç—å —Å–≤—ñ—Ç–ª–∏–π —Ç–µ–∫—Å—Ç (.dark).
-->
<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>–ü–∞—Ä–∞ 10 (–º–µ—Ö–∞–Ω—ñ–∫–∏) ‚Äî –ì—ñ–¥—Ä–∞–≤–ª—ñ–∫–∞: —Ç–∏—Å–∫/–≤–∏—Ç—Ä–∞—Ç–∞, —Ü–∏–ª—ñ–Ω–¥—Ä–∏, –∫–ª–∞–ø–∞–Ω, —Ä—É–∫–∞–≤–∞, —Ç–µ–ø–ª–æ–Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, ISO 4406</title>
<meta name="color-scheme" content="light dark">
<style>
  :root{
    --bg:#0b1220; --card:#0f172a; --muted:#94a3b8; --text:#e2e8f0;
    --accent:#22c55e; --accent-2:#60a5fa; --warn:#f59e0b; --bad:#ef4444; --good:#10b981; --line:#1f2937;
    --darkcell:#0b1324; --darkink:#e6eef9; --darkink2:#e5e7eb;
  }
  *{box-sizing:border-box}
  body{margin:0;background:linear-gradient(180deg,#0b1220,#111827 30%,#0b1220);color:var(--text);
       font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;line-height:1.55}
  .wrap{max-width:1100px;margin:0 auto;padding:24px 16px 64px}
  .badge{display:inline-block;padding:6px 10px;border:1px solid var(--line);background:#0b1220;border-radius:999px;
         font-size:12px;color:var(--muted);letter-spacing:.3px}
  h1{font-size:34px;margin:6px 0 12px;line-height:1.15;
     background:linear-gradient(90deg,#60a5fa,#22c55e);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
  h2{font-size:22px;margin:28px 0 12px} h3{font-size:18px;margin:20px 0 8px;color:#cbd5e1}
  p{margin:10px 0}.small{font-size:12px;color:#9fb0c8}.muted{color:#93a3b5}.mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Courier New",monospace}
  .btn{display:inline-block;padding:10px 14px;border-radius:10px;border:1px solid #223049;background:#0d1a2e;color:#dbeafe;text-decoration:none;cursor:pointer}
  .btn:hover{background:#0f1f39}
  .grid{display:grid;gap:12px}.g2{grid-template-columns:repeat(2,minmax(0,1fr))}.g3{grid-template-columns:repeat(3,minmax(0,1fr))}
  @media (max-width:1000px){.g2,.g3{grid-template-columns:1fr}}
  .row{display:flex;gap:10px;flex-wrap:wrap}

  .card{background:linear-gradient(180deg,#0f172a,#0b1220);border:1px solid var(--line);border-radius:16px;padding:16px;margin:12px 0;box-shadow:0 6px 24px rgba(0,0,0,.25)}
  .box{border:1px solid #223049;border-radius:12px;padding:12px;background:var(--darkcell);color:var(--darkink)}
  .ok{color:var(--good)} .warn{color:var(--warn)} .bad{color:var(--bad)}

  .table{width:100%;border-collapse:separate;border-spacing:0;overflow:auto;border-radius:12px;border:1px solid #223049}
  .table th,.table td{padding:8px 10px;border-bottom:1px solid #1f2937;font-size:14px;vertical-align:top}
  .table thead th{background:#0c1629;color:#a5b4fc;text-align:left;position:sticky;top:0}
  .table tbody tr:nth-child(even){background:var(--darkcell);color:var(--darkink2)}
  .table td.dark,.table th.dark{background:var(--darkcell)!important;color:var(--darkink2)!important}
  .out{background:var(--darkcell);color:var(--darkink2);border:1px dashed #263042;padding:10px 12px;border-radius:10px;word-break:break-all}

  input[type="text"],input[type="number"],input[type="date"],select,textarea{width:100%;padding:8px 10px;border-radius:10px;border:1px solid #223049;background:#0d1a2e;color:#e6eef9}

  /* –ß–µ–∫ 58 –º–º */
  .ticket{width:58mm;background:#fff;color:#000;padding:6mm 4mm;border-radius:6px;box-shadow:0 0 0 1px #e5e7eb inset;font-family:"Courier New",ui-monospace,monospace}
  .ticket h4{margin:0 0 6px;font-size:13px;text-align:center}.ticket p{margin:2px 0;font-size:12px}.ticket .line{border-top:1px dashed #111;margin:6px 0}
  .ticket small{font-size:10px}

  /* –í–±—É–¥–æ–≤–∞–Ω–æ (iframe) ‚Üí —Å–≤—ñ—Ç–ª–∏–π –≤–∏–≥–ª—è–¥ */
  html.embedded body{background:#fff;color:#111}
  html.embedded .card{background:#fff;border:1px solid #e5e7eb;box-shadow:none}
  html.embedded h1{-webkit-text-fill-color:initial;background:none;color:#111}
  html.embedded .box{background:#f8fafc;color:#111}
  html.embedded .table tbody tr:nth-child(even){background:#f3f4f6;color:#111}

  @media print{@page{margin:4mm}.no-print{display:none!important}}
</style>
</head>
<body>
<div class="wrap">
  <span class="badge">–ü–∞—Ä–∞ 10 ¬∑ –∞—É–¥–∏—Ç–æ—Ä–Ω–æ ¬∑ –º–µ—Ö–∞–Ω—ñ–∫–∏</span>
  <h1>üíß –ì—ñ–¥—Ä–∞–≤–ª—ñ–∫–∞: —Ç–∏—Å–∫/–≤–∏—Ç—Ä–∞—Ç–∞, —Ü–∏–ª—ñ–Ω–¥—Ä–∏, –∫–ª–∞–ø–∞–Ω, —Ä—É–∫–∞–≤–∞, —Ç–µ–ø–ª–æ–Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, ISO 4406</h1>

  <div class="card">
    <h2>üéØ –ú–µ—Ç–∞</h2>
    <p>
      –ó–∞ –ø–∞—Ä—É —Å—Ç—É–¥–µ–Ω—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É—é—Ç—å <b>—Å–∏–ª—É/—à–≤–∏–¥–∫—ñ—Å—Ç—å –≥—ñ–¥—Ä–æ—Ü–∏–ª—ñ–Ω–¥—Ä–∞</b>, <b>–ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å –Ω–∞—Å–æ—Å–∞</b>, –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç—å
      <b>–Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–µ—Ä–µ–ø—É—Å–∫–Ω–æ–≥–æ –∫–ª–∞–ø–∞–Ω–∞</b>, –ø—ñ–¥–±–µ—Ä—É—Ç—å <b>–¥—ñ–∞–º–µ—Ç—Ä —Ä—É–∫–∞–≤–∞</b> –∑–∞ –≥—Ä–∞–Ω–∏—á–Ω–æ—é —à–≤–∏–¥–∫—ñ—Å—Ç—é –ø–æ—Ç–æ–∫—É,
      –æ—Ü—ñ–Ω—è—Ç—å <b>—Ç–µ–ø–ª–æ–Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</b> —Ç–∞ <b>—á–∏—Å—Ç–æ—Ç—É –æ–ª–∏–≤–∏ (ISO 4406)</b>, —Å—Ñ–æ—Ä–º—É—é—Ç—å <b>–∫–≤–∏—Ç–æ–∫ 58 –º–º</b>, <b>NFC</b> —ñ <b>CSV</b>.
    </p>
    <p class="small">–ü–∞–º‚Äô—è—Ç–∫–∞: P(–∫–í—Ç) ‚âà (Q(–ª/—Ö–≤) √ó Œîp(–±–∞—Ä)) / 600; F(N) = p(Pa) √ó A(–º¬≤) √ó Œ∑; v (—Ü–∏–ª—ñ–Ω–¥—Ä) = Q/A; —à–≤–∏–¥–∫—ñ—Å—Ç—å —É —Ä—É–∫–∞–≤—ñ: v = 4Q/(œÄD¬≤), –¥–µ Q ‚Äî –º¬≥/—Å.</p>
  </div>

  <!-- –°–ï–ö–¶–Ü–Ø 1. –ü–ê–†–ê–ú–ï–¢–†–ò –ù–ê–°–û–°–ê/–°–ò–°–¢–ï–ú–ò -->
  <div class="card">
    <h2>‚õΩ –ù–∞—Å–æ—Å —Ç–∞ –∫–æ–Ω—Ç—É—Ä</h2>
    <div class="grid g3">
      <div class="box">
        <h3>–í–∏—Ö—ñ–¥–Ω—ñ</h3>
        <div class="row">
          <div style="flex:1"><label>–í–∏—Ç—Ä–∞—Ç–∞ Q, –ª/—Ö–≤</label><input id="Q" type="number" step="0.1" value="60"></div>
          <div style="flex:1"><label>–†–æ–±–æ—á–∏–π —Ç–∏—Å–∫ p, –±–∞—Ä</label><input id="Pbar" type="number" step="1" value="180"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <div style="flex:1"><label>–ü–µ—Ä–µ–ø–∞–¥ –Ω–∞ –∫–ª–∞–ø–∞–Ω—ñ Œîp, –±–∞—Ä</label><input id="dP" type="number" step="1" value="10"></div>
          <div style="flex:1"><label>–ö–ö–î –∑–∞–≥–∞–ª—å–Ω–∏–π Œ∑</label><input id="eta" type="number" step="0.01" value="0.85"></div>
        </div>
      </div>
      <div class="box">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏</h3>
        <p>–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å –Ω–∞—Å–æ—Å–∞: <b><span id="Pkw">‚Äî</span></b> –∫–í—Ç</p>
        <p>–í—Ç—Ä–∞—Ç–∏ –Ω–∞ –∫–ª–∞–ø–∞–Ω—ñ: <b><span id="Ploss">‚Äî</span></b> –∫–í—Ç</p>
        <p>–û—Ü—ñ–Ω–∫–∞ –Ω–∞–≥—Ä—ñ–≤—É (ŒîT/–≥–æ–¥): <b><span id="dT">‚Äî</span></b> ¬∞C/–≥–æ–¥</p>
      </div>
      <div class="box">
        <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
        <div class="row">
          <button class="btn" onclick="calcPump()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="presetPump()">üß™ –ü—Ä–∏–∫–ª–∞–¥</button>
          <button class="btn" onclick="copyCSV('csvPump')">üìã CSV (–Ω–∞—Å–æ—Å)</button>
        </div>
        <div id="csvPump" class="out" style="margin-top:8px">‚Äî</div>
      </div>
    </div>
    <p class="small muted">ŒîT –æ—Ü—ñ–Ω—é—î–º–æ –∑–∞ —Å–ø—Ä–æ—â–µ–Ω–Ω—è–º: <span class="mono">ŒîT‚âà(P–≤—Ç—Ä–∞—Ç –∫–í—Ç √ó 860) / (–º–∞—Å–ª–æ –ª √ó œÅ(–∫–≥/–ª) √ó c (–∫–∫–∞–ª/–∫–≥¬∑¬∞C))</span>, –±–µ—Ä–µ–º–æ œÅ‚âà0.86, c‚âà0.5 –∫–∫–∞–ª/–∫–≥¬∑¬∞C.</p>
  </div>

  <!-- –°–ï–ö–¶–Ü–Ø 2. –¶–ò–õ–Ü–ù–î–† -->
  <div class="card">
    <h2>üß± –ì—ñ–¥—Ä–æ—Ü–∏–ª—ñ–Ω–¥—Ä: —Å–∏–ª–∞ —Ç–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å</h2>
    <div class="grid g3">
      <div class="box">
        <h3>–ì–µ–æ–º–µ—Ç—Ä—ñ—è</h3>
        <div class="row">
          <div style="flex:1"><label>√ò –≥—ñ–ª—å–∑–∏ D, –º–º</label><input id="cylD" type="number" step="1" value="80"></div>
          <div style="flex:1"><label>√ò —à—Ç–æ–∫–∞ d, –º–º</label><input id="rodD" type="number" step="1" value="45"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <div style="flex:1"><label>–•—ñ–¥ L, –º–º</label><input id="stroke" type="number" step="1" value="500"></div>
          <div style="flex:1"><label>–¢–∏—Å–∫ p, –±–∞—Ä</label><input id="cylP" type="number" step="1" value="180"></div>
        </div>
      </div>
      <div class="box">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏</h3>
        <p>–ü–ª–æ—â–∞ –ø–æ—Ä—à–Ω—è A‚ÇÅ: <b><span id="A1">‚Äî</span></b> –º¬≤ ¬∑ –±–µ–∑ —à—Ç–æ–∫–∞ A‚ÇÇ: <b><span id="A2">‚Äî</span></b> –º¬≤</p>
        <p>–°–∏–ª–∞ ‚Üó (–≤–∏—à—Ç–æ–≤—Ö.): <b><span id="Fext">‚Äî</span></b> –∫–ù ¬∑ –°–∏–ª–∞ ‚Üò (–≤—Ç—è–≥.): <b><span id="Fret">‚Äî</span></b> –∫–ù</p>
        <p>–®–≤–∏–¥–∫. ‚Üó / ‚Üò: <b><span id="Vext">‚Äî</span></b> / <b><span id="Vret">‚Äî</span></b> –º–º/—Å</p>
        <p>–ß–∞—Å —Ö–æ–¥—É ‚Üó / ‚Üò: <b><span id="Text">‚Äî</span></b> / <b><span id="Tret">‚Äî</span></b> —Å</p>
      </div>
      <div class="box">
        <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
        <div class="row">
          <button class="btn" onclick="calcCyl()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="presetCyl()">üß™ –ü—Ä–∏–∫–ª–∞–¥</button>
          <button class="btn" onclick="copyCSV('csvCyl')">üìã CSV (—Ü–∏–ª—ñ–Ω–¥—Ä)</button>
        </div>
        <div id="csvCyl" class="out" style="margin-top:8px">‚Äî</div>
      </div>
    </div>
    <p class="small muted">–°–∏–ª–∏: <span class="mono">Fext = p¬∑A‚ÇÅ¬∑Œ∑</span>, <span class="mono">Fret = p¬∑A‚ÇÇ¬∑Œ∑</span>; —à–≤–∏–¥–∫–æ—Å—Ç—ñ: <span class="mono">v = Q/A</span>, –¥–µ Q ‚Äî –º¬≥/—Å.</p>
  </div>

  <!-- –°–ï–ö–¶–Ü–Ø 3. –ö–õ–ê–ü–ê–ù -->
  <div class="card">
    <h2>üß© –ü–µ—Ä–µ–ø—É—Å–∫–Ω–∏–π –∫–ª–∞–ø–∞–Ω (—Ä–µ–¥—É–∫—Ü—ñ–π–Ω–∏–π) ‚Äî –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è/–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞</h2>
    <div class="grid g3">
      <div class="box">
        <h3>–í–∏—Ö—ñ–¥–Ω—ñ</h3>
        <div class="row">
          <div style="flex:1"><label>–ë–∞–∂–∞–Ω–µ p(–∫–ª–∞–ø.), –±–∞—Ä</label><input id="reliefSet" type="number" step="1" value="190"></div>
          <div style="flex:1"><label>–í–∏–º—ñ—Ä –ø—ñ–¥ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º, –±–∞—Ä</label><input id="reliefMeas" type="number" step="1" value="184"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <div style="flex:1"><label>–î–æ–ø—É—Å–∫, ¬±–±–∞—Ä</label><input id="reliefTol" type="number" step="1" value="10"></div>
          <div style="flex:1"><label>–ü–∞–¥—ñ–Ω–Ω—è –¥–æ –∫–ª–∞–ø–∞–Ω–∞, –±–∞—Ä</label><input id="preDrop" type="number" step="1" value="6"></div>
        </div>
      </div>
      <div class="box">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
        <p>–†–æ–∑—Ä–∞—Ö. –Ω–∞ –∫–ª–∞–ø–∞–Ω—ñ: <b><span id="reliefAt">‚Äî</span></b> –±–∞—Ä</p>
        <p>–°—Ç–∞—Ç—É—Å: <b><span id="reliefFlag">‚Äî</span></b></p>
        <p>–ü–æ—Ä–∞–¥–∞: <b><span id="reliefTip">‚Äî</span></b></p>
      </div>
      <div class="box">
        <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
        <div class="row">
          <button class="btn" onclick="calcRelief()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="copyCSV('csvRelief')">üìã CSV (–∫–ª–∞–ø–∞–Ω)</button>
        </div>
        <div id="csvRelief" class="out" style="margin-top:8px">‚Äî</div>
      </div>
    </div>
  </div>

  <!-- –°–ï–ö–¶–Ü–Ø 4. –†–£–ö–ê–í–ê/–¢–†–£–ë–ò -->
  <div class="card">
    <h2>üßµ –†—É–∫–∞–≤–∞/—Ç—Ä—É–±–∏ ‚Äî —à–≤–∏–¥–∫—ñ—Å—Ç—å –ø–æ—Ç–æ–∫—É —Ç–∞ –¥—ñ–∞–º–µ—Ç—Ä</h2>
    <div class="grid g3">
      <div class="box">
        <h3>–í–∏—Ö—ñ–¥–Ω—ñ</h3>
        <div class="row">
          <div style="flex:1"><label>–í–∏—Ç—Ä–∞—Ç–∞ Q, –ª/—Ö–≤</label><input id="hoseQ" type="number" step="0.1" value="60"></div>
          <div style="flex:1"><label>–í–Ω—É—Ç—Ä. –¥—ñ–∞–º–µ—Ç—Ä D, –º–º</label><input id="hoseD" type="number" step="0.1" value="12"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <div style="flex:1"><label>–ì—Ä–∞–Ω–∏—á–Ω–∞ —à–≤–∏–¥–∫., –º/—Å</label><input id="vLim" type="number" step="0.1" value="5.0"></div>
          <div style="flex:1"><label>–†–µ–∂–∏–º</label>
            <select id="hoseMode">
              <option value="pressure" selected>–ù–∞–ø—ñ—Ä–Ω–∞ –ª—ñ–Ω—ñ—è (—Ä–µ–∫–æ–º–µ–Ω–¥. 3‚Äì5 –º/—Å)</option>
              <option value="return">–ó–ª–∏–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥. 2‚Äì3 –º/—Å)</option>
              <option value="suction">–í—Å–º–æ–∫—Ç. (—Ä–µ–∫–æ–º–µ–Ω–¥. 0.5‚Äì1.5 –º/—Å)</option>
            </select>
          </div>
        </div>
      </div>
      <div class="box">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
        <p>–®–≤–∏–¥–∫—ñ—Å—Ç—å v: <b><span id="hoseV">‚Äî</span></b> –º/—Å</p>
        <p>–°—Ç–∞—Ç—É—Å: <b><span id="hoseFlag">‚Äî</span></b></p>
        <p>–†–µ–∫–æ–º–µ–Ω–¥. D –º—ñ–Ω.: <b><span id="hoseDrec">‚Äî</span></b> –º–º</p>
      </div>
      <div class="box">
        <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
        <div class="row">
          <button class="btn" onclick="calcHose()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="copyCSV('csvHose')">üìã CSV (—Ä—É–∫–∞–≤)</button>
        </div>
        <div id="csvHose" class="out" style="margin-top:8px">‚Äî</div>
      </div>
    </div>
    <p class="small muted">–û—Ä—ñ—î–Ω—Ç–∏—Ä: <span class="mono">–Ω–∞–ø—ñ—Ä 3‚Äì5</span> –º/—Å, <span class="mono">–∑–ª–∏–≤ 2‚Äì3</span> –º/—Å, <span class="mono">–≤—Å–º–æ–∫—Ç. 0.5‚Äì1.5</span> –º/—Å.</p>
  </div>

  <!-- –°–ï–ö–¶–Ü–Ø 5. –ß–ò–°–¢–û–¢–ê –û–õ–ò–í–ò (ISO 4406, –Ω–∞–≤—á–∞–ª—å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞) -->
  <div class="card">
    <h2>üß™ –ß–∏—Å—Ç–æ—Ç–∞ –æ–ª–∏–≤–∏ ‚Äî ISO 4406 (–Ω–∞–≤—á–∞–ª—å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞)</h2>
    <div class="grid g3">
      <div class="box">
        <h3>–õ—ñ—á–∏–ª—å–Ω–∏–∫ —á–∞—Å—Ç–∏–Ω–æ–∫</h3>
        <div class="row">
          <div style="flex:1"><label>‚â•4 Œºm, –∫—ñ–ª—å–∫—ñ—Å—Ç—å/–º–ª</label><input id="c4" type="number" step="1" value="8000"></div>
          <div style="flex:1"><label>‚â•6 Œºm, –∫—ñ–ª—å–∫—ñ—Å—Ç—å/–º–ª</label><input id="c6" type="number" step="1" value="1600"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <div style="flex:1"><label>‚â•14 Œºm, –∫—ñ–ª—å–∫—ñ—Å—Ç—å/–º–ª</label><input id="c14" type="number" step="1" value="200"></div>
          <div style="flex:1"><label>–¶—ñ–ª—å–æ–≤–∏–π –∫–æ–¥ (–Ω–∞–ø—Ä. 18/16/13)</label><input id="isoTarget" type="text" value="18/16/13"></div>
        </div>
      </div>
      <div class="box">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
        <p>–ö–æ–¥ ISO 4406: <b><span id="isoCode">‚Äî</span></b></p>
        <p>–°—Ç–∞—Ç—É—Å: <b><span id="isoFlag">‚Äî</span></b></p>
        <p>–ü–æ—Ä–∞–¥–∞: <b><span id="isoTip">‚Äî</span></b></p>
      </div>
      <div class="box">
        <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
        <div class="row">
          <button class="btn" onclick="calcISO()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="copyCSV('csvISO')">üìã CSV (ISO)</button>
        </div>
        <div id="csvISO" class="out" style="margin-top:8px">‚Äî</div>
      </div>
    </div>
    <p class="small muted">–¢–∞–±–ª–∏—á–Ω–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è: –∫–æ–∂–Ω–µ —á–∏—Å–ª–æ ‚Äî ‚Äú—Å—Ç—É–ø—ñ–Ω—å‚Äù –ø–æ –¥—ñ–∞–ø–∞–∑–æ–Ω—É —á–∞—Å—Ç–∏–Ω–æ–∫/–º–ª (–Ω–∞–±–ª–∏–∂–µ–Ω–æ). –¶–µ <b>–Ω–∞–≤—á–∞–ª—å–Ω–∞</b> –æ—Ü—ñ–Ω–∫–∞, –Ω–µ –∑–∞–º—ñ–Ω—è—î –ª–∞–±–æ—Ä–∞—Ç–æ—Ä—ñ—é.</p>
  </div>

  <!-- –ñ–£–†–ù–ê–õ -->
  <div class="card">
    <h2>üìí –ñ—É—Ä–Ω–∞–ª –≤–∏–º—ñ—Ä—ñ–≤</h2>
    <div class="row">
      <button class="btn" onclick="addRow()">‚ûï –î–æ–¥–∞—Ç–∏ –∑–∞–ø–∏—Å</button>
      <button class="btn" onclick="presetRows()">üß™ –ü—Ä–∏–∫–ª–∞–¥</button>
      <button class="btn" onclick="copyCSV('csvLog')">üìã CSV (–∂—É—Ä–Ω–∞–ª)</button>
    </div>
    <div style="overflow:auto;margin-top:8px">
      <table class="table" id="tbl">
        <thead>
          <tr>
            <th>#</th>
            <th>–£–∑–µ–ª</th>
            <th>Q, –ª/—Ö–≤</th>
            <th>p, –±–∞—Ä</th>
            <th class="dark">P, –∫–í—Ç</th>
            <th class="dark">Œîp, –±–∞—Ä</th>
            <th class="dark">–í—Ç—Ä–∞—Ç–∏, –∫–í—Ç</th>
            <th>–¶–∏–ª. F‚Üó/F‚Üò, –∫–ù</th>
            <th>v —Ä—É–∫–∞–≤–∞, –º/—Å</th>
            <th>ISO</th>
            <th>–ü—Ä–∏–º—ñ—Ç–∫–∞</th>
          </tr>
        </thead>
        <tbody id="body"></tbody>
      </table>
    </div>
    <div id="csvLog" class="out" style="margin-top:8px">‚Äî</div>
  </div>

  <!-- –ö–í–ò–¢–û–ö + NFC -->
  <div class="card">
    <h2>üßæ –ö–≤–∏—Ç–æ–∫ 58 –º–º —Ç–∞ NFC</h2>
    <div class="grid g2">
      <div class="box">
        <h3>NFC ‚Äî ‚ÄúHYDRO CHECK‚Äù</h3>
        <div class="row">
          <div style="flex:1"><label>–ú–∞—à–∏–Ω–∞ ID</label><input id="nfcId" type="text" value="TR-001"></div>
          <div style="flex:1"><label>–ö–æ–Ω—Ç–∞–∫—Ç</label><input id="nfcPhone" type="text" value="+380XXXXXXXXX"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <button class="btn" onclick="buildNFC()">üß© –ó—ñ–±—Ä–∞—Ç–∏</button>
          <button class="btn" onclick="copyEl('nfcOut')">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
        </div>
        <div id="nfcOut" class="out">‚Äî</div>
      </div>

      <div class="box">
        <h3>–ö–≤–∏—Ç–æ–∫ ‚ÄúHYDRO CHECK‚Äù</h3>
        <div class="row">
          <button class="btn" onclick="buildTicket()">üßæ –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="window.print()">üñ®Ô∏è –î—Ä—É–∫</button>
        </div>
        <div class="ticket" id="ticket" style="margin-top:8px">
          <h4>HYDRO CHECK</h4>
          <p id="tDate"><small>–î–∞—Ç–∞: ‚Äî</small></p>
          <div class="line"></div>
          <p><b>Q/p:</b> <span id="tQ">‚Äî</span> –ª/—Ö–≤ / <span id="tP">‚Äî</span> –±–∞—Ä</p>
          <p><b>P –Ω–∞—Å–æ—Å–∞:</b> <span id="tPkW">‚Äî</span> –∫–í—Ç ¬∑ <b>–í—Ç—Ä–∞—Ç–∏:</b> <span id="tPloss">‚Äî</span> –∫–í—Ç</p>
          <p><b>–¶–∏–ª. F‚Üó/F‚Üò:</b> <span id="tFext">‚Äî</span>/<span id="tFret">‚Äî</span> –∫–ù</p>
          <p><b>–†—É–∫–∞–≤ v:</b> <span id="tVhose">‚Äî</span> –º/—Å (–º—ñ–Ω. D: <span id="tDhose">‚Äî</span> –º–º)</p>
          <p><b>–ö–ª–∞–ø–∞–Ω:</b> <span id="tRelief">‚Äî</span> –±–∞—Ä (<span id="tReliefFlag">‚Äî</span>)</p>
          <p><b>ISO:</b> <span id="tISO">‚Äî</span></p>
          <div class="line"></div>
          <p><small id="tNote">–ü—Ä–∏–º.: ‚Äî</small></p>
        </div>
      </div>
    </div>
  </div>

  <!-- –•–Ü–î –†–û–ë–û–¢–ò + –û–¶–Ü–ù–Æ–í–ê–ù–ù–Ø -->
  <div class="card">
    <h2>ü™ú –•—ñ–¥ —Ä–æ–±–æ—Ç–∏ (45‚Äì70 —Ö–≤)</h2>
    <ol>
      <li>–í–Ω–µ—Å–∏ <b>Q, p</b> —Å–∏—Å—Ç–µ–º–∏ ‚Äî –æ—Ü—ñ–Ω–∏ <b>–ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å</b>, <b>–≤—Ç—Ä–∞—Ç–∏</b>, <b>–Ω–∞–≥—Ä—ñ–≤</b>.</li>
      <li>–ó–∞–¥–∞–π –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ <b>—Ü–∏–ª—ñ–Ω–¥—Ä–∞</b> ‚Äî –æ—Ç—Ä–∏–º–∞–π <b>—Å–∏–ª—É</b>, <b>—à–≤–∏–¥–∫—ñ—Å—Ç—å</b> —ñ <b>—á–∞—Å —Ö–æ–¥—É</b>.</li>
      <li>–ü–µ—Ä–µ–≤—ñ—Ä <b>–ø–µ—Ä–µ–ø—É—Å–∫–Ω–∏–π –∫–ª–∞–ø–∞–Ω</b> –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –ø–∞–¥—ñ–Ω–Ω—è –¥–æ –Ω—å–æ–≥–æ.</li>
      <li>–ü—ñ–¥—ñ–±–µ—Ä–∏ <b>—Ä—É–∫–∞–≤/—Ç—Ä—É–±—É</b> –∑–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—é –ø–æ—Ç–æ–∫—É.</li>
      <li>–û—Ü—ñ–Ω–∏ <b>ISO 4406</b> —ñ –∑—Ä–æ–±–∏ –≤–∏—Å–Ω–æ–≤–æ–∫ –ø—Ä–æ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é/–æ–±—Å–ª—É–≥–æ–≤—É–≤–∞–Ω–Ω—è.</li>
      <li>–ó–≥–µ–Ω–µ—Ä—É–π <b>–∫–≤–∏—Ç–æ–∫</b>, <b>NFC</b> —Ç–∞ <b>CSV</b> –¥–ª—è –∑–≤—ñ—Ç—É (<span class="mono">Hydraulics</span>).</li>
    </ol>
  </div>

  <div class="card">
    <h2>‚úÖ –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è (10 –±–∞–ª—ñ–≤)</h2>
    <table class="table">
      <thead><tr><th>–ö—Ä–∏—Ç–µ—Ä—ñ–π</th><th>–ë–∞–ª–∏</th></tr></thead>
      <tbody>
        <tr><td>–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å/–≤—Ç—Ä–∞—Ç–∏/–Ω–∞–≥—Ä—ñ–≤ —Ä–æ–∑—Ä–∞—Ö–æ–≤–∞–Ω–æ –≤—ñ—Ä–Ω–æ</td><td>3</td></tr>
        <tr><td>–¶–∏–ª—ñ–Ω–¥—Ä: —Å–∏–ª–∞/—à–≤–∏–¥–∫—ñ—Å—Ç—å/—á–∞—Å ‚Äî –∫–æ—Ä–µ–∫—Ç–Ω–æ</td><td>3</td></tr>
        <tr><td>–ö–ª–∞–ø–∞–Ω —ñ —Ä—É–∫–∞–≤ ‚Äî –∞–¥–µ–∫–≤–∞—Ç–Ω—ñ –≤–∏—Å–Ω–æ–≤–∫–∏</td><td>3</td></tr>
        <tr><td>–ö–≤–∏—Ç–æ–∫/NFC + CSV</td><td>1</td></tr>
      </tbody>
    </table>
  </div>
</div>

<script>
  // –í–±—É–¥–æ–≤–∞–Ω–∏–π —Ä–µ–∂–∏–º (Moodle iFrame)
  (function(){ if (window.self !== window.top) document.documentElement.classList.add('embedded'); })();

  const byId = id => document.getElementById(id);
  const rnd = (n,d=2)=>Number((+n).toFixed(d));
  const bodyEl = document.getElementById('body');

  // ====== 1) –ù–∞—Å–æ—Å/–∫–æ–Ω—Ç—É—Ä ======
  function calcPump(){
    const Q = +byId('Q').value||0;          // –ª/—Ö–≤
    const Pbar = +byId('Pbar').value||0;    // –±–∞—Ä
    const dP = +byId('dP').value||0;        // –±–∞—Ä (–Ω–∞ –∫–ª–∞–ø–∞–Ω—ñ)
    const eta = +byId('eta').value||1;

    const PkW = (Q * Pbar) / 600;           // –∫–í—Ç (‚âà Q*l/min * bar / 600)
    const Ploss = (Q * dP) / 600;           // –∫–í—Ç
    // –û—Ü—ñ–Ω–∫–∞ –Ω–∞–≥—Ä—ñ–≤—É –Ω–∞ 100 –ª –º–∞—Å–ª–∞ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –±–∞–∫ —É–º–æ–≤–Ω–æ)
    const oilL = 100, rho=0.86, c=0.5;      // –∫–≥/–ª, –∫–∫–∞–ª/–∫–≥¬∞C
    const dT = (Ploss * 860) / (oilL * rho * c); // ¬∞C/–≥–æ–¥

    byId('Pkw').textContent = rnd(PkW,2);
    byId('Ploss').textContent = rnd(Ploss,2);
    byId('dT').textContent = rnd(dT,1);

    const csv = [
      `PUMP|Q=${Q} lpm|p=${Pbar} bar|eta=${eta}`,
      `POWER|P=${rnd(PkW,2)} kW|Loss=${rnd(Ploss,2)} kW|Heat=${rnd(dT,1)} Cph`
    ].join('\n');
    byId('csvPump').textContent = csv;

    return {Q,Pbar,dP,eta,PkW,Ploss,dT};
  }
  function presetPump(){
    byId('Q').value=75; byId('Pbar').value=190; byId('dP').value=8; byId('eta').value=0.88;
    calcPump();
  }

  // ====== 2) –¶–∏–ª—ñ–Ω–¥—Ä ======
  function calcCyl(){
    const Dmm = +byId('cylD').value||0;
    const dmm = +byId('rodD').value||0;
    const Lmm = +byId('stroke').value||0;
    const pBar = +byId('cylP').value||0;
    const Qlpm = +byId('Q').value||0; // –±–µ—Ä–µ–º–æ –∑–∞–≥–∞–ª—å–Ω—É –≤–∏—Ç—Ä–∞—Ç—É, —è–∫ –Ω–∞ —Å–µ–∫—Ü—ñ—é

    const D = Dmm/1000, d = dmm/1000; // –º
    const A1 = Math.PI*(D**2)/4;                  // –º¬≤ (–≤–∏—à—Ç–æ–≤—Ö)
    const A2 = Math.PI*(D**2 - d**2)/4;           // –º¬≤ (–≤—Ç—è–≥)
    const pPa = pBar * 1e5;                       // –ü–∞ (1 –±–∞—Ä ‚âà 1e5 –ü–∞)
    const eta = 0.9;

    const Fext = pPa*A1*eta/1000;                 // –∫–ù
    const Fret = pPa*A2*eta/1000;                 // –∫–ù

    const Qm3s = Qlpm/1000/60;                    // –º¬≥/—Å
    const Vext = (A1>0)? (Qm3s/A1)*1000 : 0;      // –º–º/—Å
    const Vret = (A2>0)? (Qm3s/A2)*1000 : 0;      // –º–º/—Å
    const Text = (Lmm>0 && Vext>0)? Lmm/Vext : 0; // —Å
    const Tret = (Lmm>0 && Vret>0)? Lmm/Vret : 0; // —Å

    byId('A1').textContent = rnd(A1,5);
    byId('A2').textContent = rnd(A2,5);
    byId('Fext').textContent = rnd(Fext,1);
    byId('Fret').textContent = rnd(Fret,1);
    byId('Vext').textContent = rnd(Vext,1);
    byId('Vret').textContent = rnd(Vret,1);
    byId('Text').textContent = rnd(Text,1);
    byId('Tret').textContent = rnd(Tret,1);

    const csv = [
      `CYL|D=${Dmm}mm|d=${dmm}mm|L=${Lmm}mm|p=${pBar}bar|Q=${Qlpm}lpm`,
      `AREA|A1=${rnd(A1,5)} m2|A2=${rnd(A2,5)} m2`,
      `FORCE|Fext=${rnd(Fext,1)} kN|Fret=${rnd(Fret,1)} kN`,
      `SPEED|Vext=${rnd(Vext,1)} mmps|Vret=${rnd(Vret,1)} mmps|Text=${rnd(Text,1)} s|Tret=${rnd(Tret,1)} s`
    ].join('\n');
    byId('csvCyl').textContent = csv;

    return {A1,A2,Fext,Fret,Vext,Vret,Text,Tret,Qlpm,pBar,Dmm,dmm,Lmm};
  }
  function presetCyl(){
    byId('cylD').value=90; byId('rodD').value=50; byId('stroke').value=600; byId('cylP').value=185;
    calcCyl();
  }

  // ====== 3) –ö–ª–∞–ø–∞–Ω ======
  function calcRelief(){
    const set = +byId('reliefSet').value||0;
    const meas = +byId('reliefMeas').value||0;
    const tol = +byId('reliefTol').value||0;
    const pre = +byId('preDrop').value||0;

    const atValve = meas + pre;
    let flag='‚Äî', tip='‚Äî', color='#10b981';
    if(Math.abs(atValve - set) <= tol){ flag='üü¢ –≤ –º–µ–∂–∞—Ö –¥–æ–ø—É—Å–∫—É'; tip='–∑–∞–ª–∏—à–∏—Ç–∏ –∞–±–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—ñ—Å–ª—è —Ä–æ–∑—ñ–≥—Ä—ñ–≤—É'; }
    else if(atValve < set - tol){ flag='üî¥ –∑–∞–Ω–∏–∑—å–∫–µ'; tip='–ø—ñ–¥–∫—Ä—É—Ç–∏—Ç–∏ –ø—Ä—É–∂–∏–Ω—É/–ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–∞—Ç—ñ–∫–∞–Ω–Ω—è, –∑–Ω–æ—Å —Å—ñ–¥–ª–∞'; color='#ef4444'; }
    else { flag='üî¥ –∑–∞–≤–∏—Å–æ–∫–µ'; tip='–∑–º–µ–Ω—à–∏—Ç–∏ –Ω–∞—Ç—è–≥ –ø—Ä—É–∂–∏–Ω–∏; —Ä–∏–∑–∏–∫ –ø–µ—Ä–µ–≥—Ä—ñ–≤—É/–ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è'; color='#ef4444'; }

    byId('reliefAt').textContent = rnd(atValve,0);
    byId('reliefFlag').textContent = flag; byId('reliefFlag').style.color = color;
    byId('reliefTip').textContent = tip;

    const csv = `RELIEF|Set=${set}bar|Meas=${meas}bar|PreDrop=${pre}bar|AtValve=${rnd(atValve,0)}bar|Flag=${flag}`;
    byId('csvRelief').textContent = csv;

    return {set,meas,pre,atValve,flag};
  }

  // ====== 4) –†—É–∫–∞–≤ ======
  function calcHose(){
    const Qlpm = +byId('hoseQ').value||0;
    const Dmm  = +byId('hoseD').value||0;
    const vLim = +byId('vLim').value||0;
    const mode = byId('hoseMode').value;

    const Qm3s = Qlpm/1000/60;
    const Dm = Dmm/1000;
    const v = (Dm>0)? (4*Qm3s)/(Math.PI*Dm*Dm) : 0;

    // –º–µ–∂—ñ –∑–∞ —Ä–µ–∂–∏–º–æ–º
    const ranges = { pressure:[3,5], return:[2,3], suction:[0.5,1.5] };
    const [vMin,vMax] = ranges[mode];
    let flag='‚Äî', color='#10b981';
    if(v>vMax) { flag='üî¥ –∑–∞–≤–µ–ª–∏–∫–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å (—à—É–º/–≤—Ç—Ä–∞—Ç–∏)'; color='#ef4444'; }
    else if(v<vMin) { flag='üü† –∑–∞–Ω–∏–∑—å–∫–∞ (–∑–∞–π–≤–∏–π –¥—ñ–∞–º–µ—Ç—Ä/–≤–∞—Ä—Ç—ñ—Å—Ç—å)'; color='#f59e0b'; }
    else { flag='üü¢ –≤ –Ω–æ—Ä–º—ñ'; }

    // –ü—ñ–¥–±—ñ—Ä –º—ñ–Ω. D –ø—Ä–∏ –∑–∞–¥–∞–Ω–æ–º—É –ª—ñ–º—ñ—Ç—ñ
    const Drec_m = Math.sqrt(4*Qm3s/(Math.PI*vLim));
    const Drec_mm = Drec_m*1000;

    byId('hoseV').textContent = rnd(v,2);
    byId('hoseFlag').textContent = flag; byId('hoseFlag').style.color = color;
    byId('hoseDrec').textContent = rnd(Drec_mm,1);

    const csv = `HOSE|Q=${Qlpm}lpm|D=${Dmm}mm|v=${rnd(v,2)}mps|mode=${mode}|Drec>=${rnd(Drec_mm,1)}mm|Flag=${flag}`;
    byId('csvHose').textContent = csv;

    return {Qlpm,Dmm,v,vLim,mode,Drec_mm,flag};
  }

  // ====== 5) ISO 4406 (–Ω–∞–≤—á–∞–ª—å–Ω–∞ –∞–ø—Ä–æ–∫—Å–∏–º–∞—Ü—ñ—è) ======
  function isoClassFromCount(c){
    // –°–ø—Ä–æ—â–µ–Ω—ñ –ø–æ—Ä–æ–≥–∏ (–±–ª–∏–∑—å–∫–æ –¥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É): –ø–æ–≤–µ—Ä—Ç–∞—î –∫–æ–¥ 6..24
    const limits = [
      {code:24, min:8000000},
      {code:23, min:4000000},
      {code:22, min:2000000},
      {code:21, min:1000000},
      {code:20, min:500000},
      {code:19, min:250000},
      {code:18, min:130000},
      {code:17, min:64000},
      {code:16, min:32000},
      {code:15, min:16000},
      {code:14, min:8000},
      {code:13, min:4000},
      {code:12, min:2000},
      {code:11, min:1000},
      {code:10, min:500},
      {code:9,  min:250},
      {code:8,  min:130},
      {code:7,  min:64},
      {code:6,  min:32}
    ];
    for(const r of limits){ if(c>=r.min) return r.code; }
    return 5;
  }
  function calcISO(){
    const n4 = +byId('c4').value||0;
    const n6 = +byId('c6').value||0;
    const n14= +byId('c14').value||0;
    const tStr = byId('isoTarget').value.trim();
    const t = tStr.match(/^(\d{1,2})\/(\d{1,2})\/(\d{1,2})$/);

    const c1 = isoClassFromCount(n4);
    const c2 = isoClassFromCount(n6);
    const c3 = isoClassFromCount(n14);
    const code = `${c1}/${c2}/${c3}`;

    let flag='‚Äî', tip='‚Äî', color='#10b981';
    if(t){
      const [_,a,b,c]=t.map(x=>+x||0);
      if(c1>a || c2>b || c3>c){ flag='üî¥ –≥—ñ—Ä—à–µ —Ü—ñ–ª—ñ'; tip='–ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏, –≥–µ—Ä–º–µ—Ç–∏—á–Ω—ñ—Å—Ç—å, —Ç–æ—á–∫—É –≤—ñ–¥–±–æ—Ä—É'; color='#ef4444'; }
      else if(c1===a && c2===b && c3===c){ flag='üü† –Ω–∞ –º–µ–∂—ñ'; tip='—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –∑–∞–º—ñ–Ω–∞ —Ñ—ñ–ª—å—Ç—Ä—ñ–≤ –∑–∞ –≥—Ä–∞—Ñ—ñ–∫–æ–º'; color='#f59e0b'; }
      else { flag='üü¢ –∫—Ä–∞—â–µ —Ü—ñ–ª—ñ'; tip='–æ–∫'; }
    }else{
      flag='üü¢ –æ—Ü—ñ–Ω–µ–Ω–æ'; tip='–≤–∫–∞–∂–∏ —Ü—ñ–ª—å–æ–≤–∏–π –∫–æ–¥ –¥–ª—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è';
    }

    byId('isoCode').textContent = code;
    byId('isoFlag').textContent = flag; byId('isoFlag').style.color = color;
    byId('isoTip').textContent = tip;

    const csv = `ISO4406|>=4um=${n4}/ml|>=6um=${n6}/ml|>=14um=${n14}/ml|Code=${code}|Target=${tStr||'-'}|Flag=${flag}`;
    byId('csvISO').textContent = csv;

    return {code,flag};
  }

  // ====== –ñ—É—Ä–Ω–∞–ª ======
  function addRow(sample){
    const p = calcPump(); const c = calcCyl(); const h = calcHose(); const iso = calcISO();
    const def = { node:'–ì—ñ–¥—Ä–æ—Ä–æ–∑–ø–æ–¥—ñ–ª—å–Ω–∏–∫ 1', Q:p.Q, P:p.Pbar, dP:p.dP, PkW:p.PkW, Ploss:p.Ploss,
                  Fext:c.Fext, Fret:c.Fret, vhose:h.v, iso:iso.code, note:'' };
    const s = Object.assign({}, def, sample||{});
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td class="idx">1</td>
      <td><input type="text" value="${s.node}"></td>
      <td><input type="number" step="0.1" value="${rnd(s.Q,1)}"></td>
      <td><input type="number" step="1" value="${rnd(s.P,0)}"></td>
      <td class="dark pkW">${rnd(s.PkW,2)}</td>
      <td class="dark dp">${rnd(s.dP,0)}</td>
      <td class="dark loss">${rnd(s.Ploss,2)}</td>
      <td class="force">${rnd(s.Fext,1)}/${rnd(s.Fret,1)}</td>
      <td class="vhose">${rnd(s.vhose,2)}</td>
      <td class="iso">${s.iso}</td>
      <td><input type="text" value="${s.note}"></td>
    `;
    bodyEl.appendChild(tr); reindex(); buildCSVlog();
  }
  function reindex(){ [...bodyEl.querySelectorAll('tr')].forEach((tr,i)=>tr.querySelector('.idx').textContent=i+1); }
  function presetRows(){
    bodyEl.innerHTML='';
    addRow({node:'–°–µ–∫—Ü—ñ—è –ø—ñ–¥–π–æ–º—É', Q:62, P:175, dP:7, PkW:(62*175/600), Ploss:(62*7/600), Fext:95, Fret:78, vhose:4.6, iso:'18/16/13', note:'–Ω–æ—Ä–º–∞'});
    addRow({node:'–°–µ–∫—Ü—ñ—è –≥—ñ–¥—Ä–æ–≤–∏–≤–æ–¥—É', Q:40, P:160, dP:10, PkW:(40*160/600), Ploss:(40*10/600), Fext:75, Fret:61, vhose:3.1, iso:'19/17/14', note:'—Ñ—ñ–ª—å—Ç—Ä –∑–∞–±—Ä—É–¥–Ω.'});
    addRow({node:'–†—É–ª—å–æ–≤–µ', Q:18, P:110, dP:4, PkW:(18*110/600), Ploss:(18*4/600),  Fext:50, Fret:40, vhose:2.0, iso:'17/15/12', note:'–æ–∫'});
    buildCSVlog();
  }
  function buildCSVlog(){
    const lines = [...bodyEl.querySelectorAll('tr')].map(tr=>{
      const idx=tr.querySelector('.idx').textContent.trim();
      const node=tr.children[1].querySelector('input').value.trim();
      const Q  =tr.children[2].querySelector('input').value.trim();
      const P  =tr.children[3].querySelector('input').value.trim();
      const PkW=tr.querySelector('.pkW').textContent.trim();
      const dP =tr.querySelector('.dp').textContent.trim();
      const loss=tr.querySelector('.loss').textContent.trim();
      const F  =tr.querySelector('.force').textContent.trim();
      const v  =tr.querySelector('.vhose').textContent.trim();
      const iso=tr.querySelector('.iso').textContent.trim();
      const note=tr.children[10].querySelector('input').value.trim();
      return [idx,node,Q,P,PkW,dP,loss,F,v,iso,note].join(' | ');
    });
    byId('csvLog').textContent = lines.join('\n') || '‚Äî';
  }

  // ====== –ö–≤–∏—Ç–æ–∫ / NFC ======
  function buildTicket(){
    const p = calcPump(); const c = calcCyl(); const h = calcHose(); const r = calcRelief(); const iso = calcISO();
    const d = new Date().toISOString().slice(0,10);
    byId('tDate').innerHTML = `<small>–î–∞—Ç–∞: ${d}</small>`;
    byId('tQ').textContent = rnd(p.Q,1);
    byId('tP').textContent = rnd(p.Pbar,0);
    byId('tPkW').textContent = rnd(p.PkW,2);
    byId('tPloss').textContent = rnd(p.Ploss,2);
    byId('tFext').textContent = rnd(c.Fext,1);
    byId('tFret').textContent = rnd(c.Fret,1);
    byId('tVhose').textContent = rnd(h.v,2);
    byId('tDhose').textContent = rnd(h.Drec_mm,1);
    byId('tRelief').textContent = byId('reliefAt').textContent || '‚Äî';
    byId('tReliefFlag').textContent = byId('reliefFlag').textContent || '‚Äî';
    byId('tISO').textContent = iso.code;
    byId('tNote').textContent = `Mode:${byId('hoseMode').value}; vLim=${byId('vLim').value}–º/—Å; –¶—ñ–ª—å ISO: ${byId('isoTarget').value}`;
  }
  function buildNFC(){
    const p = calcPump(); const c = calcCyl(); const h = calcHose(); const r = calcRelief(); const iso = calcISO();
    const text = [
      `HYDRO_NFC`,
      `MACHINE:${byId('nfcId').value}`,
      `CONTACT:${byId('nfcPhone').value}`,
      `Q:${rnd(p.Q,1)} lpm; p:${rnd(p.Pbar,0)} bar; P:${rnd(p.PkW,2)} kW; Loss:${rnd(p.Ploss,2)} kW`,
      `CYL:Fext=${rnd(c.Fext,1)}kN/Fret=${rnd(c.Fret,1)}kN; Vhose=${rnd(h.v,2)}mps; Drec>=${rnd(h.Drec_mm,1)}mm`,
      `RELIEF:${byId('reliefAt').textContent} bar (${byId('reliefFlag').textContent})`,
      `ISO:${iso.code}`,
      `STAMP:${new Date().toISOString().slice(0,19).replace('T',' ')}`
    ].join('\n');
    byId('nfcOut').textContent = text;
  }

  // ====== –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è ======
  function copyCSV(id){
    const t = document.getElementById(id).textContent.trim();
    if(!t||t==='‚Äî'){ alert('–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è'); return; }
    navigator.clipboard.writeText(t).then(()=>flash('‚úÖ CSV —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'),()=>flash('–ù–µ –≤–¥–∞–ª–æ—Å—è'));
  }
  function copyEl(id){
    const t = byId(id).textContent.trim();
    if(!t||t==='‚Äî'){ alert('–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö'); return; }
    navigator.clipboard.writeText(t).then(()=>flash('‚úÖ –°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'),()=>flash('–ù–µ –≤–¥–∞–ª–æ—Å—è'));
  }
  function flash(msg){ const o=document.title; document.title=msg; setTimeout(()=>document.title=o,900); }

  // ====== –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è ======
  (function init(){
    // —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
    calcPump(); calcCyl(); calcRelief(); calcHose(); calcISO();
    // —Å–ª—É—Ö–∞—á—ñ
    document.addEventListener('change', e=>{
      if(e.target.matches('input,select')) { calcPump(); calcCyl(); calcRelief(); calcHose(); calcISO(); }
    });
  })();
</script>
</body>
</html>
