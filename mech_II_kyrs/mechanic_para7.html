<!-- mechanic_para7.html
     –ü–ê–†–ê 7 (–∞—É–¥–∏—Ç–æ—Ä–Ω–æ) –¥–ª—è –º–µ—Ö–∞–Ω—ñ–∫—ñ–≤
     –¢–µ–º–∞: –¢–Ø–ì–ê, –ë–£–ö–°–£–í–ê–ù–ù–Ø, –ë–ê–õ–ê–°–¢, –¢–ò–°–ö –£ –®–ò–ù–ê–• ‚Äî —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —Ç—è–≥–∏, –ø–æ—Ç—É–∂–Ω–æ—Å—Ç—ñ –Ω–∞ –¥–∏—à–ª—ñ, –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∑—á–µ–ø–ª–µ–Ω–Ω—è, —Ü—ñ–ª—å–æ–≤–∏–π –±—É–∫—Å, —Ä–æ–∑–ø–æ–¥—ñ–ª –±–∞–ª–∞—Å—Ç—É,
           —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —Ç–∏—Å–∫—É –≤ —à–∏–Ω–∞—Ö, –∂—É—Ä–Ω–∞–ª –≤–∏–º—ñ—Ä—ñ–≤ (GPS/—Ö—Ä–æ–Ω–æ–º–µ—Ç—Ä), —á–µ–∫ 58 –º–º, NFC, CSV
     –§–æ–∫—É—Å: —Ç–µ–ª–µ—Ñ–æ–Ω–∏/–ü–ö; –±–µ–∑ –±—ñ–±–ª—ñ–æ—Ç–µ–∫; –ø—Ä–∞—Ü—é—î –Ω–∞ GitHub Pages —ñ –≤ Moodle (iframe).
     –ü—Ä–∏–º—ñ—Ç–∫–∞ —â–æ–¥–æ –∫–æ–Ω—Ç—Ä–∞—Å—Ç—É: —Ç–µ–º–Ω—ñ –∫–ª—ñ—Ç–∏–Ω–∫–∏ —Ç–∞–±–ª–∏—Ü—å –º–∞—é—Ç—å —Å–≤—ñ—Ç–ª–∏–π —Ç–µ–∫—Å—Ç (.dark).
-->
<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>–ü–∞—Ä–∞ 7 (–º–µ—Ö–∞–Ω—ñ–∫–∏) ‚Äî –¢—è–≥–∞, –±—É–∫—Å—É–≤–∞–Ω–Ω—è, –±–∞–ª–∞—Å—Ç, —Ç–∏—Å–∫ —É —à–∏–Ω–∞—Ö, —á–µ–∫ 58 –º–º, NFC, CSV</title>
<meta name="color-scheme" content="light dark">
<style>
  :root{
    --bg:#0b1220; --card:#0f172a; --muted:#94a3b8; --text:#e2e8f0;
    --accent:#22c55e; --accent-2:#60a5fa; --warn:#f59e0b; --bad:#ef4444; --good:#10b981; --line:#1f2937;
    --darkcell:#0b1324; --darkink:#e6eef9; --darkink2:#e5e7eb;
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:linear-gradient(180deg,#0b1220,#111827 30%,#0b1220);
    color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif; line-height:1.55
  }
  .wrap{max-width:1100px; margin:0 auto; padding:24px 16px 64px}
  .badge{display:inline-block; padding:6px 10px; border:1px solid var(--line); background:#0b1220; border-radius:999px; font-size:12px; color:var(--muted); letter-spacing:.3px}
  h1{font-size:34px; margin:6px 0 12px; line-height:1.15;
     background:linear-gradient(90deg,#60a5fa,#22c55e); -webkit-background-clip:text; -webkit-text-fill-color:transparent}
  h2{font-size:22px; margin:28px 0 12px}
  h3{font-size:18px; margin:20px 0 8px; color:#cbd5e1}
  p{margin:10px 0}
  .small{font-size:12px; color:#9fb0c8}
  .muted{color:#93a3b5}
  .btn{display:inline-block; padding:10px 14px; border-radius:10px; border:1px solid #223049; background:#0d1a2e; color:#dbeafe; text-decoration:none; cursor:pointer}
  .btn:hover{background:#0f1f39}
  .row{display:flex; gap:10px; flex-wrap:wrap}
  .grid{display:grid; gap:12px}
  .g2{grid-template-columns:repeat(2,minmax(0,1fr))}
  .g3{grid-template-columns:repeat(3,minmax(0,1fr))}
  @media (max-width:1000px){.g2,.g3{grid-template-columns:1fr}}

  .card{background:linear-gradient(180deg,#0f172a,#0b1220); border:1px solid var(--line); border-radius:16px; padding:16px; margin:12px 0; box-shadow:0 6px 24px rgba(0,0,0,.25)}
  .box{border:1px solid #223049; border-radius:12px; padding:12px; background:var(--darkcell); color:var(--darkink)}
  .ok{color:var(--good)} .warn{color:var(--warn)} .bad{color:var(--bad)}
  .mono,code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}

  .table{width:100%; border-collapse:separate; border-spacing:0; overflow:auto; border-radius:12px; border:1px solid #223049}
  .table th,.table td{padding:8px 10px; border-bottom:1px solid #1f2937; font-size:14px; vertical-align:top}
  .table thead th{background:#0c1629; color:#a5b4fc; text-align:left; position:sticky; top:0}
  .table tbody tr:nth-child(even){background:var(--darkcell); color:var(--darkink2)}
  .table td.dark, .table th.dark{background:var(--darkcell) !important; color:var(--darkink2) !important}
  .out{background:var(--darkcell); color:var(--darkink2); border:1px dashed #263042; padding:10px 12px; border-radius:10px; word-break:break-all}

  input[type="text"], input[type="number"], input[type="date"], select, textarea{
    width:100%; padding:8px 10px; border-radius:10px; border:1px solid #223049; background:#0d1a2e; color:#e6eef9
  }

  /* –ß–µ–∫ 58 –º–º */
  .ticket{ width:58mm; background:#fff; color:#000; padding:6mm 4mm; border-radius:6px; box-shadow:0 0 0 1px #e5e7eb inset; font-family:"Courier New",ui-monospace,monospace}
  .ticket h4{margin:0 0 6px; font-size:13px; text-align:center}
  .ticket p{margin:2px 0; font-size:12px}
  .ticket .line{border-top:1px dashed #111; margin:6px 0}
  .ticket small{font-size:10px}

  /* –í–±—É–¥–æ–≤–∞–Ω–æ (iframe) ‚Üí —Å–≤—ñ—Ç–ª–∏–π –≤–∏–≥–ª—è–¥ */
  html.embedded body{background:#fff; color:#111}
  html.embedded .card{background:#fff; border:1px solid #e5e7eb; box-shadow:none}
  html.embedded h1{-webkit-text-fill-color:initial; background:none; color:#111}
  html.embedded .box{background:#f8fafc; color:#111}
  html.embedded .table tbody tr:nth-child(even){background:#f3f4f6; color:#111}

  @media print{
    @page{ margin:4mm }
    .no-print{ display:none !important }
  }
</style>
</head>
<body>
  <div class="wrap">
    <span class="badge">–ü–∞—Ä–∞ 7 ¬∑ –∞—É–¥–∏—Ç–æ—Ä–Ω–æ ¬∑ –º–µ—Ö–∞–Ω—ñ–∫–∏</span>
    <h1>üöú –¢—è–≥–∞, –±—É–∫—Å—É–≤–∞–Ω–Ω—è, –±–∞–ª–∞—Å—Ç —ñ —Ç–∏—Å–∫ —É —à–∏–Ω–∞—Ö ‚Äî —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏, –∂—É—Ä–Ω–∞–ª –≤–∏–º—ñ—Ä—ñ–≤, —á–µ–∫ 58 –º–º, NFC</h1>

    <div class="card">
      <h2>üéØ –ú–µ—Ç–∞</h2>
      <p>
        –ó–∞ –ø–∞—Ä—É —Å—Ç—É–¥–µ–Ω—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É—é—Ç—å <b>–ø–æ—Ç—Ä—ñ–±–Ω—É —Ç—è–≥—É</b> —ñ <b>–ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å –Ω–∞ –¥–∏—à–ª—ñ</b>, –æ—Ü—ñ–Ω—è—Ç—å <b>–æ–±–º–µ–∂–µ–Ω–Ω—è –∑–∞ –∑—á–µ–ø–ª–µ–Ω–Ω—è–º</b>,
        –ø—ñ–¥–±–µ—Ä—É—Ç—å <b>–±–∞–ª–∞—Å—Ç —ñ —Ä–æ–∑–ø–æ–¥—ñ–ª –ø–æ –æ—Å—è—Ö</b>, –≤–∏–∑–Ω–∞—á–∞—Ç—å <b>—Ü—ñ–ª—å–æ–≤–∏–π –±—É–∫—Å (8‚Äì15%)</b> —ñ <b>—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π —Ç–∏—Å–∫ —É —à–∏–Ω–∞—Ö</b>,
        –∑–±–µ—Ä—É—Ç—å <b>–∂—É—Ä–Ω–∞–ª –≤–∏–º—ñ—Ä—ñ–≤</b> (—Ç–µ–æ—Ä. vs —Ñ–∞–∫—Ç. —à–≤–∏–¥–∫—ñ—Å—Ç—å), –∑–≥–µ–Ω–µ—Ä—É—é—Ç—å <b>–∫–≤–∏—Ç–æ–∫ 58 –º–º</b>, <b>NFC</b>-—Ç–µ–∫—Å—Ç —ñ <b>CSV</b>.
      </p>
      <p class="small">–ü–∞–º‚Äô—è—Ç–∫–∞: –¥–ª—è MFWD (–ø–µ—Ä–µ–¥–Ω—ñ–π –ø—Ä–∏–≤—ñ–¥ –ø—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è) –±–∞–∂–∞–Ω–∏–π —Å—Ç–∞—Ç–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª –º–∞—Å–∏ <span class="mono">35‚Äì40% –ø–µ—Ä–µ–¥ / 60‚Äì65% –∑–∞–¥</span> (–±–µ–∑ –∑–Ω–∞—Ä—è–¥–¥—è),
        —Ü—ñ–ª—å–æ–≤–∏–π –±—É–∫—Å —É –ø–æ–ª—ñ <span class="mono">8‚Äì15%</span> (–¥–æ 20% –Ω–∞ –≤–∞–∂–∫–∏—Ö —Ä–æ–±–æ—Ç–∞—Ö), –∫–æ–µ—Ñ. –∑—á–µ–ø–ª–µ–Ω–Ω—è “ë—Ä—É–Ω—Ç/—à–∏–Ω–∏ <span class="mono">0.4‚Ä¶0.6</span> (—É–º–æ–≤–Ω–æ).</p>
    </div>

    <!-- –í–•–Ü–î–ù–Ü –î–ê–ù–Ü –¢–†–ê–ö–¢–û–†–ê / –ó–ù–ê–†–Ø–î–î–Ø -->
    <div class="card">
      <h2>‚öôÔ∏è –¢—Ä–∞–∫—Ç–æ—Ä —Ç–∞ –∑–∞–≤–¥–∞–Ω–Ω—è</h2>
      <div class="grid g3">
        <div class="box">
          <h3>–ú–∞—Å–∞ —Ç–∞ –æ—Å—ñ</h3>
          <div class="row">
            <div style="flex:1"><label>–ú–∞—Å–∞ —Ç—Ä–∞–∫—Ç–æ—Ä–∞, —Ç</label><input id="massT" type="number" step="0.01" value="6.5"></div>
            <div style="flex:1"><label>–ß–∞—Å—Ç–∫–∞ –Ω–∞ –ø–µ—Ä–µ–¥., %</label><input id="frontPct" type="number" step="1" value="38"></div>
          </div>
          <div class="row" style="margin-top:6px">
            <div style="flex:1"><label>–ü—Ä–∏–≤—ñ–¥</label>
              <select id="drive"><option value="mfwd" selected>MFWD (4√ó4 –ø—ñ–¥–∫–ª—é—á.)</option><option value="2wd">2WD (–∑–∞–¥–Ω—ñ–π)</option><option value="4wd">–ü–æ—Å—Ç. 4√ó4</option></select>
            </div>
            <div style="flex:1"><label>–î—ñ–∞–º–µ—Ç—Ä —à–∏–Ω–∏ (–µ—Ñ.), –º</label><input id="tireDia" type="number" step="0.01" value="1.5"></div>
          </div>
        </div>

        <div class="box">
          <h3>–¢—è–≥–æ–≤–∞ –∑–∞–¥–∞—á–∞</h3>
          <div class="row">
            <div style="flex:1"><label>–ü–æ—Ç—Ä—ñ–±–Ω–∞ —Ç—è–≥–∞ F, –∫–ù</label><input id="needF" type="number" step="0.1" value="25"></div>
            <div style="flex:1"><label>–®–≤–∏–¥–∫—ñ—Å—Ç—å, –∫–º/–≥–æ–¥</label><input id="speed" type="number" step="0.1" value="8.0"></div>
          </div>
          <div class="row" style="margin-top:6px">
            <div style="flex:1"><label>–ö–æ–µ—Ñ. –∑—á–µ–ø–ª–µ–Ω–Ω—è Œº</label><input id="mu" type="number" step="0.01" value="0.5"></div>
            <div style="flex:1"><label>–¶—ñ–ª—å–æ–≤–∏–π –±—É–∫—Å, %</label><input id="slipTarget" type="number" step="1" value="12"></div>
          </div>
        </div>

        <div class="box">
          <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
          <div class="row">
            <button class="btn" onclick="recalc()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
            <button class="btn" onclick="preset()">üß™ –ü—Ä–∏–∫–ª–∞–¥</button>
            <button class="btn" onclick="copyCSV('csvSys')">üìã CSV (—Å–∏—Å—Ç–µ–º–∞)</button>
          </div>
          <div id="csvSys" class="out" style="margin-top:8px">‚Äî</div>
        </div>
      </div>

      <div class="grid g3" style="margin-top:8px">
        <div class="box">
          <h3>–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å –Ω–∞ –¥–∏—à–ª—ñ</h3>
          <p>P·µà = F¬∑v = <b><span id="Pdraw">‚Äî</span></b> –∫–í—Ç</p>
          <p class="small">v = –∫–º/–≥–æ–¥ √∑ 3.6 ‚Üí –º/—Å; F —É –∫–ù ‚Üí –∫–ù¬∑–º/—Å = –∫–í—Ç.</p>
        </div>
        <div class="box">
          <h3>–û–±–º–µ–∂–µ–Ω–Ω—è –∑–∞ –∑—á–µ–ø–ª–µ–Ω–Ω—è–º</h3>
          <p>–ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ –≤–µ–¥—É—á—É(—ñ) –≤—ñ—Å—å(—ñ): <b><span id="Wdrive">‚Äî</span></b> –∫–ù</p>
          <p>–ú–∞–∫—Å. —Ç—è–≥–æ–≤–∞ —Å–∏–ª–∞ Œº¬∑Wdrive: <b><span id="Fmax">‚Äî</span></b> –∫–ù</p>
          <p>–î–µ—Ñ—ñ—Ü–∏—Ç —Ç—è–≥–∏: <b><span id="Fgap">‚Äî</span></b> –∫–ù</p>
        </div>
        <div class="box">
          <h3>–ë–∞–ª–∞—Å—Ç —Ç–∞ —Ä–æ–∑–ø–æ–¥—ñ–ª</h3>
          <p>–î–æ–¥. –±–∞–ª–∞—Å—Ç –Ω–∞ –≤–µ–¥—É—á—É(—ñ): <b><span id="BallastNeed">‚Äî</span></b> —Ç</p>
          <p>–†–µ–∫–æ–º–µ–Ω–¥. —Å—Ç–∞—Ç–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª: <b><span id="SplitRec">‚Äî</span></b></p>
          <p class="small">–†–æ–∑–º—ñ—â–µ–Ω–Ω—è: <span class="mono">60‚Äì65% –∑–∞–¥</span> / <span class="mono">35‚Äì40% –ø–µ—Ä–µ–¥</span> (MFWD).</p>
        </div>
      </div>
    </div>

    <!-- –¢–ò–°–ö –£ –®–ò–ù–ê–• / –ö–û–ù–¢–ê–ö–¢–ù–ò–ô –¢–ò–°–ö -->
    <div class="card">
      <h2>üõû –¢–∏—Å–∫ —É —à–∏–Ω–∞—Ö —Ç–∞ –∫–æ–Ω—Ç–∞–∫—Ç–Ω–∏–π —Ç–∏—Å–∫</h2>
      <div class="grid g3">
        <div class="box">
          <h3>–í–∏—Ö—ñ–¥–Ω—ñ</h3>
          <div class="row">
            <div style="flex:1"><label>–ö-—Ç—å —à–∏–Ω –Ω–∞ –≤—ñ—Å—å (–ø–∞—Ä–∞)</label><input id="tiresPerAxle" type="number" step="1" value="2"></div>
            <div style="flex:1"><label>–¶—ñ–ª—å–æ–≤–∏–π –∫–æ–Ω—Ç–∞–∫—Ç–Ω–∏–π —Ç–∏—Å–∫, –∫–ü–∞</label><input id="pTarget" type="number" step="5" value="110"></div>
          </div>
          <div class="row" style="margin-top:6px">
            <div style="flex:1"><label>–ö–æ–µ—Ñ. –∑–∞–ø–∞—Å—É —Ç–∏—Å–∫—É</label><input id="pSF" type="number" step="0.05" value="1.10"></div>
            <div style="flex:1"><label>–ö–æ–µ—Ñ. –ø–ª–æ—â—ñ –ø–ª—è–º–∏ k</label><input id="areaK" type="number" step="0.05" value="1.10"></div>
          </div>
          <p class="small">–°–ø—Ä–æ—â–µ–Ω–Ω—è: <span class="mono">P—à–∏–Ω–∏ ‚âà P–∫–æ–Ω—Ç–∞–∫—Ç √ó –∫–æ–µ—Ñ.–∑–∞–ø–∞—Å—É</span>; –ø–ª–æ—â–∞ ‚âà <span class="mono">k¬∑–ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è/—Ç–∏—Å–∫</span>.</p>
        </div>
        <div class="box">
          <h3>–ü–µ—Ä–µ–¥–Ω—è –≤—ñ—Å—å</h3>
          <p>–ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ –≤—ñ—Å—å: <b><span id="loadFront">‚Äî</span></b> –∫–ù ‚Üí –Ω–∞ —à–∏–Ω—É: <b><span id="perTireF">‚Äî</span></b> –∫–ù</p>
          <p>–†–µ–∫–æ–º–µ–Ω–¥. —Ç–∏—Å–∫ (—Ö–æ–ª–æ–¥–Ω–∏–π): <b><span id="pFront">‚Äî</span></b> –∫–ü–∞</p>
          <p>–û—Ü—ñ–Ω–∫–∞ –ø–ª–æ—â—ñ –ø–ª—è–º–∏: <b><span id="areaFront">‚Äî</span></b> –¥–º¬≤/—à–∏–Ω—É</p>
        </div>
        <div class="box">
          <h3>–ó–∞–¥–Ω—è –≤—ñ—Å—å</h3>
          <p>–ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ –≤—ñ—Å—å: <b><span id="loadRear">‚Äî</span></b> –∫–ù ‚Üí –Ω–∞ —à–∏–Ω—É: <b><span id="perTireR">‚Äî</span></b> –∫–ù</p>
          <p>–†–µ–∫–æ–º–µ–Ω–¥. —Ç–∏—Å–∫ (—Ö–æ–ª–æ–¥–Ω–∏–π): <b><span id="pRear">‚Äî</span></b> –∫–ü–∞</p>
          <p>–û—Ü—ñ–Ω–∫–∞ –ø–ª–æ—â—ñ –ø–ª—è–º–∏: <b><span id="areaRear">‚Äî</span></b> –¥–º¬≤/—à–∏–Ω—É</p>
        </div>
      </div>
      <p class="small muted">–ù–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ —É—Ç–æ—á–Ω—é–≤–∞—Ç–∏ –∑–∞ —Ç–∞–±–ª–∏—Ü—è–º–∏ –≤–∏—Ä–æ–±–Ω–∏–∫–∞ —à–∏–Ω (–º–æ–¥–µ–ª—å/—Ä–æ–∑–º—ñ—Ä/—à–≤–∏–¥–∫—ñ—Å—Ç—å). –¶—ñ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏ ‚Äî –Ω–∞–≤—á–∞–ª—å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞.</p>
    </div>

    <!-- –ñ–£–†–ù–ê–õ –ë–£–ö–°–£–í–ê–ù–ù–Ø -->
    <div class="card">
      <h2>üìí –ñ—É—Ä–Ω–∞–ª –±—É–∫—Å—É–≤–∞–Ω–Ω—è (—Ç–µ–æ—Ä. vs —Ñ–∞–∫—Ç.)</h2>
      <div class="row">
        <button class="btn" onclick="addRow()">‚ûï –î–æ–¥–∞—Ç–∏ –∑–∞–ø–∏—Å</button>
        <button class="btn" onclick="presetRows()">üß™ –ü—Ä–∏–∫–ª–∞–¥</button>
        <button class="btn" onclick="recalc()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
        <button class="btn" onclick="copyCSV('csvLog')">üìã CSV (–∂—É—Ä–Ω–∞–ª)</button>
      </div>
      <div style="overflow:auto; margin-top:8px">
        <table class="table" id="tbl">
          <thead>
            <tr>
              <th>#</th>
              <th>–ü–æ–ª–µ/–¥—ñ–ª—è–Ω–∫–∞</th>
              <th>–û–±–µ—Ä—Ç—ñ–≤ –¥–≤–∏–≥., rpm</th>
              <th>–ü–µ—Ä–µ–¥–∞—á–∞ (–∫–æ–µ—Ñ.)</th>
              <th>–†–∞–¥—ñ—É—Å –∫–æ—á–µ–Ω–Ω—è, –º</th>
              <th>V —Ç–µ–æ—Ä., –∫–º/–≥–æ–¥</th>
              <th>V —Ñ–∞–∫—Ç., –∫–º/–≥–æ–¥</th>
              <th class="dark">–ë—É–∫—Å, %</th>
              <th class="dark">–°—Ç–∞—Ç—É—Å</th>
              <th>–ü—Ä–∏–º—ñ—Ç–∫–∞</th>
            </tr>
          </thead>
          <tbody id="body"></tbody>
          <tfoot>
            <tr>
              <th class="dark" colspan="7">–°–µ—Ä–µ–¥–Ω—ñ–π –±—É–∫—Å</th>
              <th class="dark" id="avgSlip">‚Äî</th>
              <th class="dark" colspan="2">‚Äî</th>
            </tr>
          </tfoot>
        </table>
      </div>
      <div id="csvLog" class="out" style="margin-top:8px">‚Äî</div>
      <p class="small muted">V —Ç–µ–æ—Ä. ‚âà œâ–∫–æ–ª–∞√ó2œÄR; œâ–∫–æ–ª–∞ = rpm_–¥–≤–∏–≥ / i_–∑–∞–≥, –¥–µ i ‚Äî –∑–∞–≥–∞–ª—å–Ω–∏–π –ø–µ—Ä–µ–¥–∞—Ç–Ω–∏–π (–¥–≤–∏–≥—É–Ω‚Üí–∫–æ–ª–µ—Å–∞). –ë—É–∫—Å = (V—Ç–µ–æ—Ä ‚àí V—Ñ–∞–∫—Ç)/V—Ç–µ–æ—Ä¬∑100%.</p>
    </div>

    <!-- –ö–í–ò–¢–û–ö + NFC -->
    <div class="card">
      <h2>üßæ –ö–≤–∏—Ç–æ–∫ 58 –º–º —Ç–∞ NFC</h2>
      <div class="grid g2">
        <div class="box">
          <h3>NFC ‚Äî ‚ÄúTR-SLIP/BALLAST‚Äù</h3>
          <div class="row">
            <div style="flex:1"><label>–ú–∞—à–∏–Ω–∞ ID</label><input id="nfcId" type="text" value="TR-001"></div>
            <div style="flex:1"><label>–ö–æ–Ω—Ç–∞–∫—Ç</label><input id="nfcPhone" type="text" value="+380XXXXXXXXX"></div>
          </div>
          <div class="row" style="margin-top:6px">
            <button class="btn" onclick="buildNFC()">üß© –ó—ñ–±—Ä–∞—Ç–∏</button>
            <button class="btn" onclick="copyEl('nfcOut')">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
          </div>
          <div id="nfcOut" class="out">‚Äî</div>
        </div>

        <div class="box">
          <h3>–ö–≤–∏—Ç–æ–∫ ‚Äú–ë–∞–ª–∞—Å—Ç & –¢–∏—Å–∫ —à–∏–Ω‚Äù</h3>
          <div class="row">
            <button class="btn" onclick="buildTicket()">üßæ –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏</button>
            <button class="btn" onclick="window.print()">üñ®Ô∏è –î—Ä—É–∫</button>
          </div>
          <div class="ticket" id="ticket" style="margin-top:8px">
            <h4>–ë–ê–õ–ê–°–¢ & –¢–ò–°–ö –®–ò–ù</h4>
            <p id="tDate"><small>–î–∞—Ç–∞: ‚Äî</small></p>
            <div class="line"></div>
            <p><b>F–ø–æ—Ç—Ä:</b> <span id="tF">‚Äî</span> –∫–ù ¬∑ <b>P·µà:</b> <span id="tPd">‚Äî</span> –∫–í—Ç</p>
            <p><b>Œº¬∑Wdrive:</b> <span id="tFmax">‚Äî</span> –∫–ù ¬∑ <b>ŒîF:</b> <span id="tFgap">‚Äî</span> –∫–ù</p>
            <p><b>–ë–∞–ª–∞—Å—Ç (–≤–µ–¥—É—á—ñ):</b> <span id="tBall">‚Äî</span> —Ç</p>
            <div class="line"></div>
            <p><b>–¢–∏—Å–∫ —à–∏–Ω F/R:</b> <span id="tPF">‚Äî</span> / <span id="tPR">‚Äî</span> –∫–ü–∞</p>
            <p><b>–¶—ñ–ª—å–æ–≤–∏–π –±—É–∫—Å:</b> <span id="tSlipT">‚Äî</span> %</p>
            <div class="line"></div>
            <p><small id="tNote">–ü—Ä–∏–º.: ‚Äî</small></p>
          </div>
        </div>
      </div>
    </div>

    <!-- –•–Ü–î –†–û–ë–û–¢–ò -->
    <div class="card">
      <h2>ü™ú –•—ñ–¥ —Ä–æ–±–æ—Ç–∏ (45‚Äì70 —Ö–≤)</h2>
      <ol>
        <li>–ó–∞–¥–∞–π <b>–º–∞—Å–∏/—Ä–æ–∑–ø–æ–¥—ñ–ª</b>, <b>–ø–æ—Ç—Ä—ñ–±–Ω—É —Ç—è–≥—É</b>, <b>—à–≤–∏–¥–∫—ñ—Å—Ç—å</b>, <b>Œº</b> —Ç–∞ <b>—Ü—ñ–ª—å–æ–≤–∏–π –±—É–∫—Å</b> ‚Üí –ø–µ—Ä–µ–≤—ñ—Ä –¥–µ—Ñ—ñ—Ü–∏—Ç/–Ω–∞–¥–ª–∏—à–æ–∫ —Ç—è–≥–∏.</li>
        <li>–†–æ–∑—Ä–∞—Ö—É–π <b>–±–∞–ª–∞—Å—Ç</b> —ñ –æ–Ω–æ–≤–∏ <b>—Ç–∏—Å–∫ —É —à–∏–Ω–∞—Ö</b> –¥–æ —Ü—ñ–ª—å–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–≥–æ —Ç–∏—Å–∫—É.</li>
        <li>–ó–∞–ø–æ–≤–Ω–∏ 3‚Äì5 —Ä—è–¥–∫—ñ–≤ <b>–∂—É—Ä–Ω–∞–ª—É</b> (–¥–≤–∏–≥—É–Ω rpm, –ø–µ—Ä–µ–¥–∞—Ç–Ω–∏–π, —Ä–∞–¥—ñ—É—Å, —Ñ–∞–∫—Ç. —à–≤–∏–¥–∫—ñ—Å—Ç—å –≤—ñ–¥ GPS/—Ö—Ä–æ–Ω–æ–º–µ—Ç—Ä–∞) ‚Üí –æ—Ü—ñ–Ω–∫–∞ –±—É–∫—Å—É.</li>
        <li>–ó–≥–µ–Ω–µ—Ä—É–π <b>NFC</b>, <b>–∫–≤–∏—Ç–æ–∫ 58 –º–º</b> —ñ <b>CSV</b> –¥–ª—è –∑–≤—ñ—Ç—É (<span class="mono">Traction</span>).</li>
      </ol>
    </div>

    <div class="card">
      <h2>‚úÖ –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è (10 –±–∞–ª—ñ–≤)</h2>
      <table class="table">
        <thead><tr><th>–ö—Ä–∏—Ç–µ—Ä—ñ–π</th><th>–ë–∞–ª–∏</th></tr></thead>
        <tbody>
          <tr><td>–ö–æ—Ä–µ–∫—Ç–Ω—ñ P·µà, –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ Œº¬∑Wdrive —ñ –æ–±“ë—Ä—É–Ω—Ç–æ–≤–∞–Ω–∏–π –±–∞–ª–∞—Å—Ç</td><td>4</td></tr>
          <tr><td>–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π —Ç–∏—Å–∫ —É —à–∏–Ω–∞—Ö (–ª–æ–≥—ñ–∫–∞/–≤–∏—Å–Ω–æ–≤–∫–∏)</td><td>2</td></tr>
          <tr><td>–ñ—É—Ä–Ω–∞–ª –±—É–∫—Å—É–≤–∞–Ω–Ω—è (‚â•3 —Ä—è–¥–∫–∏) —Ç–∞ –∞–Ω–∞–ª—ñ–∑</td><td>3</td></tr>
          <tr><td>–ö–≤–∏—Ç–æ–∫/NFC + CSV</td><td>1</td></tr>
        </tbody>
      </table>
    </div>
  </div>

<script>
  // –í–±—É–¥–æ–≤–∞–Ω–∏–π —Ä–µ–∂–∏–º (Moodle iFrame)
  (function(){ if (window.self !== window.top) document.documentElement.classList.add('embedded'); })();

  const byId = id => document.getElementById(id);
  const rnd = (n,d=2) => Number((+n).toFixed(d));
  const bodyEl = document.getElementById('body');

  function weights(){
    const mT = (+byId('massT').value||0);          // —Ç
    const g = 9.81;                                // –º/—Å¬≤
    const Wtot = mT * g;                            // –∫–ù (–±–æ —Ç*9.81 = –∫–ù –ø—Ä–∏–±–ª–∏–∑–Ω–æ)
    const fPct = (+byId('frontPct').value||0)/100;
    const Wfront = Wtot * fPct;
    const Wright = Wtot - Wfront;

    // –Ø–∫–∞ –≤—ñ—Å—å –≤–µ–¥—É—á–∞?
    const drive = byId('drive').value;
    let Wdrive = 0;
    if(drive==='2wd') Wdrive = Wright;            // –∑–∞–¥–Ω—è –≤–µ–¥—É—á–∞
    else if(drive==='mfwd' || drive==='4wd') Wdrive = Wtot; // –æ–±–∏–¥–≤—ñ –≤–µ–¥—É—á—ñ (—Å–ø—Ä–æ—â–µ–Ω–æ)

    return {Wtot,Wfront,Wright,Wdrive};
  }

  function tractionCalc(){
    const F = (+byId('needF').value||0);          // –∫–ù
    const V = (+byId('speed').value||0);          // –∫–º/–≥–æ–¥
    const mu = (+byId('mu').value||0);
    const slipT = (+byId('slipTarget').value||0);
    const w = weights();

    const Pdraw = F * (V/3.6);                    // –∫–í—Ç
    const Fmax = mu * w.Wdrive;                   // –∫–ù
    const Fgap = F - Fmax;                        // –∫–ù (–ø–æ–∑–∏—Ç–∏–≤–Ω–µ = –Ω–µ –≤–∏—Å—Ç–∞—á–∞—î –∑—á–µ–ø–ª–µ–Ω–Ω—è)
    // –ú—ñ–Ω. –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –±–∞–ª–∞—Å—Ç –Ω–∞ –≤–µ–¥—É—á—É(—ñ), —â–æ–± F ‚â§ Œº¬∑(Wdrive+ŒîW): ŒîW ‚â• (F/Œº - Wdrive)/g? –ú–∏ –≤–∂–µ –≤ –∫–ù ‚Üí –ø–æ–¥—ñ–ª–∏–º–æ –Ω–∞ g(‚âà9.81) –¥–ª—è —Ç–æ–Ω–Ω.
    let ballastT = 0;
    if(Fgap>0 && mu>0){
      const add_kN = (F/mu) - w.Wdrive;          // –∫–ù
      ballastT = Math.max(0, add_kN / 9.81);     // —Ç
    }

    // –†–µ–∫–æ–º. —Å—Ç–∞—Ç–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª (—Ç–µ–∫—Å—Ç)
    let split = '35‚Äì40% –ø–µ—Ä–µ–¥ / 60‚Äì65% –∑–∞–¥ (MFWD)';
    if(byId('drive').value==='2wd') split = '25‚Äì35% –ø–µ—Ä–µ–¥ / 65‚Äì75% –∑–∞–¥ (2WD)';
    if(byId('drive').value==='4wd') split = '50/50 (–ø–æ—Å—Ç—ñ–π–Ω–∏–π 4√ó4)';

    // –í–∏–≤—ñ–¥
    byId('Pdraw').textContent = rnd(Pdraw,1);
    byId('Wdrive').textContent= rnd(w.Wdrive,1);
    byId('Fmax').textContent  = rnd(Fmax,1);
    byId('Fgap').textContent  = rnd(Fgap,1);
    byId('BallastNeed').textContent = rnd(ballastT,2);
    byId('SplitRec').textContent = split;

    // CSV
    const csv = [
      `TRACTOR|m=${byId('massT').value}t|front%=${byId('frontPct').value}|drive=${byId('drive').value}`,
      `TASK|F=${F}kN|V=${V}kmh|mu=${mu}|slipT=${slipT}%|Pdraw=${rnd(Pdraw,1)}kW`,
      `GRIP|Wdrive=${rnd(w.Wdrive,1)}kN|Fmax=${rnd(Fmax,1)}kN|Fgap=${rnd(Fgap,1)}kN|BallastNeed=${rnd(ballastT,2)}t|Split=${split}`
    ].join('\n');
    byId('csvSys').textContent = csv;

    return {F,V,mu,slipT,Pdraw,Fmax,Fgap,ballastT,split,weights:w};
  }

  function tires(){
    const t = tractionCalc();
    const tiresPerAxle = (+byId('tiresPerAxle').value||2);
    const pT = (+byId('pTarget').value||110); // –∫–ü–∞
    const pSF = (+byId('pSF').value||1.1);    // –∫–æ–µ—Ñ. –∑–∞–ø–∞—Å—É
    const kA  = (+byId('areaK').value||1.1);  // –∫–æ–µ—Ñ. –ø–ª–æ—â—ñ

    // –ö–ù ‚Üí –ù: *1000; –∫–ü–∞ = –∫–ù/–º¬≤
    const loadF_kN = t.weights.Wfront;
    const loadR_kN = t.weights.Wright;
    const perTireF_kN = loadF_kN / tiresPerAxle;
    const perTireR_kN = loadR_kN / tiresPerAxle;

    const pFront = rnd(pT * pSF, 0);
    const pRear  = rnd(pT * pSF, 0);

    // –ü–ª–æ—â–∞ –ø–ª—è–º–∏ (–Ω–∞–≤—á–∞–ª—å–Ω–∞ –æ—Ü—ñ–Ω–∫–∞): A ‚âà k * (–ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–ù / —Ç–∏—Å–∫ –∫–ü–∞) –º¬≤; –ø–µ—Ä–µ–≤–µ–¥–µ–º–æ —É –¥–º¬≤ (√ó100)
    const areaF_dm2 = rnd( kA * (perTireF_kN / pT) * 100 , 1);
    const areaR_dm2 = rnd( kA * (perTireR_kN / pT) * 100 , 1);

    byId('loadFront').textContent = rnd(loadF_kN,1);
    byId('loadRear').textContent  = rnd(loadR_kN,1);
    byId('perTireF').textContent  = rnd(perTireF_kN,2);
    byId('perTireR').textContent  = rnd(perTireR_kN,2);
    byId('pFront').textContent    = pFront;
    byId('pRear').textContent     = pRear;
    byId('areaFront').textContent = areaF_dm2;
    byId('areaRear').textContent  = areaR_dm2;

    return {pFront,pRear,perTireF_kN,perTireR_kN,areaF_dm2,areaR_dm2};
  }

  // ==== –ñ—É—Ä–Ω–∞–ª –±—É–∫—Å—É–≤–∞–Ω–Ω—è ====
  function addRow(sample){
    const def = { field:'F-01', rpm:1800, ratio:30, R: (+byId('tireDia').value||1.5)/2, vfact:7.2, note:'' };
    const s = Object.assign({}, def, sample||{});
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td class="idx">1</td>
      <td><input type="text" value="${s.field}"></td>
      <td><input type="number" step="10" value="${s.rpm}"></td>
      <td><input type="number" step="0.1" value="${s.ratio}"></td>
      <td><input type="number" step="0.001" value="${s.R}"></td>
      <td class="vth">‚Äî</td>
      <td><input type="number" step="0.1" value="${s.vfact}"></td>
      <td class="dark slip">‚Äî</td>
      <td class="dark flag">‚Äî</td>
      <td><input type="text" value="${s.note}"></td>
    `;
    bodyEl.appendChild(tr);
    reindex();
  }
  function reindex(){ [...bodyEl.querySelectorAll('tr')].forEach((tr,i)=>tr.querySelector('.idx').textContent=i+1); }

  function recalcLog(){
    let sum=0, n=0;
    [...bodyEl.querySelectorAll('tr')].forEach(tr=>{
      const rpm  = +tr.children[2].querySelector('input').value||0;
      const ratio= +tr.children[3].querySelector('input').value||0; // –∑–∞–≥–∞–ª—å–Ω–∏–π
      const R    = +tr.children[4].querySelector('input').value||0;
      const vfact= +tr.children[6].querySelector('input').value||0;

      const w_wheel = ratio>0 ? rpm/ratio : 0;             // –æ–±/—Ö–≤
      const vth = w_wheel>0 ? (2*Math.PI*R) * (w_wheel/60) : 0; // –º/—Å
      const vth_kmh = vth*3.6;
      const slip = (vth_kmh>0) ? ( (vth_kmh - vfact)/vth_kmh * 100 ) : 0;

      tr.querySelector('.vth').textContent = vth_kmh? rnd(vth_kmh,2) : '‚Äî';
      tr.querySelector('.slip').textContent= isFinite(slip)? rnd(slip,1) : '‚Äî';

      // –°—Ç–∞—Ç—É—Å –∑–∞ —Ü—ñ–ª—å–æ–≤–∏–º –±—É–∫—Å–æ–º
      const t = (+byId('slipTarget').value||0);
      let flag='‚Äî', color='';
      if(vth_kmh>0){
        if(slip<t-3) { flag='üü¢ –Ω–∏–∑—å–∫–∏–π (–º–æ–∂–Ω–∞ –∑–º–µ–Ω—à–∏—Ç–∏ —Ç–∏—Å–∫/–¥–æ–¥–∞—Ç–∏ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è/–≤–∏—â–∞ –ø–µ—Ä–µ–¥–∞—á–∞)'; color='#10b981'; }
        else if(slip<=t+3) { flag='üü† –≤ —Ü—ñ–ª—ñ (¬±3%)'; color='#f59e0b'; }
        else { flag='üî¥ –∑–∞–≤–µ–ª–∏–∫–∏–π (–∑–Ω–∏–∑–∏—Ç–∏ —Ç–∏—Å–∫/–∑–º–µ–Ω—à–∏—Ç–∏ —à–≤–∏–¥–∫—ñ—Å—Ç—å/–¥–æ–¥–∞—Ç–∏ –±–∞–ª–∞—Å—Ç)'; color='#ef4444'; }
      }
      tr.querySelector('.flag').textContent = flag;
      tr.querySelector('.flag').style.color = color;

      if(vth_kmh>0){ sum += Math.max(0,slip); n++; }
    });
    byId('avgSlip').textContent = n? rnd(sum/n,1)+'%' : '‚Äî';

    // CSV –∂—É—Ä–Ω–∞–ª
    const lines = [...bodyEl.querySelectorAll('tr')].map(tr=>{
      const idx=tr.querySelector('.idx').textContent.trim();
      const field=tr.children[1].querySelector('input').value.trim();
      const rpm =tr.children[2].querySelector('input').value.trim();
      const ratio=tr.children[3].querySelector('input').value.trim();
      const R   =tr.children[4].querySelector('input').value.trim();
      const vth =tr.querySelector('.vth').textContent.trim();
      const vf  =tr.children[6].querySelector('input').value.trim();
      const slip=tr.querySelector('.slip').textContent.trim();
      const flag=tr.querySelector('.flag').textContent.trim();
      const note=tr.children[9].querySelector('input').value.trim();
      return [idx,field,rpm,ratio,R,vth,vf,slip,flag,note].join(' | ');
    });
    byId('csvLog').textContent = lines.join('\n') || '‚Äî';
  }

  function recalc(){
    tractionCalc();
    tires();
    recalcLog();
  }

  function preset(){
    byId('massT').value = 7.2;
    byId('frontPct').value = 40;
    byId('drive').value = 'mfwd';
    byId('needF').value = 28;
    byId('speed').value = 7.5;
    byId('mu').value = 0.48;
    byId('slipTarget').value = 12;
    byId('tireDia').value = 1.6;
    recalc();
  }

  function presetRows(){
    bodyEl.innerHTML='';
    addRow({field:'F-01', rpm:1800, ratio:28, R:(+byId('tireDia').value||1.6)/2, vfact:6.6, note:'–æ—Ä–∞–Ω–∫–∞'});
    addRow({field:'F-02', rpm:2000, ratio:30, R:(+byId('tireDia').value||1.6)/2, vfact:7.1, note:'–∫—É–ª—å—Ç–∏–≤–∞—Ü—ñ—è'});
    addRow({field:'F-03', rpm:1700, ratio:26, R:(+byId('tireDia').value||1.6)/2, vfact:6.9, note:'–ø–æ—Å—ñ–≤'});
    recalc();
  }

  // ==== –ö–≤–∏—Ç–æ–∫ / NFC / CSV –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è ====
  function buildTicket(){
    const t = tractionCalc();
    const pr = tires();
    const d = new Date().toISOString().slice(0,10);
    byId('tDate').innerHTML = `<small>–î–∞—Ç–∞: ${d}</small>`;
    byId('tF').textContent = rnd(t.F,1);
    byId('tPd').textContent = rnd(t.Pdraw,1);
    byId('tFmax').textContent = rnd(t.Fmax,1);
    byId('tFgap').textContent = rnd(t.Fgap,1);
    byId('tBall').textContent = rnd(t.ballastT,2);
    byId('tPF').textContent = pr.pFront;
    byId('tPR').textContent = pr.pRear;
    byId('tSlipT').textContent = t.slipT;
    byId('tNote').textContent = `–†–æ–∑–ø–æ–¥—ñ–ª: ${t.split}; Tires/axle: ${byId('tiresPerAxle').value}; k=${byId('areaK').value}`;
  }

  function buildNFC(){
    const t = tractionCalc();
    const pr = tires();
    const text = [
      `TR_SLIP_BAL_NFC`,
      `MACHINE:${byId('nfcId').value}`,
      `CONTACT:${byId('nfcPhone').value}`,
      `TASK:F=${rnd(t.F,1)}kN; V=${rnd(t.V,1)}kmh; mu=${t.mu}; SlipT=${t.slipT}%`,
      `GRIP:Wdrive=${rnd(t.weights.Wdrive,1)}kN; Fmax=${rnd(t.Fmax,1)}kN; BallastNeed=${rnd(t.ballastT,2)}t`,
      `TIRES:Front=${pr.pFront}kPa;Rear=${pr.pRear}kPa; perTireF=${rnd(pr.perTireF_kN,2)}kN; perTireR=${rnd(pr.perTireR_kN,2)}kN`,
      `NOTE:Split=${t.split}`,
      `STAMP:${new Date().toISOString().slice(0,19).replace('T',' ')}`
    ].join('\n');
    byId('nfcOut').textContent = text;
  }

  function copyCSV(id){
    const t = document.getElementById(id).textContent.trim();
    if(!t||t==='‚Äî'){ alert('–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è'); return; }
    navigator.clipboard.writeText(t).then(()=>flash('‚úÖ CSV —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'),()=>flash('–ù–µ –≤–¥–∞–ª–æ—Å—è'));
  }
  function copyEl(id){
    const t = byId(id).textContent.trim();
    if(!t||t==='‚Äî'){ alert('–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö'); return; }
    navigator.clipboard.writeText(t).then(()=>flash('‚úÖ –°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'),()=>flash('–ù–µ –≤–¥–∞–ª–æ—Å—è'));
  }
  function flash(msg){ const o=document.title; document.title=msg; setTimeout(()=>document.title=o,900); }

  // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
  (function init(){
    addRow(); addRow();
    recalc();
  })();

  // –ü–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫ –ø—Ä–∏ –∑–º—ñ–Ω–∞—Ö
  document.addEventListener('change', e=>{
    if(e.target.matches('input,select')) recalc();
  });
</script>
</body>
</html>
