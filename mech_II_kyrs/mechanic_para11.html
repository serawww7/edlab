<!-- mechanic_para11.html
     –ü–ê–†–ê 11 (–∞—É–¥–∏—Ç–æ—Ä–Ω–æ) –¥–ª—è –º–µ—Ö–∞–Ω—ñ–∫—ñ–≤
     –¢–µ–º–∞: –ï–õ–ï–ö–¢–†–ò–ö–ê 12/24–í ‚Äî –ø–∞–¥—ñ–Ω–Ω—è –Ω–∞–ø—Ä—É–≥–∏, –ø—ñ–¥–±—ñ—Ä –ø–µ—Ä–µ—Ä—ñ–∑—É –ø—Ä–æ–≤–æ–¥—É, –∑–∞–ø–æ–±—ñ–∂–Ω–∏–∫/—Ä–µ–ª–µ, –±–∞–ª–∞–Ω—Å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞,
           —Å–ø–æ–∂–∏–≤–∞—á—ñ (—Å–≤—ñ—Ç–ª–æ/–Ω–∞—Å–æ—Å–∏/–ï–ë–£), —Ç–µ—Å—Ç "–º–∞—Å–∏" –ø—ñ–¥ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º, —á–µ–∫ 58 –º–º, NFC, CSV.
     –§–æ–∫—É—Å: —Ç–µ–ª–µ—Ñ–æ–Ω–∏/–ü–ö; –±–µ–∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫; –≥–æ—Ç–æ–≤–æ –¥–ª—è GitHub Pages —Ç–∞ Moodle (iframe).
     –û–±–ª–∞–¥–Ω–∞–Ω–Ω—è: —Ç–µ–ª–µ—Ñ–æ–Ω–∏ (–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä/—Ç–∞–π–º–µ—Ä); –∑–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ ‚Äî –º—É–ª—å—Ç–∏–º–µ—Ç—Ä (–¥–∞–Ω—ñ –º–æ–∂–Ω–∞ –≤–≤–µ—Å—Ç–∏ –≤—Ä—É—á–Ω—É).
     –ü—Ä–∏–º—ñ—Ç–∫–∞ —â–æ–¥–æ –∫–æ–Ω—Ç—Ä–∞—Å—Ç—É: —Ç–µ–º–Ω—ñ –∫–ª—ñ—Ç–∏–Ω–∫–∏ —Ç–∞–±–ª–∏—Ü—å –º–∞—é—Ç—å —Å–≤—ñ—Ç–ª–∏–π —Ç–µ–∫—Å—Ç (.dark).
-->
<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>–ü–∞—Ä–∞ 11 (–º–µ—Ö–∞–Ω—ñ–∫–∏) ‚Äî –ï–ª–µ–∫—Ç—Ä–∏–∫–∞ 12/24–í: –ø–∞–¥—ñ–Ω–Ω—è –Ω–∞–ø—Ä—É–≥–∏, –ø—Ä–æ–≤—ñ–¥, –∑–∞–ø–æ–±—ñ–∂–Ω–∏–∫/—Ä–µ–ª–µ, –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä, –∂—É—Ä–Ω–∞–ª, –∫–≤–∏—Ç–æ–∫ 58 –º–º, NFC</title>
<meta name="color-scheme" content="light dark">
<style>
  :root{
    --bg:#0b1220; --card:#0f172a; --muted:#94a3b8; --text:#e2e8f0;
    --accent:#22c55e; --accent-2:#60a5fa; --warn:#f59e0b; --bad:#ef4444; --good:#10b981; --line:#1f2937;
    --darkcell:#0b1324; --darkink:#e6eef9; --darkink2:#e5e7eb;
  }
  *{box-sizing:border-box}
  body{margin:0;background:linear-gradient(180deg,#0b1220,#111827 30%,#0b1220);color:var(--text);
       font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;line-height:1.55}
  .wrap{max-width:1100px;margin:0 auto;padding:24px 16px 64px}
  .badge{display:inline-block;padding:6px 10px;border:1px solid var(--line);background:#0b1220;border-radius:999px;
         font-size:12px;color:var(--muted);letter-spacing:.3px}
  h1{font-size:34px;margin:6px 0 12px;line-height:1.15;
     background:linear-gradient(90deg,#60a5fa,#22c55e);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
  h2{font-size:22px;margin:28px 0 12px} h3{font-size:18px;margin:20px 0 8px;color:#cbd5e1}
  p{margin:10px 0}.small{font-size:12px;color:#9fb0c8}.muted{color:#93a3b5}.mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Courier New",monospace}
  .btn{display:inline-block;padding:10px 14px;border-radius:10px;border:1px solid #223049;background:#0d1a2e;color:#dbeafe;text-decoration:none;cursor:pointer}
  .btn:hover{background:#0f1f39}
  .grid{display:grid;gap:12px}.g2{grid-template-columns:repeat(2,minmax(0,1fr))}.g3{grid-template-columns:repeat(3,minmax(0,1fr))}
  @media (max-width:1000px){.g2,.g3{grid-template-columns:1fr}}
  .row{display:flex;gap:10px;flex-wrap:wrap}
  .card{background:linear-gradient(180deg,#0f172a,#0b1220);border:1px solid var(--line);border-radius:16px;padding:16px;margin:12px 0;box-shadow:0 6px 24px rgba(0,0,0,.25)}
  .box{border:1px solid #223049;border-radius:12px;padding:12px;background:var(--darkcell);color:var(--darkink)}
  .ok{color:var(--good)} .warn{color:var(--warn)} .bad{color:var(--bad)}
  .table{width:100%;border-collapse:separate;border-spacing:0;overflow:auto;border-radius:12px;border:1px solid #223049}
  .table th,.table td{padding:8px 10px;border-bottom:1px solid #1f2937;font-size:14px;vertical-align:top}
  .table thead th{background:#0c1629;color:#a5b4fc;text-align:left;position:sticky;top:0}
  .table tbody tr:nth-child(even){background:var(--darkcell);color:var(--darkink2)}
  .table td.dark,.table th.dark{background:var(--darkcell)!important;color:var(--darkink2)!important}
  .out{background:var(--darkcell);color:var(--darkink2);border:1px dashed #263042;padding:10px 12px;border-radius:10px;word-break:break-all}
  input[type="text"],input[type="number"],input[type="date"],select,textarea{width:100%;padding:8px 10px;border-radius:10px;border:1px solid #223049;background:#0d1a2e;color:#e6eef9}
  /* –ß–µ–∫ 58 –º–º */
  .ticket{width:58mm;background:#fff;color:#000;padding:6mm 4mm;border-radius:6px;box-shadow:0 0 0 1px #e5e7eb inset;font-family:"Courier New",ui-monospace,monospace}
  .ticket h4{margin:0 0 6px;font-size:13px;text-align:center}.ticket p{margin:2px 0;font-size:12px}.ticket .line{border-top:1px dashed #111;margin:6px 0}
  .ticket small{font-size:10px}
  /* –í–±—É–¥–æ–≤–∞–Ω–æ (iframe) ‚Üí —Å–≤—ñ—Ç–ª–∏–π –≤–∏–≥–ª—è–¥ */
  html.embedded body{background:#fff;color:#111}
  html.embedded .card{background:#fff;border:1px solid #e5e7eb;box-shadow:none}
  html.embedded h1{-webkit-text-fill-color:initial;background:none;color:#111}
  html.embedded .box{background:#f8fafc;color:#111}
  html.embedded .table tbody tr:nth-child(even){background:#f3f4f6;color:#111}
  @media print{@page{margin:4mm}.no-print{display:none!important}}
</style>
</head>
<body>
<div class="wrap">
  <span class="badge">–ü–∞—Ä–∞ 11 ¬∑ –∞—É–¥–∏—Ç–æ—Ä–Ω–æ ¬∑ –º–µ—Ö–∞–Ω—ñ–∫–∏</span>
  <h1>üîå –ï–ª–µ–∫—Ç—Ä–∏–∫–∞ 12/24–í: –ø–∞–¥—ñ–Ω–Ω—è –Ω–∞–ø—Ä—É–≥–∏, –ø—Ä–æ–≤—ñ–¥/–∑–∞–ø–æ–±—ñ–∂–Ω–∏–∫/—Ä–µ–ª–µ, –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä, –∂—É—Ä–Ω–∞–ª, –∫–≤–∏—Ç–æ–∫ 58 –º–º, NFC</h1>

  <div class="card">
    <h2>üéØ –ú–µ—Ç–∞</h2>
    <p>
      –ó–∞ –ø–∞—Ä—É —Å—Ç—É–¥–µ–Ω—Ç–∏ –Ω–∞–≤—á–∞—Ç—å—Å—è <b>—Ä–æ–∑—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –ø–∞–¥—ñ–Ω–Ω—è –Ω–∞–ø—Ä—É–≥–∏</b> —Ç–∞ <b>–ø—ñ–¥–±–∏—Ä–∞—Ç–∏ –ø–µ—Ä–µ—Ä—ñ–∑ –ø—Ä–æ–≤–æ–¥—É</b>, 
      –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–∏–±–∏—Ä–∞—Ç–∏ <b>–∑–∞–ø–æ–±—ñ–∂–Ω–∏–∫</b> —ñ <b>—Ä–µ–ª–µ</b>, –æ—Ü—ñ–Ω—é–≤–∞—Ç–∏ <b>–±–∞–ª–∞–Ω—Å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞</b> –∑–∞ —Å—É–º–æ—é —Å–ø–æ–∂–∏–≤–∞—á—ñ–≤,
      –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ <b>‚Äú–º–∞—Å—É‚Äù –ø—ñ–¥ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º</b>, —Ñ–æ—Ä–º—É–≤–∞—Ç–∏ <b>–∂—É—Ä–Ω–∞–ª</b>, <b>–∫–≤–∏—Ç–æ–∫ 58 –º–º</b>, <b>NFC</b> —Ç–∞ <b>CSV</b>.
    </p>
    <p class="small">–ù–æ—Ä–º–∏ (–Ω–∞–≤—á–∞–ª—å–Ω–æ): –ø–∞–¥—ñ–Ω–Ω—è U ‚Äî –¥–æ <span class="mono">3 %</span> –¥–ª—è –∂–∏–≤–ª–µ–Ω–Ω—è –ï–ë–£/–Ω–∞—Å–æ—Å—ñ–≤ —ñ <span class="mono">‚â§10 %</span> –¥–ª—è –æ—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è; 
      –∑–∞–ø–æ–±—ñ–∂–Ω–∏–∫ ‚âà <span class="mono">1.25√óI—Ä–æ–±</span>, –∞–ª–µ –Ω–µ –≤–∏—â–µ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ –¥–ª—è –ø–µ—Ä–µ—Ä—ñ–∑—É; –º—ñ–¥—å: <span class="mono">œÅ‚âà0.0175 Œ©¬∑–º–º¬≤/–º</span>, –∞–ª—é–º—ñ–Ω—ñ–π: <span class="mono">œÅ‚âà0.028</span>.</p>
  </div>

  <!-- –°–ï–ö–¶–Ü–Ø 1. –í–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –µ–ª–µ–∫—Ç—Ä–æ—Å–∏—Å—Ç–µ–º–∏ -->
  <div class="card">
    <h2>‚öôÔ∏è –ü—Ä–æ—Ñ—ñ–ª—å –µ–ª–µ–∫—Ç—Ä–æ—Å–∏—Å—Ç–µ–º–∏</h2>
    <div class="grid g3">
      <div class="box">
        <h3>–ú–µ—Ä–µ–∂–∞ —Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä</h3>
        <div class="row">
          <div style="flex:1"><label>–ù–æ–º—ñ–Ω–∞–ª –º–µ—Ä–µ–∂—ñ, –í</label>
            <select id="U" onchange="syncU()"><option value="12" selected>12</option><option value="24">24</option></select>
          </div>
          <div style="flex:1"><label>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä, –ê</label><input id="AltA" type="number" step="1" value="120"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <div style="flex:1"><label>–†–µ–∑–µ—Ä–≤ –Ω–∞ –∑–∞—Ä—è–¥ –ê–ö–ë, –ê</label><input id="AltReserve" type="number" step="1" value="15"></div>
          <div style="flex:1"><label>–ú–∞—Ç–µ—Ä—ñ–∞–ª –ø—Ä–æ–≤–æ–¥—É</label>
            <select id="mat"><option value="cu" selected>–º—ñ–¥—å</option><option value="al">–∞–ª—é–º—ñ–Ω—ñ–π</option></select>
          </div>
        </div>
      </div>
      <div class="box">
        <h3>–°—Ç–∞–Ω –ê–ö–ë (–æ—Ü—ñ–Ω–∫–∞)</h3>
        <div class="row">
          <div style="flex:1"><label>–Ñ–º–Ω—ñ—Å—Ç—å, Ah</label><input id="Ah" type="number" step="1" value="100"></div>
          <div style="flex:1"><label>CCA, –ê (–ø—É—Å–∫)</label><input id="CCA" type="number" step="10" value="750"></div>
        </div>
        <p class="small">CCA –¥–∞—î —É—è–≤–ª–µ–Ω–Ω—è –ø—Ä–æ <b>–ø—É—Å–∫–æ–≤–∏–π —Å—Ç—Ä—É–º —Å—Ç–∞—Ä—Ç–µ—Ä–∞</b> —ñ –ø—Ä–æ—Å—ñ–¥–∞–Ω–Ω—è –Ω–∞–ø—Ä—É–≥–∏ –≤ –º–æ—Ä–æ–∑.</p>
      </div>
      <div class="box">
        <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
        <div class="row">
          <button class="btn" onclick="recalc()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="preset()">üß™ –ü—Ä–∏–∫–ª–∞–¥</button>
          <button class="btn" onclick="copyCSV('csvSys')">üìã CSV (—Å–∏—Å—Ç–µ–º–∞)</button>
        </div>
        <div id="csvSys" class="out" style="margin-top:8px">‚Äî</div>
      </div>
    </div>
  </div>

  <!-- –°–ï–ö–¶–Ü–Ø 2. –ü–∞–¥—ñ–Ω–Ω—è –Ω–∞–ø—Ä—É–≥–∏ / –ø—ñ–¥–±—ñ—Ä –ø–µ—Ä–µ—Ä—ñ–∑—É / –∑–∞–ø–æ–±—ñ–∂–Ω–∏–∫ -->
  <div class="card">
    <h2>üîã –ü–∞–¥—ñ–Ω–Ω—è –Ω–∞–ø—Ä—É–≥–∏, –ø–µ—Ä–µ—Ä—ñ–∑ –ø—Ä–æ–≤–æ–¥—É, –∑–∞–ø–æ–±—ñ–∂–Ω–∏–∫</h2>
    <div class="grid g3">
      <div class="box">
        <h3>–õ—ñ–Ω—ñ—è –∂–∏–≤–ª–µ–Ω–Ω—è</h3>
        <div class="row">
          <div style="flex:1"><label>–°—Ç—Ä—É–º I, –ê</label><input id="I" type="number" step="0.1" value="8.5"></div>
          <div style="flex:1"><label>–î–æ–≤–∂–∏–Ω–∞ —à–ª—è—Ö—É L, –º (—Ç—É–¥–∏+–Ω–∞–∑–∞–¥)</label><input id="L" type="number" step="0.1" value="6"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <div style="flex:1"><label>–ü–µ—Ä–µ—Ä—ñ–∑ S, –º–º¬≤</label><input id="S" type="number" step="0.5" value="2.5"></div>
          <div style="flex:1"><label>–ì—Ä–∞–Ω–∏—á–Ω–µ –ø–∞–¥—ñ–Ω–Ω—è, %</label><input id="dropPctLim" type="number" step="0.1" value="3"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <div style="flex:1"><label>–ó–∞–ø–æ–±—ñ–∂–Ω–∏–∫, –ê</label><input id="fuse" type="number" step="1" value="15"></div>
          <div style="flex:1"><label>–†–µ–ª–µ (–∫–æ—Ç—É—à–∫–∞), Œ©</label><input id="relayR" type="number" step="1" value="90"></div>
        </div>
      </div>
      <div class="box">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏</h3>
        <p>R –ª—ñ–Ω—ñ—ó: <b><span id="Rline">‚Äî</span></b> Œ©</p>
        <p>–ü–∞–¥—ñ–Ω–Ω—è ŒîU: <b><span id="dU">‚Äî</span></b> –í (<b><span id="dUp">‚Äî</span></b> %)</p>
        <p>–†–µ–∫–æ–º–µ–Ω–¥. –º—ñ–Ω. S (–∑–∞ –ª—ñ–º—ñ—Ç–æ–º): <b><span id="Sneed">‚Äî</span></b> –º–º¬≤</p>
        <p>–ö–æ—Ç—É—à–∫–∞ —Ä–µ–ª–µ I: <b><span id="IRelay">‚Äî</span></b> –ê</p>
        <p>–°—Ç–∞—Ç—É—Å –ª—ñ–Ω—ñ—ó: <b><span id="lineFlag">‚Äî</span></b></p>
      </div>
      <div class="box">
        <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
        <div class="row">
          <button class="btn" onclick="calcDrop()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="copyCSV('csvDrop')">üìã CSV (–ª—ñ–Ω—ñ—è)</button>
        </div>
        <div id="csvDrop" class="out" style="margin-top:8px">‚Äî</div>
      </div>
    </div>
    <p class="small muted">–§–æ—Ä–º—É–ª–∏: <span class="mono">R = œÅ¬∑(2L)/S</span>, –¥–µ œÅ –¥–ª—è Cu = 0.0175 Œ©¬∑–º–º¬≤/–º (Al=0.028); <span class="mono">ŒîU = I¬∑R</span>; 
      —Ü—ñ–ª—å–æ–≤–∏–π S –∑–∞ –æ–±–º–µ–∂–µ–Ω–Ω—è–º: <span class="mono">S ‚â• œÅ¬∑(2L)¬∑I / ŒîU–¥–æ–ø</span>. –ó–∞–ø–æ–±—ñ–∂–Ω–∏–∫: <span class="mono">F ‚âà 1.25¬∑I</span>, –∞–ª–µ –Ω–µ –≤–∏—â–µ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ –¥–ª—è S.</p>
  </div>

  <!-- –°–ï–ö–¶–Ü–Ø 3. –ë–∞–ª–∞–Ω—Å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ / —Å–ø–æ–∂–∏–≤–∞—á—ñ -->
  <div class="card">
    <h2>‚ö° –ë–∞–ª–∞–Ω—Å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Ç–∞ —Å–ø–æ–∂–∏–≤–∞—á—ñ</h2>
    <div class="row">
      <button class="btn" onclick="addLoad()">‚ûï –î–æ–¥–∞—Ç–∏ —Å–ø–æ–∂–∏–≤–∞—á–∞</button>
      <button class="btn" onclick="presetLoads()">üß™ –ü—Ä–∏–∫–ª–∞–¥</button>
      <button class="btn" onclick="recalc()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
      <button class="btn" onclick="copyCSV('csvLoads')">üìã CSV (–Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è)</button>
    </div>
    <div style="overflow:auto;margin-top:8px">
      <table class="table" id="tbl">
        <thead>
          <tr>
            <th>#</th>
            <th>–°–ø–æ–∂–∏–≤–∞—á</th>
            <th>U, –í</th>
            <th>P, –í—Ç</th>
            <th class="dark">I, –ê</th>
            <th class="dark">–ì—Ä—É–ø–∞</th>
            <th class="dark">–°—Ç–∞—Ç—É—Å</th>
            <th>–ü—Ä–∏–º—ñ—Ç–∫–∞</th>
          </tr>
        </thead>
        <tbody id="body"></tbody>
        <tfoot>
          <tr>
            <th class="dark" colspan="4">–°—É–º–∞—Ä–Ω–∏–π —Å—Ç—Ä—É–º</th>
            <th class="dark" id="Itot">‚Äî</th>
            <th class="dark" colspan="2">–ó–∞–ø–∞—Å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞</th>
            <th class="dark" id="AltHead">‚Äî</th>
          </tr>
        </tfoot>
      </table>
    </div>
    <div id="csvLoads" class="out" style="margin-top:8px">‚Äî</div>
    <p class="small muted">–ì—Ä—É–ø–∏: <span class="mono">–ø–æ—Å—Ç—ñ–π–Ω–æ</span> (–ï–ë–£/–Ω–∞—Å–æ—Å–∏), <span class="mono">–ø–µ—Ä—ñ–æ–¥–∏—á–Ω–æ</span> (–∫–µ—Ä–º–æ, –ø—ñ–¥–π–æ–º), <span class="mono">—Å–≤—ñ—Ç–ª–æ</span>.</p>
  </div>

  <!-- –°–ï–ö–¶–Ü–Ø 4. –¢–µ—Å—Ç "–º–∞—Å–∏" –ø—ñ–¥ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º -->
  <div class="card">
    <h2>üß© –¢–µ—Å—Ç ‚Äú–º–∞—Å–∏‚Äù –ø—ñ–¥ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º</h2>
    <div class="grid g3">
      <div class="box">
        <h3>–í—Ö—ñ–¥–Ω—ñ</h3>
        <div class="row">
          <div style="flex:1"><label>U –±–µ–∑ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, –í</label><input id="Uopen" type="number" step="0.01" value="12.6"></div>
          <div style="flex:1"><label>U –ø—ñ–¥ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º, –í</label><input id="Uload" type="number" step="0.01" value="11.8"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <div style="flex:1"><label>I –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, –ê</label><input id="Iload" type="number" step="0.1" value="20"></div>
          <div style="flex:1"><label>–î–æ–ø—É—Å—Ç–∏–º–µ –ø–∞–¥—ñ–Ω–Ω—è, –í</label><input id="Udok" type="number" step="0.01" value="0.5"></div>
        </div>
      </div>
      <div class="box">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
        <p>–ü–∞–¥—ñ–Ω–Ω—è –Ω–∞ ‚Äú–º–∞—Å—ñ‚Äù: <b><span id="Ugnd">‚Äî</span></b> –í</p>
        <p>–ï–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç R ‚Äú–º–∞—Å–∏‚Äù: <b><span id="Rgnd">‚Äî</span></b> Œ©</p>
        <p>–°—Ç–∞—Ç—É—Å: <b><span id="gndFlag">‚Äî</span></b></p>
      </div>
      <div class="box">
        <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
        <div class="row">
          <button class="btn" onclick="calcGnd()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="copyCSV('csvGnd')">üìã CSV (–º–∞—Å–∞)</button>
        </div>
        <div id="csvGnd" class="out" style="margin-top:8px">‚Äî</div>
      </div>
    </div>
    <p class="small muted">–í–∏–º—ñ—Ä: —á–æ—Ä–Ω–∏–π —â—É–ø ‚Äî –Ω–∞ –º–∞—Å—É –ê–ö–ë, —á–µ—Ä–≤–æ–Ω–∏–π ‚Äî –Ω–∞ –∫–æ—Ä–ø—É—Å —Å–ø–æ–∂–∏–≤–∞—á–∞ –ø—ñ–¥ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º; –Ω–æ—Ä–º–∞–ª—å–Ω–µ –ø–∞–¥—ñ–Ω–Ω—è <span class="mono">‚â§0.2‚Ä¶0.5 –í</span> (12 –í).</p>
  </div>

  <!-- –ñ–£–†–ù–ê–õ -->
  <div class="card">
    <h2>üìí –ñ—É—Ä–Ω–∞–ª –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫</h2>
    <div class="row">
      <button class="btn" onclick="addLog()">‚ûï –î–æ–¥–∞—Ç–∏ –∑–∞–ø–∏—Å</button>
      <button class="btn" onclick="presetLog()">üß™ –ü—Ä–∏–∫–ª–∞–¥</button>
      <button class="btn" onclick="copyCSV('csvLog')">üìã CSV (–∂—É—Ä–Ω–∞–ª)</button>
    </div>
    <div style="overflow:auto;margin-top:8px">
      <table class="table" id="tblLog">
        <thead>
          <tr>
            <th>#</th>
            <th>–õ–∞–Ω—Ü—é–≥</th>
            <th>U—Å–∏—Å—Ç, –í</th>
            <th>I, –ê</th>
            <th>S, –º–º¬≤</th>
            <th class="dark">ŒîU, –í</th>
            <th class="dark">ŒîU, %</th>
            <th class="dark">–ó–∞–ø–æ–±., –ê</th>
            <th class="dark">–°—Ç–∞—Ç—É—Å</th>
            <th>–ü—Ä–∏–º—ñ—Ç–∫–∞</th>
          </tr>
        </thead>
        <tbody id="bodyLog"></tbody>
      </table>
    </div>
    <div id="csvLog" class="out" style="margin-top:8px">‚Äî</div>
  </div>

  <!-- –ö–í–ò–¢–û–ö + NFC -->
  <div class="card">
    <h2>üßæ –ö–≤–∏—Ç–æ–∫ 58 –º–º —Ç–∞ NFC</h2>
    <div class="grid g2">
      <div class="box">
        <h3>NFC ‚Äî ‚ÄúELEC CHECK‚Äù</h3>
        <div class="row">
          <div style="flex:1"><label>–ú–∞—à–∏–Ω–∞ ID</label><input id="nfcId" type="text" value="TR-001"></div>
          <div style="flex:1"><label>–ö–æ–Ω—Ç–∞–∫—Ç</label><input id="nfcPhone" type="text" value="+380XXXXXXXXX"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <button class="btn" onclick="buildNFC()">üß© –ó—ñ–±—Ä–∞—Ç–∏</button>
          <button class="btn" onclick="copyEl('nfcOut')">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
        </div>
        <div id="nfcOut" class="out">‚Äî</div>
      </div>

      <div class="box">
        <h3>–ö–≤–∏—Ç–æ–∫ ‚ÄúELEC CHECK‚Äù</h3>
        <div class="row">
          <button class="btn" onclick="buildTicket()">üßæ –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="window.print()">üñ®Ô∏è –î—Ä—É–∫</button>
        </div>
        <div class="ticket" id="ticket" style="margin-top:8px">
          <h4>ELEC CHECK</h4>
          <p id="tDate"><small>–î–∞—Ç–∞: ‚Äî</small></p>
          <div class="line"></div>
          <p><b>ŒîU –ª—ñ–Ω—ñ—ó:</b> <span id="tDU">‚Äî</span> –í (<span id="tDUp">‚Äî</span> %)</p>
          <p><b>S —Ñ–∞–∫—Ç / –º—ñ–Ω:</b> <span id="tS">‚Äî</span> / <span id="tSneed">‚Äî</span> –º–º¬≤</p>
          <p><b>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∑–∞–ø–∞—Å:</b> <span id="tAltHead">‚Äî</span> –ê</p>
          <p><b>–ú–∞—Å–∞ ŒîU:</b> <span id="tUgnd">‚Äî</span> –í</p>
          <div class="line"></div>
          <p><small id="tNote">–ü—Ä–∏–º.: ‚Äî</small></p>
        </div>
      </div>
    </div>
  </div>

  <!-- –•–Ü–î –†–û–ë–û–¢–ò + –û–¶–Ü–ù–Æ–í–ê–ù–ù–Ø -->
  <div class="card">
    <h2>ü™ú –•—ñ–¥ —Ä–æ–±–æ—Ç–∏ (45‚Äì70 —Ö–≤)</h2>
    <ol>
      <li>–ó–∞–ø–æ–≤–Ω–∏ <b>–ø—Ä–æ—Ñ—ñ–ª—å —Å–∏—Å—Ç–µ–º–∏</b> (12/24 –í, –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä, —Ä–µ–∑–µ—Ä–≤, –º–∞—Ç–µ—Ä—ñ–∞–ª –ø—Ä–æ–≤–æ–¥—É).</li>
      <li>–î–ª—è –∫–ª—é—á–æ–≤–æ—ó –ª—ñ–Ω—ñ—ó –ø–æ—Ä–∞—Ö—É–π <b>R, ŒîU, %</b>, –ø—ñ–¥–±–µ—Ä–∏ <b>S</b>, <b>–∑–∞–ø–æ–±—ñ–∂–Ω–∏–∫</b>, –æ—Ü—ñ–Ω—é–π <b>—Ä–µ–ª–µ</b>.</li>
      <li>–î–æ–¥–∞–π <b>—Å–ø–æ–∂–∏–≤–∞—á—ñ–≤</b> (—Å–≤—ñ—Ç–ª–æ/–Ω–∞—Å–æ—Å–∏/–ï–ë–£) ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä <b>–∑–∞–ø–∞—Å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞</b>.</li>
      <li>–í–∏–∫–æ–Ω–∞–π <b>—Ç–µ—Å—Ç ‚Äú–º–∞—Å–∏‚Äù</b> (–≤–≤–µ–¥–∏ –≤–∏–º—ñ—Ä–∏) ‚Äî –∑—Ä–æ–±–∏ –≤–∏—Å–Ω–æ–≤–æ–∫.</li>
      <li>–ó–∞–ø–æ–≤–Ω–∏ <b>–∂—É—Ä–Ω–∞–ª</b> (‚â•3 —Ä—è–¥–∫–∏), —Å—Ñ–æ—Ä–º—É–π <b>NFC</b>, <b>–∫–≤–∏—Ç–æ–∫ 58 –º–º</b> —ñ <b>CSV</b> (<span class="mono">Electrical</span>).</li>
    </ol>
  </div>

  <div class="card">
    <h2>‚úÖ –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è (10 –±–∞–ª—ñ–≤)</h2>
    <table class="table">
      <thead><tr><th>–ö—Ä–∏—Ç–µ—Ä—ñ–π</th><th>–ë–∞–ª–∏</th></tr></thead>
      <tbody>
        <tr><td>–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ ŒîU/S/–∑–∞–ø–æ–±—ñ–∂–Ω–∏–∫–∞ –∫–æ—Ä–µ–∫—Ç–Ω–∏–π</td><td>4</td></tr>
        <tr><td>–ë–∞–ª–∞–Ω—Å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —ñ –≤–∏—Å–Ω–æ–≤–∫–∏</td><td>3</td></tr>
        <tr><td>–¢–µ—Å—Ç ‚Äú–º–∞—Å–∏‚Äù —Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó</td><td>2</td></tr>
        <tr><td>–ö–≤–∏—Ç–æ–∫/NFC + CSV</td><td>1</td></tr>
      </tbody>
    </table>
  </div>
</div>

<script>
  // –í–±—É–¥–æ–≤–∞–Ω–∏–π —Ä–µ–∂–∏–º (Moodle iFrame)
  (function(){ if (window.self !== window.top) document.documentElement.classList.add('embedded'); })();

  const byId = id => document.getElementById(id);
  const rnd = (n,d=2)=>Number((+n).toFixed(d));
  const bodyEl = document.getElementById('body');
  const bodyLogEl = document.getElementById('bodyLog');

  function syncU(){
    // –ø–µ—Ä–µ—Å—Ä–∞—Ö—É–≤–∞—Ç–∏ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–∏ –∑–º—ñ–Ω—ñ –Ω–∞–ø—Ä—É–≥–∏
    [...bodyEl.querySelectorAll('tr')].forEach(tr=>{
      const U = +byId('U').value||12;
      const Pin = +tr.children[3].querySelector('input').value||0;
      const I = U>0 ? Pin/U : 0;
      tr.querySelector('.I').textContent = rnd(I,2);
    });
    recalc();
  }

  function preset(){
    byId('U').value = '12';
    byId('AltA').value = 150;
    byId('AltReserve').value = 20;
    byId('mat').value = 'cu';
    byId('Ah').value = 110;
    byId('CCA').value = 800;
    byId('I').value = 12.0;
    byId('L').value = 5.2;
    byId('S').value = 4;
    byId('dropPctLim').value = 3;
    byId('fuse').value = 20;
    byId('relayR').value = 85;
    recalc();
  }

  function recalc(){
    calcDrop();
    calcLoads();
    calcGnd();
    // CSV —Å–∏—Å—Ç–µ–º–∏
    const csv = [
      `SYS|U=${byId('U').value}V|Alt=${byId('AltA').value}A|Reserve=${byId('AltReserve').value}A|mat=${byId('mat').value}`,
      `BAT|Ah=${byId('Ah').value}|CCA=${byId('CCA').value}`
    ].join('\n');
    byId('csvSys').textContent = csv;
  }

  // ==== –ü–∞–¥—ñ–Ω–Ω—è –Ω–∞–ø—Ä—É–≥–∏ / –ø–µ—Ä–µ—Ä—ñ–∑ ====
  function rho(){ return byId('mat').value==='cu' ? 0.0175 : 0.028; } // Œ©¬∑–º–º¬≤/–º
  function calcDrop(){
    const U = +byId('U').value||12;
    const I = +byId('I').value||0;
    const L = +byId('L').value||0;
    const S = Math.max(0.1, +byId('S').value||0.1);
    const limP = +byId('dropPctLim').value||3;
    const fuse = +byId('fuse').value||0;
    const Rcoil = +byId('relayR').value||0;

    const Rline = rho()*(2*L)/S;
    const dU = I*Rline;
    const dUp = U>0 ? (dU/U*100) : 0;

    const dUlim = U*limP/100;
    const Sneed = (rho()*(2*L)*I) / (dUlim>0 ? dUlim : 1e-9);

    const IRelay = Rcoil>0 ? U/Rcoil : 0;

    // —Å—Ç–∞—Ç—É—Å
    let flag='üü¢ –æ–∫', color='#10b981';
    if(dUp>limP) { flag='üî¥ –ø–µ—Ä–µ–≤–∏—â—É—î –ª—ñ–º—ñ—Ç'; color='#ef4444'; }
    else if(dUp>limP*0.7) { flag='üü† –±–ª–∏–∑—å–∫–æ –¥–æ –º–µ–∂—ñ'; color='#f59e0b'; }

    byId('Rline').textContent = rnd(Rline,4);
    byId('dU').textContent = rnd(dU,3);
    byId('dUp').textContent = rnd(dUp,1);
    byId('Sneed').textContent = rnd(Sneed,2);
    byId('IRelay').textContent = rnd(IRelay,2);
    byId('lineFlag').textContent = flag; byId('lineFlag').style.color = color;

    // CSV
    const csv = `LINE|U=${U}V|I=${I}A|L=${L}m|S=${S}mm2|rho=${rho()}|dU=${rnd(dU,3)}V|dUp=${rnd(dUp,1)}%|Sneed>=${rnd(Sneed,2)}mm2|Fuse=${fuse}A|RelayI=${rnd(IRelay,2)}A`;
    byId('csvDrop').textContent = csv;

    return {U,I,L,S,Sneed,dU,dUp,fuse,IRelay};
  }

  // ==== –ù–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è / –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä ====
  function addLoad(sample){
    const def = {name:'–†–æ–±–æ—á–∏–π —Å–≤—ñ—Ç–ª–æ–¥—ñ–æ–¥–Ω–∏–π –ø—Ä–æ–∂–µ–∫—Ç–æ—Ä', U:+byId('U').value||12, P:36, group:'—Å–≤—ñ—Ç–ª–æ', note:''};
    const s = Object.assign({}, def, sample||{});
    const tr = document.createElement('tr');
    const I = s.U>0 ? s.P/s.U : 0;
    tr.innerHTML = `
      <td class="idx">1</td>
      <td><input type="text" value="${s.name}"></td>
      <td><input type="number" step="0.1" value="${s.U}"></td>
      <td><input type="number" step="1" value="${s.P}"></td>
      <td class="dark I">${rnd(I,2)}</td>
      <td class="dark">
        <select>
          <option ${s.group==='–ø–æ—Å—Ç—ñ–π–Ω–æ'?'selected':''}>–ø–æ—Å—Ç—ñ–π–Ω–æ</option>
          <option ${s.group==='–ø–µ—Ä—ñ–æ–¥–∏—á–Ω–æ'?'selected':''}>–ø–µ—Ä—ñ–æ–¥–∏—á–Ω–æ</option>
          <option ${s.group==='—Å–≤—ñ—Ç–ª–æ'?'selected':''}>—Å–≤—ñ—Ç–ª–æ</option>
        </select>
      </td>
      <td class="dark flag">‚Äî</td>
      <td><input type="text" value="${s.note}"></td>
    `;
    bodyEl.appendChild(tr); reindex(); calcLoads();
    // —Å–ª—É—Ö–∞—á—ñ –Ω–∞ –∑–º—ñ–Ω–∏ U/P/group
    tr.querySelectorAll('input,select').forEach(el=>{
      el.addEventListener('change', ()=>{
        const U = +tr.children[2].querySelector('input').value||0;
        const P = +tr.children[3].querySelector('input').value||0;
        tr.querySelector('.I').textContent = rnd(U>0? P/U : 0, 2);
        calcLoads();
      });
    });
  }
  function reindex(){ [...bodyEl.querySelectorAll('tr')].forEach((tr,i)=>tr.querySelector('.idx').textContent=i+1); }

  function calcLoads(){
    const U = +byId('U').value||12;
    const AltA = +byId('AltA').value||0;
    const reserve = +byId('AltReserve').value||0;
    let Itot = 0;
    [...bodyEl.querySelectorAll('tr')].forEach(tr=>{
      const I = +tr.querySelector('.I').textContent||0;
      Itot += I;
    });
    const head = AltA - reserve - Itot; // –∑–∞–ø–∞—Å –ø—ñ—Å–ª—è —Ä–µ–∑–µ—Ä–≤—É –Ω–∞ –∑–∞—Ä—è–¥
    let flag='üü¢ –æ–∫', color='#10b981';
    if(head<0){ flag='üî¥ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è'; color='#ef4444'; }
    else if(head<AltA*0.1){ flag='üü† –º–∞–ª–∏–π –∑–∞–ø–∞—Å'; color='#f59e0b'; }

    byId('Itot').textContent = rnd(Itot,2);
    byId('AltHead').textContent = `${rnd(head,1)} –ê ${flag}`;
    byId('AltHead').style.color = color;

    // CSV
    const lines = [...bodyEl.querySelectorAll('tr')].map(tr=>{
      const idx=tr.querySelector('.idx').textContent.trim();
      const name=tr.children[1].querySelector('input').value.trim();
      const u  =tr.children[2].querySelector('input').value.trim();
      const p  =tr.children[3].querySelector('input').value.trim();
      const i  =tr.querySelector('.I').textContent.trim();
      const grp=tr.children[5].querySelector('select').value;
      return [idx,name,u,p,i,grp].join(' | ');
    });
    const summary = `TOTAL|I=${rnd(Itot,2)}A|Alt=${AltA}A|Reserve=${reserve}A|Head=${rnd(head,1)}A`;
    byId('csvLoads').textContent = lines.concat(summary).join('\n') || '‚Äî';

    return {Itot,head};
  }

  function presetLoads(){
    bodyEl.innerHTML='';
    const U = +byId('U').value||12;
    addLoad({name:'–ï–ë–£ –¥–≤–∏–≥—É–Ω–∞', U, P:30, group:'–ø–æ—Å—Ç—ñ–π–Ω–æ'});
    addLoad({name:'–ü–∞–ª–∏–≤–Ω–∏–π –Ω–∞—Å–æ—Å', U, P:60, group:'–ø–æ—Å—Ç—ñ–π–Ω–æ'});
    addLoad({name:'–ü—ñ–¥—Ä—É–ª—å–æ–≤–∏–π –≥—ñ–¥—Ä–æ–Ω–∞—Å–æ—Å (–µ–ª.–∫–ª–∞–ø–∞–Ω–∏)', U, P:48, group:'–ø–µ—Ä—ñ–æ–¥–∏—á–Ω–æ'});
    addLoad({name:'–°–≤—ñ—Ç–ª–æ –ø–µ—Ä–µ–¥–Ω—î LED', U, P:72, group:'—Å–≤—ñ—Ç–ª–æ'});
    addLoad({name:'–ì–∞–±–∞—Ä–∏—Ç–∏/–ø–∞–Ω–µ–ª—å', U, P:24, group:'—Å–≤—ñ—Ç–ª–æ'});
    calcLoads();
  }

  // ==== –¢–µ—Å—Ç "–º–∞—Å–∏" ====
  function calcGnd(){
    const Uo = +byId('Uopen').value||0;
    const Ul = +byId('Uload').value||0;
    const I = +byId('Iload').value||0;
    const Ud = +byId('Udok').value||0.5;
    const drop = Math.max(0, Uo - Ul);
    const R = I>0 ? drop / I : 0;
    let flag='üü¢ –æ–∫', color='#10b981';
    if(drop>Ud){ flag='üî¥ –≤–µ–ª–∏–∫–µ –ø–∞–¥—ñ–Ω–Ω—è (–æ—á–∏—Å—Ç–∏—Ç–∏ —Ç–æ—á–∫–∏ –º–∞—Å–∏, –∑–∞—Ç—è–≥–Ω—É—Ç–∏ –±–æ–ª—Ç–∏)'; color='#ef4444'; }
    else if(drop>Ud*0.6){ flag='üü† –±–ª–∏–∑—å–∫–æ –¥–æ –º–µ–∂—ñ'; color='#f59e0b'; }
    byId('Ugnd').textContent = rnd(drop,2);
    byId('Rgnd').textContent = rnd(R,3);
    byId('gndFlag').textContent = flag; byId('gndFlag').style.color = color;

    const csv = `GND|Uopen=${Uo}V|Uload=${Ul}V|I=${I}A|drop=${rnd(drop,2)}V|R=${rnd(R,3)}Œ©|Limit=${Ud}V|Flag=${flag}`;
    byId('csvGnd').textContent = csv;

    return {drop,R,flag};
  }

  // ==== –ñ—É—Ä–Ω–∞–ª ====
  function addLog(sample){
    const ld = calcDrop();
    const name = sample?.name || '–õ—ñ–Ω—ñ—è –∂–∏–≤–ª–µ–Ω–Ω—è –ï–ë–£';
    const U = +byId('U').value||12;
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td class="idx">1</td>
      <td><input type="text" value="${name}"></td>
      <td class="Us">${U}</td>
      <td class="I">${rnd(ld.I,2)}</td>
      <td class="S">${rnd(ld.S,2)}</td>
      <td class="dark dU">${rnd(ld.dU,3)}</td>
      <td class="dark dUp">${rnd(ld.dUp,1)}</td>
      <td class="dark F">${byId('fuse').value}</td>
      <td class="dark flag">${byId('lineFlag').textContent}</td>
      <td><input type="text" value=""></td>
    `;
    bodyLogEl.appendChild(tr);
    reindexLog(); buildCSVlog();
  }
  function reindexLog(){ [...bodyLogEl.querySelectorAll('tr')].forEach((tr,i)=>tr.querySelector('.idx').textContent=i+1); }

  function presetLog(){
    bodyLogEl.innerHTML='';
    addLog({name:'–õ—ñ–Ω—ñ—è –ï–ë–£'});
    // –ø—Ä–∏–∫–ª–∞–¥ —ñ–Ω—à–∏—Ö –ª—ñ–Ω—ñ–π (—Ä—É—á–Ω–µ –≤–≤–µ–¥–µ–Ω–Ω—è I/S –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó)
    const addCustom = (name,U,I,S,dU,dUp,F,flag,note)=>{
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td class="idx">1</td>
        <td><input type="text" value="${name}"></td>
        <td class="Us">${U}</td>
        <td class="I">${I}</td>
        <td class="S">${S}</td>
        <td class="dark dU">${dU}</td>
        <td class="dark dUp">${dUp}</td>
        <td class="dark F">${F}</td>
        <td class="dark flag">${flag}</td>
        <td><input type="text" value="${note}"></td>
      `;
      bodyLogEl.appendChild(tr);
    };
    addCustom('–°–≤—ñ—Ç–ª–æ –ø–µ—Ä–µ–¥–Ω—î', 12, '6.00', '1.5', '0.48', '4.0', '10', 'üü† –±–ª–∏–∑—å–∫–æ –¥–æ –º–µ–∂—ñ', '—Ä–æ–∑–≤–µ—Å—Ç–∏ –ª—ñ–Ω—ñ—é –æ–∫—Ä–µ–º–æ');
    addCustom('–ù–∞—Å–æ—Å –ø–∞–ª–∏–≤–Ω–∏–π', 12, '5.00', '4', '0.35', '2.9', '15', 'üü¢ –æ–∫', '‚Äî');
    reindexLog(); buildCSVlog();
  }

  function buildCSVlog(){
    const lines = [...bodyLogEl.querySelectorAll('tr')].map(tr=>{
      const idx=tr.querySelector('.idx').textContent.trim();
      const name=tr.children[1].querySelector('input').value.trim();
      const U  =tr.querySelector('.Us').textContent.trim();
      const I  =tr.querySelector('.I').textContent.trim();
      const S  =tr.querySelector('.S').textContent.trim();
      const dU =tr.querySelector('.dU').textContent.trim();
      const dUp=tr.querySelector('.dUp').textContent.trim();
      const F  =tr.querySelector('.F').textContent.trim();
      const flag=tr.querySelector('.flag').textContent.trim();
      const note=tr.children[9].querySelector('input').value.trim();
      return [idx,name,U,I,S,dU,dUp,F,flag,note].join(' | ');
    });
    byId('csvLog').textContent = lines.join('\n') || '‚Äî';
  }

  // ==== –ö–≤–∏—Ç–æ–∫ / NFC ====
  function buildTicket(){
    const d = new Date().toISOString().slice(0,10);
    const ld = calcDrop();
    const loads = calcLoads();
    const g = calcGnd();
    byId('tDate').innerHTML = `<small>–î–∞—Ç–∞: ${d}</small>`;
    byId('tDU').textContent = rnd(ld.dU,3);
    byId('tDUp').textContent = rnd(ld.dUp,1);
    byId('tS').textContent = rnd(ld.S,2);
    byId('tSneed').textContent = rnd(ld.Sneed,2);
    byId('tAltHead').textContent = rnd(loads.head,1);
    byId('tUgnd').textContent = rnd(g.drop,2);
    byId('tNote').textContent = `U=${byId('U').value}–í; Fuse=${byId('fuse').value}–ê; –†–µ–ª–µI=${byId('relayR').value>0?(+byId('U').value/+byId('relayR').value).toFixed(2):'0'}–ê`;
  }

  function buildNFC(){
    const ld = calcDrop();
    const loads = calcLoads();
    const g = calcGnd();
    const text = [
      `ELEC_NFC`,
      `MACHINE:${byId('nfcId').value}`,
      `CONTACT:${byId('nfcPhone').value}`,
      `LINE:dU=${rnd(ld.dU,3)}V(${rnd(ld.dUp,1)}%)|S=${rnd(ld.S,2)}mm2|Sneed>=${rnd(ld.Sneed,2)}mm2|Fuse=${byId('fuse').value}A`,
      `ALT:Head=${rnd(loads.head,1)}A (Alt=${byId('AltA').value}A, Reserve=${byId('AltReserve').value}A)`,
      `GND:drop=${rnd(g.drop,2)}V`,
      `STAMP:${new Date().toISOString().slice(0,19).replace('T',' ')}`
    ].join('\n');
    byId('nfcOut').textContent = text;
  }

  // ==== –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è ====
  function copyCSV(id){
    const t = document.getElementById(id).textContent.trim();
    if(!t||t==='‚Äî'){ alert('–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è'); return; }
    navigator.clipboard.writeText(t).then(()=>flash('‚úÖ CSV —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'),()=>flash('–ù–µ –≤–¥–∞–ª–æ—Å—è'));
  }
  function copyEl(id){
    const t = byId(id).textContent.trim();
    if(!t||t==='‚Äî'){ alert('–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö'); return; }
    navigator.clipboard.writeText(t).then(()=>flash('‚úÖ –°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'),()=>flash('–ù–µ –≤–¥–∞–ª–æ—Å—è'));
  }
  function flash(msg){ const o=document.title; document.title=msg; setTimeout(()=>document.title=o,900); }

  // ==== –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è ====
  (function init(){
    addLoad(); // –æ–¥–∏–Ω —Å–ø–æ–∂–∏–≤–∞—á –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
    recalc();
    document.addEventListener('change', e=>{
      if(e.target.matches('input,select')) recalc();
    });
  })();
</script>
</body>
</html>
