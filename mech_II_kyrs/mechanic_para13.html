<!-- mechanic_para13.html
     –ü–ê–†–ê 13 (–∞—É–¥–∏—Ç–æ—Ä–Ω–æ) –¥–ª—è –º–µ—Ö–∞–Ω—ñ–∫—ñ–≤
     –¢–µ–º–∞: –¢–†–ê–ù–°–ú–Ü–°–Ü–Ø –¢–ê –ü–†–ò–í–û–î–ò ‚Äî –ø–µ—Ä–µ–¥–∞—Ç–æ—á–Ω—ñ —á–∏—Å–ª–∞ (–ö–ü–ü/—Ä–µ–¥—É–∫—Ç–æ—Ä/–¥–∏—Ñ), —à–≤–∏–¥–∫—ñ—Å—Ç—å —Ä—É—Ö—É,
           –æ–±–µ—Ä—Ç–∏ –í–í–ü, –ø–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫ —à–∫—ñ–≤—ñ–≤/–∑—ñ—Ä–æ—á–æ–∫, –¥–æ–≤–∂–∏–Ω–∞ —Ç–∞ –Ω–∞—Ç—è–≥ —Ä–µ–º–µ–Ω—è/–ª–∞–Ω—Ü—é–≥–∞,
           –∫–≤–∏—Ç–æ–∫ 58 –º–º, NFC, CSV-–∂—É—Ä–Ω–∞–ª–∏.
     –§–æ–∫—É—Å: —Ç–µ–ª–µ—Ñ–æ–Ω–∏/–ü–ö; –±–µ–∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫; –≥–æ—Ç–æ–≤–æ –¥–ª—è GitHub Pages / Moodle (iframe).
     –û–±–ª–∞–¥–Ω–∞–Ω–Ω—è: —Ç–µ–ª–µ—Ñ–æ–Ω–∏; (–æ–ø—Ü.) —à—Ç–∞–Ω–≥–µ–Ω—Ü–∏—Ä–∫—É–ª—å/—Ç–∞—Ö–æ–º–µ—Ç—Ä; 58 –º–º –ø—Ä–∏–Ω—Ç–µ—Ä; NFC-–º—ñ—Ç–∫–∏.

     –ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ:
     ‚Ä¢ Ground Speed: —à–∏–Ω–∞ (–¥—ñ–∞–º–µ—Ç—Ä/–ø—Ä–æ—Ñ—ñ–ª—å/R), –æ–±–µ—Ä—Ç–∏ –¥–≤–∏–≥—É–Ω–∞, –ö–ü–ü/–≥–æ–ª–æ–≤–Ω–∞/—Ä–æ–∑–¥–∞—Ç–∫–∞ ‚Üí –∫–º/–≥–æ–¥.
     ‚Ä¢ PTO: –æ–±–µ—Ä—Ç–∏ –¥–≤–∏–≥—É–Ω–∞ ‚Üî –æ–±/—Ö–≤ –í–í–ü (540/1000) —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–¥–∞—Ç–æ—á–Ω–µ.
     ‚Ä¢ –†–µ–º–µ–Ω—ñ: –¥–æ–≤–∂–∏–Ω–∞ –∫–ª–∞—Å–∏—á–Ω–æ–≥–æ –∫–ª–∏–Ω–æ–≤–æ–≥–æ (—Ñ–æ—Ä–º—É–ª–∞ —Å–µ—Ä–µ–¥–Ω—å–æ—ó –¥–æ–≤–∂–∏–Ω–∏), –Ω–∞—Ç—è–≥ –∑–∞ ŒîL —ñ –∫—É—Ç–æ–º –æ–±—Ö–≤–∞—Ç—É.
     ‚Ä¢ –õ–∞–Ω—Ü—é–≥: –∫—Ä–æ–∫, –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ª–∞–Ω–æ–∫, –∑—ñ—Ä–æ—á–∫–∏, –º—ñ–∂–æ—Å—å–æ–≤–∞ ‚Äî –æ—Ü—ñ–Ω–∫–∞ –¥–æ–≤–∂–∏–Ω–∏ —Ç–∞ –∑–º—ñ–Ω–∏ –ø—Ä–∏ —Ä–µ–≥—É–ª—é–≤–∞–Ω–Ω—ñ.
     ‚Ä¢ ‚Äú–ö–≤–∏—Ç–æ–∫‚Äù 58 –º–º, NFC-—Ç–µ–∫—Å—Ç –¥–ª—è –º—ñ—Ç–∫–∏, CSV –¥–ª—è Google Sheets.
     –ü—Ä–∏–º—ñ—Ç–∫–∞ –∫–æ–Ω—Ç—Ä–∞—Å—Ç—É: —Ç–µ–º–Ω—ñ –∫–ª—ñ—Ç–∏–Ω–∫–∏ —Ç–∞–±–ª–∏—Ü—å –º–∞—é—Ç—å —Å–≤—ñ—Ç–ª–∏–π —Ç–µ–∫—Å—Ç (.dark).
--><!DOCTYPE html><html lang="uk"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>–ü–∞—Ä–∞ 13 (–º–µ—Ö–∞–Ω—ñ–∫–∏) ‚Äî –¢—Ä–∞–Ω—Å–º—ñ—Å—ñ—è: –ø–µ—Ä–µ–¥–∞—Ç–æ—á–Ω—ñ, —à–≤–∏–¥–∫—ñ—Å—Ç—å, –í–í–ü, —Ä–µ–º–µ–Ω—ñ/–ª–∞–Ω—Ü—é–≥–∏, –∫–≤–∏—Ç–æ–∫ 58 –º–º, NFC</title>
<meta name="color-scheme" content="light dark">
<style>
  :root{
    --bg:#0b1220; --card:#0f172a; --muted:#94a3b8; --text:#e2e8f0;
    --accent:#22c55e; --accent-2:#60a5fa; --warn:#f59e0b; --bad:#ef4444; --good:#10b981; --line:#1f2937;
    --darkcell:#0b1324; --darkink:#e6eef9; --darkink2:#e5e7eb;
  }
  *{box-sizing:border-box}
  body{margin:0;background:linear-gradient(180deg,#0b1220,#111827 30%,#0b1220);color:var(--text);
       font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;line-height:1.55}
  .wrap{max-width:1100px;margin:0 auto;padding:24px 16px 64px}
  .badge{display:inline-block;padding:6px 10px;border:1px solid var(--line);background:#0b1220;border-radius:999px;
         font-size:12px;color:var(--muted);letter-spacing:.3px}
  h1{font-size:34px;margin:6px 0 12px;line-height:1.15;
     background:linear-gradient(90deg,#60a5fa,#22c55e);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
  h2{font-size:22px;margin:28px 0 12px} h3{font-size:18px;margin:20px 0 8px;color:#cbd5e1}
  p{margin:10px 0}.small{font-size:12px;color:#9fb0c8}.muted{color:#93a3b5}.mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Courier New",monospace}
  .btn{display:inline-block;padding:10px 14px;border-radius:10px;border:1px solid #223049;background:#0d1a2e;color:#dbeafe;text-decoration:none;cursor:pointer}
  .btn:hover{background:#0f1f39}
  .grid{display:grid;gap:12px}.g2{grid-template-columns:repeat(2,minmax(0,1fr))}.g3{grid-template-columns:repeat(3,minmax(0,1fr))}
  @media (max-width:1000px){.g2,.g3{grid-template-columns:1fr}}
  .row{display:flex;gap:10px;flex-wrap:wrap}
  .card{background:linear-gradient(180deg,#0f172a,#0b1220);border:1px solid var(--line);border-radius:16px;padding:16px;margin:12px 0;box-shadow:0 6px 24px rgba(0,0,0,.25)}
  .box{border:1px solid #223049;border-radius:12px;padding:12px;background:var(--darkcell);color:var(--darkink)}
  .ok{color:var(--good)} .warn{color:var(--warn)} .bad{color:var(--bad)}
  .table{width:100%;border-collapse:separate;border-spacing:0;overflow:auto;border-radius:12px;border:1px solid #223049}
  .table th,.table td{padding:8px 10px;border-bottom:1px solid #1f2937;font-size:14px;vertical-align:top}
  .table thead th{background:#0c1629;color:#a5b4fc;text-align:left;position:sticky;top:0}
  .table tbody tr:nth-child(even){background:var(--darkcell);color:var(--darkink2)}
  .table td.dark,.table th.dark{background:var(--darkcell)!important;color:var(--darkink2)!important}
  .out{background:var(--darkcell);color:var(--darkink2);border:1px dashed #263042;padding:10px 12px;border-radius:10px;word-break:break-all}
  input[type="text"],input[type="number"],input[type="date"],select,textarea{width:100%;padding:8px 10px;border-radius:10px;border:1px solid #223049;background:#0d1a2e;color:#e6eef9}
  /* –ö–≤–∏—Ç–æ–∫ 58 –º–º */
  .ticket{width:58mm;background:#fff;color:#000;padding:6mm 4mm;border-radius:6px;box-shadow:0 0 0 1px #e5e7eb inset;font-family:"Courier New",ui-monospace,monospace}
  .ticket h4{margin:0 0 6px;font-size:13px;text-align:center}.ticket p{margin:2px 0;font-size:12px}.ticket .line{border-top:1px dashed #111;margin:6px 0}
  .ticket small{font-size:10px}
  /* –í–±—É–¥–æ–≤–∞–Ω–æ (iframe) ‚Üí —Å–≤—ñ—Ç–ª–∏–π –≤–∏–≥–ª—è–¥ */
  html.embedded body{background:#fff;color:#111}
  html.embedded .card{background:#fff;border:1px solid #e5e7eb;box-shadow:none}
  html.embedded h1{-webkit-text-fill-color:initial;background:none;color:#111}
  html.embedded .box{background:#f8fafc;color:#111}
  html.embedded .table tbody tr:nth-child(even){background:#f3f4f6;color:#111}
  @media print{@page{margin:4mm}.no-print{display:none!important}}
</style>

<style>
/* PRINT PATCH v1 CSS (auto) */
.ticket{ font-weight:700; letter-spacing:0.1px }
.ticket h4{ font-weight:700 }
.ticket p,
.ticket b,
.ticket strong,
.ticket span,
.ticket small{ font-weight:700 }
</style>

<meta name="description" content="–ó–∞ –ø–∞—Ä—É —Å—Ç—É–¥–µ–Ω—Ç–∏ –Ω–∞–≤—á–∞—Ç—å—Å—è —Ä–∞—Ö—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–¥–∞—Ç–æ—á–Ω—ñ —á–∏—Å–ª–∞ —Ç–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å —Ä—É—Ö—É —Ç–µ—Ö–Ω—ñ–∫–∏, –ø–µ—Ä–µ—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –æ–±–µ—Ä—Ç–∏ –í–í–ü –≤—ñ–¥ –æ–±–µ—Ä—Ç—ñ–≤ –¥–≤–∏–≥—É–Ω–∞, –ø—ñ–¥–±–∏—Ä–∞—Ç–∏ —à–∫—ñ–≤–∏/–∑—ñ—Ä–æ—á–∫–∏ –¥–ª—è"><link rel="canonical" href="https://edlab.pp.ua/mech_II_kyrs/mechanic_para13.html"><meta property="og:type" content="article"><meta property="og:title" content="‚öôÔ∏è –¢—Ä–∞–Ω—Å–º—ñ—Å—ñ—è: –ø–µ—Ä–µ–¥–∞—Ç–æ—á–Ω—ñ, —à–≤–∏–¥–∫—ñ—Å—Ç—å —Ä—É—Ö—É, –í–í–ü, —Ä–µ–º–µ–Ω—ñ/–ª–∞–Ω—Ü—é–≥–∏, –∫–≤–∏—Ç–æ–∫ 58 –º–º, NFC"><meta property="og:description" content="–ó–∞ –ø–∞—Ä—É —Å—Ç—É–¥–µ–Ω—Ç–∏ –Ω–∞–≤—á–∞—Ç—å—Å—è —Ä–∞—Ö—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–¥–∞—Ç–æ—á–Ω—ñ —á–∏—Å–ª–∞ —Ç–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å —Ä—É—Ö—É —Ç–µ—Ö–Ω—ñ–∫–∏, –ø–µ—Ä–µ—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –æ–±–µ—Ä—Ç–∏ –í–í–ü –≤—ñ–¥ –æ–±–µ—Ä—Ç—ñ–≤ –¥–≤–∏–≥—É–Ω–∞, –ø—ñ–¥–±–∏—Ä–∞—Ç–∏ —à–∫—ñ–≤–∏/–∑—ñ—Ä–æ—á–∫–∏ –¥–ª—è"><meta property="og:url" content="https://edlab.pp.ua/mech_II_kyrs/mechanic_para13.html"><script type="application/ld+json">{"@context":"https://schema.org","@type":"LearningResource","name":"‚öôÔ∏è –¢—Ä–∞–Ω—Å–º—ñ—Å—ñ—è: –ø–µ—Ä–µ–¥–∞—Ç–æ—á–Ω—ñ, —à–≤–∏–¥–∫—ñ—Å—Ç—å —Ä—É—Ö—É, –í–í–ü, —Ä–µ–º–µ–Ω—ñ/–ª–∞–Ω—Ü—é–≥–∏, –∫–≤–∏—Ç–æ–∫ 58 –º–º, NFC","description":"–ó–∞ –ø–∞—Ä—É —Å—Ç—É–¥–µ–Ω—Ç–∏ –Ω–∞–≤—á–∞—Ç—å—Å—è —Ä–∞—Ö—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–¥–∞—Ç–æ—á–Ω—ñ —á–∏—Å–ª–∞ —Ç–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å —Ä—É—Ö—É —Ç–µ—Ö–Ω—ñ–∫–∏, –ø–µ—Ä–µ—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –æ–±–µ—Ä—Ç–∏ –í–í–ü –≤—ñ–¥ –æ–±–µ—Ä—Ç—ñ–≤ –¥–≤–∏–≥—É–Ω–∞, –ø—ñ–¥–±–∏—Ä–∞—Ç–∏ —à–∫—ñ–≤–∏/–∑—ñ—Ä–æ—á–∫–∏ –¥–ª—è","inLanguage":"uk","educationalLevel":"college","url":"https://edlab.pp.ua/mech_II_kyrs/mechanic_para13.html","provider":{"@type":"Organization","name":"EDLab"}}</script></head>
<body>
<div class="wrap">
  <span class="badge">–ü–∞—Ä–∞ 13 ¬∑ –∞—É–¥–∏—Ç–æ—Ä–Ω–æ ¬∑ –º–µ—Ö–∞–Ω—ñ–∫–∏</span>
  <h1>‚öôÔ∏è –¢—Ä–∞–Ω—Å–º—ñ—Å—ñ—è: –ø–µ—Ä–µ–¥–∞—Ç–æ—á–Ω—ñ, —à–≤–∏–¥–∫—ñ—Å—Ç—å —Ä—É—Ö—É, –í–í–ü, —Ä–µ–º–µ–Ω—ñ/–ª–∞–Ω—Ü—é–≥–∏, –∫–≤–∏—Ç–æ–∫ 58 –º–º, NFC</h1>

  <div class="card">
    <h2>üéØ –ú–µ—Ç–∞</h2>
    <p>
      –ó–∞ –ø–∞—Ä—É —Å—Ç—É–¥–µ–Ω—Ç–∏ –Ω–∞–≤—á–∞—Ç—å—Å—è —Ä–∞—Ö—É–≤–∞—Ç–∏ <b>–ø–µ—Ä–µ–¥–∞—Ç–æ—á–Ω—ñ —á–∏—Å–ª–∞</b> —Ç–∞ <b>—à–≤–∏–¥–∫—ñ—Å—Ç—å —Ä—É—Ö—É</b> —Ç–µ—Ö–Ω—ñ–∫–∏,
      –ø–µ—Ä–µ—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ <b>–æ–±–µ—Ä—Ç–∏ –í–í–ü</b> –≤—ñ–¥ –æ–±–µ—Ä—Ç—ñ–≤ –¥–≤–∏–≥—É–Ω–∞, –ø—ñ–¥–±–∏—Ä–∞—Ç–∏ <b>—à–∫—ñ–≤–∏/–∑—ñ—Ä–æ—á–∫–∏</b> –¥–ª—è –ø–æ—Ç—Ä—ñ–±–Ω–∏—Ö –æ–±–µ—Ä—Ç—ñ–≤,
      –æ—Ü—ñ–Ω—é–≤–∞—Ç–∏ <b>–¥–æ–≤–∂–∏–Ω—É —Ç–∞ –Ω–∞—Ç—è–≥ —Ä–µ–º–µ–Ω—è/–ª–∞–Ω—Ü—é–≥–∞</b>, –≤–µ—Å—Ç–∏ <b>–∂—É—Ä–Ω–∞–ª</b>, —Ñ–æ—Ä–º—É–≤–∞—Ç–∏ <b>–∫–≤–∏—Ç–æ–∫</b>, <b>NFC</b> —ñ <b>CSV</b>.
    </p>
    <p class="small">–ù–∞–≥–∞–¥—É–≤–∞–Ω–Ω—è: v(–∫–º/–≥–æ–¥) ‚âà <span class="mono">œâ–¥–≤ / (i–ö–ü–ü¬∑i–ì–ü¬∑i–†–æ–∑–¥) ¬∑ (œÄ¬∑D–∫–æ–ª–∞) ¬∑ 60 / 1000</span> (–±–µ–∑ –±—É–∫—Å—É–≤–∞–Ω–Ω—è);
      —Ä–µ–º—ñ–Ω—å L‚âà<span class="mono">2C + œÄ(R+r) + (R‚àír)^2/C</span>; V-–ø—Ä–æ—Ñ—ñ–ª—å: –Ω–∞—Ç—è–≥ –ø–æ –¥–æ–ø—É—Å—Ç–∏–º–æ–º—É –ø—Ä–æ–≥–∏–Ω—É, –ª–∞–Ω—Ü—é–≥ ‚Äî –∑–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—é –ª–∞–Ω–æ–∫ —ñ —Ä–µ–≥—É–ª—é–≤–∞–Ω–Ω—è–º —Ü–µ–Ω—Ç—Ä–∞ C.</p>
  </div>

  <!-- 1. –®–í–ò–î–ö–Ü–°–¢–¨ –†–£–•–£ -->
  <div class="card">
    <h2>üöú –®–≤–∏–¥–∫—ñ—Å—Ç—å —Ä—É—Ö—É (Ground Speed)</h2>
    <div class="grid g3">
      <div class="box">
        <h3>–ü–∞—Ä–∞–º–µ—Ç—Ä–∏</h3>
        <div class="row">
          <div style="flex:1"><label>–û–±–µ—Ä—Ç–∏ –¥–≤–∏–≥—É–Ω–∞, –æ–±/—Ö–≤</label><input id="rpm" type="number" step="1" value="1800"></div>
          <div style="flex:1"><label>–ü–µ—Ä–µ–¥–∞—á–∞ –ö–ü–ü (i)</label><input id="ig" type="number" step="0.001" value="4.200"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <div style="flex:1"><label>–ì–æ–ª–æ–≤–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ (i)</label><input id="ifd" type="number" step="0.001" value="3.800"></div>
          <div style="flex:1"><label>–†–æ–∑–¥–∞—Ç–∫–∞/—Ä–µ–¥—É–∫—Ç–æ—Ä (i)</label><input id="irt" type="number" step="0.001" value="1.000"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <div style="flex:1"><label>D —à–∏–Ω–∏, –º–º</label><input id="Dtire" type="number" step="1" value="1500"></div>
          <div style="flex:1"><label>–ë—É–∫—Å—É–≤–∞–Ω–Ω—è, %</label><input id="slip" type="number" step="1" value="5"></div>
        </div>
      </div>
      <div class="box">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
        <p>–ö—É—Ç–æ–≤–∞ –Ω–∞ –∫–æ–ª–µ—Å—ñ: <b><span id="wheelRPM">‚Äî</span></b> –æ–±/—Ö–≤</p>
        <p>–¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å: <b><span id="vTheo">‚Äî</span></b> –∫–º/–≥–æ–¥</p>
        <p>–ó —É—Ä–∞—Ö. –±—É–∫—Å—É–≤–∞–Ω–Ω—è: <b><span id="vReal">‚Äî</span></b> –∫–º/–≥–æ–¥</p>
      </div>
      <div class="box">
        <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
        <div class="row">
          <button class="btn" onclick="calcSpeed()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="presetSpeed()">üß™ –ü—Ä–∏–∫–ª–∞–¥</button>
          <button class="btn" onclick="copyCSV('csvSpeed')">üìã CSV (speed)</button>
        </div>
        <div id="csvSpeed" class="out" style="margin-top:8px">‚Äî</div>
      </div>
    </div>
  </div>

  <!-- 2. –í–í–ü / PTO -->
  <div class="card">
    <h2>üîÑ –í–í–ü (PTO) ‚Äî 540/1000 –æ–±/—Ö–≤</h2>
    <div class="grid g3">
      <div class="box">
        <h3>–ü–∞—Ä–∞–º–µ—Ç—Ä–∏</h3>
        <div class="row">
          <div style="flex:1"><label>–û–±–µ—Ä—Ç–∏ –¥–≤–∏–≥—É–Ω–∞, –æ–±/—Ö–≤</label><input id="rpm2" type="number" step="1" value="1800"></div>
          <div style="flex:1"><label>i –¥–≤–∏–≥—É–Ω‚Üí–í–í–ü</label><input id="ipto" type="number" step="0.001" value="3.000"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <div style="flex:1"><label>–¶—ñ–ª—å –í–í–ü, –æ–±/—Ö–≤</label>
            <select id="ptoTarget"><option value="540">540</option><option value="1000" selected="">1000</option></select>
          </div>
          <div style="flex:1"><label>–†–µ–∂–∏–º</label>
            <select id="ptoMode"><option value="fromEngine">–¥–≤–∏–≥—É–Ω ‚Üí –í–í–ü</option><option value="toEngine">—Ü—ñ–ª—å –í–í–ü ‚Üí –ø–æ—Ç—Ä—ñ–±–Ω—ñ –æ–±–µ—Ä—Ç–∏ –¥–≤–∏–≥—É–Ω–∞</option></select>
          </div>
        </div>
      </div>
      <div class="box">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
        <p>–û–±/—Ö–≤ –í–í–ü: <b><span id="ptoRPM">‚Äî</span></b></p>
        <p>–ü–æ—Ç—Ä—ñ–±–Ω—ñ –æ–±/—Ö–≤ –¥–≤–∏–≥—É–Ω–∞ –¥–ª—è —Ü—ñ–ª—ñ: <b><span id="needRPM">‚Äî</span></b></p>
        <p>–°—Ç–∞—Ç—É—Å: <b><span id="ptoFlag">‚Äî</span></b></p>
      </div>
      <div class="box">
        <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
        <div class="row">
          <button class="btn" onclick="calcPTO()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="copyCSV('csvPTO')">üìã CSV (pto)</button>
        </div>
        <div id="csvPTO" class="out" style="margin-top:8px">‚Äî</div>
      </div>
    </div>
    <p class="small muted">–ü–∞–º‚Äô—è—Ç–∫–∞: <span class="mono">n–í–í–ü = n–¥–≤ / i</span>; –∑–≤–æ—Ä–æ—Ç–Ω–æ: <span class="mono">n–¥–≤ = n–í–í–ü¬∑i</span>.</p>
  </div>

  <!-- 3. –®–ö–Ü–í–ò / –ó–Ü–†–û–ß–ö–ò -->
  <div class="card">
    <h2>üßØ –®–∫—ñ–≤–∏/–∑—ñ—Ä–æ—á–∫–∏ ‚Äî –ø–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫ –æ–±–µ—Ä—Ç—ñ–≤</h2>
    <div class="grid g3">
      <div class="box">
        <h3>–í–∏—Ö—ñ–¥–Ω—ñ</h3>
        <div class="row">
          <div style="flex:1"><label>–í–µ–¥—É—á–∏–π √ò, –º–º</label><input id="d1" type="number" step="0.1" value="120"></div>
          <div style="flex:1"><label>–í–µ–¥–µ–Ω–∏–π √ò, –º–º</label><input id="d2" type="number" step="0.1" value="200"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <div style="flex:1"><label>n –≤–µ–¥—É—á–∏–π, –æ–±/—Ö–≤</label><input id="n1" type="number" step="1" value="1800"></div>
          <div style="flex:1"><label>–¢–∏–ø</label>
            <select id="driveType"><option value="belt" selected="">—Ä–µ–º–µ–Ω–µ–≤–∏–π</option><option value="chain">–ª–∞–Ω—Ü—é–≥–æ–≤–∏–π (–∑—ñ—Ä–æ—á–∫–∏)</option></select>
          </div>
        </div>
      </div>
      <div class="box">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
        <p>–ü–µ—Ä–µ–¥–∞—Ç–æ—á–Ω–µ i: <b><span id="i12">‚Äî</span></b></p>
        <p>n –≤–µ–¥–µ–Ω–∏–π: <b><span id="n2">‚Äî</span></b> –æ–±/—Ö–≤</p>
        <p>–û–±–µ—Ä—Ç–∏ –∑–º—ñ–Ω–∏—Ç–∏ –¥–æ —Ü—ñ–ª—ñ: <b><span id="tuneTip">‚Äî</span></b></p>
      </div>
      <div class="box">
        <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è</h3>
        <div class="row">
          <button class="btn" onclick="calcPulley()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="copyCSV('csvPulley')">üìã CSV (pulleys)</button>
        </div>
        <div id="csvPulley" class="out" style="margin-top:8px">‚Äî</div>
      </div>
    </div>
    <p class="small muted">–†–µ–º–µ–Ω—ñ/–ª–∞–Ω—Ü—é–≥–∏ —ñ–¥–µ–∞–ª—å–Ω–æ: <span class="mono">i ‚âà D2/D1</span> (–∞–±–æ <span class="mono">Z2/Z1</span> –¥–ª—è –∑—ñ—Ä–æ—á–æ–∫).</p>
  </div>

  <!-- 4. –î–û–í–ñ–ò–ù–ê –¢–ê –ù–ê–¢–Ø–ì –†–ï–ú–ï–ù–Ø/–õ–ê–ù–¶–Æ–ì–ê -->
  <div class="card">
    <h2>‚õìÔ∏è –î–æ–≤–∂–∏–Ω–∞ —Ç–∞ –Ω–∞—Ç—è–≥ —Ä–µ–º–µ–Ω—è / –ª–∞–Ω—Ü—é–≥–∞</h2>
    <div class="grid g2">
      <div class="box">
        <h3>–†–µ–º—ñ–Ω—å (–∫–ª–∏–Ω–æ–≤–∏–π)</h3>
        <div class="row">
          <div style="flex:1"><label>√ò –≤–µ–¥—É—á–∏–π, –º–º</label><input id="bd1" type="number" step="0.1" value="120"></div>
          <div style="flex:1"><label>√ò –≤–µ–¥–µ–Ω–∏–π, –º–º</label><input id="bd2" type="number" step="0.1" value="200"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <div style="flex:1"><label>–ú—ñ–∂–æ—Å—å–æ–≤–∞ C, –º–º</label><input id="bC" type="number" step="1" value="600"></div>
          <div style="flex:1"><label>ŒîC —Ä–µ–≥—É–ª—é–≤–∞–Ω–Ω—è, –º–º</label><input id="bAdj" type="number" step="1" value="30"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <button class="btn" onclick="calcBelt()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="copyCSV('csvBelt')">üìã CSV (belt)</button>
        </div>
        <div class="out" id="csvBelt" style="margin-top:8px">‚Äî</div>
      </div>
      <div class="box">
        <h3>–õ–∞–Ω—Ü—é–≥ (—Ä–æ–ª–∏–∫–æ–≤–∏–π)</h3>
        <div class="row">
          <div style="flex:1"><label>–ö-—Ç—å –∑—É–±—ñ–≤ Z1/Z2</label><input id="cz1" type="number" step="1" value="15"></div>
          <div style="flex:1"><label>‚Äî</label><input id="cz2" type="number" step="1" value="25"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <div style="flex:1"><label>–ö—Ä–æ–∫ t, –º–º</label><input id="ct" type="number" step="0.01" value="12.7"></div>
          <div style="flex:1"><label>–ú—ñ–∂–æ—Å—å–æ–≤–∞ C, –º–º</label><input id="cC" type="number" step="1" value="600"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <button class="btn" onclick="calcChain()">üîÅ –ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="copyCSV('csvChain')">üìã CSV (chain)</button>
        </div>
        <div class="out" id="csvChain" style="margin-top:8px">‚Äî</div>
      </div>
    </div>
    <p class="small muted">–†–µ–º—ñ–Ω—å: L‚âà2C+œÄ(R+r)+(R‚àír)^2/C, –¥–µ R=D/2 (–º–º). –õ–∞–Ω—Ü—é–≥ (–Ω–∞–±–ª–∏–∂–µ–Ω–æ): L–ª–∞–Ω–∫‚âà<span class="mono">2C/t + (Z1+Z2)/2 + ((Z2‚àíZ1)^2)¬∑t/(4œÄ¬≤¬∑C)</span>.</p>
  </div>

  <!-- 5. –ñ–£–†–ù–ê–õ–ò -->
  <div class="card">
    <h2>üìí –ñ—É—Ä–Ω–∞–ª–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤</h2>
    <div class="row">
      <button class="btn" onclick="addRow()">‚ûï –î–æ–¥–∞—Ç–∏ —Ä—è–¥–æ–∫</button>
      <button class="btn" onclick="presetRows()">üß™ –ü—Ä–∏–∫–ª–∞–¥</button>
      <button class="btn" onclick="copyCSV('csvLog')">üìã CSV (journal)</button>
    </div>
    <div style="overflow:auto;margin-top:8px">
      <table class="table" id="tbl">
        <thead>
          <tr>
            <th>#</th>
            <th>–í—É–∑–æ–ª</th>
            <th>i (–∞–±–æ D/Z)</th>
            <th class="dark">n1‚Üín2</th>
            <th class="dark">v, –∫–º/–≥–æ–¥</th>
            <th class="dark">PTO</th>
            <th>–†–µ–º—ñ–Ω—å/–õ–∞–Ω—Ü—é–≥ (L‚Ä¶)</th>
            <th>–ü—Ä–∏–º—ñ—Ç–∫–∞</th>
          </tr>
        </thead>
        <tbody id="body"></tbody>
      </table>
    </div>
    <div id="csvLog" class="out" style="margin-top:8px">‚Äî</div>
  </div>

  <!-- 6. –ö–í–ò–¢–û–ö + NFC -->
  <div class="card">
    <h2>üßæ –ö–≤–∏—Ç–æ–∫ 58 –º–º —Ç–∞ NFC</h2>
    <div class="grid g2">
      <div class="box">
        <h3>NFC ‚Äî ‚ÄúDRIVELINE CARD‚Äù</h3>
        <div class="row">
          <div style="flex:1"><label>–ú–∞—à–∏–Ω–∞/–ø—Ä–∏–≤—ñ–¥</label><input id="nfcId" type="text" value="TR-001/Drive-A"></div>
          <div style="flex:1"><label>–ö–æ–Ω—Ç–∞–∫—Ç</label><input id="nfcPhone" type="text" value="+380XXXXXXXXX"></div>
        </div>
        <div class="row" style="margin-top:6px">
          <button class="btn" onclick="buildNFC()">üß© –ó—ñ–±—Ä–∞—Ç–∏</button>
          <button class="btn" onclick="copyEl('nfcOut')">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏</button>
        </div>
        <div id="nfcOut" class="out">‚Äî</div>
      </div>
      <div class="box">
        <h3>–ö–≤–∏—Ç–æ–∫ ‚ÄúDRIVELINE CHECK‚Äù</h3>
        <div class="row">
          <button class="btn" onclick="buildTicket()">üßæ –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏</button>
          <button class="btn" onclick="printTicketNewTab()">üñ®Ô∏è –î—Ä—É–∫</button>
        </div>
        <div class="ticket" id="ticket" style="margin-top:8px">
          <h4>DRIVELINE CHECK</h4>
          <p id="tDate"><small>–î–∞—Ç–∞: ‚Äî</small></p>
          <div class="line"></div>
          <p><b>v(–∫–º/–≥–æ–¥):</b> <span id="tV">‚Äî</span></p>
          <p><b>n –∫–æ–ª–µ—Å–æ:</b> <span id="tWh">‚Äî</span> –æ–±/—Ö–≤</p>
          <p><b>PTO:</b> <span id="tPTO">‚Äî</span></p>
          <p><b>–®–∫—ñ–≤–∏/–∑—ñ—Ä–æ—á–∫–∏:</b> <span id="tPul">‚Äî</span></p>
          <p><b>–†–µ–º—ñ–Ω—å/–ª–∞–Ω—Ü—é–≥:</b> <span id="tBL">‚Äî</span></p>
          <div class="line"></div>
          <p><small id="tNote">–ü—Ä–∏–º.: ‚Äî</small></p>
        </div>
      </div>
    </div>
  </div>

  <!-- 7. –•–Ü–î –†–û–ë–û–¢–ò + –û–¶–Ü–ù–Æ–í–ê–ù–ù–Ø -->
  <div class="card">
    <h2>ü™ú –•—ñ–¥ —Ä–æ–±–æ—Ç–∏ (45‚Äì70 —Ö–≤)</h2>
    <ol>
      <li>–†–æ–∑—Ä–∞—Ö—É–π <b>v</b> —Ç–∞ <b>n –∫–æ–ª–µ—Å–∞</b> –¥–ª—è 2‚Äì3 –ø–µ—Ä–µ–¥–∞—á —ñ –¥–≤–æ—Ö –¥—ñ–∞–º–µ—Ç—Ä—ñ–≤ —à–∏–Ω.</li>
      <li>–ü–µ—Ä–µ–≤—ñ—Ä <b>–í–í–ü</b> (540/1000) ‚Äî –ø—ñ–¥–±–µ—Ä–∏ –æ–±–µ—Ä—Ç–∏ –¥–≤–∏–≥—É–Ω–∞ / –∞–±–æ –æ—Ü—ñ–Ω—é–π –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è.</li>
      <li>–ü—ñ–¥—ñ–±–µ—Ä–∏ <b>—à–∫—ñ–≤–∏/–∑—ñ—Ä–æ—á–∫–∏</b> –ø—ñ–¥ –∑–∞–¥–∞–Ω—É —Ü—ñ–ª—å –æ–±–µ—Ä—Ç—ñ–≤.</li>
      <li>–û—Ü—ñ–Ω–∏ <b>–¥–æ–≤–∂–∏–Ω—É —Ä–µ–º–µ–Ω—è</b> —ñ <b>–ª–∞–Ω—Ü—é–≥–∞</b>, –ø–µ—Ä–µ–≤—ñ—Ä –∑–∞–ø–∞—Å —Ä–µ–≥—É–ª—é–≤–∞–Ω–Ω—è.</li>
      <li>–ó–∞–ø–æ–≤–Ω–∏ <b>–∂—É—Ä–Ω–∞–ª</b> (‚â•3 —Ä—è–¥–∫–∏), –∑–≥–µ–Ω–µ—Ä—É–π <b>NFC</b>, <b>–∫–≤–∏—Ç–æ–∫</b> —Ç–∞ <b>CSV</b> (<span class="mono">Driveline</span>).</li>
    </ol>
  </div>

  <div class="card">
    <h2>‚úÖ –û—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è (10 –±–∞–ª—ñ–≤)</h2>
    <table class="table">
      <thead><tr><th>–ö—Ä–∏—Ç–µ—Ä—ñ–π</th><th>–ë–∞–ª–∏</th></tr></thead>
      <tbody>
        <tr><td>–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —à–≤–∏–¥–∫–æ—Å—Ç—ñ/–í–í–ü –∫–æ—Ä–µ–∫—Ç–Ω–∏–π</td><td>4</td></tr>
        <tr><td>–ü—ñ–¥—ñ–±—Ä–∞–Ω—ñ —à–∫—ñ–≤–∏/–∑—ñ—Ä–æ—á–∫–∏ –¥–æ —Ü—ñ–ª—å–æ–≤–∏—Ö –æ–±–µ—Ä—Ç—ñ–≤</td><td>3</td></tr>
        <tr><td>–†–µ–º—ñ–Ω—å/–ª–∞–Ω—Ü—é–≥: –¥–æ–≤–∂–∏–Ω–∞/—Ä–µ–≥—É–ª—é–≤–∞–Ω–Ω—è –æ–±“ë—Ä—É–Ω—Ç–æ–≤–∞–Ω—ñ</td><td>2</td></tr>
        <tr><td>–ö–≤–∏—Ç–æ–∫/NFC + CSV</td><td>1</td></tr>
      </tbody>
    </table>
  </div>
</div>

<script>
  // –í–±—É–¥–æ–≤–∞–Ω–∏–π —Ä–µ–∂–∏–º (Moodle iFrame)
  (function(){ if (window.self !== window.top) document.documentElement.classList.add('embedded'); })();

  const byId = id => document.getElementById(id);
  const rnd = (n,d=2)=>Number((+n).toFixed(d));
  const bodyEl = document.getElementById('body');

  // ===== 1) –®–≤–∏–¥–∫—ñ—Å—Ç—å —Ä—É—Ö—É =====
  function calcSpeed(){
    const rpm = +byId('rpm').value||0;
    const ig  = +byId('ig').value||1;
    const ifd = +byId('ifd').value||1;
    const irt = +byId('irt').value||1;
    const Dmm = +byId('Dtire').value||0;
    const slip = (+byId('slip').value||0)/100;

    const iTot = ig*ifd*irt;
    const wheelRPM = iTot>0 ? rpm/iTot : 0;
    const C = Math.PI * (Dmm/1000); // –º
    const vTheo = (wheelRPM * C * 60) / 1000; // –∫–º/–≥–æ–¥
    const vReal = vTheo * (1 - slip);

    byId('wheelRPM').textContent = rnd(wheelRPM,1);
    byId('vTheo').textContent = rnd(vTheo,2);
    byId('vReal').textContent = rnd(vReal,2);

    const csv = `SPEED|rpm=${rpm}|iTot=${rnd(iTot,3)}|wheelRPM=${rnd(wheelRPM,1)}|D=${Dmm}mm|vTheo=${rnd(vTheo,2)}kmh|vReal=${rnd(vReal,2)}kmh|slip=${(slip*100).toFixed(1)}%`;
    byId('csvSpeed').textContent = csv;

    return {wheelRPM,vTheo,vReal,iTot};
  }
  function presetSpeed(){
    byId('rpm').value=2000; byId('ig').value=3.200; byId('ifd').value=4.100; byId('irt').value=1.000; byId('Dtire').value=1580; byId('slip').value=6;
    calcSpeed();
  }

  // ===== 2) PTO =====
  function calcPTO(){
    const rpm = +byId('rpm2').value||0;
    const i   = +byId('ipto').value||1;
    const target = +byId('ptoTarget').value||540;
    const mode = byId('ptoMode').value;

    const pto = i>0 ? rpm / i : 0;
    const need = target * i;

    let flag='‚Äî', color='#10b981';
    const diff = pto - target;
    if(Math.abs(diff)<=10) { flag='üü¢ –≤ –Ω–æ—Ä–º—ñ (¬±10 –æ–±/—Ö–≤)'; }
    else if(Math.abs(diff)<=50) { flag='üü† –±–ª–∏–∑—å–∫–æ'; color='#f59e0b'; }
    else { flag='üî¥ –¥–∞–ª–µ–∫–æ'; color='#ef4444'; }

    byId('ptoRPM').textContent = rnd(pto,0);
    byId('needRPM').textContent = mode==='toEngine'? rnd(need,0) : '‚Äî';
    byId('ptoFlag').textContent = flag; byId('ptoFlag').style.color = color;

    const csv = `PTO|rpmEngine=${rpm}|i=${i}|pto=${rnd(pto,0)}rpm|target=${target}|needEngine=${rnd(need,0)}rpm|flag=${flag}`;
    byId('csvPTO').textContent = csv;

    return {pto,need,flag};
  }

  // ===== 3) –®–∫—ñ–≤–∏ / –∑—ñ—Ä–æ—á–∫–∏ =====
  function calcPulley(){
    const d1 = +byId('d1').value||0;
    const d2 = +byId('d2').value||0;
    const n1 = +byId('n1').value||0;
    const type = byId('driveType').value;

    const i = (d1>0)? (d2/d1) : 0; // –∞–±–æ Z2/Z1
    const n2 = i>0 ? n1/i : 0;

    let tip='‚Äî';
    if(n2>0){
      tip = (n2>1000)? '–∑–º–µ–Ω—à–∏—Ç–∏ D2 –∞–±–æ –∑–±—ñ–ª—å—à–∏—Ç–∏ D1' : (n2<300? '–∑–±—ñ–ª—å—à–∏—Ç–∏ D2 –∞–±–æ –∑–º–µ–Ω—à–∏—Ç–∏ D1' : '–ø–æ—Ö–æ–∂–µ –æ–∫');
    }

    byId('i12').textContent = rnd(i,3);
    byId('n2').textContent = rnd(n2,0);
    byId('tuneTip').textContent = tip;

    const csv = `PULLEY|type=${type}|D1=${d1}mm|D2=${d2}mm|i=${rnd(i,3)}|n1=${n1}rpm|n2=${rnd(n2,0)}rpm|tip=${tip}`;
    byId('csvPulley').textContent = csv;

    return {i,n2,tip};
  }

  // ===== 4) –†–µ–º—ñ–Ω—å / –ª–∞–Ω—Ü—é–≥ =====
  function calcBelt(){
    const D1 = +byId('bd1').value||0, R = D1/2;
    const D2 = +byId('bd2').value||0, r = D2/2;
    const C  = +byId('bC').value||0;
    const Adj= +byId('bAdj').value||0;

    // –§–æ—Ä–º—É–ª–∞ —Å–µ—Ä–µ–¥–Ω—å–æ—ó –¥–æ–≤–∂–∏–Ω–∏ (–º–º)
    const L = 2*C + Math.PI*(R+r) + ((R-r)*(R-r))/C;
    const Lmin = 2*(C-Adj) + Math.PI*(R+r) + ((R-r)*(R-r))/(C-Adj);
    const Lmax = 2*(C+Adj) + Math.PI*(R+r) + ((R-r)*(R-r))/(C+Adj);

    const csv = `BELT|D1=${D1}mm|D2=${D2}mm|C=${C}mm|Adj=¬±${Adj}mm|L=${rnd(L,0)}mm|Lrange=[${rnd(Lmin,0)}..${rnd(Lmax,0)}]mm`;
    byId('csvBelt').textContent = csv;

    return {L,Lmin,Lmax};
  }

  function calcChain(){
    const Z1 = +byId('cz1').value||0;
    const Z2 = +byId('cz2').value||0;
    const t  = +byId('ct').value||0; // –º–º
    const C  = +byId('cC').value||0; // –º–º

    // –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ª–∞–Ω–æ–∫ (–Ω–∞–±–ª–∏–∂–µ–Ω–∞ –∫–ª–∞—Å–∏–∫–∞)
    const Llinks = 2*(C/t) + (Z1+Z2)/2 + ((Z2-Z1)*(Z2-Z1))*t/(4*Math.PI*Math.PI*C);
    const Lmm = Llinks * t;

    const csv = `CHAIN|Z1=${Z1}|Z2=${Z2}|t=${t}mm|C=${C}mm|Links‚âà${rnd(Llinks,1)}|L‚âà${rnd(Lmm,0)}mm`;
    byId('csvChain').textContent = csv;

    return {Llinks,Lmm};
  }

  // ===== 5) –ñ—É—Ä–Ω–∞–ª =====
  function addRow(sample){
    const sp = calcSpeed(), pto = calcPTO(), pl = calcPulley();
    const b = calcBelt(), c = calcChain();
    const def = {
      node:'–ü—Ä–∏–≤—ñ–¥ –∂–∞—Ç–∫–∏', io:rnd(pl.i,3), n:`${byId('n1').value}‚Üí${pl.n2?rnd(pl.n2,0):'‚Äî'}`,
      v:rnd(sp.vReal,2), pto:`${rnd(pto.pto,0)}rpm(${pto.flag})`,
      belt:`${rnd(b.L,0)}–º–º`, note:'–æ–∫'
    };
    const s = Object.assign({}, def, sample||{});
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td class="idx">1</td>
      <td><input type="text" value="${s.node}"></td>
      <td>${s.io}</td>
      <td class="dark">${s.n}</td>
      <td class="dark">${s.v}</td>
      <td class="dark">${s.pto}</td>
      <td>${s.belt}; chain‚âà${rnd(c.Lmm,0)}–º–º</td>
      <td><input type="text" value="${s.note}"></td>
    `;
    bodyEl.appendChild(tr); reindex(); buildCSVlog();
  }
  function reindex(){ [...bodyEl.querySelectorAll('tr')].forEach((tr,i)=>tr.querySelector('.idx').textContent=i+1); }
  function presetRows(){
    bodyEl.innerHTML='';
    const sp = calcSpeed(); const pto = calcPTO(); const pl = calcPulley(); const b = calcBelt(); const c = calcChain();
    addRow({node:'–ü—Ä–∏–≤—ñ–¥ –≤–µ–Ω—Ç–∏–ª—è—Ç–æ—Ä–∞', io:rnd(pl.i,3), n:`${byId('n1').value}‚Üí${rnd(pl.n2,0)}`, v:rnd(sp.vReal,2), pto:`${rnd(pto.pto,0)}rpm(${pto.flag})`, belt:`${rnd(b.L,0)}–º–º`, note:'–Ω–∞—Ç—è–≥ –æ–∫'});
    addRow({node:'–ü—Ä–∏–≤—ñ–¥ –º–æ–ª–æ—Ç–∏–ª—å–Ω–æ–≥–æ –±–∞—Ä–∞–±–∞–Ω–∞', io:'1.667', n:'1500‚Üí900', v:'‚Äî', pto:'‚Äî', belt:`${rnd(b.L,0)}–º–º`, note:'–∑–∞–ø–∞—Å —Ä–µ–≥—É–ª—é–≤–∞–Ω–Ω—è +20–º–º'});
    addRow({node:'PTO ‚Üí –ø–æ–¥—Ä—ñ–±–Ω—é–≤–∞—á', io:'0.750', n:'1000‚Üí750', v:'‚Äî', pto:`${rnd(pto.pto,0)}rpm`, belt:`chain‚âà${rnd(c.Lmm,0)}–º–º`, note:'–∑—ñ—Ä–æ—á–∫–∏ 18/24'});
    buildCSVlog();
  }
  function buildCSVlog(){
    const lines = [...bodyEl.querySelectorAll('tr')].map(tr=>{
      const idx=tr.querySelector('.idx').textContent.trim();
      const node=tr.children[1].querySelector('input').value.trim();
      const io  =tr.children[2].textContent.trim();
      const n   =tr.children[3].textContent.trim();
      const v   =tr.children[4].textContent.trim();
      const pto =tr.children[5].textContent.trim();
      const bl  =tr.children[6].textContent.trim();
      const note=tr.children[7].querySelector('input').value.trim();
      return [idx,node,io,n,v,pto,bl,note].join(' | ');
    });
    byId('csvLog').textContent = lines.join('\n') || '‚Äî';
  }

  // ===== 6) –ö–≤–∏—Ç–æ–∫ / NFC =====
  function buildTicket(){
    const sp = calcSpeed(); const pto = calcPTO(); const pl = calcPulley();
    const b = calcBelt(); const c = calcChain();
    const d = new Date().toISOString().slice(0,10);
    byId('tDate').innerHTML = `<small>–î–∞—Ç–∞: ${d}</small>`;
    byId('tV').textContent = `${rnd(sp.vReal,2)} (—Ç–µ–æ—Ä. ${rnd(sp.vTheo,2)})`;
    byId('tWh').textContent = rnd(sp.wheelRPM,1);
    byId('tPTO').textContent = `${rnd(pto.pto,0)} rpm (${pto.flag})`;
    byId('tPul').textContent = `i=${byId('i12').textContent}, n2=${byId('n2').textContent} rpm`;
    byId('tBL').textContent = `belt‚âà${rnd(b.L,0)}–º–º, chain‚âà${rnd(c.Lmm,0)}–º–º`;
    byId('tNote').textContent = `iTot=${rnd(sp.iTot||(+byId('ig').value*+byId('ifd').value*+byId('irt').value),3)}; D=${byId('Dtire').value}–º–º; slip=${byId('slip').value}%`;
  }

  function buildNFC(){
    const sp = calcSpeed(); const pto = calcPTO(); const pl = calcPulley(); const b = calcBelt(); const c = calcChain();
    const text = [
      `DRIVELINE_NFC`,
      `ID:${byId('nfcId').value}`,
      `SPEED:v=${rnd(sp.vReal,2)}kmh (wheel=${rnd(sp.wheelRPM,1)}rpm)`,
      `PTO:${rnd(pto.pto,0)}rpm target=${byId('ptoTarget').value}`,
      `PULLEY:i=${byId('i12').textContent} n2=${byId('n2').textContent}rpm`,
      `BELT‚âà${rnd(b.L,0)}mm; CHAIN‚âà${rnd(c.Lmm,0)}mm`,
      `CONTACT:${byId('nfcPhone').value}`,
      `STAMP:${new Date().toISOString().slice(0,19).replace('T',' ')}`
    ].join('\n');
    byId('nfcOut').textContent = text;
  }

  // ===== –£—Ç–∏–ª—ñ—Ç–∏ =====
  function copyCSV(id){
    const t = document.getElementById(id).textContent.trim();
    if(!t||t==='‚Äî'){ alert('–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è'); return; }
    navigator.clipboard.writeText(t).then(()=>flash('‚úÖ CSV —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'),()=>flash('–ù–µ –≤–¥–∞–ª–æ—Å—è'));
  }
  function copyEl(id){
    const t = byId(id).textContent.trim();
    if(!t||t==='‚Äî'){ alert('–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö'); return; }
    navigator.clipboard.writeText(t).then(()=>flash('‚úÖ –°–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ'),()=>flash('–ù–µ –≤–¥–∞–ª–æ—Å—è'));
  }
  function flash(msg){ const o=document.title; document.title=msg; setTimeout(()=>document.title=o,900); }

  // ===== –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è =====
  (function init(){
    calcSpeed(); calcPTO(); calcPulley(); calcBelt(); calcChain();
    document.addEventListener('change', e=>{
      if(e.target.matches('input,select')) { calcSpeed(); calcPTO(); calcPulley(); calcBelt(); calcChain(); }
    });
  })();
</script>

<script>
// PRINT PATCH v1 (auto)
function printTicketNewTab(){
  var ticket = document.getElementById('ticket');
  if(!ticket){ alert('–ù–µ–º–∞—î #ticket –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ'); return; }
  try{
    var someTxt = (document.querySelector('#ticket span, #ticket p, #ticket h4')||{}).textContent||'';
    if(!someTxt || someTxt.trim()==='‚Äî'){ if(typeof buildTicket==='function') buildTicket(); }
  }catch(_){}

  var css = `
    @media print { @page { size:58mm auto; margin:0 } }
    html,body{ margin:0; padding:0; background:#fff; color:#000 }
    .ticket{
      width:58mm; margin:0; padding:6mm 4mm; background:#fff; color:#000;
      font-family:"Courier New", Courier, monospace; font-weight:700; letter-spacing:0.1px;
      border:none; box-shadow:none; border-radius:0
    }
    .ticket h4{ margin:0 0 6px; font-size:13px; text-align:center; font-weight:700 }
    .ticket p{ margin:2px 0; font-size:12px; font-weight:700 }
    .ticket b,.ticket strong,.ticket span{ font-weight:700 }
    .line{ border-top:1px dashed #111; margin:6px 0 }
    small{ font-size:10px; font-weight:700 }
  `;
  var html = `<!DOCTYPE html><html><head><meta charset="utf-8"><title>–ß–µ–∫ 58 –º–º</title><style>${css}</style></head><body>${ticket.outerHTML}
  <script>
    window.addEventListener('load',()=>{
      try{ window.focus(); window.print(); if(window.opener) window.opener.postMessage({type:'ticketPrint',status:'invoked'},'*'); }
      catch(e){ if(window.opener) window.opener.postMessage({type:'ticketPrint',status:'error'},'*'); }
    });
  <\/script>
  </body></html>`;

  var w = window.open('', '_blank');
  if(!w){ openTicketOnly(); return; }  // –ø–æ–ø–∞–ø –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ ‚Äî —Ñ–æ–ª–±–µ–∫
  w.document.open(); w.document.write(html); w.document.close();

  var timer = setTimeout(()=>{ openTicketOnly(); }, 1200);
  window.addEventListener('message', (ev)=>{
    if(ev && ev.data && ev.data.type==='ticketPrint'){ clearTimeout(timer); }
  }, {once:true});
}

function openTicketOnly(){
  var ticket = document.getElementById('ticket');
  if(!ticket){ alert('–ù–µ–º–∞—î #ticket –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ'); return; }
  try{
    var someTxt = (document.querySelector('#ticket span, #ticket p, #ticket h4')||{}).textContent||'';
    if(!someTxt || someTxt.trim()==='‚Äî'){ if(typeof buildTicket==='function') buildTicket(); }
  }catch(_){}

  var css = `
    @media print { @page { size:58mm auto; margin:0 } }
    html,body{ margin:0; background:#fff; color:#000 }
    .ticket{
      width:58mm; margin:0; padding:6mm 4mm; background:#fff; color:#000;
      font-family:"Courier New", Courier, monospace; font-weight:700; letter-spacing:0.1px;
      border:none; box-shadow:none; border-radius:0
    }
    .ticket h4{ margin:0 0 6px; font-size:13px; text-align:center; font-weight:700 }
    .ticket p{ margin:2px 0; font-size:12px; font-weight:700 }
    .line{ border-top:1px dashed #111; margin:6px 0 }
    small{ font-size:10px; font-weight:700 }
  `;
  var html = `<!DOCTYPE html><html><head><meta charset="utf-8"><title>–ß–µ–∫ 58 –º–º</title><style>${css}</style></head><body>${ticket.outerHTML}
<script>window.addEventListener('load',()=>{ try{ window.focus(); window.print(); }catch(e){} });<\/script>
</body></html>`;

  var blob = new Blob([html], {type:'text/html'});
  var url = URL.createObjectURL(blob);
  window.open(url, '_blank');
  setTimeout(()=>URL.revokeObjectURL(url), 60000);
}
</script>



</body></html>